---
title: "datadog-agent のログ連携の不具合調査"
date: "2022-01-27T07:47:57+09:00"
dates: [2022/01]
cover: ""
tags: [datadog, kubernetes]
showFullContent: true
---

0時に寝て4時に起きた。朝から1時間ほどドラクエタクトやってた。

## ログ連携の不具合調査

少し前に本番環境で [datadog-agent](https://github.com/DataDog/datadog-agent) からログが (クラウドの) datadog に連携されていないことがわかった。kubectl logs のコマンドで確認すると、アプリケーションのログは出力されているので datadog-agent から datadog にログを送信するところの問題であるように推測された。たまたま今日、同じような現象をテスト環境で確認できた。ちょうどスクラムのプランニングでログ調査のための作業をするチケットの承認を得たところだった。満を持して発生したような障害だったので私が調査すると明言して調査してた。半日ぐらい調査して、pod 内の credential 情報が置き換わってしまうことが原因っぽいと特定できたが、なぜ置き換わってしまうのかはまだわからない。もう少し調査して解決したら会社のテックブログにいいなと思ったので、日記に書いてた内容を移行することにした。
