---
title: "ネットワークからスマートプラグの制御"
date: "2023-06-12T09:15:47+09:00"
dates: [2023/06]
cover: ""
tags: [smartplug, device]
showFullContent: true
---

昨日は夕方に親が立ち寄るかもしれないというから待機していたのに空振りに終わった。0時に寝ようとしてあまり眠れなくて7時に起きた。ここ最近寝ているのか寝てないのかよく分からない眠り方になる。

## 決済してスマートプラグを ON にしろ

[昨日の続き]({{< ref "posts/2023/0611.md" >}}) 。夕方に [Tapo P105](https://www.tp-link.com/jp/home-networking/smart-plug/tapo-p105/) が届いたので業務を終えてからさっそく使ってみた。

{{< figure src="img/2023/0612_smartplug.jpeg" >}}

オフィスの wifi に接続して、tp-link 社のスマホアプリからデバイス登録する。スマホアプリからはすぐに on/off できた。スマホで電源の on/off を制御できてあまり嬉しいことはパッと思いつかないけど、プログラムから制御できるならなにか遊べそうな気もしてくる。[ifttt](https://ifttt.com) というインテグレーションサービスがあって、それを使うと tp-link 社のデバイスと ifttt 社の web api 経由で制御できる。おそらくなんらかの web api が tp-link 社からも提供されているはず。それが公開されていれば ifttt を使う必要はないし、すでにハックされているものを使うのでもよいかもしれない。ひとまず動かすことを目的とするので ifttt を使う。スマートプラグに電球をつなげて、決済したら電球が灯って3秒後に消えるようなサンプルアプリを作った。一通り最後まで動かすことができておもしろかった。

* https://github.com/kazamori/stripe-webhook-sample
