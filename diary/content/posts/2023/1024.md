---
title: "初めて rbac なライブラリを実装した"
date: "2023-10-24T11:48:05+09:00"
dates: [2023/10]
cover: ""
tags: [go, auth, history, economy]
showFullContent: true
---

22時頃から休んでいて寝たり起きたりで7時に起きた。起きたらネットの記事とかだらだら読んでた。

## rbac なライブラリの実装

昨日から認可のための仕組みを調査している。私の中ではもっとも一般的な rbac (role-based access control) でまずは作ってみようと思う。次の2つのライブラリの利用を検討したが、自分たちのやりたいことにあわない気がして今回は見送ることにした。

* https://github.com/casbin/casbin
  * モデル定義とポリシー設定が複雑過ぎて設定が難しい、保守が大変になりそう
* https://github.com/mikespook/gorbac
  * イメージはあっているが、この程度のライブラリなら自分で作った方が学習コストもなく、拡張にも柔軟に思える

一通り、ライブラリとして使えるように参照実装した。これから実際のアプリケーション要件にあわせてミドルウェアとして rbac な認可処理を作っていく。

## 変わりゆく世界秩序

[サンフランシスコが陥った負の“スパイラル”](https://www3.nhk.or.jp/news/special/international_news_navi/articles/feature/2023/09/26/34645.html) の記事にあるような、米国で950ドル以下の窃盗は軽犯罪とするという法律の変更によって、万引きを逮捕しなくなってモラル崩壊が起きて、小売店の商品を普通に盗むという事件が多発しているらしい。fin-py でおがわさんとそんな話しをしていたら次の動画を教えてもらった。私は歴史が好きなので、こういった「歴史は繰り返す」といったものはだいたいみてしまう。厳密な裏付けはわからないが、盛者必衰という言葉もあるように、どんな国でも栄枯盛衰のサイクルはあるだろうというのは大局の視点として同意できる。過去の歴史と国の栄枯盛衰をいくつかの指標とお金の視点から調査したものでおもしろかった。

日本は80年サイクルで戦争の周期がくるといった説もあるが、この動画でもサイクルの切り替わりのタイミングで平和的にしろ暴力的にしろ、かならず戦争は起きると説明している。もうすでに戦争は始まっている感もあるが、戦争は避けようがないという点も同意するところだ。本も読んでみようと思う。

{{< youtube id="y3oy8y0EljY" class="video-container" title="レイ・ダリオ著 「変わりゆく世界秩序」" >}}
