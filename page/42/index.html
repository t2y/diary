<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.123.1"><title></title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0127/>コードリーディングの成果</a></h1><div class=post-meta><span class=post-date>2023-01-27 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/code-reading/>code reading</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#最後のコードリーディング>最後のコードリーディング</a></li></ul></nav></div><div class=post-content><p>22時に寝て4時に起きて1時間ほどだらだらしていて8時に起きた。生活のリズムが少しズレてきてしまっている。</p><h2 id=最後のコードリーディング>最後のコードリーディング</h2><p>先週からコードリーディングの勉強会をやっていて今日が最後。今日の対象のプログラムは windows サーバーで動く c++ のコードなので私はどちらも素人であまりよく分からない。上長の判断で別チームのベテランの開発者に来てもらうとよいとアドバイスを受けてお願いして来てもらった。これは本当によかった。実装されたコードだけではなく、設計を見直した方がよい視点なども指摘してもらって、もう少し時間をかけてこの windows プログラムを改修した方がよいと私は判断した。windows サーバーをクラッシュさせてしまうリスクのあるサービスにフックして実行されるコードを書いているので、windows サーバーの振る舞いや異常系処理の経験がないと潜在的にリスクのあるコードを動かしてしまう。web のアプリケーションなら多少のバグは後で直せばよいけど、os をクラッシュさせてしまうものは慎重にレビューした方がよいように思えた。次回の定例で話題にあげて課題を掘り下げようと思う。結論としてはコードリーディングしてよかったという話し。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0126/>pure go の javascript 処理系を使ってみた</a></h1><div class=post-meta><span class=post-date>2023-01-26 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/javascript/>javascript</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#pure-go-の-javascript-処理系>pure go の javascript 処理系</a></li></ul></nav></div><div class=post-content><p>23時に寝て2時に起きてだらだらして寝て7時に起きた。<a href=https://yanmaga.jp/comics/%E3%83%86%E3%83%B3%E3%82%AB%E3%82%A4%E3%83%81_%E6%97%A5%E6%9C%AC%E6%9C%80%E5%BC%B7%E6%AD%A6%E8%8A%B8%E8%80%85%E6%B1%BA%E5%AE%9A%E6%88%A6>テンカイチ 日本最強武芸者決定戦</a> という漫画を読んでた。</p><h2 id=pure-go-の-javascript-処理系>pure go の javascript 処理系</h2><p>ユーザー定義スクリプトを実行する要件がある。システム管理者がスクリプトを書くなら javascript がいいかなと次のリファレンスを調べたりしていた。</p><ul><li><a href=https://prasanthmj.github.io/go/javascript-parser-in-go/>How to support custom Javascript scripting in Go Applications</a></li><li><a href=https://go.libhunt.com/goja-alternatives>goja alternatives</a></li><li><a href=https://www.reddit.com/r/golang/comments/u8gyii/choosing_scripting_extension_need_advice/>Choosing scripting extension - need advice</a></li></ul><p>これらを読んだ結果として <a href=https://github.com/dop251/goja>dop251/goja</a> がよいだろうと判断した。README だけ読めばすぐに実装できてめっちゃ簡単で感心した。こういうライブラリを私も会社のプロダクトとして作ってみたい。万人が使うものではなくても、必要なときがたまにあって、すごく使いやすいみたいな。こんな感じで goja の機能を使ってライブラリ実装してみた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>FunctionCaller</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>funcName</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>args</span> <span style=color:#f92672>...</span><span style=color:#66d9ef>interface</span>{}) (<span style=color:#66d9ef>interface</span>{}, <span style=color:#66d9ef>error</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewFunctionCaller</span>(<span style=color:#a6e22e>script</span> <span style=color:#66d9ef>string</span>) (<span style=color:#a6e22e>FunctionCaller</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>vm</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>goja</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>vm</span>.<span style=color:#a6e22e>RunString</span>(<span style=color:#a6e22e>script</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>funcName</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>args</span> <span style=color:#f92672>...</span><span style=color:#66d9ef>interface</span>{}) (<span style=color:#66d9ef>interface</span>{}, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>f</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>goja</span>.<span style=color:#a6e22e>AssertFunction</span>(<span style=color:#a6e22e>vm</span>.<span style=color:#a6e22e>Get</span>(<span style=color:#a6e22e>funcName</span>))
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to get function: %s&#34;</span>, <span style=color:#a6e22e>funcName</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>funcArgs</span> <span style=color:#f92672>:=</span> make([]<span style=color:#a6e22e>goja</span>.<span style=color:#a6e22e>Value</span>, <span style=color:#ae81ff>0</span>, len(<span style=color:#a6e22e>args</span>))
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>for</span> <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>arg</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>args</span> {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>funcArgs</span> = append(<span style=color:#a6e22e>funcArgs</span>, <span style=color:#a6e22e>vm</span>.<span style=color:#a6e22e>ToValue</span>(<span style=color:#a6e22e>arg</span>))
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>value</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>f</span>(<span style=color:#a6e22e>goja</span>.<span style=color:#a6e22e>Undefined</span>(), <span style=color:#a6e22e>funcArgs</span><span style=color:#f92672>...</span>)
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to call javascript function: %w&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>value</span>.<span style=color:#a6e22e>Export</span>(), <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>	}, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><a href=https://github.com/dop251/goja#is-it-goroutine-safe>Is it goroutine-safe?</a> によると、goroutine-safe ではないので毎回 js の runtime を生成する必要がある。用途によっては、実行したいスクリプトが大きくなるとオーバーヘッドを無視できない状況もあるかもしれない。うちの要件は小さいユーザー定義スクリプトを実行するだけなのでおそらくそれほど問題にはならないだろうという想定。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0125/>テックブログ草稿</a></h1><div class=post-meta><span class=post-date>2023-01-25 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/frontend/>frontend</a>&nbsp;
#<a href=/diary/tags/tech-selection/>tech selection</a>&nbsp;
#<a href=/diary/tags/writing/>writing</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#フロントエンドの技術選定のテックブログ>フロントエンドの技術選定のテックブログ</a></li></ul></nav></div><div class=post-content><p>2時に寝て7時に起きた。生活リズムがやや乱れ気味。メンバーの1on1以外はスポット的に時間が空いていてテックブログを書いてた。</p><h2 id=フロントエンドの技術選定のテックブログ>フロントエンドの技術選定のテックブログ</h2><p>顧問のはらさんに勉強会をお願いして、技術選定の観点を教えてもらい、その後 next.js と sveltekit でチュートリアルやって感触を確かめ、最終的には CTO 判断でエイヤで決めた。その過程や調査結果などをそのままテックブログに書いた。お手伝い先のテックブログも hugo で動いている。私にとっては慣れた環境なので環境構築やプレビュー確認などはすぐにできた。テーマの違いによるテーブルやスタイルの定義などを他の記事を参考にしながら調整するのに手間取ったぐらい。半日ぐらいがっつり時間をとって草稿を書き上げた。これからレビューしてもらって問題なければ公開することになる。私の名前で普通に書いたけど、それが OK なら事例紹介に近いものにもなる。いつも半年働いてから、私が自分で納得できる品質を提供できていれば事例紹介をお願いしている。いまじゃなくてももう3ヶ月経ってからでもいいかもしれない。</p><p>私は会社のテックブログを書くのが嫌じゃない。私ぐらいになると、あちこちの会社でテックブログを書いてきたからお手伝いした会社は記事を1つぐらい書いて記念を残したいとまで考えるようになってきた。昔、ある会社でお手伝いしたときに調査した技術情報を社内 wiki にまとめただけで、長文をちゃんと書ける人は少ないと高い評価を得たことがあった。テックブログを書く開発者が少ないことを考慮するとさもありなんと言えるかもしれない。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0124/>起業相談が再び</a></h1><div class=post-meta><span class=post-date>2023-01-24 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/svelte/>svelte</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#sveltekit-の-ui-からのリクエスト>sveltekit の ui からのリクエスト</a></li><li><a href=#起業相談>起業相談</a></li></ul></nav></div><div class=post-content><p>1時に寝て8時に起きた。寝坊して朝起きれないものの、わりかしよく眠れるようになってきた。</p><h2 id=sveltekit-の-ui-からのリクエスト>sveltekit の ui からのリクエスト</h2><p><a href=https://kit.svelte.dev/docs/routing#page-page-svelte>+page.svelte</a> のスクリプトで <code>onMount()</code> を定義すると bff へ http リクエストを fetch できる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-typescript data-lang=typescript><span style=display:flex><span>&lt;<span style=color:#f92672>script</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ts&#34;</span>&gt;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>import</span> <span style=color:#66d9ef>type</span> { <span style=color:#a6e22e>User</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;$lib/types/users&#39;</span>;
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>onMount</span> } <span style=color:#66d9ef>from</span> <span style=color:#e6db74>&#39;svelte&#39;</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>data</span>: <span style=color:#66d9ef>User</span>[] <span style=color:#f92672>=</span> [];
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>onMount</span>(<span style=color:#66d9ef>async</span> () <span style=color:#f92672>=&gt;</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>r</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;/api/users&#39;</span>);
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>ok</span>) {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>data</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>json</span>();
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	});
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>script</span>&gt;
</span></span></code></pre></div><p>bff 側では web api を提供する必要がある。それは <a href=https://kit.svelte.dev/docs/routing#server>+server.ts</a> を定義することで実装できる。内部的にはバックエンドの web api を呼び出して、それを返すだけの実装になる。こういった連携も sveltekit だと簡単に実装できる。前のお仕事は bff も java で作っていたけど、bff なら node.js でいいんじゃないかと思うぐらいにはフロントエンドの技術に慣れてきた自分がいる。</p><h2 id=起業相談>起業相談</h2><p><a href=/diary/posts/2023/0120/#起業相談>少し前にも起業相談</a> に乗ったが、まったく別の人で12月に起業された方が三ノ宮.dev のコミュニティに入られて起業相談にのってほしいというので行ってきた。個人でもわりと有名な方らしく、ある2つのキーワードでググるとトップに出てくる。スタートアップを目指している方で、できるだけ多くのお金を資金調達して作りたいものを開発したいという話し。いまは金融緩和から緊縮に向かう状況なのでベンチャー資金も渋い状況ではないかと推測する。そんな中で cto をどうやって探せばよいかという質問が大きな話題だった。資金調達する上でもちゃんとした cto がいる方が融資する側からみても印象が違うという。それはそうかなとも思う。</p><p>一方で cto を探すのは相当に難しいという話しを私からした。基本的には過去に一緒に働いた人でスキルのある人や同じ意思をもっている知人や友だちに依頼するのがよいだろうと。それも難しい話しだけど、cto 募集なんかでよい人がみつかる確率は低いし、ましては ceo が技術に明るくないのであれば応募してくる求職者のスキルや知識を評価するのも難しい。他のコミュニティメンバーも同意見で、最初は cto を雇わず、普通にテックリードになれる開発者を雇って、プロダクトを開発して実績を作って資金調達した後に再度 cto を探してはどうか？と提案した。</p><p>あと資金調達は実績がないと難しいから、最初はすぐにお金を稼げるプロダクト開発をして、それで十分な収益をあげ、その実績から資金調達するのはどうかといった計画の話しをしていて、それはもっと難しそうだと私からは感じた。お金のためだけにやりたくもないプロダクト開発を1-2年やって、その後に本当にやりたいプロダクト開発を資金調達してからやる。それぞれのプロダクトはまったく関係がなく、組織も2つになるという。そんなやり方で成功したスタートアップを私は聞いたことがない。組織の難しさをあまりにも軽視していて無謀だとアドバイスした。</p><p>私も起業して早3年が経った。マイクロ法人だから簡単でしょと言われたらそれまでなんだけど、起業相談を依頼されるケースも増えてきた。これはこれで顧問やコンサル業ができるのではないかと少し皮算用していたりする。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0123/>人間の体調もマシンの調子も悪い</a></h1><div class=post-meta><span class=post-date>2023-01-23 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/nginx/>nginx</a>&nbsp;
#<a href=/diary/tags/tls/>tls</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#デスクトップマシンの調子が悪い>デスクトップマシンの調子が悪い</a></li><li><a href=#nginx-の-multi-upstream-対応>nginx の multi upstream 対応</a></li></ul></nav></div><div class=post-content><p>1時に寝て7時に起きた。冬のせいか、朝起きるのが辛くなってきた。自身の体調がパッとしないと思っていたらマシンにも移ってしまった。</p><h2 id=デスクトップマシンの調子が悪い>デスクトップマシンの調子が悪い</h2><p>何の前触れもなく os がいきなりストールする。これまでも稀にあったり、サスペンドから復帰しないとかも1ヶ月に1回ぐらいはあったりしていたけど、今日は2時間以内に3回発生した。使い始めてちょうど3年を超えたところなのでそろそろ故障が出てきてもおかしくはない。もっとも疑わしいディスクの S.M.A.R.T チェックをやってみた。<a href=https://qiita.com/ken-yossy/items/ffecfd31d41d71f27dca#smart--health-information%E3%81%AE%E5%86%85%E5%AE%B9>SMART / Health Informationの内容</a> をみると、<em>Percentage Used</em> という値がメーカーが独自計算した耐久値を表しているとのころ。しかし、値は13%なのでまだまだ大丈夫そう。その他のエラーチェックなどでもまったく問題は検出されなかった。どうやらディスクではないみたい。</p><pre tabindex=0><code>=== START OF SMART DATA SECTION ===
SMART overall-health self-assessment test result: PASSED

SMART/Health Information (NVMe Log 0x02)
Critical Warning:                   0x00
Temperature:                        28 Celsius
Available Spare:                    100%
Available Spare Threshold:          50%
Percentage Used:                    13%
Data Units Read:                    48,536,210 [24.8 TB]
Data Units Written:                 57,978,947 [29.6 TB]
Host Read Commands:                 1,818,481,150
Host Write Commands:                1,973,810,058
Controller Busy Time:               9,182
Power Cycles:                       1,863
Power On Hours:                     4,576
Unsafe Shutdowns:                   80
Media and Data Integrity Errors:    0
Error Information Log Entries:      0
Warning  Comp. Temperature Time:    0
Critical Comp. Temperature Time:    0
Temperature Sensor 1:               28 Celsius
Thermal Temp. 1 Transition Count:   90
Thermal Temp. 2 Transition Count:   50
Thermal Temp. 1 Total Time:         2246
Thermal Temp. 2 Total Time:         50
</code></pre><h2 id=nginx-の-multi-upstream-対応>nginx の multi upstream 対応</h2><p><a href=/diary/posts/2023/0120/#sveltekit-アプリのデプロイ>先週末の続き</a> 。docker compose でデプロイして node.js 上のポートに http 接続できるところまでやっていた。nginx のリバースプロキシ経由でアクセスできるようにする。web api も外部から https 接続できるようにすると2つの upstream が必要になる。ホスト名を dns 登録していないから同じ ip アドレスでアクセスしているため、ポート番号を変えないといけない。そのまま server 設定を行うと location 設定が dry の原則に反してしまう。どうやったら再利用できるかを調べたら conf として外部に出してしまって include すればいいとあったので次のようにして再利用できた。これで node.js アプリは 443 を、web api は 8443 で https 接続できた。</p><pre tabindex=0><code>http {

    upstream my-app {
        server app:3000;
    }

    upstream web-api {
        server api:18080;
    }

    server {
        listen 443 ssl;
        server_name server-app;
        location / {
            include     /etc/nginx/common_proxy.conf;
            proxy_pass  http://my-app;
        }
    }

    server {
        listen 8443 ssl;
        server_name server-api;
        location / {
            include     /etc/nginx/common_proxy.conf;
            proxy_pass  http://web-api;
        }
    }
}
</code></pre></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0122/>何もしてないのに1日が過ぎた</a></h1><div class=post-meta><span class=post-date>2023-01-22 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/drink/>drink</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/medium/>medium</a>&nbsp;
#<a href=/diary/tags/java/>java</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#jj>jj</a></li><li><a href=#法事の出席者管理>法事の出席者管理</a></li><li><a href=#java-は死んだ>Java は死んだ</a></li></ul></nav></div><div class=post-content><p>仲の良い焼き鳥屋さんで軽く飲んできた。2時に寝て7時に起きた。午前中はだらだらしてた。午後から会社の事務手続きをやりながら、実家の法事の段取りをやりながら、ブログの記事などを読んでいた。</p><h2 id=jj>jj</h2><p><a href=https://www.suntory.co.jp/sho-chu/matsurika/>茉莉花 (ジャスミン焼酎)</a> をジャスミン茶で割った飲みものを <em>jj</em> と呼ぶらしい。焼き鳥屋さんのマスター曰く、お客さんが <a href=https://kushi-tanaka.com/news/entry/1920>串カツ田中で販売</a> しているのをみて、焼き鳥屋さんでも扱ってよと言うから置いてみたと話していた。あまりこれまで飲んだことのない不思議な飲みものになっていた。基本はジャスミン茶なんだけど、アルコール入っているなという雰囲気がするカルイ飲みものに感じた。お茶ベースだからどんな食べものにもあいそう。すごくおいしいものではない分、軽く飲みたいときにちょうどいいかもしれない。</p><h2 id=法事の出席者管理>法事の出席者管理</h2><p>来週は35日の <a href=https://www.kobe-np.co.jp/rentoku/shingokoku/P20170612MS00167.shtml>だんご転がし</a> がある。2月の上旬には49日もある。過去の葬儀もあわせて親戚や関係者の、出席を管理するためのスプレッドシートを作った。出席確認を母に任せていたらなかなか進まなくてお正月から2週間あってもまだ確認を取り切れていない。人間を調整するのがもっとも面倒で時間がかかる。その後に初盆、1回忌、3回忌と続く。連絡先の電話番号も私の方で管理して、私が電話していった方がよいのかなぁ。</p><h2 id=java-は死んだ>Java は死んだ</h2><ul><li><a href=https://medium.com/@sidh.thomas1/java-is-dead-6-misconceptions-of-developers-that-still-think-java-is-relevant-today-683310849855>Java is Dead — 5 Misconceptions of developers that still think Java is relevant today!</a></li></ul><p>この記事の著者はいまも java が通用すると思っているとしたらそれは誤解があるという。その誤解を5つあげるといった記事。</p><blockquote><p>誤解1: Javaには、大規模で活発な開発者コミュニティーがある。</p></blockquote><p>これは誤解ではなく事実だと書いてある (´・ω・｀) 著者の意見としては、他言語の進化が速く java は冗長で古い型システムで時代遅れみたいなことを主張している。私の意見だと java の進化もいまは速くていうほど時代遅れというほどではない。過去の資産がいまの java に追いつけていないといったのもある。十分に他言語に機能的に追いついているし開発サイクルも速い。</p><blockquote><p>誤解2: Javaは幅広い用途に使われる。Javaは単なるWeb開発言語ではなく、モバイルアプリやゲーム、エンタープライズレベルのソフトウェアの開発にも利用されている。</p></blockquote><p>これも著者の視点が適切ではない。モバイルでは kotlin が席巻していて、web の開発言語としても java をあげるのは大企業やエンタープライズ開発のみではないかと説いている。たしかに kotlin は java ではないが、jvm 言語ではあるので jvm は未だに必要とされているという事実がある。もう1つ、java はエンタープライズレベルのでミドルウェアで確固とした地位を気付いている。例えば、cassandra, hadoop, kafka など、これらを web 開発で使っている限り、それは web 開発でも使われていると言えるだろう。</p><blockquote><p>誤解3: Javaは基礎となる言語である。多くの新しいプログラミング言語は、Javaの原理と概念に基づいて構築されており、何らかの形でJavaと互換性を持つように設計されている。</p></blockquote><p>こんなこと誰も言っていないと思うけど、著者がそもそも誤解しているのではないか。一方でクリーンアーキテクチャに代表されるような、java のエコシステムで開発されたアーキテクチャなどは java と相性がよい。java と他言語との最大の違いはクラスがないとプログラミングできないという点であり、これはメリット・デメリットをもたらすが、oop においては di 技術を進化させてクリーンアーキテクチャのような概念の下支えをしている。</p><blockquote><p>誤解4: Javaは大手企業の強力なサポートがある。Javaを保守・サポートしているオラクル社は、Javaという言語に強いこだわりを持っており、その開発・改良に投資を続けている。また、GoogleやAmazonなど、多くの大手企業が自社の製品やサービスにJavaを採用している。</p></blockquote><p>oracle という企業とそのプロダクトが市場でのシェアを失っているという視点で懸念を表明している。たしかに oracle はそうかもしれないが、google や amazon だって java を活用しているので oracle がダメになっても web 系の大企業がサポートしていくのではないかと私は推測する。</p><blockquote><p>誤解5: Javaは学校や大学で広く教えられている。</p></blockquote><p>この点だけは著者の意見に違和感はない。一昔前は java が大学でよく教えられていたと思うが、今後は python や go といった、他の言語が最初に学ぶプログラミング言語として人気を博していくのではないかと私も思う。</p><p>ざっと読んでみて java 開発をやったことのない経験が浅い開発者が書いた記事だなと思えた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0121/>納車と慣らし運転</a></h1><div class=post-meta><span class=post-date>2023-01-21 (Sat.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#ストレッチ>ストレッチ</a></li><li><a href=#納車>納車</a></li></ul></nav></div><div class=post-content><p>1時に寝て7時に起きた。なんか微妙な疲れがある。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前155cmで、ストレッチ後159cmだった。先週と同じか。腰に張りは残っているものの、先週のような疲労が蓄積して大変な状況からは脱した。先週に引き続き、ふくらはぎの後ろ筋肉のストレッチを受けているとかなり辛い。プロのトレーナーさんなのでこれ以上は耐えられないという一歩手前のところでコントロールしている。もうちょっと続けられたらもう無理の少し手前で終わるのでなんとか耐えられている。経験上、ストレッチが痛いときほど状態が悪いという警告だと理解しているのでそれはそれで自分の体調がわかってよい。</p><h2 id=納車>納車</h2><p>先日 <a href=/diary/posts/2023/0104/#社用車の購入相談>購入した社用車</a> が納車された。年明けの出張前に駐車場の手続きをうまくやったので車庫証明も車検も段取りがうまく進み2週間で納車となった。午後から引き取りに行ってきた。いくつかの書類に署名をして印鑑を押して車の操作の説明を受けた。初めてレンタカーを借りるときにも戸惑ったが、いまは車の鍵ではなく、電子キーになっていて勝手にロックが空いたり、エンジンをかけるのも鍵をまわすのではなくボタンを押すといった仕様になっている。他にもハンドル周りにボタンがあったり、ナビゲーターのモニターにもボタンがあったりで使い方を教えてもらった。運転中は不可だが、ワンセグも入るのでテレビもみれるという。あとスマートフォンと bluetooth 接続できる。iphone なら apple music で音楽を聞いたりできる。まだ試したことはないけど、電話もできるらしい。2015年モデルの中古車でもそのぐらいの設備が付いている。ドライブレコーダーも付いていて標準のものではないので前の所有者が取り付けたものを外さずに下取りに出したと推測されるとのこと。私はまったくこだわりはないので付いているならそのまま使えばいいやって感じでラッキーに思えた。</p><p><a href=https://ucar.honda.co.jp/HOT/u-select/inspection/>車両状態証明書</a> によると総合評価点は2と高くはない。機能、内装、走行は問題ない。これは外装にいくつか擦り傷やへこみがあるためにそういった評価になっている。ただ普通にパッと見てわかる擦り傷は1箇所だけで十分にきれいにみえる。外装に擦り傷が多いために総合評価点が低く、年式が新しく走行距離も少ないにも関わらず車両価格が割安であった。そこに私のような、初めて購入して乗る車はきっとぶつけたり擦ったりする確率が高いだろうと想定しているためにまったく気にしない人間とウマがあった。</p><p>せっかくなので慣らし運転に行こうと思ってディーラーの営業さんと話していたら <a href=https://nishinomiya-ebisu.com/>西宮神社</a> へ行くお客さんが多いという。えべっさんと言えば商売繁盛で有名な神様だけど、交通安全祈願のお祓いもやってくれるみたい。お祓いまではお願いしなかったけど、三ノ宮から10kmぐらいの距離で20-30分もあれば行けるのでちょうどよい距離だった。お参りして交通安全のお守りを買ってきた。</p><figure><img src=/diary/img/2023/0121_nishinomiya.jpg></figure></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0120/>今日は打ち合わせの多い日だった</a></h1><div class=post-meta><span class=post-date>2023-01-20 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/career/>career</a>&nbsp;
#<a href=/diary/tags/communication/>communication</a>&nbsp;
#<a href=/diary/tags/svelte/>svelte</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#隔週の雑談>隔週の雑談</a></li><li><a href=#sveltekit-アプリのデプロイ>sveltekit アプリのデプロイ</a></li><li><a href=#起業相談>起業相談</a></li></ul></nav></div><div class=post-content><p>1時に寝て2時、3時、6時と起きて7時に起きた。久しぶりに胃酸が逆流して気分悪かった。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。sveltekit アプリで使う ui フレームワークの相談をして、<a href=/diary/posts/2023/0119/#課題管理の雑談>昨日の課題管理の雑談内容</a> からさらに考察を深めた。私の中では知っていたことだったはずなのに、いつの間にか、そのことを軽視してしまっていることを再認識したような発見だった。</p><p>コミュ障の私にとってはペアワークという概念がすっぽり抜けていたことは昨日書いた通りだが、それでもいまマネージャーとしてそれなりにコードレビューやインフラタスクに時間を割いている。プロジェクトマネジメントだけをやっているわけではない。それは自分が遊撃として開発者のメンバーを手伝っていることに相当するなと気付いて、そう言えば、過去に五月雨式にだらだらと遅れるようなプロジェクトでは、他のメンバーのタスクが遅れることを横からみているだけしかやってなかったような気がした。もし私が自分のタスクを投げ出して遅れている課題に介入したらどうなっただろうか？と思考実験するだけの余地はあった。</p><p>もう1つ。盛り上がった話しにおっさんはエモい話しをしにくいと私が考えていると伝えた。なぜなら、私の経験則ではエモい話しをするおっさんは総じてスキルをもっていなかった。具体的な知識やプラクティスを話すときはエモい話にならないからだ。その発言に対して、はらさんからはこんなコメントが返ってきた。おっさんもスキルはあるのだけど、そのスキルが時代にあわなくなって古くなってしまった。現場の技術とあわないスキルは、現場の人間からみるとスキルがない人と同じである。少し前に40歳の壁という本を読んだが、そのノリで言うと、40歳になるとスキルが現場に通じなくなる。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>いまマネージャーをしていて気付かないうちに遊撃というポジションをこなしているのではないかと思うようになってきた。原則として実務をやらず、プロジェクトマネジメントをしている。とはいえ、コードレビューには2-3日／週ぐらいの工数を割いてきた。</p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1616767644002291712?ref_src=twsrc%5Etfw">January 21, 2023</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=sveltekit-アプリのデプロイ>sveltekit アプリのデプロイ</h2><p>昨日の続き。<a href=https://kit.svelte.dev/docs/building-your-app>Building your app</a> によると、sveltekit のビルドは vite と adapter の2段階で行われる。gitlab ci/cd で node.js 向けにビルドして、それを docker イメージに同梱して、コンテナレジストリに登録する。あとはテスト環境で構築している docker compose に組み込むだけ。今日中にできたらいいなと思って、ぎりぎりだったけど、テスト環境で node.js 上にデプロイしたアプリと疎通できるところまでできた。ssr を介して web api サーバーと疎通できるところまで整備した。ここから先はメンバーに管理画面を作っていってもらう。メンバーの開発着手前にデプロイが一通りできているという気持ちよさ。</p><h2 id=起業相談>起業相談</h2><p>過去に働いていた会社の、私と同い年の元同僚が起業するというので相談にのることに。私が会社を作ってなんとかやっているのをみて関心が出てきたという。いきなり会社を辞めると不安だから副業から始めて、本業の収入を上回るようになったから個人事業主から法人化しようと考えているらしい。実際に会社を辞めるかどうかはまだこれから検討するのかな？本業をやりながら最大4つか5つの副業をまわしてたというから驚き。そんなこと物理的に可能なの？と思ったら開発は人を雇ってマネジメントだけやったりしていたらしい。おそらく4人ぐらい開発者を雇っているという雰囲気だったけど、それでも本業をやりながら4つもマネジメントをするのは相当に大変だと思う。十分にその同僚の能力を認めているつもりだったけれど、それ以上の忍耐や集中力をもっていて、もしかしたら過小評価していたのかもしれない。1つの会社内でも3つ以上プロジェクトを兼任して成果を出しているマネージャーなんか私は見たことない。それを本業と副業と寄せ集めの開発者で実現しているのは類稀な能力だと思う。本人も睡眠時間削って働いてやり過ぎたとは言っていたが。法人登記、税金、節税、働き方とか、ざっくばらんに私が起業してやってきた3年間のお話しをした。なにかしら役に立って活躍されるといいな。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0119/>sveltekit の ssr を理解した</a></h1><div class=post-meta><span class=post-date>2023-01-19 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/svelte/>svelte</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#sveltekit-の初期プロジェクト>sveltekit の初期プロジェクト</a></li><li><a href=#課題管理の雑談>課題管理の雑談</a></li></ul></nav></div><div class=post-content><p>2時に寝て7時に起きた。キングダムの新刊を読みながら寝てた。</p><h2 id=sveltekit-の初期プロジェクト>sveltekit の初期プロジェクト</h2><p><a href=/diary/posts/2023/0117/#svelte-アプリの開発に着手>技術選定で svelte を採用した</a> ので昨日から <a href=https://kit.svelte.dev/>SvelteKit</a> でアプリケーション開発に着手した。<a href=https://kit.svelte.dev/docs/project-structure>Project structure</a> にもだいぶ慣れてきた。開発初期はディレクトリ構成に迷うのでドキュメントに標準的な階層構造を書いてくれているのは素晴らしい。<a href=https://kit.svelte.dev/docs/routing>Routing</a> もキモいけど、ssr の場合は <code>+page.svelte</code> と <code>+page.server.ts</code> を設けるのに慣れてきた。ssr で proxy 的に web api 呼び出しも簡単に実装した。知らないフレームワークで開発するのは学ぶところが多くて楽しい。区切りのよいところで初期開発の issue はクローズして明日は gitlab ci/cd でテスト環境にデプロイするのをやってみる。</p><h2 id=課題管理の雑談>課題管理の雑談</h2><p>過去に働いていた会社の同僚と課題管理について雑談した。web3 系の会社で働いているのでブロックチェーンや dao 周りの話しも一緒にしたりしていた。一回りぐらい私より若いと思うけれど、私よりはるかに優秀な開発者だなぁと感じながら話しを聞いていた。いま一緒に働いても足手まといになるんじゃないかと思えて身が引き締まる。いくつか話題の中で学んだことを抜き出してみる。</p><ul><li>自分の知識やスキルを共有する手段の1つとしてペアワークをやる<ul><li>ペアワークを通してメンバーとの信頼関係も構築していく</li><li>いまもっている知識やスキルには個人差はあるが、模倣の能力が低い人をみたことがない</li></ul></li><li>上位の意思決定者から低いレベルにあわせる (標準化など) ように指示がきたときは反発する<ul><li>ユーザーファーストが第一ならレベルを下げるような指示はおかしい</li><li>「誰を向いて仕事しているの？」と説得する</li></ul></li><li>プロジェクトにおいて目的を明確化せずに始めてしまうのは本当によくない<ul><li>日本人は上意下達で行動するように教育されてきた弊害ではないか</li><li>目的を明確化するのは意見を言うことと同じである<ul><li>レイヤーが上がるほどエモい話しになって人生観や哲学の話しになっていく</li><li>チームのモチベーションを維持する上でも有効ではないか</li></ul></li></ul></li></ul><p>私はコミュ障だから他人と一緒に作業しようという発想がそもそもなかった。こちらから一緒にやろうと声をかけて知識やスキルを共有する手段もあるのかと気付いた。これまでも何人もの人にいろんな話しを伺っている。他人のノウハウを聞くだけでもこの雑談をすることに意味はあると思えた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0118/>日銀会合の質疑応答をみた</a></h1><div class=post-meta><span class=post-date>2023-01-18 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#日銀会合の結果>日銀会合の結果</a></li><li><a href=#コワーキングのオンラインイベント>コワーキングのオンラインイベント</a></li></ul></nav></div><div class=post-content><p>0時に寝て7時に起きた。最近はよく眠れるようになってきた。</p><h2 id=日銀会合の結果>日銀会合の結果</h2><p>12時から 1on1 だったのでずっとみていたわけじゃないけど、12時前チェックしたら為替が円安に触れていたので現状維持なことが伺えた。業務を終えてから後藤さんの記事も拝見した。YCC はいずれ修正されるので近い将来に金利が上がることはわかっているが、そのときに市場が動揺して急激な円高になってしまうようなことは経済にとってよくないとのこと。本来はそういうことが起こらないように中央銀行と市場が丁寧に対話を重ねるものだという。いまの日銀の雰囲気だと、3月か4月に急激な形で訪れるかもしれないといった懸念があるように伺えた。</p><ul><li><a href=https://note.com/goto_finance/n/n03e3364dadec>【速報】日銀会合 スピード解説</a></li></ul><div class=video-container><iframe src="https://www.youtube.com/embed/2kWDRvUGnq4?start=3742" allowfullscreen title=総裁定例記者会見（2023年1月18日）></iframe></div><p>後藤さんが質問しているところだけでもみようと思ってみた。のらりくらりとかわされてしまったとのこと。</p><h2 id=コワーキングのオンラインイベント>コワーキングのオンラインイベント</h2><p>月例のカフーツさんのオンラインイベントに参加した。<a href=/diary/posts/2022/1221/#コワーキングのオンラインイベント>先月の所感はここ</a> 。メンバーの1人が <a href=https://jmty.jp/>ジモティー</a> でイベントするのが熱いという話題がおもしろかった。ジモティーって中古品の売買するプラットフォームじゃないの？とみんな思ってたら、最近はイベントなんかもできるようになっていて、ユーザーが多いのにあまりイベント開催に使っている人がいないから狙い目だという。へーと思って、私もスマホにジモティーをインストールしてどんな雰囲気か眺めてみた。ざっとみたら婚活イベントが多くてうんざりしたが。</p><p>コワーキングスペースのイベント管理プラットフォームの開発を進めているらしい。日本にはコワーキングスペース向けのプラットフォームというのが存在しないからチャンスはあるのだと思う。これまでなかったのはコワーキングスペースという市場が小さ過ぎて儲からないから誰も参入しようとしていないだけでしょうというのは納得感がある。さらに私からみると、すでに世の中に sns や無料のプラットフォームがたくさんある中で、わざわざコワーキングスペース向けのツールが必要なのかどうか、需要のところでどうなんだろう？という懸念はある。これからクラウドファウンディングなども予定しているそうでそれが公開されたら、私も (会社として) お世話になっているから少しくらい寄付しようかと思う。この場合は会社間の付き合いとも受け取れるから協賛金として会計処理してよいはず。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0117/>今年はしばらく svelte に注目</a></h1><div class=post-meta><span class=post-date>2023-01-17 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/java/>java</a>&nbsp;
#<a href=/diary/tags/frontend/>frontend</a>&nbsp;
#<a href=/diary/tags/tech-selection/>tech selection</a>&nbsp;
#<a href=/diary/tags/code-reading/>code reading</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#svelte-アプリの開発に着手>svelte アプリの開発に着手</a></li><li><a href=#java-の-ldap-クライアント>java の ldap クライアント</a></li></ul></nav></div><div class=post-content><p>1時に寝て7時に起きた。なんか朝うまく起きれなくなってきた。なんでだろう？</p><h2 id=svelte-アプリの開発に着手>svelte アプリの開発に着手</h2><p>12月の1週間分ぐらいの工数をかけて行っていた <a href=/diary/posts/2022/1214/#フロントエンドの技術選定の調査>フロントエンドの技術選定</a> の意志決定をした、というよりはしてもらった。私は調査結果をまとめ、react を選択しても svelte を選択しても開発視点ではどちらも同じという判断を下した。あとはお手伝い先の会社にとってどちらの技術に取り組みたいかという視点しかないなと考えて CTO に最終決断を委ねた。その結果 svelte を採用することに決まった。この調査や意志決定についていずれテックブログに書きたい。私がどのぐらい開発に参加するかはまだ未定だけど、初期のリポジトリの整理ぐらいはしておこうと svelte アプリ開発に着手した。初めて関わる技術はなんにせよおもしろい。お仕事で学びがあれば個人でもなにかしら svelte アプリを作ってみたい。</p><h2 id=java-の-ldap-クライアント>java の ldap クライアント</h2><p>昨日のコードリーディングの続き。いま使っているライブラリは <a href=https://directory.apache.org/api/>Apache Directory LDAP API</a> というものだけど、このライブラリの設計があまりイケてない。古い java の考え方で設計されているライブラリのような印象を受けた。他にも java の ldap クライアントはないのかな？と調べたら so でちょうど議論されていた。</p><ul><li><a href=https://stackoverflow.com/questions/15619147/java-api-to-query-ldap>Java API to query LDAP</a></li></ul><p>この so によると、<a href=https://ldap.com/unboundid-ldap-sdk-for-java/>UnboundID LDAP SDK for Java</a> がベストアンサーになっている。また機会があれば触ってみようかなと思った。</p></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/41/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/page/43/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>