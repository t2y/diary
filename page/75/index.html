<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.109.0"><title>forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="forest nook"><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0528/>法人決算をほぼ完了</a></h1><div class=post-meta><span class=post-date>2022-05-28 (Sat.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#ストレッチ>ストレッチ</a></li><li><a href=#法人決算をほぼ完了>法人決算をほぼ完了</a></li></ul></nav></div><div class=post-content><p>0時に寝て6時に起きた。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前160cmで、ストレッチ後162cmだった。先週とほぼ変わらないので現状維持といったところ。右腰に張りがあって今週は椅子に座って後ろに寄りかかっていてもやや右腰が張るなぁと自覚症状もあった。ストレッチを受けていても効くなぁって感じだった。新しいトレーナーさんに代わってから1ヶ月のストレッチを受けてだいぶ打ち解けた感はある。</p><h2 id=法人決算をほぼ完了>法人決算をほぼ完了</h2><p><a href=/diary/posts/2022/0524/#消費税と地方消費税の申告>法人決算の e-tax 申請</a> の続き。前に消費税の申告をしたときに別表五以外はすべて作成していた。別表五はどこに何の数字を入力するのかが難しくて、過去の書類と数字を見返しながらやらないと詳細を覚えていなかったりする。その作業をするのが面倒でずっと先送りしていた。本気出してやれば1-2時間もあれば完了した。なんやらかんやらで eltax も e-tax の電子申告も自分でできるようになった。できることが増えていくことそのものが楽しい。</p><p>今回の法人決算で申告・申請したのは次の3つ。</p><figure><img src=/diary/img/2022/0528_e-tax-list1.png></figure><p>e-tax の画面は基本的に帳票そのものなので数値を入力した後で紙に印刷することで帳票を保管することもできる。例えば、法人税・地方法人税の申告に必要な帳票がこれらになる。過去2年は手書きで作成していたけど、ほぼ同じの内容を画面で作成してデータで送付するだけの違いしかない。紙なら2時間で終えられる作業を、(使いにくい) アプリケーションの画面で入力すると余分に数時間かかってしまうものの、システムだと差し引きや合計値の計算は自動でやってくれるので記入ミスは起こりにくい。とはいえ、システムの自動計算が間違っていることもあるので強制入力が必要になるときもある。</p><figure><img src=/diary/img/2022/0528_e-tax-list2.png></figure><p>税務署へ電話で問い合わせたときに財務諸表を pdf 添付でよいと話していたけど、いざやろうとしたら財務諸表は xml または xbrl 形式でないとダメだと説明が出てきた。仕方ないので月曜日に税務署へ行って紙で提出してくる。電子申告と紙を組み合わせて法人決算やることは構わないとのこと。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0527/>スクラムマスターは超人か</a></h1><div class=post-meta><span class=post-date>2022-05-27 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/scrum/>scrum</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#隔週の雑談>隔週の雑談</a></li></ul></nav></div><div class=post-content><p>0時に寝て6時に起きた。調子よくて7時からオフィスで作業してた。なんだかんだで今日は主にお手伝い先のお仕事をしてた。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の話題はたくさんあった。</p><ul><li>スライドマスター作成のふりかえり</li><li>課題管理のためのメンタルモデルづくり</li><li>スクラムの悪いところの共有</li><li>住民税の変遷について</li></ul><p>会社としての発表のスライドを管理するために speakerdeck の会社アカウントを作成した。jjug の主催者のスライドチェックが完了したらアップロードしようと思う。google docs をそのまま公開するのと speakerdeck のどちらがいいかを検討した。google docs だと、スライド資料のノートまで公開されてしまうのでスライドだけなら speakerdeck の方がよさそうかなと判断した。</p><ul><li><a href=https://speakerdeck.com/kazamori>https://speakerdeck.com/kazamori</a></li></ul><p>スクラムの悪いところの1つとして、スクラムマスターが現状認識を誤っているときの是正方法がないという話題をした。スクラムマスターは po や開発者にアドバイスするのだけど、アドバイス自体が誤っているのではなく、アドバイスしている内容がプロジェクトの置かれている状況にあっていないというギャップに対しての、ふりかえりや是正の仕組みがスクラムに包含されていない。ある知人によると、スクラムマスターは超人でなければ務まらないという前提になっているのではないかという意見もあった。現時点でとくに結論はないのだけど、難しい課題だなぁと議論していた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0526/>aws-lambda-python-alpha を使っておけばいい</a></h1><div class=post-meta><span class=post-date>2022-05-26 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/cdk/>cdk</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#aws-lambda-python-alpha>aws-lambda-python-alpha</a></li><li><a href=#jjug-ccc-2022-spring-のタイムテーブル>JJUG CCC 2022 Spring のタイムテーブル</a></li></ul></nav></div><div class=post-content><p>0時に寝て6時に起きて7時半に起きた。なんかバテバテ。</p><h2 id=aws-lambda-python-alpha>aws-lambda-python-alpha</h2><p>cdk 標準の lambda モジュールで python スクリプトをデプロイすることはもちろんできるが、その python スクリプト内でサードパーティのライブラリを使いたい場合、layer という機能を使って複数の lambda 関数で再利用するというのがもともとのやり方っぽい。とはいえ、サードパーティの依存ライブラリも python スクリプトによって使うものが違ったりするので lambda 関数単位に管理したいという場合もある。その要件を考慮した場合、python のパッケージングを lambda 関数のデプロイ時に再利用できるのが望ましくて、そのためのモジュールが aws-lambda-python-alpha になる。説明が長い。</p><ul><li><a href=https://www.npmjs.com/package/@aws-cdk/aws-lambda-python-alpha>@aws-cdk/aws-lambda-python-alpha</a></li><li><a href=https://docs.aws.amazon.com/cdk/api/v2/docs/aws-lambda-python-alpha-readme.html#packaging>Amazon Lambda Python Library - Packaging</a></li></ul><h2 id=jjug-ccc-2022-spring-のタイムテーブル>JJUG CCC 2022 Spring のタイムテーブル</h2><p>タイムテーブルが公開された。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>タイムテーブルが公開されたみたい。2022/06/19 10:25〜 Track C <a href="https://twitter.com/hashtag/jjug_ccc_c?src=hash&ref_src=twsrc%5Etfw">#jjug_ccc_c</a> でカスタム github actions の話しをします。よかったらご覧ください。スライド資料も主催のチェック完了後に公開予定です。<a href=https://t.co/AjP1aLt9EM>https://t.co/AjP1aLt9EM</a></p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1529788493895188480?ref_src=twsrc%5Etfw">May 26, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>私の前の発表が大橋さんという、一緒のチームでお仕事している方で github actions で運用している開発のワークフロー全般を改善したという話しをされる。その大半は私が設計して既存のワークフローを作り直したものなので応援している。改善の前後におけるワークフローの実行時間の比較や資料のレビューなども手伝っていて、私が主導してやったんだから内容についての責任は私にあると考えていろいろサポートしていた。おそらく github actions つながりで連続しているのかなと推測する。当初はお互いに送客すればいいかなと考えていたけど、普通のセッションの規定が厳しくて、スポンサーじゃなければ会社や製品の宣伝はダメという話しなので送客は断念した。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0525/>severless framework vs cdk</a></h1><div class=post-meta><span class=post-date>2022-05-25 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/cdk/>cdk</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#severless-framework-と-cdk-の比較>severless framework と cdk の比較</a><ul><li></li></ul></li></ul></nav></div><div class=post-content><p>22時に寝て1時に起きて5時半に起きた。前日はあまり寝てなかったので知らないうちに寝てしまった。</p><h2 id=severless-framework-と-cdk-の比較>severless framework と cdk の比較</h2><p><a href=https://www.serverless.com/>serverless framework</a> というツールがある。マルチクラウド対応で aws で言えば lambda のような、サーバーレスのアプリケーションを簡単にデプロイするためのツール。よく使われているようで、私がお手伝いしている会社でも lambda 関数のデプロイにこのツールを使っている。いろいろ調べていたら、serverless framework は cdk と真正面から競合になるツールで、cdk をすでに使っているなら cdk に一元管理した方が保守コストが下がっていいだろうと考え、新たに lambda 関数を作る作業を cdk でやってみた。私はほとんど serverless framework を使ったことがないので正しく理解できていない可能性は高いが、ざっくり比較すると次になる。</p><h4 id=serverless-framework>serverless framework</h4><p>メリット</p><ul><li>cdk より学習コストが低い</li><li>yaml 設定だけで簡単にデプロイできる</li></ul><p>デメリット</p><ul><li>リソース管理のための s3 バケットを必要とする</li><li>lambda に関連するリソースしかデプロイできない</li><li>開発者が明示的に設定しなくても裏でリソースを勝手に生成するので意図せず適切に管理されていないインフラを作ってしまう懸念がある</li><li>大半の実務レベルのアプリケーションでは cf テンプレートの dsl を yaml に設定する必要があり、設定が煩雑になったり見通しが悪くなる</li></ul><h4 id=cdk>cdk</h4><p>メリット</p><ul><li>任意の aws インフラのリソースを管理できる</li><li>プログラミング言語で記述できるので動的なリソースの依存関係を定義できる</li><li>cf は裏に隠蔽されているが、serverless framework のような dsl を記述する必要はない</li></ul><p>デメリット</p><ul><li>学習コストが高い</li></ul><p>リファレンス</p><ul><li><a href=https://www.secjuice.com/aws-cdk-vs-serverless-framework/>AWS CDK vs Serverless Framework</a></li><li><a href=https://dev.to/tastefulelk/serverless-framework-vs-sam-vs-aws-cdk-1g9g>Serverless Framework vs SAM vs AWS CDK</a></li></ul><p>結論から言うと、将来的に cdk を使うならまず cdk を使った方がよい。本当にシンプルな要件で lambda 関数のインフラしか扱わないなら serverless framework でもいいかもしれない。serverless framework は cdk がない時代に作られたツールだろうからいまから新規に導入する場合は、多少の学習コストを払っても cdk を学んでおけば、将来的に役に立つ場面が多いと思う。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0524/>法人として消費税を納めた</a></h1><div class=post-meta><span class=post-date>2022-05-24 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/kubernetes/>kubernetes</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#消費税と地方消費税の申告>消費税と地方消費税の申告</a></li><li><a href=#eks-k8s-から-alb-の管理>eks (k8s) から alb の管理</a></li></ul></nav></div><div class=post-content><p>5時に寝て7時過ぎに起きた。前日の夜から法人決算の電子申告に取り組み始めた。本当は紙でやるつもりだったんだけど、eltax が快適だったので e-tax も衝動的にやってみたくなった。</p><h2 id=消費税と地方消費税の申告>消費税と地方消費税の申告</h2><p><a href=/diary/posts/2022/0505/#法人決算>法人決算</a> の一部。今回が初めての消費税と地方消費税の申告になる。簡易課税で支払う。</p><blockquote><p>消費税は、国税（国に納付する税金）であり消費税の納税義務がある事業者が納付します。地方消費税とは、 <strong>消費税と同様で商品の販売やサービスの提供などの取引にかかる税金</strong> です。消費税との違いは、 <strong>地方消費税は国税ではなく地方税（都道府県や市町村に納付する税金）という点です。</strong> しかし実際に納付するときは消費税と分けて納付はせずに、 <strong>消費税と一緒に地方消費税を所管税務署へ納付します。</strong></p><p><a href=https://biz.moneyforward.com/tax_return/basic/70/#i>消費税と地方消費税の違いは？納付対象者や納付方法、計算の仕方まで徹底解説！</a></p></blockquote><p>freee で出力した書類をみながら e-tax の画面で同じ書類の項目を埋めていくだけの作業。1つだけバリデーションエラーが発生して、何度やり直しても数値は正しいようにみえるので無視して処理を継続することにした。メッセージにも値が正しければ継続してくださいと書いてあるのでバリデーションがバグっているのだろうと推測する。書類を作成して、署名して、送信して、納付情報が返ってきて、pay-easy で納付額を振り込む。1時間ほどで完了できた。</p><h2 id=eks-k8s-から-alb-の管理>eks (k8s) から alb の管理</h2><p>eks (k8s) に aws-load-balancer-controller をインストールすると k8s 上のリソースとして alb を管理できるようになる。</p><ul><li><a href=https://docs.aws.amazon.com/ja_jp/eks/latest/userguide/aws-load-balancer-controller.html>AWS Load Balancer Controller アドオンのインストール</a></li></ul><p>具体的には k8s の Ingress と Nodepoint リソースから次の3つのリソースを生成してくれる。</p><ul><li>application load balancer</li><li>http listener</li><li>target groups</li></ul><p>alb からのヘルスチェックは次のようにエンドポイントを記述する。spring boot だと <a href=https://docs.spring.io/spring-boot/docs/current/actuator-api/htmlsingle/>Actuator</a> という web api がヘルスチェックの機能を提供している。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>alb.ingress.kubernetes.io/healthcheck-path</span>: <span style=color:#ae81ff>/actuator/health</span>
</span></span></code></pre></div><p><code>alb.ingress.kubernetes.io/scheme</code> の設定で alb を配置するサブネットを指定できる。デフォルトは <code>internal</code> になる。</p><p>private subnet に配置するとき</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>alb.ingress.kubernetes.io/scheme</span>: <span style=color:#ae81ff>internal</span>
</span></span></code></pre></div><p>public subnet に配置するとき</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>alb.ingress.kubernetes.io/scheme</span>: <span style=color:#ae81ff>internet-facing</span>
</span></span></code></pre></div></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0523/>aws のシステム構成図に挑戦</a></h1><div class=post-meta><span class=post-date>2022-05-23 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/diagram/>diagram</a>&nbsp;
#<a href=/diary/tags/vscode/>vscode</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#drawio-を触ってみた>draw.io を触ってみた</a></li></ul></nav></div><div class=post-content><p>0時に寝て5時半に起きた。</p><h2 id=drawio-を触ってみた>draw.io を触ってみた</h2><p>先週末から着手している <a href=/diary/posts/2022/0519/#インフラのドキュメント作成>インフラのドキュメント作成</a> の続き。aws のシステム構成図を書こうと思ったものの、書いたことがないので次の記事を読み始めた。</p><ul><li><a href=https://aws.amazon.com/jp/builders-flash/202204/way-to-draw-architecture/>AWS のアーキテクチャ図を描きたい ! でもどうすれば良いの ?</a></li></ul><p>そこから <a href=https://aws.amazon.com/jp/architecture/icons/>AWS アーキテクチャアイコン</a> のダイアグラム作成ツールとして紹介されているツールを一通りみてみた。書いたことがないのでどのツールを使えばいいのかすらわかっていない。見た目だけ比べればどれも似たり寄ったりで何でもいいやと思えた。既存の cdk コードからインポートして自動生成できるツールもあったけど、なんか出力結果がいまいちでそれよりは手で書いた方がいいように思えた。前任者は <a href=https://drawio-app.com/>draw.io</a> で書いていたので、それでいいかと思って draw.io を触り始めた。前任者はリポジトリに svg ファイルのみをコミットしていた。なぜ draw.io の web サイトのリンクがないのだろう？と不思議に思いつつ、draw.io でユーザーアカウントをどうやって作るのかを調べていて気付いた。draw.io って ui ですべて作図していてサーバー側に情報をもってないみたい。だからユーザーアカウントを作る必要もなくて、ブラウザを単なる gui のインターフェースにしているだけみたい。有償プランもユーザーが管理しているストレージに対するアクセス管理機能のようなものを提供している。先入観から web ベースのツールだと思い込んでいたので新鮮な気持ちになった。</p><p>前任者は web ブラウザも使っていなくて vscode の <a href="https://marketplace.visualstudio.com/items?itemName=hediet.vscode-drawio">Draw.io Integration</a> で書いたらしい。ui 側のロジックが再利用できるなら vscode でもブラウザで書くのと同じ品質レベルの操作ができるのだろうと推測する。vscode の方がローカルで書いている実感がわくかもしれない。svg ファイルをコミットしていたのも github の rich diff を使うと svg ファイルの画像差分も表示してくれるから。当初は xml でバージョン管理しようと思っていたんだけど、差分表示ができるなら svg ファイルでもいいと思えた。今日のところは draw.io を使おうということだけ決定した。</p><ul><li><a href=https://dev.classmethod.jp/articles/create-infrastructure-diagrams-in-drawio-diactamsnet-manage-them-in-code-and-github/>Draw.io（diagrams.net）で作成したインフラ構成図をコードで管理する、GitHubで編集差分を確認する</a></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0522/>発表ビデオ提出</a></h1><div class=post-meta><span class=post-date>2022-05-22 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#ビデオセッションの撮影>ビデオセッションの撮影</a></li><li><a href=#小規模企業共済と住民税>小規模企業共済と住民税</a></li></ul></nav></div><div class=post-content><p>1時に寝て8時に起きた。疲れてだらだらしてた。</p><h2 id=ビデオセッションの撮影>ビデオセッションの撮影</h2><p>Widnows マシンで撮るか、Ubuntu で撮るかを迷ったあげく、<a href=https://launchpad.net/kazam>Kazam Screencaster</a> というツールを使って Ubuntu で撮ることにした。google docs のスライドをプレゼンター表示にして、メニューから全画面モードを選択すれば、プレゼン資料のノートをみながらフルスクリーンで画面に表示できる。そのフルスクリーン画面を kazam でキャプチャーする。kazam はシンプルなツールなので私の要件にも合致していてよかった。うちのシェアオフィスは壁が薄いので話し声などが隣に聞こえてしまう。発表のビデオ撮影をしていると、お隣さんからするとうるさくて迷惑をかけてしまうのでお隣さんが帰るのを待っていたら19時ぐらいになってしまった。19時から撮影を始めて内容を手直ししたり、失敗したりしながら3回ぐらい撮り直しをして完成させた。ビデオ撮影を1度やったので次にやるときはもっと要領よくできそうな気がする。ビデオ登壇は準備が楽そうだというのがわかってきたので今後も挑戦してみたい。</p><h2 id=小規模企業共済と住民税>小規模企業共済と住民税</h2><p>住民税は原則として原則として所属している会社が給与天引きで徴収して納めないといけない。これを特別徴収と呼ぶ。住民税の区切りは6月始まりなので、年に1回、5月に翌年の社員の住民税の通知が会社宛に届く。その通知には毎月徴収する住民税の金額が書いてある。<a href=/diary/posts/2022/0206/#2021年度の個人の確定申告>2021年度は小規模企業共済による所得減額</a> が48万円ある。所得税も減るし住民税も減る。昨年から総所得金額は変わっていないので小規模企業共済の掛け金によって所得金額が少なくなっている。おそらくその分で37,300円の住民税が安くなった。現状は4万円/月で運用しているが、将来的に余裕ができてくれば掛け金を増やしてもいいのかもしれない。</p></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/74/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a>
<a href=/diary/page/76/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>