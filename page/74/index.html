<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.123.1"><title></title>
<meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0609/>コンテンツは狙ってバズらない</a></h1><div class=post-meta><span class=post-date>2022-06-09 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/scrum/>scrum</a>&nbsp;
#<a href=/diary/tags/cdk/>cdk</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;
#<a href=/diary/tags/audio-media/>audio media</a>&nbsp;
#<a href=/diary/tags/marketing/>marketing</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#serverless-framework-から-cdk-移行の背景>serverless framework から cdk 移行の背景</a></li><li><a href=#terapyon-channel-のコンテンツ公開>terapyon channel のコンテンツ公開</a></li></ul></nav></div><div class=post-content><p>1時に寝て8時に起きた。昨晩はたくさん話してテンション上がって眠れなくてバテ気味。</p><h2 id=serverless-framework-から-cdk-移行の背景>serverless framework から cdk 移行の背景</h2><p>木曜日はスプリントレビューがある。ステークホルダーが出席する唯一のスプリントイベントなので、大半はステークホルダーとの情報共有や質疑応答、プロジェクトにとっての大きい括りでの現状の共有になる。大半はお手伝い先の社員さん同士のやり取りで、協力会社の開発者は詳細が必要になったときだけ説明するといったイベント。前スプリントで <a href=/diary/posts/2022/0601/#mvpminimum-viable-productで対応した>既存の lambda 関数を serverless framework から cdk へ移行</a> した。プロジェクトメンバーではないのだけど、業務のリーダークラスの方が cdk に関心をもって質問してくれた。聞くところによると、他プロジェクトでも cdk を使うようになってきているらしく、なぜいま移行しているのか？という質問だった。普段インフラ作業を孤独にやっているのもあって、業務の人が関心を示してくれたのが嬉しくて、変なスイッチが入っていろいろ説明した。serverless framework は2015年10月リリース、cdk は2018年7月リリースで、歴史的に serverless framework が普及して、その後に cdk が台頭してきたので実績や機能性から serverless framework が広く利用されている。但し、いま aws のインフラ管理をするのであれば、cdk は serverless framework 以上の管理ができることから cdk に一元管理した方がツールの学習コストを減らし、保守コストを下げることにつながるといった話しを丁寧に説明した。相手がそこまでの回答を求めていたかはわからないけど、関心を示してくれたことそのもので私が救われた気がした。</p><h2 id=terapyon-channel-のコンテンツ公開>terapyon channel のコンテンツ公開</h2><p>昨日の今日で公開された。ほとんど無編集だったのかな。web サイトのコンテンツ紹介の内容も手伝って夕方には公開された。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>Podcast terapyon channel 「#58 もりもとさんの年1ゲスト会 マイクロ法人と開発ワークフローのカイゼン話ほか」を共有 <a href=https://t.co/aQfbuA6XrO>https://t.co/aQfbuA6XrO</a> <a href="https://twitter.com/hashtag/terapyon_channel?src=hash&amp;ref_src=twsrc%5Etfw">#terapyon_channel</a></p>&mdash; terapyon (Manabu TERADA) (@terapyon) <a href="https://twitter.com/terapyon/status/1534817292080451584?ref_src=twsrc%5Etfw">June 9, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>私の中ではいろんな話題を楽しく話せて充実感があった。一部にだけ関心をもつ人にも聞きたいところだけ聞けていいんじゃないかと思えた。基本的に自分の podcast を聞き直すことはないんだけど、今回は自分が充実感をもって話せたせいか、2回ほど聞き直しておもしろい話だなぁと自画自賛してた (笑) 。自分がよいものは周りもそう思うはずだと、ついつい先入観で考えがちだけど、全然そうじゃなかった。全くいいねがつかなかったので周りからみたら私の自己満足のコンテンツでしかなかった (笑) 。コンテンツあるあるだけど、狙ってコンテンツをバズらせるのは難しい。ブログでもがんばって書いた記事が全く読まれないことはあるし、手間暇かけずに軽く書いた記事がめっちゃバズったこともある。コンテンツがバズるかどうかは、最初にみた人たちが拡散するかにも依ってくる。いずれにしても、他者が関心をもつようなコンテンツかどうかは本人ではわからないというのは確かかな。</p><p>今期から会社のマーケティングも少しずつやっていく予定になる。自分がよいと思ったコンテンツに全く関心を示されないことは今後も多々あるだろう。作ったコンテンツを多くの人に見聞きしてもらおうと思ったらやることは1つだけで、当たるまでひたすら作り続けて、いつか当たるのを気長に待つという戦略しか、いまのところ思いつかない。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0608/>書いた後に話して</a></h1><div class=post-meta><span class=post-date>2022-06-08 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/scrum/>scrum</a>&nbsp;
#<a href=/diary/tags/audio-media/>audio media</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#開発チームで設計の話し>開発チームで設計の話し</a></li><li><a href=#terapyon-channel-の収録>terapyon channel の収録</a></li></ul></nav></div><div class=post-content><p>3時に寝て7時に起きた。ワーケーションの記事まとめで1時ぐらいまでオフィスにいたので帰ってきてから寝るのが遅くなった。</p><h2 id=開発チームで設計の話し>開発チームで設計の話し</h2><p>昨日のスクラムイベントのふりかえりでスプリントゴール未達の話題があった。うちのチームはスプリントが1週間と短いのもあるけど、スプリントゴールが未達になることがままある。というか、メンバーも本当の意味でスプリントゴールを守ろうとしていない。守れそうにないと分かっても残業も延期もせずに最終日を迎えて未達で終わるだけでしかない。それはともかく、ゴールに含めるタスクの見積もりの精度が悪いのではないかという話題が出たときに、私の周りではプランニングにもっと時間を割いてがっつり設計までやるという話しを聞くので、うちらのプランニングはチケットを選択して適当に割り当てたストーリーポイントで曖昧な見積もりをしているのでそれが悪いのではないかという意見を上げた。そしたら開発者だけで設計のミーティングをやろうという話しになって、今日から毎週やっていくのかな。会議が増えて実務をやる時間が減るというデメリットはあるものの、チームとして学ぶ時間が少ないとは前から思っていたので、チームとして学びの時間を使ってメンバーのスキルを高めていくきっかけの1つとしてはよいかもしれないと思った。あるチケットで議論していて、本質的にはどうなるべき？という議論をして、直近のマイルストーンでは実装できないが将来的に対応するときのためにチケットを作っておいたりした。そういう1つずつの積み重ねが将来の品質をあげていく糧になる。開発者だけで設計という枠組で話すこと自体は大事な時間だとは思えた。</p><h2 id=terapyon-channel-の収録>terapyon channel の収録</h2><p>21時過ぎから <a href=https://podcast.terapyon.net/>terapyon channel</a> の収録を行った。たまたまだけど、私は年に1回出演していて、今後もそのペースがいいなという思えた。6月は法人決算を終えて気楽になっているし、1年に1回なら近況報告として話題もたくさんある。前回からのツールのアップグレードとして <a href=https://iris.fm/>iris</a> というツールで収録した。これまではローカルで音声ファイルを録音して、終わった後に寺田さんへその録音ファイルを送信していた。iris を使うと、ブラウザだけでそれをやってくれるのでゲスト側の作業が減ってお手軽になる。ホスト側もゲスト側で録音に失敗するという最悪の事態のリスクを軽減できるので望ましいという。iris のホスト側の画面にはゲスト側の音声が録音されていることを表すインジケーターもみえるらしい。それが安心感を与えているとのこと。久しぶりに寺田さんと話して、podcast の収録というよりも寺田さんと普通に近況の雑談をしたぐらいの感覚でしかない。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0607/>変哲もない1日</a></h1><div class=post-meta><span class=post-date>2022-06-07 (Tue.)</span></div><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#開発の隙間>開発の隙間</a></li><li><a href=#ワーケーションのまとめ>ワーケーションのまとめ</a></li></ul></nav></div><div class=post-content><p>0時に寝て7時に起きた。もうバテバテ。</p><h2 id=開発の隙間>開発の隙間</h2><p>インフラタスクも一段落したのでアプリケーション開発の手伝いをしている。言うてももうすぐ feature freeze で大半の機能は fix しているのでサービスインに向けての運用系のタスクを先行して取っているだけ。簡単なサーバーサイドの修正を行い、割り当てられたタスクの内容を確認したり、スクラムイベントのふりかえりをしたり、ドキュメントを書いたりしたら1日が終わってしまった。ワーケーションへ行ってきた疲れが残っているのか、インフラタスクが落ち着いて次のタスクへの切り替わりのせいか、あまり集中できなかった。6月の週末はちょっと休んでもいいかもしれない。</p><h2 id=ワーケーションのまとめ>ワーケーションのまとめ</h2><p>3日目のワーケーションの記事を書き終えた。明日、音声コンテンツの収録があるからそれまでに終えようと思って無理して書き上げた。日が変わるぐらいまでは作業してたと思う。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0606/>aws sns を介した pubsub</a></h1><div class=post-meta><span class=post-date>2022-06-06 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/cdk/>cdk</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#lambda-関数と-sns-の連携>lambda 関数と sns の連携</a></li></ul></nav></div><div class=post-content><p>0時に寝て4時半に起きた。21時頃からオフィスで作業してたらそのまま寝落ちした。朝の掃除機をかける音で目覚めて、始業までワーケーションのふりかえりをしていた。</p><h2 id=lambda-関数と-sns-の連携>lambda 関数と sns の連携</h2><p>定期実行で数百程度の web api 呼び出しを行いたい。これまで定期実行を lambda 関数で実装してきたが、負荷分散を考慮して作ってほしいと言われたので sns を使ってメッセージ分割した上で1つ1つの lambda 関数は sns のメッセージを受け取って実行されるように構成した。lambda 関数を使って pubsub するときは sns を使えばよいらしい。sns はあまり使ったことがないので私自身ノウハウをもっていないし、運用の勘所もよくわかっていない。ドキュメントをいくつか読みながら cdk のコードを書いてた。producer と consumer を lambda 関数で作成し、sns を介してリクエストの負荷分散を図る。lambda 関数は同時並行数を設定できるのでこれがスロットル制限のような役割にもなる。インフラやスクリプトのコードはすぐに実装できたが、lambda 関数の destroy にやたら時間がかかる。権限周りでいくつか設定を試すために destroy しながら検証をしたかった。destroy するのに20分はかかるので deploy や設定の手作業などをやっていると1つの設定を試すのに平気で1時間ぐらいかかってしまう。3回ぐらいやって疲れて検証作業はやや妥協した。</p><ul><li><a href=https://docs.aws.amazon.com/ja_jp/lambda/latest/dg/with-sns.html>Amazon SNS でのAWS Lambdaの使用</a></li><li><a href=https://docs.aws.amazon.com/lambda/latest/dg/configuration-concurrency.html>Managing Lambda reserved concurrency</a></li><li><a href=https://docs.aws.amazon.com/sns/latest/dg/sns-security-best-practices.html>Amazon SNS security best practices</a></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0605/>ワーケーション 3日目</a></h1><div class=post-meta><span class=post-date>2022-06-05 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/workcation/>workcation</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#朝風呂とモーニング>朝風呂とモーニング</a></li><li><a href=#チェックアウト>チェックアウト</a></li><li><a href=#出石そばと城下町散策>出石そばと城下町散策</a></li><li><a href=#西紀サービスエリア>西紀サービスエリア</a></li><li><a href=#小さなふりかえりと神戸空港>小さなふりかえりと神戸空港</a></li><li><a href=#ストレッチ>ストレッチ</a></li></ul></nav></div><div class=post-content><p>3時に寝て6時前に起きた。起きて作業しようと思って階下に降りた (寝室は2階) ものの、なんかバテてて、畳の部屋で寝転がっていた。涼しくて気持ちよかった。2度寝もしてたかもしれない。起きてからは帰りの高速道路のサービスエリアを調べたり、丹波篠山市か、六甲山天覧台に寄り道するならどういうルートになるかシミュレーションしたりした。</p><h2 id=朝風呂とモーニング>朝風呂とモーニング</h2><p>昨日と同じように7時を過ぎてから朝風呂に出掛けていく。今日は「地蔵湯」に入った。子ども向けの浅いお風呂と大きなお風呂があった。座椅子でやや腰に負担がかかっていたのでジャグジーで腰の療養をした。昨日3時まで雑談して疲れていたせいか、2泊を終えてバーンアウトしてしまったのか、3日目の旅程の考えがうまくまとまらなくて、お風呂に入りながらぼーっとしていた。喫茶店の <a href=https://tabelog.com/hyogo/A2808/A280801/28014933/>萠阿 (のあ)</a> さんでモーニングを食べた。</p><figure><img src=/diary/img/2022/0605_morning1.jpg></figure><p>事前に作成しておいた旅のしおりでは、チェックアウトは11時にして、13時に城崎温泉を出発する旅程になっていた。意図としては観光したい人向けに余裕をもったスケジュールにしていたつもりだった。しかし、周りも疲れているようにみえて、11時に城崎温泉を出てもいいかなという空気にはなっていた。とはいえ、11時から帰り始めると2時間半で神戸に着いてしまう。はらさんの帰りの飛行機の時間が19時だったのであまり早くても持て余してしまう。車で行ける付近の場所を観光してもいいかなと思いつつも具体的なアイディアが出てこない。疲れると想定外の状況に対していくつかの仮説を並行してシミュレーションできなくなっていた感じ。お昼ご飯どうする？という話題に、城崎温泉で食べるか、よそで食べるかもまとまらない。誰かが出石そばを食べに行こうと言い始めて「あっ、よさそう」と思えた。近くのパーキングエリアで出石そばを食べたらいいんじゃない？という案もあったが、出石の城下街へ行こうと押し切った。はまらないパズルのピースがはまった。学生の頃にツーリングで出石に行ったことがあったので私はどんな場所かを知っていて、お昼ご飯も食べられて少し観光もできてちょうどいいと思えた。</p><h2 id=チェックアウト>チェックアウト</h2><p>11時に管理人さんが来られ、チェックアウトの手続きはすぐに済み、みんなで記念写真を撮って帰り始める。管理人さんは城崎温泉のことを質問すると、あれやこれやと教えてくれていた。すみよしさんが「出石そばのお薦めのお店知っています？」と管理人さんに尋ねた。私がそれは流石に知らんやろと横で聞いていたら「ちょっと待ってください」と即答で2店舗を教えてくれた。この管理人さんは何でも知っているんやなと感心して笑ってしまった。管理人さんは本当に親切でよい人だった。</p><p>このときの集合写真はきのいえのインスタグラムで公開されている。</p><ul><li><a href=https://www.instagram.com/p/CeatOWvLNMs/>お宿で勉強会！</a></li></ul><h2 id=出石そばと城下町散策>出石そばと城下町散策</h2><p>11時に城崎温泉を出て出石の城下町へ向かう。40分ほどで着く。きのいえの管理人さんに教えてもらった <a href=https://tabelog.com/hyogo/A2808/A280801/28006603/>官兵衛</a> さんに訪問。お昼前で少し早かったせいか、ちょうど待たずに入れた。うちらがお店を出たときは2組ほど並んでいた。出石そばのシステムがわからなくて、注文するときに店員さんに尋ねると、大人男性ならだいたい10-15皿だという。ひとまず10皿を頼んで足りなかったらまた注文すればいいとのこと。まずはそばだけ食べて、その後に薬味を使って、卵は後半の方がよいと教えてくれた。私は、最初の2皿をそばだけを食べて、次にわさび、その後に葱や大根おろしを試し、とろろも入れ、8皿目ぐらいに卵をつかってみた。ちょっとした味のバリエーションにもなっていておもしろかった。私は10皿で満足した。</p><p><figure><img src=/diary/img/2022/0605_soba1.jpg></figure><figure><img src=/diary/img/2022/0605_soba2.jpg></figure></p><p>余談だが、まったく値段を知らずに入ったので、お会計のときにこれはいくらなんだろう？思いながら勘定をした。1人あたり薬味150円と皿そばが170円 * 10皿で合計すると1,850円 (税込) だった。おいしかったし、皿そばという名物を食べるという雰囲気も味わえてよかったのでまったく不満はない。純粋にそばだけだからそんなに高くないのかな？という先入観から想像以上だったので少し驚いた感じ。はらさんが「外国人を連れてきたらすごく喜ぶと思いますよ。」と2回ぐらい言ってた気がするので、これは大事なことなんだと思って、外国人を連れてきたらいいと私の記憶に残った。</p><figure><img src=/diary/img/2022/0605_izushi1.jpg></figure><p>その後、せっかく出石に来たから城跡も行ってみることにした。城跡には行ったことがなかった。城跡だから原っぱみたいな場所をみるだけかな？と考えていたら、石垣がしっかり残っていて3段目ぐらいまで登って街並みを展望できた。さらにもっと山を登っていけるようで、頂上までいくとそれなりの山登りハイキングができる場所になっているみたい。</p><p><figure><img src=/diary/img/2022/0605_izushi2.jpg></figure><figure><img src=/diary/img/2022/0605_izushi4.jpg></figure></p><p>私はまったく出石城のことを知らなくて、もともとのお殿様ではないが、なんやらかんやらで <a href=https://ja.wikipedia.org/wiki/%E4%BB%99%E7%9F%B3%E7%A7%80%E4%B9%85>仙石秀久</a> が城主になったらしい。<a href=https://www.sunrise-pub.co.jp/duet-vol93/>センゴク</a> の漫画の主人公。城跡に上る鳥居の裏に作者の宮下英樹さんの名前もあった。<a href=https://xn--y8jwb3fsa0346bwq3atxzab5s.com/saiko/sengoku-hidehisa/>仙石秀久：鈴鳴り武者、またの名を蕎麦の伝道師…、あんたはいったい何者だ!?</a> の記事によると、出石そばも仙石秀久が信州から出石へ転封したときに一緒に付いてきた信濃のそば職人が発祥になっているらしい。はーん。</p><figure><img src=/diary/img/2022/0605_izushi3.jpg></figure><h2 id=西紀サービスエリア>西紀サービスエリア</h2><p><a href=/diary/posts/2022/0603/#三ノ宮から城崎温泉への移動>ワーケーション1日目の反省点</a> にも書いたが、車の移動で行きはどこで休憩するかを決めていなかった。そうすると、どのタイミングでどこのサービスエリアに入っていいかがわからなくなってしまった。帰りは下調べして、休憩によさそうな設備があって中間の適切な位置として、舞鶴若狭自動車道の西紀サービスエリアがよさそうと調べていた。そして最初からナビの目的地をサービスエリアにしてしまうことで走り過ぎや休憩までのペースなども走りながら考える必要がない。当たり前のことなんだけど、自分で運転してみて初日はうまく段取りできなかったのでこれも大事な事前準備だと気付いた。</p><figure><img src=/diary/img/2022/0605_sa1.jpg></figure><h2 id=小さなふりかえりと神戸空港>小さなふりかえりと神戸空港</h2><p>神戸に戻ってきてから雨がぱらぱらし始めた。天候も何とかもってちょうどよかった。1時間ほどドトールさんで休憩しながら軽いふりかえりみたいになった。</p><ul><li>朝と夜に温泉入るのは疲れる<ul><li>7つの外湯があり、パスポートを購入していても連続でお風呂に入る人はいなかった</li></ul></li><li>開発合宿は2泊3日が限界<ul><li>非日常の慣れない生活は楽しさととも緊張もあるので疲労も大きい</li></ul></li><li>実際にやってみることから得られる経験や体験はとても大きい<ul><li>城崎温泉がどういう場所か、その文化や歴史の一端を垣間見えた</li><li>主催としてやらなければならない段取りや準備の経験を大きく積めた<ul><li>今回の経験をベースにして今後も課題管理システムに積み重なっていく</li></ul></li></ul></li><li>今後の開発合宿イベントの展望<ul><li>オープン版は三ノ宮.devでやりそうなのでそこに便乗する</li><li>うちの会社の関係者や知人に声をかけてクローズドなイベントを1回/年でやる<ul><li>(当面は) bizpy ではやらないかなぁ</li></ul></li></ul></li></ul><p>その後、解散してはらさんを神戸空港まで送っていった。空港の場所は知っていたけど、実際に行ったことなかったので車で空港への行き方がわかってよかった。これで飛行機で神戸に来る人がいても送迎ができる。18時半にレンタカーを返却した。今回は日産 NOTE e-Power というハイブリッド車を初めて運転した。今回の旅程で約350km走って消費したガソリンは約15リットルだった。燃費は23.3/リットルだった。レンタカーを返して家に着いたらやり終えたなって感じで気分がよかった。</p><h2 id=ストレッチ>ストレッチ</h2><p>いつもは土曜日の10時に通っているストレッチを、ワーケーションがあったので日曜日の19時半に変更してもらっていた。温泉に入った後に多少はストレッチをしたものの、運転疲れで体が硬くなってしまっていた。今日の開脚幅は開始前155cmで、ストレッチ後160cmだった。ワーケーションへ行ってきて疲れた後にストレッチを受けられるのは、疲弊した箇所がわかってとてもよかった。外湯に入るために普段より歩いたのものあって腰とふくらはぎの張りが強かった。その上で座椅子や車の運転なども相乗効果があって疲れが溜まっていた感じ。トレーナーさんと旅のふりかえりを雑談しながらストレッチを受けていて、週末どこかへ行ってきた後にストレッチを受けるのはすごくいいと思ってしまった。この場合、私の中ではストレッチがマッサージに置き換わってしまっている。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0604/>ワーケーション 2日目</a></h1><div class=post-meta><span class=post-date>2022-06-04 (Sat.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/workcation/>workcation</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#朝風呂とモーニング>朝風呂とモーニング</a></li><li><a href=#わたなべさん合流>わたなべさん合流</a></li><li><a href=#晩ご飯の買い出し>晩ご飯の買い出し</a></li><li><a href=#夜風呂と海鮮鍋>夜風呂と海鮮鍋</a></li><li><a href=#夜散歩>夜散歩</a></li><li><a href=#プレゼン大会と出前ラーメン>プレゼン大会と出前ラーメン</a></li></ul></nav></div><div class=post-content><p>0時に寝て5時半に起きた。軽く作業をしてから朝風呂を入りに行くことにした。</p><h2 id=朝風呂とモーニング>朝風呂とモーニング</h2><p><a href=https://kinosaki-spa.gr.jp/about/spa/7onsen/>7つの外湯</a> のうち、朝7時からあいているところは次の4つ。</p><ul><li>地蔵湯</li><li>一の湯</li><li>御所の湯</li><li>鴻の湯</li></ul><p>朝風呂を入るために浴衣姿で外を出歩く。城崎温泉のよいところとして、浴衣姿でその辺を散歩していても変な人に思われない文化を意図的に作っている。浴衣のまま出歩けるというのは、温泉が外湯なので出掛けるために着替えないといけないという手間を軽減するとともに、日本的くつろぎの雰囲気も醸し出している。実利と文化の両面から城崎温泉というコンテンツに付加価値を与えているおもしろい文化だと思えた。街が一体となってそういう文化を作ってきたんだなという歴史の重みも感じた。</p><p>「一の湯」に入ることにした。外へつながる扉に「洞窟」と書いてあって、露天風呂があるんだろうと思いながら外に出たら本当に洞窟があった。洞窟の温泉というのに入ったことがなかったのでびっくりした。後から入ってきたはらさんをみていて、なにこれ？みたいな表情をしたのがおもしろくて、初見ならびっくりするよなと私も入ったときにそんな顔をしていたのだろうとおもしろかった。入り終えてからから街並みをぶらぶらしながら <a href=https://tabelog.com/hyogo/A2808/A280801/28028485/>カフェこやま</a> さんでモーニングを食べた。懐かしい雰囲気。その後、さらに街並みを20-30分ほどぶらぶら散歩して戻ってきた。朝から徒歩で出かけてお風呂に入って2時間ほど時間が経っていた。</p><figure><img src=/diary/img/2022/0604_food1.jpg></figure><h2 id=わたなべさん合流>わたなべさん合流</h2><p>宿に戻ってきて10-12時まで作業をしていた。12時半にわたなべさんが来られるので城崎温泉駅で出迎えて一緒にお昼ご飯を食べた。この時点で4人の全参加者が揃った。駅前でカニとろろ丼を食べておいしかった。</p><figure><img src=/diary/img/2022/0604_food2.jpg></figure><p>宿に戻ってきて13-15時まで私は雑談していた。今回の合宿の一番の私の収穫として次のことを学んだ。はらさんと話していたときにふとこんなことを聞いた。</p><blockquote><p>作業は自宅やオフィスで黙々と時間をかければできるけど、そうじゃないもの、なにを作るかがそもそも明確ではないものを考えるときは移動しながら考えていることが多い。</p></blockquote><p>はらさんはデザインのお仕事をされているので、ひらめきが必要なお仕事も多いのだろうと推測する。その話しを聞いてから、私も神戸に戻ってできる作業は後回しにして、普段やらないことや課題が曖昧なことの考えごとに取り組もうと姿勢を改めた。書きものをしながら、主には他のメンバーと雑談していた気がする。</p><h2 id=晩ご飯の買い出し>晩ご飯の買い出し</h2><p>一棟貸しの宿を借りたのでせっかくだから自炊してみんなで鍋をやろうと考えた。城崎温泉の注意点としてお店が早く閉まる。市場は17時、他のお土産屋さんや喫茶店も18時にはほぼ閉まっていたように思える。もしかしたら、6月は閑散期らしく観光客も少なかったためにそうしていたのかもしれない。そのため、15時半から買い出しに出掛ける。</p><p><a href=https://www.okesyo.com/>おけしょう鮮魚</a> さんで海のものを購入する。店員さんに話しかけると、陳列していないお魚をいろいろ紹介してくれた。残念ながら、いまはカニの季節ではなく、松葉ガニは3月末に、紅ズワイガニ (香住ガニ) は5月末に漁が終わっているという。紅ズワイガニのゆでたものだけ置いてあったが、ゆでてあるカニを鍋にすると味が薄くなるだけと話されていた。いまは漁の季節ではないから生のカニが手に入らなくてカニ鍋をするにはむかないと教えてくれた。方針を転換して、真鱈と地元の魚を選んで切り身を見繕ってもらった。このときにお魚やさんに「骨を取って」と伝える方がよかったことを学んだ。私は滅多に魚を買わないのでそういう機微を知らなかった。あと1つ400円ぐらいの地元で取れたはまぐりを4つ購入した。魚屋さんが言うには、中国産の安いものもあるからそれでも味はそんなに変わらないよと気遣ってくれたけど、せっかく来たので地元のものを食べたいと思って値段の高い地元のはまぐりを買うことに決めた。魚を捌くのに15分ほどかかるので次の買い出しへ向かう。<a href=https://kinosaki-spa.gr.jp/directory/wada-ya/>和田屋</a> さんで鍋に入れる野菜やきのこ、糸こんにゃくを買う。白飯も置いてた。お惣菜も少し売っている。<a href=https://kinosaki-spa.gr.jp/directory/okamoto/>岡本酒店</a> さんで店長おすすめのそのお店オリジナルの日本酒を購入した。最後に <a href=https://www.ekiten.jp/shop_5101588/>ミニフレッシュ</a> で足りないもの、お茶などを購入した。ここは普通のスーパーになる。</p><p>1時間ほどで買い出しを完了した。温泉街の中心地にある宿の立地がよいので徒歩で十分に買い出しできた。車であちこち行くのかと想像していたのでとても楽だった。</p><h2 id=夜風呂と海鮮鍋>夜風呂と海鮮鍋</h2><p>買い出しを終えてから少し作業をして17時半ぐらいから「御所の湯」へ出掛ける。目の前に小さい川 (滝) を眺めながらお風呂に入れてよかった。「一の湯」の洞窟と匹敵する自然の風情を活かしたお風呂になっていた。その帰りに <a href=https://kinosaki-spa.gr.jp/directory/center-yugijo/>センター遊技場</a> が開いてたので入ってみた。昔ながらの射的があってやっているのを眺めてた。</p><figure><img src=/diary/img/2022/0604_shooting1.jpg></figure><p>お風呂から宿に戻って海鮮鍋を作り始めた。19時前後かな。アラで取った出汁と購入した出汁を組み合わせ、あとは野菜やきのこ、魚を入れて煮込むだけ。調理は簡単だったし、すぐにできた。食べながら魚を追加で入れたり、最後に白飯を入れて雑炊を作ったりして、みんなでわいわい作る楽しさもあって、やや不格好だったものの味はおいしかったと思う。一応、はまぐりの砂抜きも2-3時間ほどやってみて、砂が抜けたかどうかよくわからなかったけど、食べてみて砂を感じなかったので大丈夫だったと思う。もしかしたら魚屋さんでやっていたのかもしれない。和田家さんでポン酢も買っておいたけれど、出汁だけでそのまま食べてもおいしかったので、ポン酢はあまり使われなかった。岡本酒店さんの限定日本酒も甘口で奥深さのあるおいしい日本酒だった。お土産にもよさそうかな。鍋にもあっていたと思う。</p><p><figure><img src=/diary/img/2022/0604_food3.jpg></figure><figure><img src=/diary/img/2022/0604_food4.jpg></figure><figure><img src=/diary/img/2022/0604_food5.jpg></figure><figure><img src=/diary/img/2022/0604_food6.jpg></figure></p><h2 id=夜散歩>夜散歩</h2><p>21時過ぎにお茶がなくなったので買い出しも兼ねて夜散歩してきた。温泉街の中心地を川が流れていて、その左右に柳とライトアップが見栄えよく、きれいだという話しを聞いたのでみんなで散歩しながら眺めてきた。6月という季節は、暑くも寒くもなくてちょうどよかったと思う。城崎温泉は徒歩で行ける街並みの景観がよいので老若男女誰でも楽しめる場所のように思えた。たぶん温泉街ってそういうものかな。</p><p><figure><img src=/diary/img/2022/0604_view1.jpg></figure><figure><img src=/diary/img/2022/0604_view2.jpg></figure><figure><img src=/diary/img/2022/0604_view3.jpg></figure></p><h2 id=プレゼン大会と出前ラーメン>プレゼン大会と出前ラーメン</h2><p>22時から親睦も兼ねてのプレゼン大会。みんなに何か話すネタを作ってきてとお願いしていたのでみんなちゃんと作ってきてくれてた。はらさんはこの合宿で取り組んだ <a href=https://www.oreilly.co.jp/books/9784873119342/>スマートコントラクト入門</a> の話し、すみよしさんは <a href=https://sannomiya.dev/>三ノ宮.dev</a> を3年以上、運営してきてわかった話し、わたなべさんはやってきた研究と貿易統計からみる日本の経済動向の話し、それぞれが個性や特性を出していて、とてもおもしろかった。少ない人数でやると深い質疑応答のやり取りも出来たりしてよい。全然違うバックボーンをもった参加者同士が、自由に発表していたのでみんな違う話しでとてもよかったと思う。私は最近デザイナーさんに作ってもらったスライドマスターを使って、会社紹介を作りつつ、課題管理をビジネスとしてやってみたいという話しをした。話題がちょっと堅かったかもしれないなとも思えたが、プレゼン大会が終わってからその夜にわたなべさんと3時まで課題管理がどうのこうとか、ビジネスの展開について雑談していた。その後の雑談ネタにもなってよかったのかもしれない。</p><p><figure><img src=/diary/img/2022/0604_presentation1.jpg></figure><figure><img src=/diary/img/2022/0604_presentation2.jpg></figure></p><p>プレゼン大会の途中で wifi の調子が悪くなって、プロジェクターとラップトップの接続がうまくいかなかったりもした。午後からネットワークも不安定で繋がらないときもあったりしたのでルーターの再起動をできるとよかったのかもしれない。次回があれば、管理人さんにそういった状況を想定して、ルーターの場所を聞いておいて、うちらが再起動してもいいかどうかを確認しておいてもよかったのかもしれない。</p><p>余談だけど、プレゼン大会の途中で <a href=https://tabelog.com/hyogo/A2808/A280801/28011388/>宮政ラーメン</a> という宅配ラーメン？で出前をとったりもした。電話で注文すると、宿まで来てくれて、その場で屋台ラーメンを作ってくれる。この店主は37年やっているらしい。みんな油そばを頼んでいておいしかったみたい。私はお腹いっぱいだったし、この時間 (0時) に食べると次の日に胃もたれで辛そうかなと思って今回は断念した。営業時間は21時から翌1時。もうちょっと早い時間に気付いて注文すればよかったかもしれない。</p><p><figure><img src=/diary/img/2022/0604_food7.jpg></figure><figure><img src=/diary/img/2022/0604_food8.jpg></figure></p><p>プレゼン大会を終えてから海鮮鍋の片付けをした。0時回っていてちょっと疲れたなという印象もあったのでもうちょっと時間の配分や段取りをうまくできればよかったと思う。次回への反省点かな。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0603/>ワーケーション 1日目</a></h1><div class=post-meta><span class=post-date>2022-06-03 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/workcation/>workcation</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#三ノ宮から城崎温泉への移動>三ノ宮から城崎温泉への移動</a></li><li><a href=#きのいえのチェックイン>きのいえのチェックイン</a></li><li><a href=#はらさん合流と午後の作業>はらさん合流と午後の作業</a></li><li><a href=#外湯めぐりと晩ご飯>外湯めぐりと晩ご飯</a></li><li><a href=#就寝前>就寝前</a></li></ul></nav></div><div class=post-content><p>23時に寝て6時に起きた。</p><h2 id=三ノ宮から城崎温泉への移動>三ノ宮から城崎温泉への移動</h2><p>8時前にレンタカーを借り、途中で同乗者のすみよしさんを拾ってから城崎温泉へと向かう。途中、丹羽市の氷上というパーキングエリアで15分ほど休憩した。よく知らない道を運転しているとどこのパーキングエリアで休憩していいかわからなくなる。事前に休憩する場所を調べておく必要があったことに気付いた。もともとかなり余裕をもったスケジュールで運転していたものの、普通に高速道路を運転していると10時半ぐらいには城崎温泉の近くまで着いていた。宿の管理人さんには12時前後と伝えていたのでかなり早過ぎる。寄り道しようということで近くの玄武洞に行ってみることにした。残念ながら展示している岸壁の工事をしていてあまり景観はよくなかったけど、軽いハイキングのような感覚で玄武洞周りの公園を歩いたり、ミュージアム (というよりはお土産さんみたい印象) で様々な石をみたりもできた。</p><p><figure><img src=/diary/img/2022/0603_genbudo1.jpg></figure><figure><img src=/diary/img/2022/0603_genbudo2.jpg></figure><figure><img src=/diary/img/2022/0603_genbudo3.jpg></figure></p><h2 id=きのいえのチェックイン>きのいえのチェックイン</h2><p>30分強ほど玄武洞で時間を潰して11時半頃に城崎温泉の <a href=https://kinosaki-kinoie.com/index.html>きのいえ</a> に辿り着いた。何度か道を間違えてうろうろしたりもした。初めて行く場所は道を間違えることも計算に入れて少し早めに行くぐらいでちょうどよい時間帯になるのかもしれない。2泊3日で城崎温泉唯一の一棟貸しの宿を借りた。本来のチェックインは15時からになるものの、管理人さんの計らいで特別に12時にチェックインの手続きをしてくれた。宿に到着して電話すると15分ぐらいでやってきて、宿泊者のワクチン摂取確認と本人確認を行い、その後に宿泊料を私がクレジットカードで一括で支払った。これは <a href=https://www.hyogo-tourism.jp/furusato-ouen/>ひょうごを旅しようキャンペーン＋(プラス)</a> で割引を受けるためにワクチン摂取証明と本人確認が厳しいという背景。事務手続きを終えて施設の説明を一通り受ける。管理人さんは見た目30歳前後の若い方で、普段はカーテン職人として働きながら週末だけきのいえの管理人をやっているという。週末起業みたいなものかもしれない。とても親切な方で丁寧に設備の説明をしてくれて、付近のおすすめのお店や城崎温泉での過ごし方なども教えてくれた。</p><p><figure><img src=/diary/img/2022/0603_hotel1.jpg></figure><figure><img src=/diary/img/2022/0603_hotel2.jpg></figure></p><h2 id=はらさん合流と午後の作業>はらさん合流と午後の作業</h2><p>13時前に千葉から来られたはらさんを城崎温泉駅で出迎えて一緒にお昼ご飯を食べた。但馬牛の牛すじ丼とうどんを食べた。おいしろかった。宿に戻っていたらお手伝い先のミーティングが入っていることに気付く。1時間ほどテレビ会議でややこしい内容の方向性の議論をして、その後もチケットの作業をしていた。17時ぐらいから sns でシェアするときの ogp 画像のデザインについてはらさんに相談にのってもらった。これまでは、私が求めていたデザインに近いものを最初から提供してくれていたデザイナーさんだったが、今回は苦戦していて、最初のものは全然違うって感じでボツにして再作成してもらった。いくつかやり取りして、ある程度、近いものに修正してくれて、微調整をはらさんと一緒にしていた。はらさんのアドバイスは的確で、こうした方がよいと言われた内容をデザイナーさんに伝えて、修正してもらって、再アップロードしてもらった画像をみると、ちょっとした違いでうける印象も変わったりしてよくなった。デザイナー視点における &ldquo;見る&rdquo; ポイントがあるんだなぁと、素人の私にはわからない視点を見抜かれていたようだ。</p><figure><img src=/diary/img/2022/0603_food1.jpg></figure><h2 id=外湯めぐりと晩ご飯>外湯めぐりと晩ご飯</h2><p>17時過ぎからみんなの作業も終わったところで温泉に入りにいくことにした。<a href=https://kinosaki-spa.gr.jp/about/spa/7onsen/>7つの外湯</a> があり、まずは駅の近くの「さとの湯」に入った。2Fと3Fにお風呂があって、3種類のお風呂と3種類のサウナ (高温、中温、ミスト)、露天風呂があって、1つずつはそんなに特筆するものはないものの、いろいろ入ってみて楽しめたのでよかったと思う。すべての温泉に付属しているかは確認していないが、私が入った4つの温泉はどこも隣に足湯があって憩いの場になっていた。</p><figure><img src=/diary/img/2022/0605_footspa1.jpg></figure><p>温泉に入ってから定番のコーヒーを飲み、宿の管理人さんに紹介してもらった居酒屋 <a href=https://tabelog.com/hyogo/A2808/A280801/28017042/>ふくとみ</a> さんに行ってきた。3人で適当に見繕ってくださいという適当なオーダーでおでんとお刺身を頼んで十分な量が出てきたのでよかった。他にもおすすめはいくつかあったけれど、食べきれないので何度か通うようなお店みたい。</p><figure><img src=/diary/img/2022/0603_food2.jpg></figure><h2 id=就寝前>就寝前</h2><p>22時前には宿に戻ってきて今日の出来事をまとめていた。座椅子で低足の机に向かってラップトップを使うのは腰にくるというのを数時間で悟って、私はタイニングテーブルと椅子で作業することにした。翌日の旅程のチェックや補足事項の調査、細々したことをやっていた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0602/>draw.io で描いたインフラ構成図</a></h1><div class=post-meta><span class=post-date>2022-06-02 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/diagram/>diagram</a>&nbsp;
#<a href=/diary/tags/vscode/>vscode</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#drawio-を描いてみた>draw.io を描いてみた</a></li></ul></nav></div><div class=post-content><p>0時に寝て4時に起きて7時までだらだらしてた。なんか調子悪い。</p><h2 id=drawio-を描いてみた>draw.io を描いてみた</h2><p>先日、<a href=/diary/posts/2022/0523/>draw.io で aws 構成図を描く調査</a> をした。割り込みの作業をやっていてシステム構成図の作成を先延ばししていた。だいたいの調査は終わっていたのであとは根を詰めて描くだけ。次のサンプル構成図をみながら同じように描いていく。</p><ul><li><a href=https://aws.amazon.com/jp/builders-flash/202204/way-to-draw-architecture/>AWS のアーキテクチャ図を描きたい ! でもどうすれば良いの ?</a></li></ul><p>2つの環境があって、そのうちの1つを作成した。新規構築した環境でスクラッチから描いたものの、インフラリソースの構成要素が少なかったのでサンプル構成図を参考にしながらすぐに描けた。半角スペースで文字位置を調整したりすると、github 上で svg 表示したときに文字の位置がずれたりするのでそういうやり方はダメだとわかった。あと draw.io の振る舞いなのか、vscode のプラグインのせいなのかわからないけど、オブジェクトの配置の前後関係をうまく調整できなくてコピペし直したり、なにかの操作をしたタイミングでインフラリソースのアイコンが後ろに隠蔽されていたりもした。リソース間の接続のための線も自動的に繋がるときもあって便利なのだが、誤動作して変な位置にレイアウトされることもあって制御が難しい。私の感覚では、多少の利便性のために自動化されるよりも、自分で思い通りに制御出来る方を好む。draw.io の自動調整機能の制御が難しいなと思った。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0601/>手抜き</a></h1><div class=post-meta><span class=post-date>2022-06-01 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/scrum/>scrum</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#mvpminimum-viable-productで対応した>mvp（minimum viable product）で対応した</a></li></ul></nav></div><div class=post-content><p>2時に寝て6時に起きた。疲れていたからよく眠れた。</p><h2 id=mvpminimum-viable-productで対応した>mvp（minimum viable product）で対応した</h2><p>スクラムに限った話しではないと思うが、プロダクト開発をしていると mvp（minimum viable product）という言葉を聞くことがままある。昔ながらのイテレーション開発よりも、アジャイル開発の文脈でよく使われるように思う。というのは、短い開発期間でプロトタイプを作ったり、最低限の動く機能を作ったりすることをよしとする考え方があるから。昔ながらのやり方だと、イテレーション期間の中でそういった段階的な開発はするものの、外部からみたとき (もしくはマイルストーン) においてはそこそこの機能が提供されているので mvp といった言い方をすることはなかった。もしかしたらアルファとかベータとか呼んでいたかもしれない。最近ある lambda 関数の移行作業を行った。serverless framework でデプロイしていたリソースを cdk で一元管理する。その過程で既存のコードを読むと、ある id をハードコーディングで指定して <em>FIXME</em> がこんな感じに書いてあった。この id が指すリソースはその後なくなっており、本番環境で不要な処理が定期実行でずっと動き続けていたのと、本来は複数の id リソースに対して行うべき処理を実行していなかった。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e># FIXME 対象 id 一覧を取得する。(Phase2までに対応します)</span>
</span></span><span style=display:flex><span>id <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;ABC001&#39;</span>
</span></span></code></pre></div><p>チームの開発リーダーはその存在を全く忘れていたし、このスクリプトを実装したさらに上位の開発リーダーからはこの処理の要否はよくわからないからチームで確認してという曖昧な返事が返ってきた。チームで確認したところ、この処理は必要だとわかり、この機に複数の id リソースに対して対応するようにした。何も知らない私が修正しても5分で対応を完了した。</p><blockquote><p>mvp で対応したんで</p></blockquote><p>このように実装者は話していたが、本当なのだろうか？と思えた。さらにこのスクリプトのエラーログのログストリームを監視して slack 通知する lambda 関数も移行対象で、コードの検証をしていたところ、slack 通知をするための lambda 関数が別途あり、その動作検証をしていたところ、その lambda 関数を呼び出す権限 <em>lambda:InvokeFunction</em> が足りないことに気付いた。これも実装者に問い合わせたところ、動作検証はやっていないし、過去に1度も slack 通知は発生していないという。状況証拠から考えると、権限が足りないために正常に動作していなかったと推測される。結果的に mvp で対応したという2つの lambda 関数は実運用で半年間、無駄にリソースを浪費して何の役にも立っていなかった。当然、引き継ぎも、課題管理システムのチケットも、ドキュメントも何ら残されていなかった。mvp で対応したという表現に開発で大事なものを誤魔化してはいないだろうか。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0531/>締め切りの45分前</a></h1><div class=post-meta><span class=post-date>2022-05-31 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#法人決算の間違い>法人決算の間違い</a></li></ul></nav></div><div class=post-content><p>0時に寝て4時に起きて7時に起きた。最近は4時に一回起きることも多くなってきた。ちょっとゲームしていつの間にか、寝たりもするけど。</p><h2 id=法人決算の間違い>法人決算の間違い</h2><p>5月の最終日なのでお昼休みに社会保険の引き落としの明細を手動で入力していた。ufj 銀行 (法人口座) の api 連携は有償サービスで、主に社会保険や経営セーフティ共済の引き落としにしか使っていないのでうちの会社は有償サービスを使っていない。通帳もしくは当日残高の明細をみて、それを手入力で freee の口座に登録する。そこで稀に利息がつくというのを失念していた。2月の利息15円の明細登録が漏れていることに気付いた。freee には登録残高という自動計算された口座残高をもっているので、それと明細の残高を見比べれば気付けるようになっているのだけど、たった15円の差異だったのでこれまで私が見落としていた。</p><p>法人決算の確定申告をすでに終えているのに15円の受取利息が漏れていることに気付いてしまった。ひとまず税務署に電話してどうしたらいいかを相談した。今日中に訂正するなら上書き更新、明日以降なら修正申告と言われた。所得や税引き前純利益の金額に15円の差異があり、3つか4つぐらいの帳票の項目の値が変わる。法人税の金額計算には影響しない。欠損金の繰り戻し還付の申請でも15円の違いから2円の差額になった。銀行の受け取り利息の消費税は非課税なので消費税の申告には影響しない。</p><p>e-tax で送信したデータをコピーして、元データがある状態で誤り箇所を修正して再送信するのはすぐできて30分ぐらいで訂正送信できた。電子申告の良さを実感した。紙だとこうはいかなかったかもしれない。財務諸表は紙で提出しないといけないので、e-tax の修正送信後に慌てて税務署へ行って再提出してきた。それが16時15分。法人決算締め切りの45分前。オフィスから税務署まで自転車で5分の距離だから間に合った。思いの他、最終日に落とし穴にはまったものの、ちゃちゃっと訂正できたので行政の事務手続きスキルは上がってきたなと自信ももてた。こんな失敗をしておけば今後は登録残高と明細残高のチェックも忘れることはないだろう。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0530/>aws サービスと ipv6</a></h1><div class=post-meta><span class=post-date>2022-05-30 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/cdk/>cdk</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#cloudfront-と-waf-と-s3-と-ipv6-と>cloudfront と waf と s3 と ipv6 と</a></li></ul></nav></div><div class=post-content><p>0時に寝て6時頃に起きて7時半に起きた。</p><h2 id=cloudfront-と-waf-と-s3-と-ipv6-と>cloudfront と waf と s3 と ipv6 と</h2><p>aws サービスについて ipv6 について調べると、少しずつ対応してきた経緯があって、ipv4 と ipv6 の両対応のことを aws は dualstack と読んでいる。エンドポイントのサブドメインに dualstack があれば、ipv6 対応していると考えてよいと思う。リモートワークしている開発者がテスト環境に接続するときに、その開発者の IP アドレスを登録する aws lambda 関数がある。その lambda 関数にリクスとすると、リクエストしたクライアントの IP アドレスを waf の IP sets に登録することで、パケットフィルタリングのルールを更新している。たまたま、そのインフラを cdk 移行したところ、ある開発者は ipv6 で登録しようとしてエラーになるということがわかった。移行のときに api gateway を使わずに直接 lambda の fuction url を使うようにしたところ、lambda は ipv6 対応しているのでそのまま ipv6 の IP アドレスを登録しようとして waf の設定が ipv4 しか対応していなかったためにエラーになっていた。</p><ul><li><a href=https://aws.amazon.com/jp/about-aws/whats-new/2021/12/aws-lambda-ipv6-endpoints-inbound-connections/>AWS Lambda がインバウンド接続用のインターネットプロトコルバージョン 6 (IPv6) エンドポイントのサポートを開始</a></li></ul><p>cloudfront, waf, s3 の ipv6 対応は2016年頃に対応していて、この3つのサービスに対して一緒にブログ記事を書いているのは、これらのサービスを一緒に使うことを想定しているとみなすべきだろう。</p><ul><li><a href=https://aws.amazon.com/jp/blogs/news/ipv6-support-update-cloudfront-waf-and-s3-transfer-acceleration/>IPv6 サポートの更新 – CloudFront、WAF、S3 Transfer Acceleration</a></li></ul><p>cdk のコードで cloudfront, waf は ipv6 対応したのだけど、cloudfront のオリジンに当たる s3 の ipv6 対応を cdk からどうやって設定していいかわからなかった。<a href=https://github.com/aws/aws-cdk/tree/master/packages/%40aws-cdk/aws-cloudfront-origins>aws-cloudfront-origins</a> の <code>S3Origin</code> のコードを読むと、どうも s3 の ipv6 対応のエンドポイント (dualstack) を考慮して制御しているようにはみえない。バグではないけど、設定方法がわからないので feature request として issue 登録してみた。aws-cdk に issue 登録するのは初めて。余談だけど、<a href=https://github.com/aws/aws-cdk/tree/master/.github/ISSUE_TEMPLATE>ISSUE_TEMPLATE</a> もよく出来ていて、これを参考にして自分たちのリポジトリにも取り入れてもよさそう。</p><ul><li><a href=https://github.com/aws/aws-cdk/issues/20550>(aws-cloudfront-origins): Support dualstack domain name (ipv6) for S3 origin #20550</a></li></ul></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/73/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/page/75/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>