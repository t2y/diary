<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.109.0"><title>forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="forest nook"><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1002/>テーマスタイルのカスタマイズ</a></h1><div class=post-meta><span class=post-date>2021-10-02 (Sat.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#ストレッチ>ストレッチ</a></li><li><a href=#価値観を育てる>価値観を育てる</a></li><li><a href=#hugoterminalのカスタマイズ>Hugo/Terminalのカスタマイズ</a></li></ul></nav></div><div class=post-content><p>昨日の夜は早めに仕事を終えて <a href=https://opt.connpass.com/event/222709/>第一回関数型プログラミング（仮）の会</a> の、やましたさんとみずしまさんの発表の2つだけ聞いて、疲れてそのまま帰ってゆっくりしてた。ドラクエタクトの新しいイベントやってたかな。あと今秋初めて買った梨を食べてた。たぶん0時ぐらいには寝て8時ぐらいに起きた。</p><p><a href=https://www.ytv.co.jp/asapara/>あさパラS</a> は総裁選の振り返りや役員人事の解説やっててほむほむと見てた。河野さんが官僚に嫌われる要因の1つとしてちょっと前にパワハラ音声が流出してたけど、言葉遣いがきついのに加え、正論をきつく言うから官僚の逃げ道をなくして追い詰めてしまうといったことが話されてた。心理的安全性の文脈で、お互いに信頼関係が築けた上で厳しいことを指摘するのは構わない (言い方は配慮すべき) が、そうじゃないと相手を追い詰めてしまう。過去に私も不誠実な相手に対して正論を言って追い詰めがちだったのでいまは反省している。目的は課題を解決することであって、相手を追い詰めても目的を果たせないということがようやく経験から理解できるようになってきた。</p><h2 id=ストレッチ>ストレッチ</h2><p>毎週土曜日は <a href=https://doctorstretch.com/>Dr.stretch</a> さんでストレッチしてる。開脚の幅が目標 (メトリクス) になっていて毎週測っている。目標は自分の身長と同じぐらいということで178cm。ストレッチの開始前に測って、ストレッチを受けてから再計測する。今日は開始前169cm、ストレッチ後171cmと初めて170cmの大台に到達した。このままうまくいけば、あと3-6ヶ月ぐらいあれば目標の身長と同じぐらいの開脚幅になるかもしれない。家でも毎日ではないけど、2日に1回ぐらいのペースでストレッチをするのが習慣になりつつある。いまジョギングをすると腰に負担がくるんやけど、トレーナーさんが言うには、開脚幅が広がると股関節の可動域があがって腰の負担も減るという。本来、腰の筋肉は動かない方の筋肉だが、股関節の可動域が小さいとそれを補うために腰の筋肉が動いてしまい、その結果として腰に負担がかかる。なので、股関節が本来の意図した動きをしていれば、自然に腰の負担も下がるという理屈らしい。</p><h2 id=価値観を育てる>価値観を育てる</h2><p>あんちぽさんのスライドを眺めて共感してた。日記を書き始めたのも <a href=https://kentarokuribayashi.com/>あんちぽさんの日記</a> を読んでて、毎日やっていることを「書くこと」は何かしら意味や意義があるんじゃないかと思うようになったから。</p><iframe class=speakerdeck-iframe frameborder=0 src=https://speakerdeck.com/player/422f05833bc64c1a978c1ba92020a249 title="自分の人生を生きる - 遊びで生きて価値観を育てよう / Live Your Own Life - Live for Fun and Develop Your Values" allowfullscreen mozallowfullscreen=true webkitallowfullscreen=true style="border:0;background:padding-box padding-box rgba(0,0,0,.1);margin:0;padding:0;border-radius:6px;box-shadow:rgba(0,0,0,.2)0 5px 40px;width:560px;height:314px"></iframe><p>歳を経て難しく感じるようになったことの1つに <strong>動機づけ (モチベーションコントロール)</strong> がある。</p><p>私は基本的に忙しいという言葉を使わない。やらないといけないことの何かが進捗していないとき、それは「やる気がない」と受け止めている。もちろん相手がいるときにやる気がないとそのまま表現すると横柄だったり失礼だったりすることもあるので余裕がないと答える場合もある。しかし、本質的にはやる気がないが正しい。もう少し補足すると、いまやっていることの方が自分にとって優先度が高く (やる気があり)、それ以外の別のことを先送りしているだけだと捉えている。もし別のことにやる気があるならば、いまやっていることを後回しにすればいいだけだからだ。</p><p>ここで、何をやってもいいとしたら、何をやりたいかという課題が出てくる。適当にあれこれやってみても、実際にやってみるとうまくいかなくて、やる気が持続しなかったりすることがある。多くのケースで、若い頃ほどなにかに夢中になってやっていた経験が誰しもあると思うが、あのときはなぜそんなに夢中になってできたのか。いま思い返しながら、自分にとっての動機づけの源泉を探るようなことをしていかないとわからないのだ。まったく自分のことなのに。2021年に入ってからそういったことを考え続けていたところ、このスライドを眺めてたら動機よりも価値観なんだよと書いてあって、私がこの9ヶ月間、掘り返し続けてた動機づけの源泉=価値観という考え方はしっくりきて、価値観がブレると動機づけもうまくいかないなと思えた。</p><h2 id=hugoterminalのカスタマイズ>Hugo/Terminalのカスタマイズ</h2><p>Speaker Deck のスライドの埋め込みができなくて調べた。<a href=https://chizuchizu.com/blog/tag_hugo/>HUGOで埋め込みができない時の対処法</a> によると、<code>config.toml</code> に次の設定を追加すると表示された。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>markup</span>]
</span></span><span style=display:flex><span>  [<span style=color:#a6e22e>markup</span>.<span style=color:#a6e22e>goldmark</span>]
</span></span><span style=display:flex><span>    [<span style=color:#a6e22e>markup</span>.<span style=color:#a6e22e>goldmark</span>.<span style=color:#a6e22e>renderer</span>]
</span></span><span style=display:flex><span>      <span style=color:#a6e22e>unsafe</span> = <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><p>Terminal のテーマだと本文と引用の違いわかりにくかったのでスタイルを変えてみた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span><span style=color:#f92672>blockquote</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>background</span>: <span style=color:#ae81ff>#eafff4</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>color</span>: <span style=color:#ae81ff>#2d3330</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-style</span>: <span style=color:#66d9ef>italic</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><p>変更前</p><figure><img src=/diary/img/2021/1002_blockquote-before.png></figure></li><li><p>変更後</p><figure><img src=/diary/img/2021/1002_blockquote-after.png></figure></li></ul><p>日付の表記を少し大きくして目立つようにした。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#a6e22e>post-date</span> {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-weight</span>: <span style=color:#66d9ef>bold</span>;
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>font-size</span>: <span style=color:#ae81ff>1.3</span><span style=color:#66d9ef>rem</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1001/>インボイス制度への準備</a></h1><div class=post-meta><span class=post-date>2021-10-01 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/gig/>gig</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#インボイス制度の準備>インボイス制度の準備</a></li><li><a href=#terminal-のカスタマイズ>Terminal のカスタマイズ</a></li><li><a href=#joel-on-software>Joel on Software</a></li><li><a href=#カジュアル面談>カジュアル面談</a></li></ul></nav></div><div class=post-content><p>夜はドラクエタクトやってて2時過ぎに寝て7時に起きた。気のせいか、日記を書くようになってから早く寝付けるようになった。まつのさんが twitter で久しぶりに Python 書いたとツィートしていて、何気なくふと <a href=https://github.com/line/line-bot-sdk-python/pull/340>Implement experimental asyncio support #101 #340</a> をみて、そのツールの関係者でもないのに勝手にクソリプ的なレビューコメントをした。気付いてしまったらみなかった振りするのも気持ち悪いので。</p><h2 id=インボイス制度の準備>インボイス制度の準備</h2><p>2023年10月1日から <a href=https://www.nta.go.jp/taxes/shiraberu/zeimokubetsu/shohi/keigenzeiritsu/index.htm>消費税の軽減税率制度・適格請求書等保存方式（いわゆるインボイス制度）</a> が開始される。開始される前に適格請求書発行事業者に登録しておく必要があり、その登録受付が今日から開始された。前に知人が教えてもらった解説動画を見返した。</p><div class=video-container><iframe src=https://www.youtube.com/embed/E0lOsLfj1T0 allowfullscreen title=消費税インボイス方式対策として今からやっておくべき３つのことをお話します。【簡易課税で税負担1/2に！？】></iframe></div><p>ちなみにうちの会社は今期から課税事業者になるのでインボイス制度開始による益税の影響は受けない。前期の決算で消費税を算出したとき、本則課税と簡易課税なら後者の方が46%の納税金額が少なくなることがわかった。IT 業界は経費に占める人件費の割合が大きい (人件費は消費税がかからない) ので簡易課税の方が節税になるのではないかという気がする。そのため、簡易課税で申請している。一度、申請すると2年間適用され、不適用届出を出さない限りはずっと簡易課税で継続される。</p><p>国税庁の <a href=https://www.nta.go.jp/taxes/shiraberu/zeimokubetsu/shohi/keigenzeiritsu/invoice_shinei.htm>申請手続</a> をみながら￼e-Tax (WEB 版) で申請した。</p><p>個人で副業を受けることを想定すると、個人でも適格請求書発行事業者に登録した方がよいのだけど、私の場合、自分の会社なので法人で仕事を受けるのと個人で仕事を受けることの違いって何だろう？とわからなくなった。法人税と個人の所得税の税率の違いの話しは一旦置いておいて、最も大きな違いは会社で仕事を受けても(直近の)給与は増えないのでその報酬を自由には使えない。個人で仕事を受けたらその報酬を自由に使えるぐらいかな？もうちょっとその違いを調べ直してから考えよう。先の youtube 動画の中で税理士さんが「免税事業者という制度をやめたらいいのに。。。」と言ってたけど、個人はどうしよう？と悩んでしまう本質は免税事業者という概念があるからというのは正しいと思う。</p><h2 id=terminal-のカスタマイズ>Terminal のカスタマイズ</h2><p>hugo の Shortcodes で <code>class</code> で任意の CSS クラスを指定できる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>{{&lt; <span style=color:#f92672>youtube</span> <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;E0lOsLfj1T0&#34;</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;video-container&#34;</span> &gt;}}
</span></span></code></pre></div><p><code>static/style.css</code> をカスタムの CSS として読み込んでくれる。youtube のビデオサイズをよしなに調整するために次のスタイルを定義した。なかなか難しい。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=display:flex><span>.<span style=color:#a6e22e>video-container</span> <span style=color:#f92672>iframe</span> {
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>border</span>:<span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>max-width</span>: <span style=color:#ae81ff>600</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>max-height</span>: <span style=color:#ae81ff>338</span><span style=color:#66d9ef>px</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>50</span><span style=color:#66d9ef>vh</span>;
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=joel-on-software>Joel on Software</h2><p>読み終えた。ソフトウェアの本で test of time (時の試練？) に耐えるのは相当に難しい。本書だとマネジメントや教育、ビジネスや経営に関する内容はいまでも有効でおもしろかった。また後日ブログに書評を書く。いまとなっては手放しでお勧めできる本ではないため、どういう切り口で書くかが難しい。自分にとって学びとして身につけたいと思った本はなるべく書評を書いて自分の言葉で説明できるようになっていきたい。</p><h2 id=カジュアル面談>カジュアル面談</h2><p>プロジェクトマネージャーを募集している会社の CTO と面談。先方の時間が15分しかないという話しだったので事前に質問は連絡しつつ、バックエンドは Go 言語を使っているという話しだったので私が過去に書いたブログ記事やちょっと前に作った <a href=https://github.com/kazamori/go-sql-executor>go-sql-executor</a> を連絡して、技術選考の参考にしてほしいと伝えた。募集要項からスクラムを採用するように読めたのでその背景を聞いたところ、外部の技術顧問が推奨しただけでとくにこだわりはないという。いまもメンバーは8人いて1週間のスプリントでスクラムっぽい運用はしているとのこと。私の言う、課題管理とイテレーション開発の概要を軽く説明しつつ、それを実践するためにプロジェクトマネージャーをやりたくて、その実践の場を探しているといった話しをした。外部の技術顧問が欠席したせいか、Go 言語の開発に関する質問はとくになかった。メンバーはすべて業務委託という話しなので寄せ集めグループのドタバタプロジェクトなんだろうなという印象を受けた。心理的安全性や一体化マネジメント法とか勉強したんで <em>グループ</em> じゃなくて <em>チーム</em> 開発できるマネジメントがやりたいなぁ。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0930/>窓のある部屋</a></h1><div class=post-meta><span class=post-date>2021-09-30 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/gig/>gig</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#カジュアル面談準備>カジュアル面談準備</a></li><li><a href=#joel-on-software>Joel on Software</a></li></ul></nav></div><div class=post-content><p>夜は自民党総裁選の総括の記事を読んでた。政治に関心があるわけではないが、選挙後の総括にはとても関心がある。とくに負けた人がどんなことを言うのか、敗因をどう分析するのか。シンゴジラで矢口の発した <em>「政界は敵か味方しかいない。シンプルだ。性に合ってる」</em> という言葉が好き。選挙というわかりやすい勝ち負けが明確に出る仕組みは確かにシンプルだ。その後、3時まで本を読んで寝て7時ぐらいに起きた。</p><h2 id=カジュアル面談準備>カジュアル面談準備</h2><p>課題管理と開発方法論の体系化のため、プロジェクトマネージャーの案件を探している。<a href=https://remogu.jp/>Remogu</a> というリモートワークxエンジニア専門のサイトでギグワークできないかを検討中。ある会社を提案されたのでその会社のサイトとサービス内容を調べてた。飲食業界向けに提供しているサービスを、これまではアウトソースで開発していたシステムを内製化するために開発者を募集しているようだった。いま風に言えば、DX の1つと言えるだろう。これから内製の開発チームを作っていくとのこと。言うても CTO (PMO) 以外はすべて業務委託で集めるとのこと。デメリットはチームにならず、寄せ集めの集団になってしまう懸念がある一方、メリットとして採用したものの、マッチングしなかったメンバーの契約更新しないことで入れ替えることができる。明日、その会社の人たちとカジュアル面談をして双方のマッチングをみてみる。</p><h2 id=joel-on-software>Joel on Software</h2><p>昨日の続き。夜に読み切ろうと思っていたけど、ドラクエタクトの新しいイベントがリリースされて、それやってたら疲れて寝てしまった。あともうちょと。特定の技術に言及している内容は2000年代半ばの話しなのでいまとなっては有効ではないものや歴史書のように読めたりもする。中盤からソフトウェアビジネスやソフトウェア会社の運営などが書いてあって、マイクロ法人を始めたばかりの私にとっては興味深い。例えば、オフィスの要件は次の内容をあげている。</p><ol><li>1人1人にちゃんとドアの付いた個室があること、絶対条件</li><li>コンセントがたくさん必要、新しいおもちゃを机の上でつなげられる</li><li>データケーブルを簡単につなぎ直せる</li><li>ペアプログラミングが可能であること (L字型の大きい机を用意する)</li><li>遠くのものを眺めて目を休められるよう窓を設け、ディスプレイを壁に向かって置いてはいけない</li><li>オフィスはそこで時を過ごすのが快適なたまり場のような場所であるべき</li></ol><p>その上で、会社の成功は、ある部分までプログラマーが実質オフィスに暮らすようになるかどうかにかかっているので、オフィスが平均的なプログラマーの家よりも素敵な場所である必要があると述べている。実際、私は過去に働いた6社すべてで泊まり込みで働いたこともあるのでまさに暮らすように働いていた時期もあったかもしれない。机に伏して寝たり椅子を並べて寝るよりは、ソファやくつろぎスペースで寝る方が快適だった。あと、いまのオフィスの唯一の欠点は窓がないことだと1年ほど働いて、ちょうど私も実感していた。窓がないと1日の天候の移り変わりや季節の移り変わりがみえなくて気分転換ができないのだ。次にオフィスを引っ越すときは窓がある部屋を条件に加えようとまさに考えていた。</p><p>あと自分にとっての課題管理の原点をみつけた。過去に働いていた会社で、課題管理システムに顧客からの問い合わせや開発者のTODOやシステム管理のメモなど、すべての情報を入れられていた。こういった課題管理システムの使い方は次の記事に影響を受けて実践されたものだったと当時の上司に確認した。たったこれだけの話なんだけど、私にとっては原点なので宝ものを発見したかのような嬉しい気持ちになった。</p><ul><li><a href=https://www.joelonsoftware.com/2006/12/20/half-a-million-bugs/>Half a million bugs!</a></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0929/>読書とイベント参加</a></h1><div class=post-meta><span class=post-date>2021-09-29 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/java/>java</a>&nbsp;</span>
<img src=/diary/img/2021/0929_temperature.jpg class=post-cover alt=読書とイベント参加><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#joel-on-software>Joel on Software</a></li><li><a href=#java-17-リリースイベント>Java 17 リリースイベント</a></li></ul></nav></div><div class=post-content><p>0時頃に寝て8時ぐらいに起きる。やや発熱して疲れてたせいか、久しぶりに早く寝付けた。一日を通して体温は平均36.7℃なのでもう副反応は過ぎたみたい。体調もまったく悪くない。</p><h2 id=joel-on-software>Joel on Software</h2><p>過去に働いていた会社での課題管理のやり方や開発方法論について、当時の上司と雑談したところ <a href=https://en.wikipedia.org/wiki/Joel_Spolsky>Joel Spolsky</a> に由来するということを聞いた。そこで今更ながらに <a href=https://www.shoeisha.co.jp/book/detail/9784798118925>More Joel on Software</a> を読むことにした。2000年代に書かれた記事の内容なのでいまとなっては古典に分類される本かもしれない。だいたい半分ぐらい読んだ。技術の詳細に言及した内容は古くなっていてあまり有用ではないものも多いけど、マネジメントや優秀なプログラマーの特性などはいまでも通用する内容に思えた。あとで私が関心をもった内容をブログでまとめることにする。</p><p>第10章コンピュータサイエンスの学生へのアドバイスで「卒業するまでにミクロ経済学を学ぶこと」という節がある。著者がミクロ経済学を推奨する理由を引用するとこれら。</p><blockquote><p>ミクロ経済学はビジネスで重要な理論すべての基礎となっている。需要と供給とか、競争優位とか、NPV とか割り引きとか限界効能について知らなければ、ビジネスの仕組みが全然理解できないからだ。</p><p>マクロ経済学は、当たっているよりもはずれていることの方が多い。スキップしてよい。それ以降はただ悪くなっていく一方。</p><p>ビジネスの基礎を理解しているプログラマは、理解していないプログラマよりもビジネスにおいてずっと価値が高いからだ。</p></blockquote><p>学んだことがなかったので簡単そうな <a href=https://www.iwanami.co.jp/book/b285381.html>ミクロ経済学入門の入門</a> を購入した。</p><p>読んでて気づきを得てふとツィートした。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>なので、システムのコンポーネントに関しての意思決定をするとき、必ずしも上位の意思決定者の判断が正しいわけではなく、現場のメンバーに判断を委ねる状況が最適な場合もある。一方向じゃなく、双方向の情報の非対称性を解消する取り組みが大事。</p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1443024587944464388?ref_src=twsrc%5Etfw">September 29, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=java-17-リリースイベント>Java 17 リリースイベント</h2><p><a href=https://jjug.doorkeeper.jp/events/127204>【オンライン】 JJUGナイトセミナー「Java 17 リリース記念イベント with Foojay」9/29(水) 開催</a> に参加した。Java の LTS はいま過渡期でややこしいことになって、8, 11, 17 になる。リリースされたばかりの Java 17 は LTS で重要なバージョンになる。<a href=https://www.oracle.com/jp/java/technologies/java-se-support-roadmap.html>Oracle Java SE Supportロードマップ</a> から Premier Support 期限が次になる。</p><ul><li>8: 2022年3月</li><li>11: 2023年9月</li><li>17: 2026年9月</li></ul><p>いま 11 を使っている組織はいいが、8 を使っている組織もまだまだ多いと推測する。8 と 11 の Premier Support 期限が近いことから 8 を使っている組織は 17 に一気にバージョンアップすることが想定される。どこかのタイミングで Java 17 を前提した開発に切り替わっていくだろうと思われる。</p><p>最初の発表は Pattern Matching & Sealed Classes に特化した内容。これまでは instanceof と共に使う機能だった。switch 構文とパターンマッチングを組み合わせると、コードが簡潔になって <a href=https://en.wikipedia.org/wiki/Cognitive_complexity>Cognitive complexity</a> を下げるという。発表者が Type Guard という呼び方をしていた。Type Guard をググると TypeScript の記事がヒットする。<a href=https://openjdk.java.net/jeps/406>JEP 406: Pattern Matching for switch (Preview)</a> ではこれを <em>guarded pattern</em> と呼んでいる。まだあまり一般的な用語ではないのかもしれない。あとは Sealed クラスと組み合わせた switch 構文のコード例では、すべてのパターンが網羅されていることをコンパイラが検出して <em>default</em> 句が不要になるコード例も紹介されててよさそうにみえた。但し、switch 構文のパターンマッチングは preview なので実際には 17 ではまだ使われないのかもしれない。今後もさらに switch 構文とパターンマッチングの機能拡張が行われる展望らしい。</p><p>2番目の発表は Java 17 の全体的な話し。fix した issues のツリーマップで contributor の分布を紹介していた。oracle, redhat, independent の順番に多い。oracle が過半数以上。日本だと ntt data が一番貢献してた。spring フレームワークの次期バージョンは Java 17 がベースラインになる。java のアップグレードを促す要因の1つにはなるはず。lts なのになぜ preview や incubator があるのか？openjdk 開発側は6ヶ月というリリースサイクルを守っている。lts にするか否かは開発者が決めているらしい。graalvm のリリースサイクルは java とは異なる。こちらは年3回のリリースなので次のリリースで出てくるはず？いくつか jep の内容を紹介してた。jep の概要は <a href=https://qiita.com/ReiTsukikazu/items/407d61cb66fa4f562bf9>Java17の新機能をざっくり紹介</a> にまとまっている。さくらばさんがパッケージの api レベルでの変更を <a href=http://www.javainthebox.com/2021/09/jepjava-17.html>JEPでは語れないJava 17</a> にまとめている。ざっと目を通して興味があるものがあればみとくぐらい。8 から 17 への移行の記事やドキュメントなども紹介されてた。移行について基本は <a href=https://docs.oracle.com/en/java/javase/17/migrate/getting-started.html>Oracle JDK Migration Guide</a> を読めとのこと。8 から 17 の移行せずにその次の 23 を待つと作り直しになってしまいますよと 17 への移行を推奨してた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0928/>副反応はいずこ？</a></h1><div class=post-meta><span class=post-date>2021-09-28 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/halp/>halp</a>&nbsp;</span>
<img src=/diary/img/2021/0928_pocarisweat-s.jpg class=post-cover alt=副反応はいずこ？><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#水分補給>水分補給</a></li><li><a href=#日記サイト構築>日記サイト構築</a></li><li><a href=#ジャーナリングとは>ジャーナリングとは</a></li><li><a href=#atlassian-community-online-meetup-の参加>Atlassian Community Online MeetUp の参加</a></li></ul></nav></div><div class=post-content><p>2時過ぎぐらいに寝て5時前ぐらいに起きる。やや熱っぽいかなぁぐらいの印象でもう一度寝る。8時前に起きるともう平気になってた。昨日、書籍や macbook を持って帰ってきて引きこもり対策してたけど、体調が悪くないのでオフィスへ行くことにした。お昼から1時間おきに熱を測ってみたら37℃前後なので少し熱は出ていたみたい。とくにしんどくなかったので普通にお仕事してた。</p><h2 id=水分補給>水分補給</h2><p>副反応対策として、ポカリスエットイオンウォーターの粉末をウォーターサーバーの水に混ぜて飲んでみる。イオンウォーターと普通の <a href=https://www.otsuka.co.jp/faq/ionwater/01.html>ポカリスエットとの違いは何ですか？</a> によると、基本的な成分は同じで低カロリーという違いがあるらしい。</p><h2 id=日記サイト構築>日記サイト構築</h2><p><a href=https://github.com/t2y/diary>diary</a> リポジトリに push すると GitHub Actions で静的サイトをビルドして GitHub Pages で扱うための gh-pages ブランチに push される。<a href=https://qiita.com/peaceiris/items/d401f2e5724fdcb0759d>GitHub Actions による GitHub Pages への自動デプロイ</a> を参考にした。gh-pages ブランチにあるものが次の URL で参照される。リポジトリ名の <code>diary</code> がパスになるらしい。</p><ul><li><a href=https://t2y.github.io/diary/>https://t2y.github.io/diary/</a></li></ul><p>まだ設定は不完全だけど、運用しながらおいおい設定を詰めていく。<a href=https://gohugo.io/>Hugo</a> は会社のホームページにも使っているので慣れているのと、使い心地も気に入っているのでこのまま使い続ける。会社のサイトはたまにしか更新しないので日記を書く方が更新頻度があがって Hugo を触るインセンティブになるかもしれない。</p><h2 id=ジャーナリングとは>ジャーナリングとは</h2><p>読みかけで放置していた <a href=https://bunkyosha.com/books/9784866510149>「手で書くこと」が知性を引き出す 心を整え、思考を解き放つ新習慣「ジャーナリング」入門</a> を読み終えた。この日記も簡易的なジャーナリングになればよいと願っていたりする。「書くこと」への期待値を高くもって読み進めたせいか、内容が薄かったように思えた。ジャーナリングを行うテーマのワークシートが24個ついていて、ページ数を稼いでいるように感じた。日常生活であまり書いていない人には関心をそそるかもしれないけど、プログラマーは日常生活で平均以上の文字数を書いていると推測する。私にとってはあまり目新しいことはなかった。</p><p>マインドフルネス (気づき) を得るための方法論の1つとして書く瞑想=<strong>ジャーナリング</strong>を推奨している。手書きとキーボードのタイピングでは効果が異なるという研究成果はおもしろかった。手書きの方が記憶力や理解力を高める、脳波はアルファ波が出るといった研究があるという。従って、より創造的な仕事に向くかもしれない。ジャーナリングの研究によって、わかってきたことの1つは、自己や他者、社会への適応力を高めると示唆されている。ここでいう「適応力が高まる」というのは、課題や問題をどうとらえ、これからどう行動すればよいかのヒントにつながる可能性があるという意図らしい。ジャーナリングは心身の健全性にもプラスの影響をもたらされる可能性が高いといった研究も紹介されている。私の感覚的にも、書くことで課題や問題を明確化することはストレスを軽減して健康になるような気がする。</p><blockquote><p>ジャーナリングをする際に大事なことは「考えない」 ということです。</p></blockquote><p>書く瞑想とも言われる所以にも思える。そのままの状態を観察して気づきとするような、そういう姿勢を説いている。この内容は業務の取り組みへの応用からは離れてしまう。</p><p>前に <a href=https://note.com/t2y1979/n/n4713058f48ce>メタ認知で〈学ぶ力〉を高める：認知心理学が解き明かす効果的学習法</a> の著者が <a href=https://www.jstage.jst.go.jp/article/jjet/37/Suppl./37_KJ00009957528/_article/-char/ja>タイピング思考法の開発とその有効性の検討</a> という研究発表をしていた。この研究は、思考過程を推測する手法として、発話思考法における問題を解決するタイピング思考法を提案し、既知の問題を解決しつつ、発想の促進効果もみられてそこそこよい結果が出たというものであった。思考過程を発話とタイピングの2つで比較している。比較項目に手書きがあると少し結果に差異が出たりしたのかなぁとか思った。</p><h2 id=atlassian-community-online-meetup-の参加>Atlassian Community Online MeetUp の参加</h2><p>課題管理システムとチャットツールを連携する <a href=https://halp.com/>Halp</a> というツールがあるらしい。うちは課題管理システムにクラウド jira を使っていて、Atlassian 社から届くメールで本イベントのことを知った。Atlassian Community Event の頭文字をとって ACE と呼ぶらしい。</p><ul><li><a href=https://ace.atlassian.com/events/details/atlassian-tokyo-presents-48-tokyo-atlassian-community-online-meetup-dian-pu-bizinesudenohuo-yong-shi-li-halphuo-yong-tipsxin-aceridafa-biao/>#48 Tokyo Atlassian Community Online MeetUp - 店舗ビジネスでの活用事例＆Halp活用Tips＆新ACEリーダー発表</a></li></ul><p>初めて ACE イベントに参加した。コミュニティ (ユーザー) 主体のイベントになるらしい。運営メンバーの中に前職での jira チームのリーダーが出ていてちょっとびっくりした。何度かやり取りしてお世話になった方だったのでこういうところでも活動しているんだと思ってさらに尊敬の念が深くなった。halp については、想像通り、非開発者向けに slack の操作だけで jira の課題管理システムと連携するためのサービスとしてよさそうだった。slack (halp) と jira は双方向にデータの同期ができる。いまのところ、halp の無料プランがないので試せてないけど、なにかの機会で一通り触ってみたいと思うサービスだった。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0927/>コロナワクチン2回目</a></h1><div class=post-meta><span class=post-date>2021-09-27 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/xr/>xr</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#horizon-workrooms>Horizon Workrooms</a></li><li><a href=#お昼>お昼</a></li><li><a href=#日記を書く環境を決める>日記を書く環境を決める</a></li><li><a href=#コロナワクチン2回目摂取>コロナワクチン2回目摂取</a></li><li><a href=#terminal-のカスタマイズ>Terminal のカスタマイズ</a></li></ul></nav></div><div class=post-content><p>土曜日は昼寝してたくさん寝たせいか、昨日はうまく寝れなかった。4時頃に <a href=https://bunkyosha.com/books/9784866510149>「手で書くこと」が知性を引き出す 心を整え、思考を解き放つ新習慣「ジャーナリング」入門</a> の序章と1章を読んだ。手で書くのとキーボードをタイピングするのでは前者の方が脳が活性化されるらしい。指先の細かい制御が脳に効果的なようだ。5時ぐらいから寝て8時前に起きる。</p><h2 id=horizon-workrooms>Horizon Workrooms</h2><p>Oculus Quest 2 を使って顧問の知人と workrooms を使って仕事の打ち合わせをやってみた。</p><ul><li><a href=https://www.oculus.com/workrooms/>https://www.oculus.com/workrooms/</a></li></ul><p>9時から1時間強ほど打ち合わせ。</p><p>macbook を Oculus リモートデスクトップで接続して、ホワイトボード (スクリーン) で共有しながらの会話をやってみた。所感としてはこんなところ。</p><ul><li>リモートデスクトップと画面共有<ul><li>目の前の画面を大きくできるのでホワイトボード (スクリーン) よりみやすい</li><li>眼の前の画面をみて説明すると、相手の顔が見えないので vr のメリットが半減する</li><li>半仮想モードで話しながらメモをとるのは可能ではあるが、現実でやるよりも難しいので効率が悪化する</li><li>パソコンの操作が現実よりも難しいので、操作しないインセンティブになりがち</li><li>リモートデスクトップで画面共有をしていたせいか、<br>フル充電した状態から1.5 時間ぐらいでバッテリーが少ない警告が出た</li></ul></li><li>ヘッドセットの位置調整がうまくいかないと画面の文字がぼやけたりする</li><li>ヘッドセットの固定がうまくいかないと、会議に集中できず、ストレスになる</li><li>1時間程度の会議であれば、とくに vr による疲れなどは気にならない</li></ul><p>打ち合わせ終わってから NeosVR をするために Linux マシンと Oculus Quest 2 を接続する方法を検討。</p><ul><li><a href=https://neosvrjp.memo.wiki/>https://neosvrjp.memo.wiki/</a></li></ul><p>Oculus Link アプリを PC にインストールする必要があるが、Windows 向けにしか提供されていない。wine で動かない、一通りツール類をインストールして試してみたつもりだけど、このエラーを解決できなかった。諦める。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wine --version
</span></span><span style=display:flex><span>wine-5.0 <span style=color:#f92672>(</span>Ubuntu 5.0-3ubuntu1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ wine ~/Downloads/OculusSetup.exe
</span></span><span style=display:flex><span>002a:err:mscoree:CLRRuntimeInfo_GetRuntimeHost Wine Mono is not installed
</span></span></code></pre></div><p>Windows マシンを買うにしても PCVR をするにはそこそこのスペックが必要になり、ざっと調べると10-20万円ぐらい。ノートPCでも15-16インチぐらいのを購入すればスペック的には大丈夫そうといった記事がいくつかみつかった。</p><ul><li><a href=https://vr-game.pw/blog/how-to-chooes-vr-pc/>https://vr-game.pw/blog/how-to-chooes-vr-pc/</a></li><li><a href=https://kimono-oyaji.com/laptoppc-for-hmd-01/>https://kimono-oyaji.com/laptoppc-for-hmd-01/</a></li></ul><p>このために Windows マシンを買ってまでやるほどのことでもないので PCVR は断念して普通に Linux マシンで NeosVR に挑戦することに決めた。</p><h2 id=お昼>お昼</h2><p>14時前ぐらいにお昼ご飯に出かけた。近所の居酒屋さんが緊急事態宣言の期間だけお弁当を販売している。いつもは13時頃には売り切れているのに、今日はたまたま14時なのに3個も残ってた。500円でおかずがいろいろ入っててコスパがいい。そのままお弁当を買ってオフィスで食べることにした。</p><h2 id=日記を書く環境を決める>日記を書く環境を決める</h2><p>この後、コロナワクチン2回目摂取があるので、副反応の発熱でいつ作業が中断してもよいように日記を書くための環境を構築することにした。</p><p>ざっくり条件はこんな感じ。</p><ul><li>目的は「書くこと」そのもの</li><li>シンプルに自分が読むためだけの文章を書ければよい</li><li>エディターやビューアをロックインされたくない</li><li>コンテンツをテキスト (markdown) で扱いたい</li><li>コンテンツをサービスにロックインされたくない</li></ul><p>それぞれのツールを検討してたときのメモ。</p><ul><li>ブログプラットフォームは使いたくない<ul><li>hatena, medium, note はすでに使っているので除外</li><li>広告やガジェットや管理ツールとかいらない</li><li>シンプルさがなくなってしまう</li></ul></li><li>メモツールに書く<ul><li><a href=https://obsidian.md/>obsidian</a> や <a href=https://hackmd.io/>hackmd</a> など</li><li>メモツールなので日記を書く用途とはちょっとズレる</li><li>シンプルさがなくなってしまう</li></ul></li><li>wiki に書く<ul><li><a href=https://www.notion.so/>notion</a> や <a href=https://github.com/weseek/growi>growi</a> など</li><li>シンプルさがなくなってしまう</li></ul></li><li>ジャーナルアプリに書く<ul><li>まさに日記そのものだけど、有償のプロダクトが多い</li><li>エディターは専用アプリになりそう</li></ul></li><li>自分で日記ツールを作る<ul><li>headless CMS とフロントエンドを実装する</li><li>いま日記を書き始めたいのにいつ書き始められるかわからない</li></ul></li></ul><p>最終的に残ったのは <a href=https://docs.github.com/ja/pages>GitHub Pages</a> だった。</p><ul><li>静的サイトジェネレーターに <a href=https://gohugo.io/>Hugo</a> を使う</li><li>Hugo のテーマをカスタマイズすればシンプルにできそう？</li><li>自分の好きなエディターで書ける</li><li>自分の好きなビューア (ブラウザ) で読める</li><li>Git リポジトリなのでサービスにロックインされない</li></ul><h2 id=コロナワクチン2回目摂取>コロナワクチン2回目摂取</h2><p>1回目の後、最速の日程から1週間ほど遅れてネット予約が取れた。摂取会場のクリニックでは、午前中は1回目、午後は診療やって、夕方に2回目摂取の時間帯になっているみたい。したがって17時という遅い時間帯に摂取した。私を含め、6人しか患者がいなかったので混雑も待ち時間もなくすぐに摂取して、15分ほど様子をみて帰ることができた。</p><p>ワクチン打った後、facebook にコメントを残したり、家族へ LINE でメッセージを送った。</p><p>それで何が変わるかわかってないけど、一人暮らしなので万が一、体調が悪くなって誰も気づかないままそのまま死んだとしても、ワクチンで運が悪くてしんだんやなと周りの人が気付けるようにという意図がある。一体、誰に気を使っているのか、自分でもよくわからないけど、自分が不慮の事故で死んでしまったとして、身近な人には多少なりとも背景が伝わることでお別れの挨拶変わりにはなるかな？という、変な気遣いをしている。</p><h2 id=terminal-のカスタマイズ>Terminal のカスタマイズ</h2><p>副反応の発熱でいつ作業が中断してもよいように日記を書くための Hugo の Terminal というテーマの設定を始めた。</p><ul><li><a href=https://github.com/panr/hugo-theme-terminal>https://github.com/panr/hugo-theme-terminal</a></li></ul><p>18時から20時ぐらいまでオフィスで作業して、買い物して帰ってきて晩ご飯食べて、その後も環境構築の作業をした。翌2時の時点で全くしんどくない。<code>config.toml</code> の設定項目に対するドキュメントがないけど、直接 grep で html のソースをみた方が早いことに気づいた。</p><p>とりあえずコンテンツを書いてみて、そこそこの見た目で表示できるようになった。まだ完全ではないので随時、後日、ソースを読みながら設定していく。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0926/>iostat-tool メンテ</a></h1><div class=post-meta><span class=post-date>2021-09-26 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/pypi/>pypi</a>&nbsp;
#<a href=/diary/tags/iostat/>iostat</a>&nbsp;</span>
<img src=https://pypi.org/static/images/logo-large.6bdbb439.svg class=post-cover alt="iostat-tool メンテ"><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#再現調査>再現調査</a></li><li><a href=#時刻のフォーマットが違う>時刻のフォーマットが違う</a></li><li><a href=#device-の軽微な変更と項目の変更>Device の軽微な変更と項目の変更</a></li><li><a href=#generator-based-coroutines-の-deprecated>generator-based coroutines の deprecated</a></li><li><a href=#iostat-tool-030-リリース>iostat-tool 0.3.0 リリース</a></li></ul></nav></div><div class=post-content><h2 id=再現調査>再現調査</h2><p>お昼ぐらいオフィスに行って事前に下調べしてあった iostat-tool の不具合修正をする。</p><ul><li><a href=https://github.com/t2y/iostat-tool/issues/3>https://github.com/t2y/iostat-tool/issues/3</a></li></ul><p>前職でディスクI/Oの振る舞いを調査していたときに iostat のアウトプットを直接みてもわからないので視覚化するツールを作った。例えば、<code>iostat -ymxt 1</code> のアウトプットは次のようなログになる。</p><pre tabindex=0><code>06/13/2018 02:10:50 PM
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.47    0.00    0.24    0.18    0.00   99.11

Device:         rrqm/s   wrqm/s     r/s     w/s    rMB/s    wMB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sdd               0.07    45.88    1.57    0.59     0.08     0.18   246.55     0.26  121.04    1.28  436.94   2.07   0.45
sdh               0.07    45.78    1.59    0.60     0.08     0.18   245.64     0.22  101.97    1.17  367.51   1.89   0.41
sdb               0.25    74.42    5.70    0.87     0.57     0.29   268.00     0.32   49.24   38.06  123.00   1.83   1.20
sdg               0.07    45.84    1.57    0.60     0.08     0.18   246.12     0.26  118.32    1.24  426.10   2.05   0.44
sdc               0.10    46.79    1.62    0.63     0.09     0.19   246.47     0.16   72.62   11.13  232.29   1.39   0.31
sde               0.07    45.79    1.56    0.60     0.08     0.18   246.16     0.21   98.68    1.10  351.50   1.83   0.39
sdj               0.07    45.88    1.56    0.60     0.08     0.18   245.68     0.21   95.91    1.07  341.03   1.80   0.39
sdf               0.07    45.76    1.58    0.60     0.08     0.18   245.70     0.19   85.95    1.03  308.11   1.79   0.39
sdk               0.07    46.68    1.56    0.61     0.08     0.18   247.68     0.28  128.43    1.25  455.92   2.17   0.47
sdi               0.07    45.67    1.57    0.60     0.08     0.18   244.58     0.21   96.74    1.11  344.99   1.84   0.40
sda               0.16    15.06    0.15    1.95     0.01     0.07    72.69     0.13   61.45    3.77   65.84   8.24   1.73
</code></pre><p>当時 rhel6 相当のディストリビューションで検証していた。そのため、その iostat のバージョンしかテストしてなかった。その後、時間が経って新しい項目が増えたり、同じ項目でも名前が変わったりしたみたい。vagrant で <a href=https://app.vagrantup.com/bento/boxes/centos-8>bento/centos-8</a> の環境を構築して <code>man iostat</code> や iostat のアウトプットを出力しながら確認した。</p><p>CentOS 8.3 の systat 11.7.3 のバージョンのアウトプットはこんな感じ。</p><pre tabindex=0><code>09/26/21 03:35:19
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.00    0.00    0.00    0.00    0.00    1.00

Device            r/s     w/s     rMB/s     wMB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util
sda              1.00    0.00      0.01      0.00     0.00     0.00   0.00   0.00    1.00    0.00   0.00     8.00     0.00   2.00   0.20
</code></pre><h2 id=時刻のフォーマットが違う>時刻のフォーマットが違う</h2><p>これは sysstat のバージョンによるものではないけど、ロケールの <code>LC_TIME</code> のエンコーディング指定を変えると時刻のフォーマットが変わることに気づいた。これも en 環境しかチェックしてなかったから今回 ja でも正しく時刻をパースできるように修正した。</p><pre tabindex=0><code>old: 06/13/2018 02:10:50 PM  # LC_TIME=&#34;en_US.UTF-8&#34;
new: 09/26/21 03:35:19       # LC_TIME=&#34;ja_JP.UTF-8&#34;
</code></pre><h2 id=device-の軽微な変更と項目の変更>Device の軽微な変更と項目の変更</h2><p>新しいフォーマットだと <code>Device:</code> のコロン文字がなくなってたりしてパースできなくなっていた。あと次の項目が名前変更、または新規追加されてた。</p><ul><li>aqu-sz</li><li>rareq-sz</li><li>wareq-sz</li><li>%rrqm</li><li>%wrqm</li></ul><p>基本的にパーサーをいじる必要はなくて項目の追加などで対応できた。当時、検証していたとき、作業がうまくいってなくて2-3日で突貫で作ったツールなのでパーサーはあまりきれいに実装はされていない。作った本人がみても1-2時間デバッグしながら直す必要があった。今後も iostat のアウトプットに大きな変更があるとは思えないからまぁいいかな。</p><h2 id=generator-based-coroutines-の-deprecated>generator-based coroutines の deprecated</h2><p>このツールを作った当時、python 3.4 以上をサポートする必要があったの generator-based coroutines で実装した気がする。それが 3.8 以降は deprecated になっているみたい。今回保守するときにサポート対象を 3.6 以上に変更したのですべて <code>async def</code> で書き直せるようになった。そう急ぐ必要もないのでまた今後、気が向いたら async 周りの実装も見直しながらやってみる。覚えていたら。</p><blockquote><p>Deprecated since version 3.8, will be removed in version 3.10: Use async def instead.</p><p><a href=https://docs.python.org/ja/3/library/asyncio-task.html#asyncio.coroutine>https://docs.python.org/ja/3/library/asyncio-task.html#asyncio.coroutine</a></p></blockquote><h2 id=iostat-tool-030-リリース>iostat-tool 0.3.0 リリース</h2><p>2018年から約3年ぶりに保守した。ついでに GitHub Actions で lint check と doctest の CI を実行するように変更した。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>新しい iostat のログフォーマットにも対応して 0.3.0 をリリースした。<a href=https://t.co/zwFuomvStO>https://t.co/zwFuomvStO</a></p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1442023934195421185?ref_src=twsrc%5Etfw">September 26, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/73/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>