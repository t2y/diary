<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.109.0"><title>forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="forest nook"><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0927/>コロナワクチン2回目</a></h1><div class=post-meta><span class=post-date>2021-09-27 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/xr/>xr</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#horizon-workrooms>Horizon Workrooms</a></li><li><a href=#お昼>お昼</a></li><li><a href=#日記を書く環境を決める>日記を書く環境を決める</a></li><li><a href=#コロナワクチン2回目摂取>コロナワクチン2回目摂取</a></li><li><a href=#terminal-のカスタマイズ>Terminal のカスタマイズ</a></li></ul></nav></div><div class=post-content><p>土曜日は昼寝してたくさん寝たせいか、昨日はうまく寝れなかった。4時頃に <a href=https://bunkyosha.com/books/9784866510149>「手で書くこと」が知性を引き出す 心を整え、思考を解き放つ新習慣「ジャーナリング」入門</a> の序章と1章を読んだ。手で書くのとキーボードをタイピングするのでは前者の方が脳が活性化されるらしい。指先の細かい制御が脳に効果的なようだ。5時ぐらいから寝て8時前に起きる。</p><h2 id=horizon-workrooms>Horizon Workrooms</h2><p>Oculus Quest 2 を使って顧問の知人と workrooms を使って仕事の打ち合わせをやってみた。</p><ul><li><a href=https://www.oculus.com/workrooms/>https://www.oculus.com/workrooms/</a></li></ul><p>9時から1時間強ほど打ち合わせ。</p><p>macbook を Oculus リモートデスクトップで接続して、ホワイトボード (スクリーン) で共有しながらの会話をやってみた。所感としてはこんなところ。</p><ul><li>リモートデスクトップと画面共有<ul><li>目の前の画面を大きくできるのでホワイトボード (スクリーン) よりみやすい</li><li>眼の前の画面をみて説明すると、相手の顔が見えないので vr のメリットが半減する</li><li>半仮想モードで話しながらメモをとるのは可能ではあるが、現実でやるよりも難しいので効率が悪化する</li><li>パソコンの操作が現実よりも難しいので、操作しないインセンティブになりがち</li><li>リモートデスクトップで画面共有をしていたせいか、<br>フル充電した状態から1.5 時間ぐらいでバッテリーが少ない警告が出た</li></ul></li><li>ヘッドセットの位置調整がうまくいかないと画面の文字がぼやけたりする</li><li>ヘッドセットの固定がうまくいかないと、会議に集中できず、ストレスになる</li><li>1時間程度の会議であれば、とくに vr による疲れなどは気にならない</li></ul><p>打ち合わせ終わってから NeosVR をするために Linux マシンと Oculus Quest 2 を接続する方法を検討。</p><ul><li><a href=https://neosvrjp.memo.wiki/>https://neosvrjp.memo.wiki/</a></li></ul><p>Oculus Link アプリを PC にインストールする必要があるが、Windows 向けにしか提供されていない。wine で動かない、一通りツール類をインストールして試してみたつもりだけど、このエラーを解決できなかった。諦める。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wine --version
</span></span><span style=display:flex><span>wine-5.0 <span style=color:#f92672>(</span>Ubuntu 5.0-3ubuntu1<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ wine ~/Downloads/OculusSetup.exe
</span></span><span style=display:flex><span>002a:err:mscoree:CLRRuntimeInfo_GetRuntimeHost Wine Mono is not installed
</span></span></code></pre></div><p>Windows マシンを買うにしても PCVR をするにはそこそこのスペックが必要になり、ざっと調べると10-20万円ぐらい。ノートPCでも15-16インチぐらいのを購入すればスペック的には大丈夫そうといった記事がいくつかみつかった。</p><ul><li><a href=https://vr-game.pw/blog/how-to-chooes-vr-pc/>https://vr-game.pw/blog/how-to-chooes-vr-pc/</a></li><li><a href=https://kimono-oyaji.com/laptoppc-for-hmd-01/>https://kimono-oyaji.com/laptoppc-for-hmd-01/</a></li></ul><p>このために Windows マシンを買ってまでやるほどのことでもないので PCVR は断念して普通に Linux マシンで NeosVR に挑戦することに決めた。</p><h2 id=お昼>お昼</h2><p>14時前ぐらいにお昼ご飯に出かけた。近所の居酒屋さんが緊急事態宣言の期間だけお弁当を販売している。いつもは13時頃には売り切れているのに、今日はたまたま14時なのに3個も残ってた。500円でおかずがいろいろ入っててコスパがいい。そのままお弁当を買ってオフィスで食べることにした。</p><h2 id=日記を書く環境を決める>日記を書く環境を決める</h2><p>この後、コロナワクチン2回目摂取があるので、副反応の発熱でいつ作業が中断してもよいように日記を書くための環境を構築することにした。</p><p>ざっくり条件はこんな感じ。</p><ul><li>目的は「書くこと」そのもの</li><li>シンプルに自分が読むためだけの文章を書ければよい</li><li>エディターやビューアをロックインされたくない</li><li>コンテンツをテキスト (markdown) で扱いたい</li><li>コンテンツをサービスにロックインされたくない</li></ul><p>それぞれのツールを検討してたときのメモ。</p><ul><li>ブログプラットフォームは使いたくない<ul><li>hatena, medium, note はすでに使っているので除外</li><li>広告やガジェットや管理ツールとかいらない</li><li>シンプルさがなくなってしまう</li></ul></li><li>メモツールに書く<ul><li><a href=https://obsidian.md/>obsidian</a> や <a href=https://hackmd.io/>hackmd</a> など</li><li>メモツールなので日記を書く用途とはちょっとズレる</li><li>シンプルさがなくなってしまう</li></ul></li><li>wiki に書く<ul><li><a href=https://www.notion.so/>notion</a> や <a href=https://github.com/weseek/growi>growi</a> など</li><li>シンプルさがなくなってしまう</li></ul></li><li>ジャーナルアプリに書く<ul><li>まさに日記そのものだけど、有償のプロダクトが多い</li><li>エディターは専用アプリになりそう</li></ul></li><li>自分で日記ツールを作る<ul><li>headless CMS とフロントエンドを実装する</li><li>いま日記を書き始めたいのにいつ書き始められるかわからない</li></ul></li></ul><p>最終的に残ったのは <a href=https://docs.github.com/ja/pages>GitHub Pages</a> だった。</p><ul><li>静的サイトジェネレーターに <a href=https://gohugo.io/>Hugo</a> を使う</li><li>Hugo のテーマをカスタマイズすればシンプルにできそう？</li><li>自分の好きなエディターで書ける</li><li>自分の好きなビューア (ブラウザ) で読める</li><li>Git リポジトリなのでサービスにロックインされない</li></ul><h2 id=コロナワクチン2回目摂取>コロナワクチン2回目摂取</h2><p>1回目の後、最速の日程から1週間ほど遅れてネット予約が取れた。摂取会場のクリニックでは、午前中は1回目、午後は診療やって、夕方に2回目摂取の時間帯になっているみたい。したがって17時という遅い時間帯に摂取した。私を含め、6人しか患者がいなかったので混雑も待ち時間もなくすぐに摂取して、15分ほど様子をみて帰ることができた。</p><p>ワクチン打った後、facebook にコメントを残したり、家族へ LINE でメッセージを送った。</p><p>それで何が変わるかわかってないけど、一人暮らしなので万が一、体調が悪くなって誰も気づかないままそのまま死んだとしても、ワクチンで運が悪くてしんだんやなと周りの人が気付けるようにという意図がある。一体、誰に気を使っているのか、自分でもよくわからないけど、自分が不慮の事故で死んでしまったとして、身近な人には多少なりとも背景が伝わることでお別れの挨拶変わりにはなるかな？という、変な気遣いをしている。</p><h2 id=terminal-のカスタマイズ>Terminal のカスタマイズ</h2><p>副反応の発熱でいつ作業が中断してもよいように日記を書くための Hugo の Terminal というテーマの設定を始めた。</p><ul><li><a href=https://github.com/panr/hugo-theme-terminal>https://github.com/panr/hugo-theme-terminal</a></li></ul><p>18時から20時ぐらいまでオフィスで作業して、買い物して帰ってきて晩ご飯食べて、その後も環境構築の作業をした。翌2時の時点で全くしんどくない。<code>config.toml</code> の設定項目に対するドキュメントがないけど、直接 grep で html のソースをみた方が早いことに気づいた。</p><p>とりあえずコンテンツを書いてみて、そこそこの見た目で表示できるようになった。まだ完全ではないので随時、後日、ソースを読みながら設定していく。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/0926/>iostat-tool メンテ</a></h1><div class=post-meta><span class=post-date>2021-09-26 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/pypi/>pypi</a>&nbsp;
#<a href=/diary/tags/iostat/>iostat</a>&nbsp;</span>
<img src=https://pypi.org/static/images/logo-large.6bdbb439.svg class=post-cover alt="iostat-tool メンテ"><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#再現調査>再現調査</a></li><li><a href=#時刻のフォーマットが違う>時刻のフォーマットが違う</a></li><li><a href=#device-の軽微な変更と項目の変更>Device の軽微な変更と項目の変更</a></li><li><a href=#generator-based-coroutines-の-deprecated>generator-based coroutines の deprecated</a></li><li><a href=#iostat-tool-030-リリース>iostat-tool 0.3.0 リリース</a></li></ul></nav></div><div class=post-content><h2 id=再現調査>再現調査</h2><p>お昼ぐらいオフィスに行って事前に下調べしてあった iostat-tool の不具合修正をする。</p><ul><li><a href=https://github.com/t2y/iostat-tool/issues/3>https://github.com/t2y/iostat-tool/issues/3</a></li></ul><p>前職でディスクI/Oの振る舞いを調査していたときに iostat のアウトプットを直接みてもわからないので視覚化するツールを作った。例えば、<code>iostat -ymxt 1</code> のアウトプットは次のようなログになる。</p><pre tabindex=0><code>06/13/2018 02:10:50 PM
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.47    0.00    0.24    0.18    0.00   99.11

Device:         rrqm/s   wrqm/s     r/s     w/s    rMB/s    wMB/s avgrq-sz avgqu-sz   await r_await w_await  svctm  %util
sdd               0.07    45.88    1.57    0.59     0.08     0.18   246.55     0.26  121.04    1.28  436.94   2.07   0.45
sdh               0.07    45.78    1.59    0.60     0.08     0.18   245.64     0.22  101.97    1.17  367.51   1.89   0.41
sdb               0.25    74.42    5.70    0.87     0.57     0.29   268.00     0.32   49.24   38.06  123.00   1.83   1.20
sdg               0.07    45.84    1.57    0.60     0.08     0.18   246.12     0.26  118.32    1.24  426.10   2.05   0.44
sdc               0.10    46.79    1.62    0.63     0.09     0.19   246.47     0.16   72.62   11.13  232.29   1.39   0.31
sde               0.07    45.79    1.56    0.60     0.08     0.18   246.16     0.21   98.68    1.10  351.50   1.83   0.39
sdj               0.07    45.88    1.56    0.60     0.08     0.18   245.68     0.21   95.91    1.07  341.03   1.80   0.39
sdf               0.07    45.76    1.58    0.60     0.08     0.18   245.70     0.19   85.95    1.03  308.11   1.79   0.39
sdk               0.07    46.68    1.56    0.61     0.08     0.18   247.68     0.28  128.43    1.25  455.92   2.17   0.47
sdi               0.07    45.67    1.57    0.60     0.08     0.18   244.58     0.21   96.74    1.11  344.99   1.84   0.40
sda               0.16    15.06    0.15    1.95     0.01     0.07    72.69     0.13   61.45    3.77   65.84   8.24   1.73
</code></pre><p>当時 rhel6 相当のディストリビューションで検証していた。そのため、その iostat のバージョンしかテストしてなかった。その後、時間が経って新しい項目が増えたり、同じ項目でも名前が変わったりしたみたい。vagrant で <a href=https://app.vagrantup.com/bento/boxes/centos-8>bento/centos-8</a> の環境を構築して <code>man iostat</code> や iostat のアウトプットを出力しながら確認した。</p><p>CentOS 8.3 の systat 11.7.3 のバージョンのアウトプットはこんな感じ。</p><pre tabindex=0><code>09/26/21 03:35:19
avg-cpu:  %user   %nice %system %iowait  %steal   %idle
           0.00    0.00    0.00    0.00    0.00    1.00

Device            r/s     w/s     rMB/s     wMB/s   rrqm/s   wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util
sda              1.00    0.00      0.01      0.00     0.00     0.00   0.00   0.00    1.00    0.00   0.00     8.00     0.00   2.00   0.20
</code></pre><h2 id=時刻のフォーマットが違う>時刻のフォーマットが違う</h2><p>これは sysstat のバージョンによるものではないけど、ロケールの <code>LC_TIME</code> のエンコーディング指定を変えると時刻のフォーマットが変わることに気づいた。これも en 環境しかチェックしてなかったから今回 ja でも正しく時刻をパースできるように修正した。</p><pre tabindex=0><code>old: 06/13/2018 02:10:50 PM  # LC_TIME=&#34;en_US.UTF-8&#34;
new: 09/26/21 03:35:19       # LC_TIME=&#34;ja_JP.UTF-8&#34;
</code></pre><h2 id=device-の軽微な変更と項目の変更>Device の軽微な変更と項目の変更</h2><p>新しいフォーマットだと <code>Device:</code> のコロン文字がなくなってたりしてパースできなくなっていた。あと次の項目が名前変更、または新規追加されてた。</p><ul><li>aqu-sz</li><li>rareq-sz</li><li>wareq-sz</li><li>%rrqm</li><li>%wrqm</li></ul><p>基本的にパーサーをいじる必要はなくて項目の追加などで対応できた。当時、検証していたとき、作業がうまくいってなくて2-3日で突貫で作ったツールなのでパーサーはあまりきれいに実装はされていない。作った本人がみても1-2時間デバッグしながら直す必要があった。今後も iostat のアウトプットに大きな変更があるとは思えないからまぁいいかな。</p><h2 id=generator-based-coroutines-の-deprecated>generator-based coroutines の deprecated</h2><p>このツールを作った当時、python 3.4 以上をサポートする必要があったの generator-based coroutines で実装した気がする。それが 3.8 以降は deprecated になっているみたい。今回保守するときにサポート対象を 3.6 以上に変更したのですべて <code>async def</code> で書き直せるようになった。そう急ぐ必要もないのでまた今後、気が向いたら async 周りの実装も見直しながらやってみる。覚えていたら。</p><blockquote><p>Deprecated since version 3.8, will be removed in version 3.10: Use async def instead.</p><p><a href=https://docs.python.org/ja/3/library/asyncio-task.html#asyncio.coroutine>https://docs.python.org/ja/3/library/asyncio-task.html#asyncio.coroutine</a></p></blockquote><h2 id=iostat-tool-030-リリース>iostat-tool 0.3.0 リリース</h2><p>2018年から約3年ぶりに保守した。ついでに GitHub Actions で lint check と doctest の CI を実行するように変更した。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>新しい iostat のログフォーマットにも対応して 0.3.0 をリリースした。<a href=https://t.co/zwFuomvStO>https://t.co/zwFuomvStO</a></p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1442023934195421185?ref_src=twsrc%5Etfw">September 26, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/109/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>