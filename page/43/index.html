<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.109.0"><title>forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content="t2y"><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="forest nook"><meta property="og:description" content><meta property="og:url" content="/diary/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0405/>rsync に daemon モードがあるらしい</a></h1><div class=post-meta><span class=post-date>2023-04-05 (Wed.)</span></div><span class=post-tags>#<a href=/diary/tags/cli/>cli</a>&nbsp;
#<a href=/diary/tags/security/>security</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/gpt/>gpt</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#rsync-daemon-over-ssh>rsync daemon over ssh</a></li><li><a href=#llmを使ってみる会>LLMを使ってみる会</a></li></ul></nav></div><div class=post-content><p>23時に寝て2時半に起きて4時や5時に起きて7時に起きた。泊まっているホテルの低反発枕の寝心地がよい。</p><h2 id=rsync-daemon-over-ssh>rsync daemon over ssh</h2><p>外部向けのドキュメントを公開するための gitlab ci/cd を構築した。web サーバにドキュメントをアップロードする手段として rsync を使っている。rsync over ssh でデータを転送するときにさらに daemon モード (rsyncd) という仕組みがあって、権限や書き込み先の acl なども細かく制御できる。手順や設定は古の古臭い雰囲気はするけれど、実用的には ssh の秘密鍵を使ってちょっと高機能なアップロードを実現できる。ssh agent で鍵登録できていれば次のような cli でセキュアに rsync できる。全然知らない方法だったので学びの1つになった。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ rsync <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --verbose <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --rsh ssh <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --stats <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --compress-choice<span style=color:#f92672>=</span>zstd <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --compress-level<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --itemize-changes <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --recursive <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --checksum <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    --delete <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>    local/ <span style=color:#e6db74>${</span>USER<span style=color:#e6db74>}</span>@<span style=color:#e6db74>${</span>HOST<span style=color:#e6db74>}</span>::<span style=color:#e6db74>${</span>RSYNC_DIR<span style=color:#e6db74>}</span>
</span></span></code></pre></div><ul><li><a href=https://jyn.jp/rsync-daemon-over-ssh/>rsync+sshはdaemonモードを使うと更に安全になる</a></li></ul><h2 id=llmを使ってみる会>LLMを使ってみる会</h2><p><a href=https://fin-py.connpass.com/event/279271/>LLMを使ってみる会</a> に参加した。私も chatgpt に調べものやちょっとしたことを聞くようになったりしているが、他の人たちがどんな用途に使っているのかも知りたくて参加してみた。fin-py のイベントだったのでみんな金融系のドキュメントの要約に使っているのが多そうにみえた。あとは研究テーマとして gpt/llm を取り上げている人たちも何人かいた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0404/>考えているとストリームが発生する</a></h1><div class=post-meta><span class=post-date>2023-04-04 (Tue.)</span></div><span class=post-tags>#<a href=/diary/tags/project-management/>project management</a>&nbsp;
#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#定例会議とふりかえり>定例会議とふりかえり</a></li></ul></nav></div><div class=post-content><p>18時から20時半ぐらいまで寝て、それから晩ご飯を食べに出掛けて、23時頃に戻ってきてまた寝て、4時に起きて、6時に起きた。出張の初日は不規則な寝方になる。</p><h2 id=定例会議とふりかえり>定例会議とふりかえり</h2><p>リリースまであと3週間。一部の開発がまだ完了していないことに大きなストレスと懸念を感じつつ、進捗はしているそうなのでその対応が完了するのを待つ。いまは日々の進捗や発生する事象に注意を配りつつ、メンバーは QA レベルのテストを、私は淡々とリリースの準備をしている。外部からアクセスできるプライベートなコンテナレジストリを docker hub でお金を払うか、自社で運用するかの決めの問題や外部向けにドキュメントを公開するための決めごとなどを確認したりしていた。</p><p>毎月のマイルストーン終了後にふりかえりをしている。今月は対応した issue のうち、70%超を私が fix しているのであまり話題がないかなぁとか思っていたけど、全然そんなことはなく、活発にふりかえりのコメント (付箋に書く) が出てよかった。当初は付箋に書いた内容に対して関心のあるものをメンバーに投票してもらっていた。そして、メンバーの関心の高いマークがたくさん付いたものから掘り下げて聞くようにしていた。最近は3人でふりかえりをやっているため、すべての付箋をみていっても10個未満程度、すべてヒアリングしても時間がちょうどよいので投票をやめた。そうすると、メンバーが自分のやったことや思ったことを他者へ話す機会になっていて、これは内省を促す意図でとてもよいことじゃないかと思うようになってきた。</p><blockquote><p>ふりかえりをしない人やチームは成長しない</p></blockquote><p>これは私の持論だ。うまくいかなかったときにふりかえりすると、当事者が嫌な気持ちになったりしんどかったり、責任を感じたりとネガティブなイメージから、私の経験則ではふりかえりを行わないチームの方がずっと多かった。こういう小さい積み重ねを継続的にやるのは後になってその人の価値観や成長に影響を与えるのではないかと最近は思う。うちのチームでは厳しく責任追及はしないのでメンバーが率直的にこれができなかったとふりかえることはできるようになっているとは思う。</p><p>ふとふりかえりをしていてこんな言葉が私の口から出た。</p><blockquote><p>作業の進捗をストリームとして確認できると嬉しい、ストリームを眺めているとメンバーが考えているのかどうかが分かる</p></blockquote><p><a href=https://gihyo.jp/book/2018/978-4-7741-9605-3>エンジニアリング組織論への招待</a> に次のような節がある。</p><blockquote><p>「悩む」と「考える」の違い</p><p>「考える」は行動であり、「悩む」は状態なのです。考えているのであれば、それはメンターがその行動を見ることができます。しかし、「悩む」であれば、メンターは心の状態を観察することはできません。</p></blockquote><p>悩んでいる状態は手が止まっていて、頭の中で思考がぐるぐる巡っていて、もやもやしている状態。考えているとは、課題を書き出したり、分解したり、調査したりと忙しく行動していると言える。当然、考えないと優れた品質のアウトプットは出せない。正に私がやっている課題管理も、そのための課題管理システムも考えていることを確認・監視するために有効な手法とシステムであることが伺える。チームのふりかえりをしながら、そういった話しをメンバーに共有したりしていた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0403/>ローカルにコンテナレジストリを構築する</a></h1><div class=post-meta><span class=post-date>2023-04-03 (Mon.)</span></div><span class=post-tags>#<a href=/diary/tags/docker/>docker</a>&nbsp;
#<a href=/diary/tags/packaging/>packaging</a>&nbsp;
#<a href=/diary/tags/mdbook/>mdbook</a>&nbsp;
#<a href=/diary/tags/document/>document</a>&nbsp;
#<a href=/diary/tags/mermaid/>mermaid</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#docker-registry-の構築>docker registry の構築</a></li><li><a href=#mdbook-の初期設定>mdbook の初期設定</a></li></ul></nav></div><div class=post-content><p>出張する日は寝ないで資料を作ったりバグ修正したりして始発の新幹線の中で寝てた。寝てなくて疲れているせいか、新幹線で寝るのに慣れたのか、わりと2-3時間ぐっすり新幹線で眠れるようになってきた。普通にベッドで寝ても3時間ぐらいしか眠れないので睡眠時間はあまり変わらない。</p><h2 id=docker-registry-の構築>docker registry の構築</h2><p><a href=/diary/posts/2023/0330/#外部向けコンテナレジストリ>先日の調査</a> の続き。<a href=https://docs.docker.com/registry/deploying/>Deploy a registry server</a> に書いてあることを実際にローカルで検証した。</p><p>tls の自己証明書の作成。subjectAltName という設定をするように書いてある。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ openssl req -newkey rsa:4096 -nodes -sha256 -keyout certs/domain.key -addext <span style=color:#e6db74>&#34;subjectAltName = DNS:myhost.mydomain.example.com&#34;</span> -x509 -days <span style=color:#ae81ff>365</span> -out certs/domain.crt
</span></span></code></pre></div><p>basic 認証のための htpasswd の設定。htpasswd とか懐かしいなと思いながら実行した。</p><pre tabindex=0><code class=language-bsah data-lang=bsah>$ docker run --entrypoint htpasswd httpd:2 -Bbn user1 secret1 &gt;&gt; dot_htpasswd
$ docker run --entrypoint htpasswd httpd:2 -Bbn user2 secret2 &gt;&gt; dot_htpasswd
</code></pre><p>docker 社が提供する oss な docker registry サーバーを使って起動する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir /mnt/registry  <span style=color:#75715e># docker image を永続化する場所</span>
</span></span><span style=display:flex><span>$ sudo docker run -d <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --restart<span style=color:#f92672>=</span>always <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --name registry <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>/auth:/auth <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_AUTH=htpasswd&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_AUTH_HTPASSWD_REALM=Registry Realm&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_AUTH_HTPASSWD_PATH=/auth/dot_htpasswd&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>/certs:/certs <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_HTTP_ADDR=0.0.0.0:443&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_HTTP_TLS_CERTIFICATE=/certs/domain.crt&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -e <span style=color:#e6db74>&#34;REGISTRY_HTTP_TLS_KEY=/certs/domain.key&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -p 8443:443 <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  -v /mnt/registry:/var/lib/registry <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  registry:2
</span></span></code></pre></div><p>これで basic 認証付きで https で通信できる docker registry サーバーができた。</p><p>外部のマシンから dokcer login しようとすると次のようなエラーが発生する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ docker login myhost.mydomain.example.com:8443
</span></span><span style=display:flex><span>Username: user2
</span></span><span style=display:flex><span>Password: ***
</span></span><span style=display:flex><span>Error response from daemon: Get <span style=color:#e6db74>&#34;https://myhost.mydomain.example.com:8443/v2/&#34;</span>: x509: certificate signed by unknown authority
</span></span></code></pre></div><p><a href=https://docs.docker.com/registry/insecure/>Test an insecure registry</a> によると、自己証明書を使って外部からアクセスできるようにするためには docker client 側にさっき作った domain.crt をコピーする必要がある。</p><p>linux だとこんな設定。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cp domain.crt /etc/docker/certs.d/myhost.mydomain.example.com:8443/ca.crt 
</span></span></code></pre></div><p>Docker Desktop for Mac を使っている場合はこんな感じ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-zsh data-lang=zsh><span style=display:flex><span>&gt; security add-trusted-cert -d -r trustRoot -k ~/Library/Keychains/login.keychain path/to/certs/domain.crt
</span></span></code></pre></div><p>これで外部からも docker login して任意の docker image を push/pull できるようになる。docker registry サーバーは Let’s Encrypt をサポートしているそうなので <a href=https://letsencrypt.org/how-it-works/>How It Works</a> を参照して設定すればよいと書いてあった。</p><h2 id=mdbook-の初期設定>mdbook の初期設定</h2><p>mdbook は新しい rust のバージョンだとビルドできなかったりするので rustup を使ってローカルに rustc をインストールするのがよいかもしれない。プラグインとしては <a href=https://github.com/badboy/mdbook-mermaid>mdbook-mermaid</a> を使う。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl --proto <span style=color:#e6db74>&#39;=https&#39;</span> --tlsv1.2 -sSf https://sh.rustup.rs | sh
</span></span><span style=display:flex><span>$ ~/.cargo/bin/rustc --version
</span></span><span style=display:flex><span>$ cargo install mdbook mdbook-mermaid
</span></span></code></pre></div><p>mdbook-mermaid の設定も簡単でドキュメントルート配下に mermaid の js ファイルを配置すると動いた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi book.toml
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>preprocessor.mermaid<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>command <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;mdbook-mermaid&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>output.html<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>additional-js <span style=color:#f92672>=</span> <span style=color:#f92672>[</span><span style=color:#e6db74>&#34;mermaid.min.js&#34;</span>, <span style=color:#e6db74>&#34;mermaid-init.js&#34;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0402/>事務手続き時々お出かけ</a></h1><div class=post-meta><span class=post-date>2023-04-02 (Sun.)</span></div><span class=post-tags>#<a href=/diary/tags/kobe/>kobe</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#mon-copain-モンコパン>Mon copain (モン・コパン)</a></li><li><a href=#夜のお花見-at-生田川公園>夜のお花見 at 生田川公園</a></li><li><a href=#請求書の即時払い>請求書の即時払い</a></li></ul></nav></div><div class=post-content><p>0時に寝て4時に起きて6時に起きて8時ぐらいまでだらだらしてた。出張前にプロジェクトの進捗を確認したり近況報告の資料を作ったり。</p><h2 id=mon-copain-モンコパン>Mon copain (モン・コパン)</h2><p><a href=/diary/posts/2022/1030/#神戸お土産探し>出張するときはお土産をもっていく</a> ようにしていて、2月の中旬からお土産を探す余裕もなくてネタ切れでどうしようと思っていたものの、朝から調べてたら
<a href=https://montplus.com/>パティスリー モンプリュ</a> というお店をみつけた。
Mon copain というガトーショコラの詰め合わせを選んでみた。ガトーショコラをあまり買ったことも食べたこともないので試しに購入してみた。本当は私が味見してからお土産にするかどうかを選定する (自分が食べてイマイチなものはお土産に持っていかない) のだが、先月からそんな余裕がなくて、お店を信頼して自分用と一緒にその場で購入したりしている。単品だと3個入りを1セットで購入できる。税込で580円になる。</p><figure><img src=/diary/img/2023/0402_mon-copain.jpg></figure><p>それぞれ上から次になる。</p><ul><li>茶色の包み: au lait キャラメルのコクが味わい深いミルク・ショコラ</li><li>白色の包み: blanc ほんのりレモンが香るホワイト・ショコラ</li><li>焦げ茶の包み: noir ほろ苦さが大人味のスイート・ショコラ</li></ul><p>しっとり柔らかい口当たりで上品な風味だった。神戸の洋菓子屋さんという印象がそのままのお菓子。甘いが甘過ぎない雰囲気でよいと思う。3つとも食感は似ているが、どれも風味がまったく違うので全部食べてみるのも楽しめると思う。お土産として量と値段のバランスも取れていてちょうどよかった。全然調査していなくても、即席でよいお店がみつかるのは神戸という地域のよさだと思う。</p><h2 id=夜のお花見-at-生田川公園>夜のお花見 at 生田川公園</h2><p><a href=/diary/posts/2022/0410/#お花見-at-生田川公園>昨年に引き続き生田川公園</a> で三ノ宮.devのお花見。今年は夜桜にしようと夕方から始めることに。私は16時ぐらいから車で買い出しへ行って17時ぐらいから参加してきた。ここ2-3週間ほど車を動かす機会を伺っていてできなかったのが、明確な目的があると車を動かすことができてよかった。初めて近所のスーパーマーケットへ車で出掛けて駐車場に停めて買いものしてきた。15分ほどで買いものして、駐車場から出るときに220円必要だった。後で調べると500円以上購入すると120分無料になったらしい。レジで駐車券ありませんか？と聞かれて車に忘れてきていたので無料化のための手続きができなかった。次回から持参するための学びの1つとなった。その後、生田川公園へ移動して、付近をまわりながらパーキングのスポットをみつけることもできた。次のお花見はまた来年になるけど、そのときに役立つはず。</p><p>昨年は4人だったのが今年は7人参加していた。昨年よりは三ノ宮.devも少し成長したのかもしれない。<a href=/diary/posts/2023/0124/#起業相談>1月に起業相談</a> されていた方も来ていて、その後、デザイナーや開発者をみつけることができて、プロダクト開発をしているらしい。3ヶ月でさっそくピボットしましたという話しをしていて、起業したばかりだとそんなもんだと私も思う。うまくいっているように話していたのでよかったと思う。これから海外に3ヶ月ぐらい出かけるといった話しもされていてスケールの大きい人だなと聞いてた。</p><p>17時頃から始めて20時半でお開きになった。街灯の近くの場所をとったので暗くなっても灯りは問題なかった。始めたときは涼しくてちょうどよかったものの、さすがに20時をまわると寒くて解散することにした。私も20-21時ぐらいで帰ろうと思っていたのでちょうどよかった。食べものも飲みものもそんなに外してはなかったが、せっかく車があったので最初にコアメンバーに声を掛けて買い出しに行ってもよかったなと思えた。私が余裕なくて段取りできなかったせいでもある。16時から始めて19時に終える花見のやり方もあることを学んだ。</p><figure><img src=/diary/img/2023/0402_hanami.jpg></figure><h2 id=請求書の即時払い>請求書の即時払い</h2><p>今月から請求書の支払いを即時払いに切り替えることにした。いまお手伝いしているお客さんは当社から請求書を送ると即時払いしてくれる。これまで取り引きしてきたお客さんは翌月末払いが普通だったのでそういうものだと思い込んでいた。私も無条件でその慣習に従っていた。もちろん契約上の支払い期限そのものは翌月末に設定しているが、支払いを即時で行うことに問題はなにもない。</p><p>キャッシュフローの視点から「回収は早く支払いは遅く」の原則がある。レバレッジを効かせた経営 (資金繰り) をするなら正しいが、うちみたいな会社が支払いを1ヶ月遅くするメリットは何もない。これまでは請求書を受け取ったときに会計システムに取り引き登録して、銀行口座から1ヶ月後に予約振り込みの登録をしていた。そして、実際に振り込みされた1ヶ月後に、銀行の振り込み明細と会計システムの取り引き明細を付き合わせて決済が完了となる。請求書を受け取ったときに即時払いにすると、タイミング的に1ヶ月ずれる2度の事務手続きを1度にまとめられる。一言でいうと事務手続きの効率化になる。</p><p>うちみたいな会社にとっては請求書の即時払いをすると、事務手続きの工数を少なくできるというメリットがあることに気付いた。こんな簡単なことにこれまで気付いていなかったわけではないのだが、私の目が曇っていたのか、慣習に引き摺られて気付かない振りをしていた。自分の頭で考えること、実際に実践してみることの重要性を改めて学んだ。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0401/>まったく終わっていない年度始まり</a></h1><div class=post-meta><span class=post-date>2023-04-01 (Sat.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#年度を気にしている余裕がない>年度を気にしている余裕がない</a></li><li><a href=#ストレッチ>ストレッチ</a></li><li><a href=#個人カンファレンス>個人カンファレンス</a></li></ul></nav></div><div class=post-content><p>23時に寝て何度か起きて7時に起きた。久しぶりに早めにお仕事を終えて、気分転換に出掛けて、帰ってきてすぐ寝てたかな。</p><h2 id=年度を気にしている余裕がない>年度を気にしている余裕がない</h2><p>お仕事の納期が4月末でまだ余談を許さない状況と言える。2ヶ月以上遅延している、ある開発作業の最後の作業をメンバーから私に担当を付け替えている。前任者が作業を終えたら私がクリティカルパスになるようにしておいて、なる早で終わらせて開発を完了させたい。リリースまであと3週間なのに code freeze すらできていないという、マネジメントとしては失態を続けている。前任者が作業を終えるのを見計らって私が休出しつつ段取りを組んで正しいスケジュールに引き戻そうと調整している。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前154cmで、ストレッチ後158cmだった。今週は (私個人の) 開発のピークを過ぎて後半は余裕があったので体にかかる負荷も少なかったのではないかと想像していたら、ストレッチを受けていても先週より調子がよいように思えた。右股関節付近の張りは継続しているものの、腰の張りもひどくなく、すねの外側の筋も問題なく、ここ1-2ヶ月ぐらいではもっとも調子がよかったかもしれないと思えた。トレーナーさんも今日は目立って悪いところはなさそうとコメントしていたぐらい。</p><h2 id=個人カンファレンス>個人カンファレンス</h2><p>ストレッチを終えてからオフィスへ行って <a href=https://tenntenn.connpass.com/event/261521/>tenntenn Conference 2023</a> に参加した。個人が1日中話しまくるという取り組みそのものがおもしろい。自社のお仕事をしながら並行で視聴していた。パネルディスカッション (個人カンファレンスなのにモデラーとパネラーがいて、どうやら同じ人物っぽい人が相互に話していたw) のときに次のような質問があった。</p><blockquote><p>Q. なぜ個人カンファレンスをやっているのか？</p><p>A. あまり深い意味はなく、誰もやっていないので思いつきでやっている</p></blockquote><p>私のような無名の開発者が個人カンファレンスを開いても誰も参加してくれないと想定される。個人カンファレンスが成り立つ開発者の知名度やコンテンツを選択するのはすごく難しいと思う。個人カンファレンスの取り組みをみていて会社のテックカンファレンスを1人でやってみるというのもおもしろそうに思えた。うちの会社は課題管理を中核にビジネスを進めていく。その一環でコンテンツをいくつも作っていく必要がある。そして、コンテンツが溜まってきたらカンファレンス形式にして一気に放出するという取り組みをいずれやってみてもよいかもしれない。</p><p>他には <a href=/diary/posts/2023/0331/#chatgpt-勉強会>昨日の雑談会</a> にも書いたことで、オンラインの勉強会で参加者とインタラクティブにやり取りする難しさをこの個人カンファレンスをみていても感じた。登録で300人超、そのうち6割参加で180人ぐらいが参加していると仮定して、インタラクティブにコメントしているのは数人ほどしかいなかったと思う。私も他の作業と並行しつつ、ながらで視聴していたのでインタラクティブなコメントなどはしなかった。たまに twitter に所感を投稿するぐらい。基本的にオンライン勉強会でインタラクティブなやり取りを求めず、オフラインで3-4人集まってインタラクティブにやり取りする内容をコンテンツとして流すというのがよいのかもしれないなと、視聴していて思ったりもした。</p><blockquote><p>Q. 有料の勉強会を始めたきっかけは？</p><p>A. お仕事じゃないとまとまった時間を使うことに家族の了承を得られにくいと考えたから</p></blockquote><p>私も有料勉強会に参加しているので興味があった。主催者が転職の隙間時間を使う理由を家族に理解してもらうためだったと話されていた。私も過去に同居人がいたときに自分の時間を勉強したり、飲み会へ行ったりするのを非難された時期があったので理解できる。私はいまや調べものや勉強をしている時間が一番幸せを感じる。私にとって他のことを考えずに集中している状態がその時間に相当する。疲れてただ寝ているときもたまにある。しかし、それはあの時間を勉強や仕事に割り当てていたらもっとうまく物事を進められたのに、、、と後になって自己嫌悪になって返ってくるときがある。いまは何をなしても満たされることはなくて、常になにかをなし続けている状態そのものに満たされる。</p><p>閑話休題。あとでアーカイブも公開されるそうなので関心がある発表はまた見返すと思う。generics 周りと静的解析に関するところに私は関心をもっている。他に個人カンファレンスをやっている人を私はみかけたことがないけれど、こういう新しい取り組みに挑戦する人は本当に尊敬できる。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0331/>chatgpt の調べものと整理して雑談した</a></h1><div class=post-meta><span class=post-date>2023-03-31 (Fri.)</span></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/gpt/>gpt</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#隔週の雑談>隔週の雑談</a></li><li><a href=#社員数を調べるハック>社員数を調べるハック</a></li><li><a href=#chatgpt-勉強会>chatgpt 勉強会</a></li></ul></nav></div><div class=post-content><p>1時に寝て6時に起きた。昨日は chatgpt の調べものをしていたら帰るのが遅くなった。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。3月はお仕事が忙しかったのでこの前はお休みして1ヶ月ぶりの雑談。主には <a href=/diary/posts/2023/0319/>来季の予算</a> について話していた。</p><p>予算を策定するときに今回から消費税を経費に含めるとよいのではないかと考えた。というのは、法人税は赤字のときにゼロになるので売上と経費を算定したときに利益が多ければ発生するだけで利益を帳消しにするといったことはない。しかし、消費税は損益に関係なく仕入よりも売上にかかる消費税が多い場合に支払う必要がある。ここで経費の大半に相当する人件費 (給与) には消費税がかからないことから損益がゼロだったとしても消費税を支払うと赤字になるといった状況は考えられる。売上よりも仕入で支払った消費税の方が多かった場合、消費税は還付されることになるが、うちは簡易課税を選択しているので売上の消費税に対して50%を支払うことになる。簡易課税の場合、最小の消費税がゼロ (つまり売上がゼロ) であり、仕入にどれだけ消費税を支払ったとしても還付は発生しない。とはいえ、通常の事業運営をすれば仕入の消費税が売上よりも多くなるといったことは発生しない。</p><p>オフィス引越しや社用車の購入に関して前年よりも固定費は増えている。それは仕方ないとして、その他に無駄遣いをしているわけでもないので来季は赤字前提の予算を見積もる。いまのところ、お仕事は半年ぐらいしかやらない予定になる。仮にそれ以上働くことになったとしても、そのときは売上が増えて財務的には助かることになる。お仕事があってもなくてもどちらでもよいという展望で予算策定を終えた。</p><h2 id=社員数を調べるハック>社員数を調べるハック</h2><p>たまたまタイムラインで <a href=https://www2.nenkin.go.jp/do/search_section/>厚生年金保険・健康保険 適用事業所検索システム</a> というシステムで毎月20日時点での厚生年金保険・健康保険の被保険者数を調べられることを知った。未上場の会社だと社員数を公表する義務がないので規模感が分からないことがある。スタートアップやベンチャー企業で話題になっている会社の規模感を調べるときなどに役に立つかもしれない。試しに過去に私が働いた会社でその後どうなったのだろう？と調べてみたら私が在籍していた当時よりも人数は減っているもののまだ被保険者数がいたので会社は存続していることがわかった。会社の栄枯盛衰を測る指標の1つとして社員数は使えると思うので業界研究の手法の1つとしてよいかもしれない。</p><h2 id=chatgpt-勉強会>chatgpt 勉強会</h2><p>今週のチーム勉強会は私が担当して <a href=https://openai.com/blog/chatgpt>chatgpt</a> についての雑談会とした。と言っても、ほとんど私が一方的に話す感じであまり雑談会にはならなかった。オンライン勉強会で雑談会を運営するのはすごく難しい。意図的に質問やツッコミを入れるという役割を参加者に課さないと雑談会を運営するのは難しいのかもしれない。勉強会で発表すると、自分で学ぶきっかけになるのでちょうどよかった。お手伝い先でも slack に chatgpt の api を用いた bot を実装してチャットで質問できるようになっている。何人かは身近に chatgpt を使って振る舞いを確認したりもしている。雑談会では次の内容で gpt (llm) とはどういうものなのか、また chatgpt の使い方が従来にはなかったものを私が知っている中で共有した。今後もしばらくは注目していこうと思う。</p><ul><li>OpenAI/ChatGPT 概要</li><li>ChatGPT の使い方</li><li>GPT 以後の世界</li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0330/>コンテナレジストリをプライベートに運用する</a></h1><div class=post-meta><span class=post-date>2023-03-30 (Thu.)</span></div><span class=post-tags>#<a href=/diary/tags/docker/>docker</a>&nbsp;
#<a href=/diary/tags/packaging/>packaging</a>&nbsp;</span><div class=table-of-contents><h2>目次</h2><nav id=TableOfContents><ul><li><a href=#外部向けコンテナレジストリ>外部向けコンテナレジストリ</a></li></ul></nav></div><div class=post-content><p>0時に寝て7時に起きた。晩ご飯を食べきれなくて調子悪いと思っていたら夜も吐き気と胃酸で気分が悪くてあまり眠れなかった。</p><h2 id=外部向けコンテナレジストリ>外部向けコンテナレジストリ</h2><p>いまお仕事で作っているアプリケーションは docker image としてパッケージングしている。エンドユーザーがこのアプリケーションを使うためには docker pull できるためにインターネットを経由してアクセスできる必要がある。普段はイントラネットのコンテナレジストリに push/pull して運用しているのを、外部のエンドユーザー向けにアクセスできるコンテナレジストリ (リポジトリ) を構築しないといけない。パブリックなリポジトリとして提供するのであれば、<a href=https://hub.docker.com/>docker hub</a> や <a href=https://docs.github.com/en/packages/working-with-a-github-packages-registry/working-with-the-container-registry>GitHub Container registry</a> などを無料で利用できる。しかし、プライベートなリポジトリで運用しようとするとその選択肢は狭まってしまう。おそらく他社のサービスを使うのであれば、実際の運用を考慮するといくらか費用がかかるだろう。</p><p>仮に docker image が使うストレージを5GiB、インターネットへの outbound なデータ転送を30GiB/月で見積もってみた。docker hub だと利用量によって課金されないのでその後に利用増加が前提であればよさそうにみえる。</p><ul><li><p>github (従量課金)</p><ul><li><a href=https://github.com/pricing>team プラン</a></li><li>開発者1人: $20.25/month, $243/year</li></ul></li><li><p>aws (従量課金)</p><ul><li>region=tokyo: $3.92/month, $47.04/year</li></ul></li><li><p>docker hub (容量無制限)</p><ul><li><a href=https://www.docker.com/pricing/>team プラン</a></li><li>開発者1人: $11/month, $132/year</li></ul></li></ul><p>別の選択肢として自前でコンテナレジストリを運用するという方法もある。docker registry サーバーは oss として公開されていて docker image の push/pull をするだけのサーバーならすぐに構築できる。ベーシック認証に近い v1 の認証でよければ <a href=https://httpd.apache.org/docs/current/programs/htpasswd.html>htpasswd</a> を使ってアカウント管理できる。</p><ul><li><a href=https://docs.docker.com/registry/deploying/>Deploy a registry server</a></li></ul><p>ドメインと tls の証明書と外部からアクセスできるサーバーがあれば、自前で運用するのもそう大変ではないと思う。実際にこれらの運用コストと他サービスの利用料金とを比べて選択することになるだろう。</p></div></div><div class=pagination><div class=pagination__buttons><a href=/diary/page/42/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a>
<a href=/diary/page/44/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>