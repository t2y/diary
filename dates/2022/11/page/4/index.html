<!doctype html><html lang=en><head><title>2022/11 :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/dates/2022/11/><link rel=stylesheet href=/diary/assets/style.css><link rel=stylesheet href=/diary/assets/green.css><link rel=stylesheet href=/diary/style.css><link rel=apple-touch-icon href=/diary/img/apple-touch-icon-192x192.png><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="2022/11"><meta property="og:description" content><meta property="og:url" content="/diary/dates/2022/11/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="2048"><meta property="og:image:height" content="1024"><link href=/diary/dates/2022/11/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><div class=menu-trigger>menu</div></div><nav class=menu><ul class="menu__inner menu__inner--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul><ul class="menu__inner menu__inner--mobile"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1130/>仲の良いチーム</a></h1><div class=post-meta><span class=post-date>2022-11-30</span></div><span class=post-tags>#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;</span><div class=post-content><p>1時に寝て何度か起きて7時に起きた。起きてからも昨日の夜にやってた勉強会の資料作りをずっとやってた。</p><h2 id=1on1-で設計談義>1on1 で設計談義</h2><p>あるマージリクエストで私が nil ガードを実装した方がよいとコメントした。その意図がわからないという話になって nil ガードを実装する背景について、実際のコードをみながらメンバーに説明した。プログラミングの文脈では全然難しくないことではあるけど、あまり経験がない人にとってはその意図や考え方を学ぶのは難しいかもしれない。こういった、詳しい人に聞けばすぐ解決するけど、ググって調べるのは難しいこともある。1on1 のような身近に話す機会があると、定例会議でみんなの時間に話すほどの重要度ではない話題を聞くことができる。そこで聞いた意見をベースに私が issue 化したり、ある話題をチームで話し合う打ち合わせの機会を設けたりしている。</p><h2 id=メンバーの送別会>メンバーの送別会</h2><p>私があるチームのマネージャーをして1ヶ月が経つ。メンバーの1人が退職することになった。実はマネージャーになって1週間後に転職が決まったという話しだった。いきなり開発体制がバタバタしたけれども、私からみたらやることは変わらないのでその影響は最小限に留められたのではないかと思う。いまのところ、当初の開発の計画にも変更をきたしていない。出張でオフィスに来ている機会なので私もそのメンバーの送別会に参加した。他の社員さんも20人ぐらい参加されていた。飲み会の雰囲気をみていて若い人が自由に発言して楽しんでいるのを傍から眺めてた。飲み会の雰囲気ってその組織の性格が出ておもしろいと思う。イヤな人がいないのは組織において重要になる。後日、経営者の方々とそういう会話をしていたら小さい会社はみんな仲良くできるといった話しをされていた。たしかにそれぞれのメンバーの顔とやっていることを見渡せる規模だから親近感を抱きやすいと言えるかもしれない。ここ数年どこへ手伝いに行ってもよい雰囲気をもつ会社は多い。変な言い方だけど、よい世の中になったと思えて嬉しい。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1129/>初めてのマイルストーンふりかえり</a></h1><div class=post-meta><span class=post-date>2022-11-29</span></div><span class=post-tags>#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;</span><div class=post-content><p>0時に寝て何度か起きつつ5時に起きた。慣れないホテルでの就寝なのに昨日はバテバテだったから割と眠れた方だと思う。</p><h2 id=ふりかえり>ふりかえり</h2><p>1ヶ月 (厳密には4イテレーション) をマイルストーンとし、マイルストーンを終えたらふりかえりを行う。前にスクラム開発で行っていたふりかえり手法をベースにしながらやってみる。ポジティブなふりかえり向けに fun/done/learn という手法がよさそうだったので採用してみた。ツールは jamboard を使った。</p><ul><li><a href=https://qiita.com/yattom/items/90ac533d993d3a2d2d0f>ファン・ダン・ラーン(FDL)ふりかえりボード</a></li><li><a href=https://www.ogis-ri.co.jp/otc/hiroba/others/ActivityPocket/FunDoneLearn.html>ふりかえりでFun! Done! Learn!</a></li></ul><p>初めてやってみたので進め方そのものにいくつか反省があった。オフィスで大きいスクリーンに映してみんながみえるようにしながら jamboard にコメントを書き込んでいく同時作業が割と忙しかった。jamboard で付箋を書くときの操作性が微妙によくない。慣れの問題かもしれないけど、なにかあとひと押しの操作性が足りない気がする。</p><p>最初なのでやり方の例として私も付箋にコメントを書きながらやっていた。私が参加者の1人として振る舞うと進行が止まってしまって忙しくなることに気付いた。あとで付箋に対して「いいね」をつけて共有してもらうときに、私の役割が開発者としての振る舞いとファシリテーターとしての振る舞いが混ざってしまって、他の参加者がどう感じたかはわからないが、私自身がいま何をやろうとしているのか分からなくなるといった混乱をきたすことがわかった。ファシリテーターとしての私はメンバーの意見を聞いてまとめ役をしないといけない。しかし、開発者としての私が意見を発してしまうと、私の意見を私がまとめることになってしまい、その客観性を担保しているのかどうかが分からなくなってしまう。要は簡潔なまとめなのか、個人の意見なのかの見分けがつかない。ファシリテーターとして振る舞うときはメンバーとしての意見を言わない方が進行がやりやすくなることに気付いた。初めてやったときはこんなもんか。次回への反省につなげる。</p><p>やったことは、課題管理システムから自分が担当者の issue をフィルターして眺めればすぐに把握できるが、ネガティブなふりかえりの気付いたことや改善したいことを掘り返す方法がないことにも気付いた。マイルストーンが1ヶ月なのでどこかに記録しておかないと忘れてしまう。go のプログラミングにまだ慣れていないといった付箋がたくさんあったが、それ以外はもう覚えていないというのもあったと思う。忘れないための一時記録の仕組みを考えないといけないことに私自身が気付いた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1128/>東京出張 2回目</a></h1><div class=post-meta><span class=post-date>2022-11-28</span></div><span class=post-tags>#<a href=/diary/tags/biztrip/>biztrip</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/government/>government</a>&nbsp;
#<a href=/diary/tags/career/>career</a>&nbsp;</span>
<img src=/diary/img/2022/1128_dinner.jpg class=post-cover alt="東京出張 2回目"><div class=post-content><p>0時に寝て4時に起きた。5時前には家を出た。初日だけは早起きして新幹線乗らないといけないので緊張する。新神戸6時10分発が始発になる。始発に乗った方が混雑もしていない。9時過ぎにはお手伝い先のオフィスについて業務を始められた。移動に約3時間。早起きは三文の徳みたいな話。</p><h2 id=フルリモートワーク>フルリモートワーク</h2><p>朝一でオフィスに着いたものの、チームのメンバーの1人はお休み、2人は在宅勤務、上長は出張だったので私が一人だけオフィスワークしてた。普段は私がフルリモートワークなのでうちのチームはリモートワークの働き方が容易になるように業務を設計している。私がオフィスにいようが、普通にリモートワークするのはある意味で自然な働き方とも言える。周りのチームの人に「あっ、いたんですね」とか声を掛けられながら1人で黙々とお仕事してた。</p><h2 id=全国旅行支援--ただいま東京プラス>全国旅行支援 + ただいま東京プラス</h2><p>今回の出張は全国旅行支援で宿泊費が40%オフになっていて、且つ <a href=https://ryokoshientokyo.jp/>ただいま東京プラス</a> という取り組みで3000円/日のクーポン券が付いていた。
<a href=https://region-pay.com/>region PAY</a> というアプリにクーポンを登録して QR コード決済で対応店舗で買いものできる。すべてのお店が対応しているわけではないが、普通に周りの飲食店やコンビニなどでも使えた。ちょっとよい晩ご飯の定食を食べて、帰りにコンビニで飲みものを買って帰るぐらいの贅沢ができる。至れり尽くせり。</p><h2 id=競輪選手というキャリア>競輪選手というキャリア</h2><p>ホテルでたまたまテレビをつけたらやっていておもしろかった。競輪オタクが競輪選手になったらめっちゃ強くて無双している、どこかのラノベみたいな話し。競輪という競技を私はあまりよく知らなかった。なぜこんなことができるかというと、競輪というスポーツは純粋な体力や身体能力で勝敗が決まらないらしい。試合展開の駆け引きがあって最後に勝敗が決まる。競輪オタクはすべての選手のプレースタイルを記憶していて、個々の選手の戦術を予測して対策できるから勝てるのだという。</p><ul><li><a href=https://post.tv-asahi.co.jp/post-202706/>競技経験ゼロ！28歳の「脱サラ競輪選手」。“オタク知識”をフル活用してまさかの快進撃</a></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1127/>出張前夜</a></h1><div class=post-meta><span class=post-date>2022-11-27</span></div><span class=post-tags>#<a href=/diary/tags/agriculture/>agriculture</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/day-off/>day off</a>&nbsp;</span><div class=post-content><p>0時に寝て6時前に起きた。昨日は夜にサッカーの試合をみながら寝た。早朝から田んぼ作業やって、慌てて戻ってイベント行って、バテバテで夕方はやや熱が出て寝込んでた。</p><h2 id=玉ねぎを植える準備>玉ねぎを植える準備</h2><p>昨日の続き。6時から田んぼへ行ける状態ではあったけど、まだ外が暗かったので7時から始めることに。畝を軽く耕して草をひき、苗を植えるための筋を作って、玉ねぎの苗を植えていく。途中から近所の手伝ってくれている方も参加して3人で作業をしていた。玉ねぎの苗を引く人、苗植えのために畝を耕す人、玉ねぎの苗を植えていく人といった役割分担。お昼休憩を含めて私は13時半まで手伝って神戸へ戻ることに。</p><p>草をひいたり玉ねぎの苗を植えたりするのに中腰で立ったり座ったりを繰り返す。筋トレに例えるとスクワット運動を何度も繰り返しているのに近い。太ももが筋肉痛になった。</p><h2 id=ホームパーティー>ホームパーティー</h2><p>13時50分に実家を出て15時頃に三ノ宮に戻る。ガソリンを満タンにしてレンタカーを返すのに10分ほどかかった。高速道路を降りて近くのガソリンスタンドへ行くルートを開拓しないといけない。一旦家に戻ってから三ノ宮.dev のホームパーティーイベントがあるというので行ってきた。13時からやっていたが、私は実家に戻ってたので16時前ぐらいから参加した。どういうイベントかまったく理解してなかった。いつもとは違う場所を借りてもくもく会みたいなのをやるのかと考えていたら普通にゲームしたり雑談したりするイベントだった。だからホームパーティーという名前なのかと行ってみて理解した。<a href=https://www.instabase.jp/space/5027865478>LienSpace</a> という部屋貸しのレンタルスペースを借りて行われた。普通にマンションの一室を借りるような感じ。 3000円/時で4時間借りてたみたい。私が行ってから軽く雑談して人生ゲームやってそれでお開きになった。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1126/>レンタカーを借りて実家に帰る</a></h1><div class=post-meta><span class=post-date>2022-11-26</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/agriculture/>agriculture</a>&nbsp;
#<a href=/diary/tags/day-off/>day off</a>&nbsp;</span><div class=post-content><p>2時過ぎに寝て7時に起きた。昨日の夜は洗濯と晩ご飯食べるために早めに帰って家事をやった後にオフィス戻って1時半ぐらいまで作業してた。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前152cmで、ストレッチ後156cmだった。先週に引き続き調子はあまりよくない。右股関節の詰まりと右太ももの張りがかなりある。今週も先週と変わらないぐらい座っている時間が長かったのでなんとなく結果は推測できた。来週は出張するから歩く機会が増えて逆に運動不足解消になってよい結果につながったりはしないだろうか。</p><h2 id=レンタカー>レンタカー</h2><p><a href=/diary/posts/2022/1121/#母の入院>母の脳梗塞疑いの検査入院</a> もあり週末に一度帰った方がよいだろうということでレンタカーを借りた。いつもコンパクトというカテゴリで借りると TOYOTA VITZ か <a href=https://www.honda.co.jp/Fit/>HONDA FIT</a> になることが多い。FIT は2-3回目なのでだいぶ車の雰囲気にも慣れてきた。今度から FIT 指名でいいかもしれないと思うぐらいには気に入ってきた。</p><h3 id=神戸市内から垂水パーキングエリア>神戸市内から垂水パーキングエリア</h3><p>三ノ宮から垂水ジャンクション近くのパーキングエリアまで30分ほど。このパーキングエリアにはたるみ食堂という普通のパーキングエリアよりもちょっと豪華な雰囲気がするものが食べられる。一番人気とあったのでジャンボチキンカツ定食を食べた。おいしかったし、量も多かったので890円ならコストパフォーマンスはよかった。一方でお腹いっぱいになってこんなにたくさん食べなくてもよかったとも思えたので今度は別のものを頼んでみたい。たるみ食堂の隣にセブンイレブンがあってちょっとだけお土産も置いてあるけど、ここでは神戸のお土産はあまり選べないことに気付いた。ご飯を食べるところやね。</p><figure><img src=/diary/img/2022/1126_tarumi-restaurant.jpg></figure><h3 id=垂水パーキングエリアから淡路サービスエリア>垂水パーキングエリアから淡路サービスエリア</h3><p>垂水パーキングエリアから20分ほど。サービスエリア内のお土産は9割淡路島のお土産でちょっとだけ神戸、大阪、京都のお土産もある。姉にお土産を買って帰らないといけない。ここにはスタバがあって、スタバのケーキがよいという。昔からあったみたいけど、あまり意識してみたことがなかった。たしかに淡路サービスエリアにスターバックスがあり、明石大橋を眺めながらコーヒーできるよい立地にあることに気付いた。初めて入ってみてケーキとドーナツをお土産に購入した。</p><figure><img src=/diary/img/2022/1126_awaji-sa.jpg></figure><h3 id=淡路サービスエリアから実家>淡路サービスエリアから実家</h3><p>淡路サービスエリアから高速道路も空いていてがんがん飛ばして実家まで40分ほど。自分で運転して帰るとあちこち寄り道できるし、たまに車の運転してストレス解消にもなるし、高速バスよりも速いし、お金がかかること以外はそれなりに楽しかった。まだまだ車を買う経済的な余裕はないけど、いつか車買って気軽にドライブに出掛けるような生活がしたい。</p><h2 id=玉ねぎを植える準備>玉ねぎを植える準備</h2><p>帰ったら母が田んぼで作業してたからそのまま手伝うことに。肥料をまいて名前の知らない農具で玉ねぎを植える畝を耕す。雨で田んぼがぬかるんでいて作業しにくかった。昔は田んぼいっぱい玉ねぎを植えていた。いまはちょっと食べるぐらいしか植えないのでほんの数個の畝を耕すだけ。</p><p><figure><img src=/diary/img/2022/1126_field1.jpg></figure><figure><img src=/diary/img/2022/1126_field2.jpg></figure></p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1125/>キックオフのマイルストーン</a></h1><div class=post-meta><span class=post-date>2022-11-25</span></div><span class=post-tags>#<a href=/diary/tags/project-management/>project management</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=post-content><p>2時に寝て5時に起きて7時に起きた。いろいろ余裕ない。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。</p><ul><li>フロントエンド勉強会のアウトラインの摺り合わせ</li><li><a href=/diary/posts/2022/1119/#ふりかえりとワークショップの定義からコミュニティ作りのなにか>ふりかえりワークショップの記事の共有</a></li></ul><p>フロントエンドの開発は monorepo が主流といった話題になって本来の monorepo はビッグテックが全社レベルで展開している巨大リポジトリのことを指していたんじゃないかという話しになった。どちらが正しいという話しでもない気はするけど、プロダクトやサービスレベルの monorepo と開発者が数万人いるような会社で開発しているものを1つのリポジトリにすべて管理する monorepo では、議論していて噛み合わないと確認した。どちらも monorepo と呼ぶからどちらかの名前を変えるべきなのかもしれない。そう言えば facebook が自社のソースコード管理システムを oss で公開していたニュースを最近みかけていた。</p><ul><li><a href=https://engineering.fb.com/2022/11/15/open-source/sapling-source-control-scalable/>Sapling: Source control that’s user-friendly and scalable</a></li></ul><h2 id=11月のマイルストーンをほぼ終えた>11月のマイルストーンをほぼ終えた</h2><p>開発スケジュールの期間を表す単位を次の3つの用語で管理する。</p><ul><li>1週間を1つのイテレーション</li><li>4イテレーションを1つのマイルストーン</li><li>マイルストーンを複数集めたものを1つのロードマップ</li></ul><p>11月のマイルストーンの締め切り日を11月29日としている。あと月曜日だけなので11月のマイルストーンをほぼ終えたと言える。このマイルストーンの目的は要件定義を確定させることに置いていた。というのは、開発体制が大きく変わり、新規参加者が私も含めて3人いる。前任者からの引き継ぎ、開発対象の再定義など、曖昧な要件の部分を私がすべて洗い出して初期の開発目標の言語化を狙いとしていた。概ね狙い通りには進捗して可もなく不可もなくという認識。プロジェクトのキックオフの初月としては十分とみなすこともできる。</p><p>開発メンバーが課題管理システム (gitlab) に慣れていて、私の指示や意図をすぐに把握して行動してくれているので課題管理はとてもやりやすい。前月に手伝っていた sier の開発者とは格段にレベルが違う。大雑把に言えば、開発メンバーが優秀だからちゃんとマネジメントすれば成果を出せる見通しが立っている。</p><h2 id=go-test-comments-の学び直し>Go Test Comments の学び直し</h2><p><a href=/diary/posts/2022/1110/#go-code-review-comments-の学び直し>Go Code Review Comments の勉強会</a> を前半・後半の2週にわけて読み終えたのでその次に <a href=https://github.com/golang/go/wiki/TestComments>Go Test Comments</a> を読んだ。ちょうど <a href=/diary/posts/2022/1123/>Gopher塾のテスト会</a> に参加した後だったのもあり、書いてある内容のいくつかは重複していて、記憶に新しかった。開発メンバーがいま書いている単体テストに有効なアドバイスもいくつかあって参考にになったように思う。wiki に書いてあることにすべて従う必要はないものの、簡単にできて役に立ちそうなものはどんどん導入すればよいと私は考えている。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1124/>マーケティングと炎上</a></h1><div class=post-meta><span class=post-date>2022-11-24</span></div><span class=post-tags>#<a href=/diary/tags/sns/>sns</a>&nbsp;
#<a href=/diary/tags/marketing/>marketing</a>&nbsp;
#<a href=/diary/tags/management/>management</a>&nbsp;
#<a href=/diary/tags/failure/>failure</a>&nbsp;</span><div class=post-content><p>0時に寝て6時半に起きた。夜にコードを書こうと思いながらネットで遊びながら寝てしまった。今日は echo 移行のコードを書いていてレビューしてもらったりしていた。11月入ってから業務中に数時間コードを書いたのは初めてかもしれない。</p><h2 id=あるサービスの社長とマーケティングと承認欲求と>あるサービスの社長とマーケティングと承認欲求と</h2><p>昨日たまたまタイムラインであるサービスを退会したというツィートをみかけて、なんかあったんやろかと調べたら note の記事が原因だとすぐにわかった。私が読んですぐ思ったことは次の曖昧な姿勢でこれはまた物議を醸しそうだと思えた。</p><ul><li>事実はどうだったのかの結論が曖昧</li><li>事件はなかったと明確に書いているのに相手と示談したという矛盾</li><li>自社の当該社員に落ち度があったという矛盾</li></ul><p>被害の有無について私はまったく知らないし関心もないが、虚偽なら虚偽と書けばいい。内容からなんらかの被害はあったようにも受け取れるため、被害者への配慮がまったくないことに懸念を感じた。いかなる背景や理由があろうと、被害を被った人がいる場合にその内容について書く文章はただ事実と謝罪のみである。過去の謝罪会見などで言い訳して余計に非難を浴びる事例はたくさんある。当事者としてできることは謝罪することしかない。これがまず鉄則。当該記事にはその姿勢がまったくみられなかったために炎上に至ったのではないかと思う。</p><p>リスク管理の専門家とも相談していてなぜこんなことが起きるのか。sns 慣れからの承認欲求もいくらかあると思うが、社長として「世間の耳目を集めるネタ」を入手したと思ってしまったのではないか。コンテンツを作るにはネタが必要でそうそう毎日おもしろいネタなどない。今回の事件は滅多に起きる事件ではなく、マーケティング的におもしろいネタになるとそのサービスの社長は考えたのではないかと推測する。リスク管理の裏側を語っていて、その在り方にクレームをつけている人たちもいる。私からみたら会社なんてそんなもんという内容でしかない。しかし、それを公けにすることで被害者が傷つかないかというのをまず第一に考えるべきである。もしこの被害者のインシデントが虚偽であればまったく問題ない。しかし、そうではないにも関わらず、会社のリスク管理の詳細を被害者が読んでどう思うかという配慮がまったくなかった。私からみて嬉々として詳細を書いてしまい、会社の危機に陥っているようにみえる。</p><p>おそらく社長個人の人柄や性格は悪くないのだと思う。自分の会社や身内を守ることのみに頭がいっぱいになってしまった結果、被害者への配慮という視点が抜け落ちてしまったのではないかと思える。私自身、そう在れるかどうかはともかく、経営者として客観的な視野をもって日々の業務の判断を下すように努めている。自社の損得ではなく論理的に考えて落とし所はここだろうという、私なりの論理最適解を顧客に提案するようにしている。このインシデントは社長が自分たちの会社のことしか考えなかったから発生したもので経営者の姿勢を問う事例の1つであると私は考えている。この状況からその会社がどういった顛末になるのか、今後の動向もみていきたい。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1123/>go の学び直し テスト編</a></h1><div class=post-meta><span class=post-date>2022-11-23</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/testing/>testing</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて気分悪くて寝付けずにだらだらしながら気付いたら5時になっていた。その後いつの間にか寝て8時に起きた。</p><h2 id=go-の学び直し>go の学び直し</h2><p><a href=https://tenntenn.connpass.com/event/265342/>Gopher塾 #1 - Testing - DAY 3</a> に参加した。</p><p>マネージャーとして go 開発のマネジメントをしているため、メンバーの開発者よりは知識やスキルが高くないとコードレビューや適切な指示ができない。2018年ぐらいまで go 開発をしていたが、その後はずっと java 開発をしていたため、最近の go 開発の話題はあまり把握していない。毎週チーム勉強会 (いまのところ、go 開発の話題) をやっていると、チーム外からも開発者が参加してくれるようになった。チーム外からの開発者が go 開発するときの参考にもなるよう、マネージャーのお仕事の付加価値として、組織全体へ go 開発の知識やスキルを提供できればと考えながら働いている。</p><p>今回はテストについて話題で7割ぐらいは知っている知識ではあったが、3割ぐらいは最近の話題や静的解析の知見からの深い洞察を話されていてとても参考になった。知っている知識でも幅広いテストの話題の中で厳選されたコンテンツになるのだろうから本質的に大事なことや最初に学ぶべき優先事項を知ることもできた。私がメンバーに教えるときのコンテンツの参考として役に立つ。まったく知らなかった話題としては、txtar というテキストをアーカイブしたフォーマットをファイルシステムとして扱えるようにした <a href=https://github.com/josharian/txtarfs>txtarfs</a> や、1.18 から追加された <a href=https://go.dev/security/fuzz/>fuzzing</a> というテストの入力値を自動生成する機能が追加されたこと。あと groovy でいうところの power assert に近い機能を提供するライブラリとして <a href=https://github.com/google/go-cmp>google/go-cmp</a> をいまはテストに使うらしい。たまたま <a href=https://github.com/golang/go/wiki/TestComments#equality-comparison-and-diffs>Go Test Comments</a> を読んでいたら go-cmp は go の開発チームが保守していて go のバージョンに依らずほとんどの比較の要件にあうツールのように説明されていて利用を推奨している。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1122/>元同僚の来訪</a></h1><div class=post-meta><span class=post-date>2022-11-22</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;
#<a href=/diary/tags/kobe/>kobe</a>&nbsp;</span><div class=post-content><p>0時に寝て4時に起きてドラクエタクトしてだらだらして7時に起きた。</p><h2 id=echo-を採用>echo を採用</h2><p>昨日の続き。echo か chi でそれぞれサンプルコードを書いたものを定例でメンバーに説明して echo に決まった。echo は知っているメンバーもいたけど、chi は知らなかったみたい。アプリケーションに近いせいか echo の方が認知度が高いみたい。既存コードの移行は私がちゃちゃとやろうと着手したものの、わりとコードが込み入っていて2-3時間でできるものでもなかった。環境変数周りの処理も dry の原則に違反していたので <a href=https://github.com/caarlos0/env>caarlos0/env</a> を使うことにした。エントリーポイント周りのコードをリファクタリングして merge request を作成した。明日中には既存の http ハンドラー周りの移行をしてレビューができるようにしておきたい。</p><h2 id=遠方より来たる>遠方より来たる</h2><p>たまたまタイムラインで元同僚が近くに来るというのをみかけてせっかくの機会なので晩ご飯を食べに行ってきた。大阪に泊まっているのにわざわざ神戸まで足を運んでくれた。感謝。ゲームのコミュニティに属していると私は思っていたのだけど、最近はゲームよりも vr の世界の住人らしくて、vr の世界のコミュニティに入り浸っているらしい。そんな生活を何年もしているうちに仲間うちで仲良くなって、たまにオフ会で会ったりもするとのこと。全国に vr の世界の仲間がいるから出張したときにオフ会したりするそうな。oculus quest 2 をもっているけど workrooms ぐらいしか使ってなくて、若い人はもっと進んでいるなと感心をもって聞いていた。</p><p>内製のデータベースのプロダクトが完成して社内でも使ってもらう運用段階まできたとのこと。データベースをフルスクラッチから3年かけて開発できるだけの余裕のある会社は少ないだろう。本人もいくつか社内・社外の事情が重なってプロジェクトが中止にならず運がよかったと話されていた。開発の区切りもついたので今後のキャリアや転職も含めていろいろ考える時期になっているみたい。まだ30歳前後だと思うのでいろいろ挑戦したらよいと思う。</p><p>帰りに三ノ宮の街並みも少し紹介した。三宮という地名は他にも一宮から八宮まであって <a href=https://www.shoko-dw.com/shrine8/index.html>神戸八社</a> と言う。間違えて九まであると言ってしまった。八までだった。2021年に <a href=https://ja.wikipedia.org/wiki/%E7%A5%9E%E6%88%B8%E4%B8%89%E5%AE%AE%E9%98%AA%E6%80%A5%E3%83%93%E3%83%AB>神戸三宮阪急ビル</a> が完成して阪急三宮駅の周辺が再整備された。夜歩きしても楽しめる雰囲気にはなっている。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1121/>http フレームワークの選び方</a></h1><div class=post-meta><span class=post-date>2022-11-21</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;</span><div class=post-content><p>昨夜いろいろあって帰ってくるのが0時過ぎになった。23時過ぎから雨降りで雨の中、自転車で帰ってきた。2時に寝て5時に起きて7時半に起きた。危うく寝坊するところだった。</p><h2 id=母の入院>母の入院</h2><p>昨夜のいろいろのすべて。最悪の事態を想定してお手伝い先にも今日休むかも？と昨日の夜時点で一報を入れていた。結論としては休む必要はなかった。「ろれつが回らない」という連絡を受けて姉が救急車で病院へいくことを指示して即検査で即入院した。母は過去に目がみえなくなって脳梗塞だったことがある。幸い一通り検査して問題はなかったものの、念のために2日間入院して明日退院する予定。姉に病院の付き添いとかいろいろやってもらったので、私も週末に帰って様子をみてくる。お仕事が立て込んでてんやわんやだけど、そのために神戸で自分の会社をやっているのもあるので仕方ない。母は車を運転しない方がよいだろうという見立てで週末にレンタカーも借りた。久しぶりに高速バスではなく、高速道路をドライブしながら実家へ帰る。</p><h2 id=echo-と-chi-でサンプルコードを書いてみた>echo と chi でサンプルコードを書いてみた</h2><p><a href=/diary/posts/2022/1117/#go-の-http-フレームワークの選定>go の http フレームワークの選定</a> の続き。明日、定例があるのでメンバーにソースコードを共有しつつ、http フレームワークの採用を決めようと考えている。特定のルーティングとミドルウェアの適用をする簡単なサンプル。</p><ul><li><a href=https://gitlab.com/t2y/echo-sample>https://gitlab.com/t2y/echo-sample</a></li><li><a href=https://gitlab.com/t2y/chi-sample>https://gitlab.com/t2y/chi-sample</a></li></ul><p>net/http のレイヤーであれこれカスタマイズしたいなら <a href=https://github.com/go-chi/chi>chi</a> でよい気もするけど、web api のアプリケーションのレイヤーにのみ注力したいなら <a href=https://echo.labstack.com/>echo</a> を使った方が楽そうという私の第一印象。web api サーバーを書いてて request のパラメーターを扱うことはあっても response writer を扱う必要性をあまり感じたことがない。json しか返さないのだし、構造体を返したら勝手に json に変換してくれたらそれでいいんじゃないかと私は考えている。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1120/>寝ることとお仕事の選び方</a></h1><div class=post-meta><span class=post-date>2022-11-20</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=post-content><p>20時過ぎに寝て0時に起きて、何度か寝たり起きたりしながら7時に起きた。<a href=https://kobe-marathon.net/2022/>神戸マラソン</a> のスタート地点が近所なので朝から神戸マラソンのアナウンスが聞こえてきた。</p><h2 id=睡眠時間と仕事始め>睡眠時間と仕事始め</h2><p><a href=https://note.com/goto_finance/membership>後藤達也 note</a> の掲示板 (たぶんメンバーしかみれない) に後藤さんがいつ寝ているのかという質問への回答を書かれていた。</p><blockquote><p>よくある睡眠パターンは21:30ごろ～4:30とかだと思います。これだと7時間寝ているので十分です。</p></blockquote><p>後藤さんも早寝早起き派らしい。私はだいたい0-6時が平均的なパターンだと思うけど、ちゃんと眠れないので6時間も寝ていない。体調の悪いときは横になっているものの1-2時間しか寝ていないときもある。7時半までには家を出てオフィスに向かい8時までにはお仕事を始める。開発が佳境に入ってきて集中力が上がっていれば仕事始めが6時半から7時ぐらいになる。開発のピークにそういう時期をもっていくように調整しながら働くときもある。最近は働き方改革でそういった密度の高い開発を要求されることも少なくはなりつつあるけど。</p><h2 id=仕事を受ける判断>仕事を受ける判断</h2><p>後藤さんはすごいなーと読んでいたら睡眠時間の投稿が思いの外盛り上がったらしく、第2段として仕事の選び方について投稿されていた。</p><blockquote><p>そのなかで仕事を受ける判断として大事にしているのが、「発見があるか」「広がりがあるか」です。</p></blockquote><p>これも私にとって共感のある内容でその投稿を読み入ってしまった。これまでも日記のあちこちに断片的には書いてきている。私も2021年1月31日に会社として引き受けないお仕事の基準を設けた。次の項目に該当したら基本的に引き受けない。</p><ul><li>自分の目指すキャリアの延長上にない</li><li>自分がもっている知識や経験だけでできる</li><li>すでにあるものを維持していく、手伝うだけ</li><li>そこそこの開発メンバーがいて人手が足りないのを補うだけ</li><li>権限委譲がなくてイニシアティブを取れない</li></ul><p>どういうお仕事を受けて、どういう働き方をするかを課題管理し、その後も継続的にずっと考えていてまだ答えは出ていない。もう2-3年かければより明確になりそうな気はしている。やりたいことよりもやりたくないことを定義する方がずっと簡単で具体的と言える。</p><h2 id=jira-の-epic-運用にもの思い>jira の epic 運用にもの思い</h2><p>jira に特化した話だけど、チケットの整理をしていて自分の中での結論を言語化できたので書いてみる。前からずっと思っていたことではある。twitter に書いた通りだけど、epic のサブタスクはあまり使わない運用がよいのではないかと思うようになった。そもそも epic という単位が story よりも大きな機能のグルーピングを表す概念なのだから epic チケットはシステム上の制約で存在しているだけでそれを通常のチケットのように扱わなくてもよいのではないかと思う。epic に限らず、チケットを束ねるだけのハブチケットまたは親チケットに通常のチケット機能を設けない方がユーザーにとってわかりやすいようにも考えている。ハブチケットや親チケットに特化した要件や振る舞いはあるはずで、多くの課題管理システムはそれを追求していないようにもみえる。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>epic の子課題は新機能や改善の種別のみにしてしまう。複数チケットに分割が想定される調査タスクなどの子課題は「○○を研究する」ように新機能や改善に置き換える。epic のサブタスクは階層化を必要としない単発のタスクのみに限定して使う、もしくは一切使わない運用にする。</p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1594185795589795840?ref_src=twsrc%5Etfw">November 20, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1119/>ふりかえりの目的とワークショップ</a></h1><div class=post-meta><span class=post-date>2022-11-19</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;
#<a href=/diary/tags/workshop/>workshop</a>&nbsp;
#<a href=/diary/tags/community/>community</a>&nbsp;</span><div class=post-content><p>早めに帰ってきて晩ご飯を食べてからまたオフィスに戻って作業して2時に寝て7時半に起きた。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前153cmで、ストレッチ後155cmだった。先週よりは体力的に回復しているものの、今週も多忙で椅子に座っている時間が長かったので数値が悪くなっているのかもしれない。基本的には、お仕事が忙しい = 座っている時間が長い = 同じ姿勢の状態を維持する = 筋肉が固まったり運動不足に陥るという理屈で体調が悪化する。今週はなぜか右太ももの前あたりの張りが強かった。逆に腰や全身の負担は軽減したように感じた。開脚幅の数値はよくないものの、先週よりは復調しているような感触。実際のところはまだよくわからない。</p><h2 id=ふりかえりとワークショップの定義からコミュニティ作りのなにか>ふりかえりとワークショップの定義からコミュニティ作りのなにか</h2><p>書籍同様、タイムラインなどでみかけた記事を後で読もうと積ん読しておくときがある。次の記事もおそらく公開時期にみかけて気付いたら積ん読のまま1ヶ月が経過していたのを精読してみた。</p><ul><li><a href=https://research.sakura.ad.jp/2022/10/21/workshop/>価値発見に焦点化した振り返りワークショップの意義と、その教育学的分析</a></li></ul><p>読み始めて、いくつかもの思いにふけりつつ、そこから派生して他の作業もしながら戻ってまた読み進めて、この記事を読むのに5時間かかった。そのぐらい私にとっては示唆のある読み応えのある記事だった。書いてあることのいくつかの点が他の事柄に繋がっていて、その点と線を確認しながら読み進めたので時間がかかってしまった。よくぞこの記事をブックマークしただけで流さなかったと過去の自分に感心したぐらいにはよい記事だった。ワークショップという言葉はよく聞く言葉ではないし、グループワークをする小さいセミナーのイメージを私はもっていた。教育学の分野の研究者によると次のような定義があるらしい。</p><blockquote><p>ワークショップとは</p><ul><li>講義など一方的な知識伝達のスタイルではなく、参加者が自ら参加・体験して共同で何かを学びあったり創り出したりする学びと創造のスタイル (中野民夫, 2001)</li><li>コミュニティ形成 (仲間づくり) のための他者理解と合意形成のエクササイズ (練習) (仮宿俊文, 2017)</li></ul></blockquote><p>ちょうど課題管理の文脈でふりかえりをどう設計しようかを考えていたときにこの記事を読んだ。ふりかえりの目的を多義的に捉えるという発想そのものが私にはなかったのでそういった目的も含め、ふりかえりを実践していければよいのではないかと、自分の中にももともと燻っていた火種を見事に言語化してくれて示唆に富む記事だと感じた。</p><ul><li>既存の業務に対する課題や改善の洗い出し (一般的なふりかえりの目的)</li><li>チームのメンバーとコラボレーションする上で他者の考え方や意見を理解するきっかけの1つにする</li><li>エージェンシーは自分一人では育まれず、同僚や上司、チームや組織との関係性の中で育まれる</li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1118/>新しいお仕事で3週間</a></h1><div class=post-meta><span class=post-date>2022-11-18</span></div><span class=post-tags>#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;</span><div class=post-content><p>2時に寝て4時に起きて仮眠して6時半に起きた。たぶん寝たんだろうぐらいの感覚。10月まで対外的には週4日で働いていたのを、11月から週5日フルタイムの働き方に移行して、やっぱりしんどいという実感がある。対外的に週4日でも10月もオフィスに来て自社のお仕事をしていたり、半日ぐらいは社外のお仕事をしたりはしていた。それでも働く義務の有無によって、意識の違いか、プレッシャーやストレスの面からなにか働き方が違うように思える。生活も働き方もまったく同じなのに。</p><h2 id=盛り上がってないイベント>盛り上がってないイベント</h2><p><a href="https://twitter.com/hashtag/techverse_ja?src=hashtag_click&f=live">ハッシュタグ</a> をみてもほとんど関係者や発表者しかコメントしていないようにみえた。過去に新規事業の立ち上げに協力したプロジェクトの発表があると元同僚のタイムラインで知ったのでその発表だけみてみた。私が辞めてから3年ほど経つので新規サービスも追加されていてその内容がメインだったように思う。</p><ul><li><a href=https://tech-verse.me/ja/sessions/133>DataSolution事業を支える技術</a></li></ul><iframe class=speakerdeck-iframe frameborder=0 src=https://speakerdeck.com/player/86cb588632a647e9baf4697c8f79110e title="Technologies that Support the Data Solution Business" allowfullscreen mozallowfullscreen=true webkitallowfullscreen=true style="border:0;background:padding-box padding-box rgba(0,0,0,.1);margin:0;padding:0;border-radius:6px;box-shadow:rgba(0,0,0,.2)0 5px 40px;width:560px;height:314px" data-ratio=1.78343949044586></iframe><p>あまり技術的な内容ではなく、ビジネス向けでもなく、どういった属性の聴衆向けの発表なのか、私にはあまりピンとこなかった。発表の準備不足な印象を受けた。発表を無理やり押し付けられたのかもしれない。</p><h2 id=go-の-time-型とタイムゾーン>go の Time 型とタイムゾーン</h2><p>go の <a href=https://pkg.go.dev/time#Time>Time</a> 型は <a href=https://pkg.go.dev/time#Location>Location</a> をもっていて、タイムゾーンも一緒に扱える。モダンな言語なら時刻を扱うときにタイムゾーンをセットで扱うのでよいと私も思う。タイムゾーンをもっていない時刻型とタイムゾーンを設定するための余分なコードのことを考えずに済む。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;time&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>mustGetJST</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Location</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>jst</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>LoadLocation</span>(<span style=color:#e6db74>&#34;Asia/Tokyo&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>jst</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>now</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;now:&#34;</span>, <span style=color:#a6e22e>now</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;jst:&#34;</span>, <span style=color:#a6e22e>now</span>.<span style=color:#a6e22e>In</span>(<span style=color:#a6e22e>mustGetJST</span>()))
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;utc:&#34;</span>, <span style=color:#a6e22e>now</span>.<span style=color:#a6e22e>UTC</span>())
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>実行結果。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>$ export TZ<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;CET&#34;</span>
</span></span><span style=display:flex><span>$ go run test_time_now.go
</span></span><span style=display:flex><span>now: 2022-11-18 17:00:30.08305121 +0100 CET m<span style=color:#f92672>=</span>+0.000011788
</span></span><span style=display:flex><span>jst: 2022-11-19 01:00:30.08305121 +0900 JST
</span></span><span style=display:flex><span>utc: 2022-11-18 16:00:30.08305121 +0000 UTC
</span></span></code></pre></div></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1117/>技術選定の根拠</a></h1><div class=post-meta><span class=post-date>2022-11-17</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/programming/>programming</a>&nbsp;</span><div class=post-content><p>0時に寝て5時に起きた。夜中に目覚めたかどうかはわからないぐらいにはたぶん寝てたと思う。</p><h2 id=go-の-http-フレームワークの選定>go の http フレームワークの選定</h2><p>net/http で実装していた web api サーバーにフレームワーク導入しようかと考えている。いままでは認証・認可を外部で行う想定だったが、やっぱり api サーバーに実装した方がよいだろうと要件を再確認したので routing と middleware を再利用できるフレームワークを使うメリットが出てくる。net/http 上で直接 routing, middleware を実装するのは別に難しくないから自分で実装すればよいという考え方がある。一方で誰が実装しても大して変わらないものを車輪の再発明する必要があるのかというところに私は懸念に感じる。また <a href=https://pkg.go.dev/context>context</a> があとから標準ライブラリに追加されたため、net/http の HandlerFunc は context をシグネチャにもっていない。リクエストコンテキストをもっていないのが net/http の欠点だと私は考えていた。しかし、調べてたら <a href=https://pkg.go.dev/net/http#NewRequestWithContext>NewRequestWithContext</a> が追加されていてハンドラーではなくリクエストからリクエストコンテキストを扱えるようになっていた。これは私の勘違いだった。</p><p>フレームワークを使おうと決めて難しいのはなにを選ぶか。最近の流行り廃りや動向を私は知らないので基準がない。たまたましぶかわさんの記事をみつけて読んでいた。</p><ul><li><a href=https://future-architect.github.io/articles/20210714a/>Goのおすすめのフレームワークはnet/http</a></li></ul><p>この中で紹介されている <a href=https://github.com/go-chi/chi>chi</a> か <a href=https://echo.labstack.com/>echo</a> のどちらかにしようと直観で決めた。echo は以前 go の勉強会をしたときにいけうちさんが採用していたのでよく覚えている。そのときの話しを聞いていてもよさそうにみえた。たまたま echo のサイトをみたら Shiguredo さんのロゴがあって驚いた。スポンサーをされているらしい。chi はまったく知らない。どちらも十分によく使われていて middleware も揃っているフレームワークにみえる。本質的にはどちらを選んでも構わない。一方でマネージャーとしてどういう調査をして、どういう根拠で、どの技術を選定するのか。メンバーに対して説明責任を果たすためにこの2つのフレームワークの調査をすることに決めた。私自身がどちらもフレームワークも使ったことがないので軽くコードも書いてみてどんな雰囲気なのか感触を掴みつつ、フレームワークのソースコードも読んでみようと思う。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1116/>デジタルノマドへの関心</a></h1><div class=post-meta><span class=post-date>2022-11-16</span></div><span class=post-tags>#<a href=/diary/tags/mermaid/>mermaid</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/community/>community</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>0時に寝て2時に起きて6時に起きた。いまは眠れる状態に落ち着きつつある。</p><h2 id=pandoc-と-mermaid-charts-の扱い>pandoc と mermaid charts の扱い</h2><p>markdown のドキュメントに <a href=https://mermaid-js.github.io/mermaid/#/>mermaid</a> で図を描く機会が増えてきた。markdown を pdf に変換するツールがあって内部的に pandoc を使っている。そのツールで pdf 変換してみたら mermaid 記法がそのままテキストで出力されたので変換するときに図に置き換えられないかを調べてみた。例えば、次のようにして markdown から html に変換できる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pandoc mydoc.md -f gfm -o mydoc.html
</span></span></code></pre></div><p>次のように mermaid 記法がそのまま出力される。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;pre</span> <span style=color:#a6e22e>class=</span><span style=color:#e6db74>&#34;mermaid&#34;</span><span style=color:#f92672>&gt;&lt;code&gt;</span>flowchart TB
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>subgraph cr [Container Registry]
</span></span><span style=display:flex><span>  repo[repository]
</span></span><span style=display:flex><span>end
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>mermaid を cli ツールとして <a href=https://github.com/mermaid-js/mermaid-cli>mermaid-cli</a> がある。markdown を直接渡しても mermaid のコードブロックを検出して画像変換してくれる。複数あってもよい。これはちょっと驚いた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone git@github.com:mermaid-js/mermaid-cli.git
</span></span><span style=display:flex><span>$ cd mermaid-cli
</span></span><span style=display:flex><span>$ yarn add @mermaid-js/mermaid-cli
</span></span><span style=display:flex><span>$ npx mmdc --version
</span></span><span style=display:flex><span>9.1.7
</span></span><span style=display:flex><span>$ npx mmdc -i mydoc.md -o mydiagram.png
</span></span><span style=display:flex><span>Found <span style=color:#ae81ff>2</span> mermaid charts in Markdown input
</span></span><span style=display:flex><span> ✅ ./mydiagram-1.png
</span></span><span style=display:flex><span> ✅ ./mydiagram-2.png
</span></span></code></pre></div><p>cli でできるなら何とでもなるんじゃないかともう少し調べていたら次の gist をみつけた。</p><ul><li><a href=https://gist.github.com/letientai299/2c974b4f5e7b05be52d369ff8693c29a>Render PDF from Markdonw that using mermaid</a></li></ul><p><a href=https://pandoc.org/filters.html>pandoc filters</a> という仕組みがあって、pandoc の ast を操作するためのインターフェースを提供している。その仕組みを使って mermaid の変換を行う <a href=https://github.com/raghur/mermaid-filter>mermaid-filter</a> を誰かが作ってくれていた。このツールをインストールして次のように pandoc を実行すると base64 でエンコードした画像を使って html に変換できた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ npm i -g mermaid-filter
</span></span><span style=display:flex><span>$ pandoc mydoc.md -F mermaid-filter -f gfm -o mydoc.html
</span></span><span style=display:flex><span>$ vi mydoc.html
</span></span><span style=display:flex><span>&lt;p&gt;システム構成図&lt;/p&gt;
</span></span><span style=display:flex><span>&lt;p&gt;&lt;img src<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;data:image/png;base64,iVBORw0KGgoAAAANSU...EnAAAAAElFTkSuQmCC&#34;</span> alt<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span> /&gt;&lt;/p&gt;
</span></span></code></pre></div><p>mermaid-cli を使うか mermaid-filter を使うかは要件や好みにもよるけど、すでにツールがあるので組み合わせれば何とかできそうというところまで確認した。</p><h2 id=コワーキングのオンラインイベント>コワーキングのオンラインイベント</h2><p>月例のカフーツさんのオンラインイベントに参加した。<a href=/diary/posts/2022/1029/#コワーキングのオンラインイベント>先月の所感はここ</a> 。いとうさんが岩手県普代村のコワーキングスペースに行ってきてそのお話しから始まった。私はまだ岩手県に行ったことすらないんやけど、めっちゃ田舎の、断崖絶壁の眺めのよい高台にある国民宿舎にコワーキングスペースがあるらしい。</p><ul><li><a href=https://note.com/kanzan10to9/n/n7802c47b1174>人口2500人弱の村でコワーキング運営の研修をしてきた〜ローカルコワーキングこそ地方創生の鍵〜</a></li></ul><p>研修の講師として、いとうさんは呼ばれてワークショップをしたらしい。参加者が付箋に課題を書き出してグループワークするといった作業に不慣れで、グループ内で話しはしているものの、あまり付箋に書いてくれなかったとかぼやいていた。<a href=https://www.soumu.go.jp/main_sosiki/jichi_gyousei/c-gyousei/02gyosei08_03000066.html>地域おこし協力隊</a> として19歳の隊員が参加者にいたらしい。19歳で地域おこし協力隊になれるの？といとうさんが驚いていた。どうやら年齢は自治体の募集要項次第らしく、たまたま普代村の要項が18歳以上で自治体もまさかそんな若い人がくるとは思ってなかったと19歳の隊員が活躍していたという。若いから頭の回転も速いし活発でワークショップもてきぱきとこなしていたらしい。</p><p>先月のお仕事探しでマネージャー実績のない私を雇う会社はほぼないという現実に直面した。いまのお仕事を終えた後で、地域おこし協力隊の要件を私が満たすなら課題管理を実践する場として行ってみてもいいかもしれないなと話しを聞いていて少し思った。ソフトウェア開発に特化した課題管理しかできないというスコープの狭さが私のスキルの欠点でもある。仮に地域おこし協力隊としてなにかに役立てられるなら、そのスコープをさらに広げられる可能性も出てくる。</p><p>それから次の記事の話題に移っていった。<a href=https://nomadlist.com/>Nomad List</a> というデジタルノマド向けポータル兼 sns のようなサイトを紹介してくれた。</p><ul><li><a href=https://workmill.jp/jp/webzine/future-coworking-20221108/>世界のデジタルノマドが集まるサイトはホスピタリティに満ちている　テクノロジーとヒトが持ち寄る情報の力</a></li></ul><p>試しに <a href=https://nomadlist.com/kobe>kobe</a> のスコアをみてみる。現時点のランキングは1182位と低い。日本はこの2年ほどコロナ禍で鎖国していたからノマドを受け入れてないのでどの都市もランキングは下がっているらしい。ざっとみてスコアがよくないのは次の項目。神戸に住んでいる私の感覚とも合致しているのでこのスコアは一定の信頼ができると思う。神戸の大半のお店は21時までには閉まるし、スタートアップ企業なんか数えるほどしかいない。とはいえ、全体としてはスコアは良好だし世界に誇れる都市の1つとしてデジタルノマドを受け入れる器はあると思う。</p><ul><li>Cost</li><li>Vulnerability to climate change</li><li>English speaking</li><li>Nightlife</li><li>Free WiFi in city</li><li>Startup Score</li></ul><figure><img src=/diary/img/2022/1116_nomadlist-kobe.png></figure><p>あと <a href=https://livinganywherecommons.com/base/mima/>徳島県美馬市脇町</a> の町興しのようなコワーキングやデジタルノマド向けの取り組みの話しがあって関心をもって聞いていた。徳島県なら実家から近い。こんな場所あったんやと聞いていた。このサイトで紹介されているのどけやさんというゲストハウスはいつ行っても外国人がいるといとうさんが話されていた。そう言われると本当なんやろか？と確かめに行きたくなる。たぶん実家から車で1時間もあれば行けそうな気がする。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1115/>課題の洗い出し</a></h1><div class=post-meta><span class=post-date>2022-11-15</span></div><span class=post-tags>#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;
#<a href=/diary/tags/management/>management</a>&nbsp;</span><div class=post-content><p>20時に寝て0時に起きて、3時に起きて6時に起きた。春先のような、なぜかたくさん眠れる状態になった。</p><h2 id=ソースコードを読むマネージャー>ソースコードを読むマネージャー</h2><p>アリエルをやめてから複数の組織で働いてきたけれど、以降ソースコードを読むマネージャーを1人もみたことがない。アリエルなんか cto が日々の開発のソースコードを読んでいたぐらいなのに。もしかしたらテックリードというマネジメントはしないが、開発のリーダー役のポジションができたせいかもしれない。そしてエンジニアリングマネージャーがソースコードを読んでいるのも見たことがない。いま私はプロダクト開発のマネージャーとしてお手伝いしているわけだけど、毎日変わるソースコードを読みながら、私が懸念に思ったコードについて issue 登録したり、技術的な課題であれば改善提案したりしている。もし開発リソースが足りそうになければ、私も開発に参戦しようと虎視眈々と狙っているのもある。</p><p>まだ初期開発フェーズなので粗いところが多々あるから読みがいがある (提案しやすい) というのもあるかもしれない。ソースコードも読めない (読まない) マネージャーが開発の進捗を正しく検査できると私は考えていない。その姿勢でプロジェクトマネジメントがどのように進捗して、どのような結果になるのか、これから私が実践して自分なりの考えをまとめたい。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1114/>久しぶりに go のテストコードを書いた</a></h1><div class=post-meta><span class=post-date>2022-11-14</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/testing/>testing</a>&nbsp;</span><div class=post-content><p>0時に寝て3時と5時に起きて7時に起きた。まぁまぁ眠れたと思う。</p><h2 id=go-のテストコードのサンプル>go のテストコードのサンプル</h2><p>先日 <a href=/diary/posts/2022/1111/#Logger-の再実装>Logger のコード</a> を書いて、テストコードのサンプルも書いてみた。いま微妙に <a href=https://github.com/golang/go/wiki/TableDrivenTests>TableDrivenTests</a> が書けてないので参照実装として Logger のデータ駆動テストを書いてチームに共有した。私も future さんのテストのチュートリアル記事を読みながら復習してた。</p><ul><li><a href=https://future-architect.github.io/articles/20200601/>Goのテストに入門してみよう！</a></li></ul><p>昔、私が go 開発していた頃にはなかった新機能としてサブテストを並列に実行できる。</p><ul><li><a href=https://pkg.go.dev/testing#hdr-Subtests_and_Sub_benchmarks>Subtests and Sub-benchmarks</a></li></ul><h2 id=uuid-ライブラリの歴史的経緯>uuid ライブラリの歴史的経緯</h2><p>たまたま Version 1 UUID を返す <a href=https://pkg.go.dev/github.com/google/UUID#NewUUID>NewUUID</a> のコードをみていて、err を返しているけど、現時点の実装では err が返ることはなく、これは歴史的経緯でシグネチャを変える方が影響が大きいだろうという意図でそうなっているらしい。</p><ul><li><a href=https://github.com/google/uuid/issues/83>https://github.com/google/uuid/issues/83</a></li></ul><p>ここでは <a href=https://pkg.go.dev/github.com/google/UUID#New>New</a> を使えとも書いてあるけれど、これはエラーが発生したときに panic が発生するのでこれはこれでいいんやろか？という疑問も出てくる。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1113/>ftx 事件</a></h1><div class=post-meta><span class=post-date>2022-11-13</span></div><span class=post-tags>#<a href=/diary/tags/cryptocurrency/>cryptocurrency</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/web3/>web3</a>&nbsp;</span><div class=post-content><p>眠くて19時には帰ってきて、20時ぐらいには寝て、夜に何度か起きても寝て、9時まで寝ていた。疲労過多でなんもやる気しない。</p><h2 id=ftx-破産事件>ftx 破産事件</h2><p>金曜日ぐらいから大きな事件のようにタイムラインで話題になっていたので経済や金融の勉強の1つとして事件の成り行きを調べていた。いくつかニュース記事を読んだ。直近の数日間の時系列をまとめたものが次の記事になる。</p><ul><li><a href="https://coinpost.jp/?p=406333">仮想通貨市場に激震、アラメダショックとFTX騒動の動向まとめ</a></li></ul><p>過去の経緯や人間関係がわりと複雑らしいので時間がない人は次のフィクションを読んで雰囲気を理解するとよさそう。あくまでフィクション。</p><ul><li><a href=https://note.com/shinjiro_tigers/n/nf7f11fa7989b>猿でも分かる？　FTX破産騒動</a></li></ul><p>twitter のタイムラインでもいろいろみつかる。数億円もの暗号資産をすべて ftx に置いていて資産を失った人。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>Now on public. 公開します<br>All gone 全て逝きました <a href=https://t.co/iQBaLo19ud>pic.twitter.com/iQBaLo19ud</a></p>&mdash; 全資産FTX (@Daniel58656357) <a href="https://twitter.com/Daniel58656357/status/1591414911179325440?ref_src=twsrc%5Etfw">November 12, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>今後の暗号資産や web3 界隈の資金繰りを心配する人。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>もっと正直に言うと↓<br><br>今引所、何とかプロダクト、何とかNFT関係、何とかDAO、何とかWeb3で務めてる方々へ：あなたが務めている会社（組織）の資金ぐりは今後急速に悪化します。その時に打つ手はあなたをクビにするしかない。だったら早めに転職の準備をしても１つの手、するかどうかは別としても。</p>&mdash; Sonny Wang｜INBグループ (@LinksSonny) <a href="https://twitter.com/LinksSonny/status/1591384722105864194?ref_src=twsrc%5Etfw">November 12, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>破産申請された内容から負債総額は100億ドルから500億ドル (1.4超円から7超円) の間とされていて、リーマンショックの負債総額は約6,000億ドル（約64兆円）だったことから規模はその10分の1ぐらい。また取引所にある顧客資産を流用していたことが発覚していることから、これはポンジ・スキームに近いものらしく、会社ぐるみで不正をしていたエンロンショックに近い詐欺事件として当局の調査もこれから行われていくらしい。今後、不正の手口なども明らかになっていくのだろうから経営や財務の勉強材料にする。</p><p>現時点で私が ftx 破産事件から学んだことはこれら。どのぐらい経済の影響を与えるのか、まだよくわからないのでしばらく注視していく。</p><ul><li>姉妹会社であるアラメダリサーチ社の資産の大半が ftx トレーディング社が発行するトークン (ftx token) で構成 (25%) されていた<ul><li>他の資産も流動性の低いトークンで構成されていて売却時のコストを考慮すると資産の評価は適切ではない懸念が指摘された暴露記事が騒動の発端</li><li>現金及び現金等価物は20億ドルしかなかった</li></ul></li><li>取引所が発行するトークンを、取引所同士で大量に持ち合いして価値の下支えをしている<ul><li>こういったトークンは流動性がないことから、大量保有者が売ると大幅に価値が下落する</li><li>ftx トレーディング社は自分たちで発行したトークンでグループ企業の資産価値を過剰に高くみせていた</li></ul></li><li>ftx トレーディング社の社長 (Sam Bankman-Fried) は経理システムにバックドアを作っていて顧客資産を流用していた<ul><li>破産申請の前夜にそのバックドアが使われて100億ドルの顧客資金が社長の投資会社に移され、そのうちの10億ドルから20億ドルの行方が分からなくなっている<ul><li>誰が何のためにバックドアを利用して資金移動したのかはまだ調査中</li></ul></li></ul></li><li>1つの取引所にすべての暗号資産を置かないこと</li><li>取引所に暗号資産をずっと置きっぱなしにしないこと</li><li>暗号資産はまったく安全ではないこと<ul><li>取引所という脆弱性、普通に盗難されるし、不正されるし、破産したら資産を失う</li></ul></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1112/>go の nil を学び直し</a></h1><div class=post-meta><span class=post-date>2022-11-12</span></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;</span><div class=post-content><p>3時半から起きていたせいか夕方に眠くなって19時過ぎから23時まで寝て、それからまたオフィス行って4時ぐらいまで作業してから戻って寝て8時半に起きた。生活がめちゃくちゃ。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前154cmで、ストレッチ後158cmだった。生活が不規則になって体力的にバテているのもあって右股関節、右腰の張りが強かった。さらに加えてふくらはぎ、腕と全身的にいつもより張りがあるように感じた。トレーナーさんが言うには座っている時間がいつもの週より多かったならその分だけ筋肉が固まってしまう可能性はあるとのこと。先週の東京出張から帰ってきて、リモート環境の構築、macbook 環境でメモをとった内容の見直し、リモートワークでマネージャー業をやるための準備や足りない知識の習得とか、さらに2つの社外イベントにも参加していたので普段の週よりも長い時間を机に向かって作業していたのは正しい。新しいお仕事を受けると一時的に仕事量の負荷が増える。それ自体は悪いことではないけれど、2-3ヶ月は余裕のない生活になりそうな気がする。毎週ストレッチがあるとそういった過労の疲労軽減に役立ってくれているので助かっている。</p><h2 id=オンライン読書会>オンライン読書会</h2><p>ずっと参加しようと思いつつ、都合があわなくて参加できていなかった <a href=https://technical-book-reading-2.connpass.com/event/262819/>第4回『Go言語による分散サービス』オンライン読書会</a> に4回目にして初参加した。7.4 発見されたサービスにリクエストし、ログをレプリケーションする (130ページ) から 8.2.3 有限ステートマシーン (163ページ) まで読んだ。途中からなので過去の経緯はわからないものの、柴田さんが詳しく解説してくれるのでまったくついていけないということはならなかった。出てくるサンプルコードのスニペットからでも学ぶことは多々ある。effective java 読書会に参加してた人だと柴田さんに覚えていてもらっていて嬉しかった。おそらく参加者の記録を自前で管理されているようにみえた。</p><p>go でインターフェースを実装しているかを確認するイディオムとして次のような宣言がある。nil を任意の struct のポインタにキャストするのを試す。変数は _ を宣言しているので実際にはこのコードはなにも定義しない。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>_</span> <span style=color:#a6e22e>mypkg</span>.<span style=color:#a6e22e>MyInterface</span> = (<span style=color:#f92672>*</span><span style=color:#a6e22e>MyImplements</span>)(<span style=color:#66d9ef>nil</span>)
</span></span></code></pre></div><p>なぜこんなことができるのかは <a href=https://text.baldanders.info/golang/nil-is-nil/>nil は nil</a> という記事で解説されている。interface 型は型への参照と値への参照を属性にもつオブジェクトであり、そのゼロ値は nil である。interface 型の nil は型への参照をもっているから nil をキャストするといったコードを書ける。python や java のような言語で nil に相当する None や null といった primitive はキャストするといった概念はない。事実上のシングルトンと言ってよいはず。一方で go の nil は原則として型への参照 nil 且つ、値への参照も nil なものではあるが、interface 型のゼロ値を表すため、この例で言えば、型への参照として mypkg.MyInterface 且つ、値への参照が nil のオブジェクトを生成できる。シングルトンではない。つまり <code>(*MyImplements)(nil) != nil</code> となる。go の nil は他言語からみて特殊ということを知ってはいたんだけど、読書会に出てそのことを確認するサンプルコードをみつけたことで私の学び直しになった。感謝。</p><p>ソースコードはここに置いた。</p><ul><li><a href=https://gitlab.com/t2y/misc/-/tree/main/implements>https://gitlab.com/t2y/misc/-/tree/main/implements</a></li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1111/>ログおじさん</a></h1><div class=post-meta><span class=post-date>2022-11-11</span></div><span class=post-tags>#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;
#<a href=/diary/tags/mermaid/>mermaid</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/logging/>logging</a>&nbsp;</span><div class=post-content><p>23時に寝て3時半に起きて眠れそうになかったからそのまま5時からオフィスで作業してた。</p><h2 id=システム構成の検討>システム構成の検討</h2><p>コンサルタントから顧客要件のヒアリングを行い、プロダクトを提供するインフラのシステム概要を mermaid で書いた。オンプレとクラウド環境のそれぞれを同じコンテナアプリケーションで動かすための構成を検討した。クラウド環境の一例として aws の構成を考えていて、https と http のプロトコル変換のようなことをするには api gateway を経由しないといけないと考えていたら、alb に証明書を設定して api gateway なくてもいけるとはらさんに教えてもらった。昔からできたそうで、なぜか私が長い間ずっと勘違いしていた。また時間があるときに自分でもやってみようと思う。</p><ul><li><a href=https://dev.classmethod.jp/articles/for-begginer-ssl-communication-by-aws-certificate-manager/>AWS Certificate Managerを使用してインターネットからELBへの通信をHTTPS化してみた</a></li></ul><h2 id=logger-の再実装>Logger の再実装</h2><p>プロダクトのコアな部分の実装は私がみた方がよいだろうと考えていて、そのうちの1つ Logger の設計がよくなかったので私が作り直した。といっても <a href=https://github.com/cybozu-go/log>cybozu-go/log</a> を使った薄いラッパーを設けただけ。チームメンバーからどこでエラーが起きているか追跡しにくいという声があったのでログ出力したところのソースコードの情報を出力しようと考えた。ググればたくさん出てくる。スタックフレームにアクセスする標準パッケージとして runtime を使うとできる。<a href=https://pkg.go.dev/runtime#Caller>runtime.Caller</a> と runtime.Callers は似て非なる関数のようでファイル名と行番号だけでよければ Caller を使った方がシンプルになると思う。関数名もほしかったら Callers を使ったスタックフレーム自体から取得する必要がある。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>Trace</span>(<span style=color:#a6e22e>skip</span> <span style=color:#66d9ef>int</span>) (<span style=color:#a6e22e>file</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>funcName</span> <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>pc</span> <span style=color:#f92672>:=</span> make([]<span style=color:#66d9ef>uintptr</span>, <span style=color:#ae81ff>15</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>n</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>Callers</span>(<span style=color:#a6e22e>skip</span>, <span style=color:#a6e22e>pc</span>)
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frames</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>runtime</span>.<span style=color:#a6e22e>CallersFrames</span>(<span style=color:#a6e22e>pc</span>[:<span style=color:#a6e22e>n</span>])
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>frame</span>, <span style=color:#a6e22e>_</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>frames</span>.<span style=color:#a6e22e>Next</span>()
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>_file</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>frame</span>.<span style=color:#a6e22e>File</span>[<span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>Index</span>(<span style=color:#a6e22e>frame</span>.<span style=color:#a6e22e>File</span>, <span style=color:#a6e22e>sourceRepositoryPath</span>)<span style=color:#f92672>+</span><span style=color:#ae81ff>8</span>:]
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>file</span> = <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s:%d&#34;</span>, <span style=color:#a6e22e>_file</span>, <span style=color:#a6e22e>frame</span>.<span style=color:#a6e22e>Line</span>)
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>file</span>, <span style=color:#a6e22e>frame</span>.<span style=color:#a6e22e>Function</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>この情報を cybozu-go/log の map に追加するようなログ関数を提供するようにした。cybozu-go/log は標準の log パッケージに足りないところだけを追加していて、そのシンプルさと拡張性の高さを私は気に入ってよく使っている。私が気に入っているのでもっと有名になってほしい。</p><p>前のお手伝いでもログ基盤を含めて Logger を作っていて、またいまも Logger を作り直していて、気付いたら私は Logger やログ出力に一家言あるような、ログおじさんになりつつある。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1110/>よい go コードを書くためのガイド</a></h1><div class=post-meta><span class=post-date>2022-11-10</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/programming/>programming</a>&nbsp;</span><div class=post-content><p>2時に寝て6時に起きて2度寝したら8時だった。生活リズムがおかしい。</p><h2 id=go-code-review-comments-の学び直し>Go Code Review Comments の学び直し</h2><p>私の周りでは <a href=https://github.com/golang/go/wiki/CodeReviewComments>Go Code Review Comments</a> というドキュメントが引用されているのをよくみかける。google 社での go のコードレビューのときによくある指摘をまとめたものである。pr/mr を送る前にこれぐらいは自分でチェックしようといったガイドになる。私自身、過去に何度か読んでいるとは思うが、久しぶりに go 開発をするので学び直しも兼ねて読み直すことにした。うちのチームは java 開発者が多いせいか、go のコードで go っぽくないところがいくつか散見されていた。チームメンバーにも共有する意図も含めて2回にわけて勉強会をしてみんなで読み合わせをする。その下調べとして既存のコードでこのガイドに準拠していないコードがあればそれはわかりやすい事例になるので探したりしていた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1109/>軽量のコンテナオーケストレーションツールは存在しない</a></h1><div class=post-meta><span class=post-date>2022-11-09</span></div><span class=post-tags>#<a href=/diary/tags/docker/>docker</a>&nbsp;
#<a href=/diary/tags/kubernetes/>kubernetes</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>0時に寝て6時に起きた。冷蔵庫に飲みものなくて不安。</p><h2 id=docker-の-swarm-mode>docker の swarm mode</h2><p>昨日から docker の <a href=https://docs.docker.com/engine/swarm/>swarm mode</a> について調べていた。</p><p>オンプレにコンテナのアプリケーションをデプロイするにあたり、軽量のコンテナオーケストレーションツールはないかと調べ始めた。<a href=https://www.portainer.io/blog/orchestrator-wars-continue>Kubernetes vs Docker Swarm vs Nomad - the orchestrator wars continue?</a> を記事を読むと、軽量のオーケストレーションツールと言えるのは swarm mode か <a href=https://www.nomadproject.io/>Nomad</a> ぐらいしかない。docker に付属しているならまずはそれを調べるべきだろうと調査した。そして swarm mode の採用は見送った。現時点でこの機能が廃止されるというアナウンスはないが、あまり保守されておらず、docker 社も積極的に推進していない。近い将来、機能が廃止される可能性が高いと私は判断した。</p><p>docker のドキュメントをみながら3台の ec2 インスタンスでクラスターを構築してみて簡単であることは間違いない。コマンド2つで swarm クラスターを構築できる。一通り触ってみて数台のマシンを管理する軽量のコンテナオーケストレーションツールとしては十分だと私は思うけれど、残念ながらこのツールが求められる業務やビジネスは少ないのだろうと思う。みんな k8s に持ってかれたという感じかな。調べていて読んだ記事など。</p><ul><li><a href=https://dockerswarm.rocks/>Docker Swarm Rocks</a></li><li><a href=https://levelup.gitconnected.com/six-tips-for-running-swarm-cluster-in-production-e0f2ef367694>Six Tips For Running Swarm Cluster in Production</a></li><li><a href=https://www.reddit.com/r/docker/comments/936924/docker_swarm_in_production_anyone_using_it/>Docker swarm in production - Anyone using it?</a></li></ul><h2 id=hannali-dao-雑談>hannali dao 雑談</h2><p><a href=https://hannari-python.connpass.com/event/265098/>Hannali DAO #02</a> に参加した。</p><p>最初は dao とは何かをみんなで雑談してた。私はお仕事しながら軽く聞いているつもりだったのが、議論に口出しして熱中してた。技術的に私が理解できないことが出てくると、私の認識が誤っていたり新しい気付きがあったりする可能性があるので、ついつい詳細を聞いてみたくなる。hannali dao でトークンをばら撒く戦略をみんなで考えていて dao の宣伝をしたら貢献の1つとみなしてトークンをもらえる。私は twitter でいくつか hannali dao のツィートをしていて、1ツィートが 300 PROG とかで、合計で 1250 PROG のトークンをもらった。PROG というのは hannali dao でのみ使えるトークンね。</p><p>その後、ウォレットに名前を付けられる <a href=https://ens.domains/ja/>ENS (Ethereum Name Service)</a> というサービスがあるのを教えてもらった。ちょうどいくらか ethereum をもってたので metamask に送金して、metamask で ens の登録 (購入) をやってみた。初めて ethereum を使ってサービスの支払いをやってみた。これで私も web3 を完全に理解したよ。ens で名前を登録 (購入) するのに $22.58 、ドメイン名みたいなものでサブドメインも登録できる。サブドメインを付けるのに $2.96 かかり、その ens を metamask に紐付けるのに $7.49 がかかった。metamask に紐付けると <a href=https://etherscan.io/>https://etherscan.io/</a> などで検索したときにウォレットのアドレスではなく、ens で購入した名前が表示されるようになる。トランザクションの履歴に名前が付いてそれが誰なのかが他人にもわかってしまうことがどういった影響を及ぼすのか、プライバシー云々の他に私はまだわかっていない。web3 なので購入した名前は一般公開されているものだけど、その名前は知り合いにしかまだ教えていない。暗号資産のウォレットに名前を付けることの意味や体験などをこれから経験してみる。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1108/>設計談義</a></h1><div class=post-meta><span class=post-date>2022-11-08</span></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;</span><div class=post-content><p>0時に寝て6時に起きた。2時と3時ぐらいに起きたけど、まぁまぁ眠れた。</p><h2 id=go-の-interface-の考え方>go の interface の考え方</h2><p>メンバーと設計の議論をしていて interface の考え方の概念を誤解しているように感じたので <a href=https://github.com/golang/go/wiki/CodeReviewComments#interfaces>Go Code Review Comments の interfaces</a> で書いてあることの意図や背景などを解説した。メンバー全員を集めて30分ほどで説明した。既存のコードは過剰に interface を設計していて、特定のメソッドを呼び出すラッパー関数を設けて、そのシグネチャに interface を受け取って構造体のメソッドを呼び出すコードを書いている。こんな感じのコード。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>myBehavior</span> <span style=color:#66d9ef>interface</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>doSome</span>(<span style=color:#a6e22e>data</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>myObject</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>  <span style=color:#a6e22e>myBehavior</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>o</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>myObject</span>) <span style=color:#a6e22e>doSome</span>(<span style=color:#a6e22e>data</span> <span style=color:#66d9ef>string</span>) {
</span></span><span style=display:flex><span>  <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleSome</span>(<span style=color:#a6e22e>o</span> <span style=color:#a6e22e>myBehavior</span>, <span style=color:#a6e22e>data</span> <span style=color:#66d9ef>string</span>) <span style=color:#66d9ef>error</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>o</span>.<span style=color:#a6e22e>doSome</span>(<span style=color:#a6e22e>data</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>handleSome のようなラッパー関数は不要だし、myObject の構造体に interface を埋め込む必要はないし、Go Code Review Comments では構造体を定義しているところで interface を提供しない方が保守コストが下がってよいよと提案している。これは java のような nominal subtyping と go の structural subtyping の違いで go らしい interface は構造体の提供側ではなく、呼び出し側で勝手に定義して任意の振る舞いを強制できるといった内容を java と go のコードを比較しながら説明した。そして、この話しが重要になるのはサードパーティのライブラリを利用するときに interface が変わると、それを使っている開発者に大きな影響を与えるので interface を提供するなら慎重に練ったものを公開しないといけないという java 開発から得られた知見などが影響しているのではないかという私見も話した。さらに自分たちが管理しているコードなら interface が変わろうが struct のメソッドが変わろうが、すべて自分たちが変更できる権限をもっているから設計時に厳密に interface やメソッドの振る舞いを詰めきれなかったとしても、後から必要ならいつでもいくらでも変えればいいだけと一緒に話した。開発のバランス感覚は経験からでないと身に付かないものだと思う。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1107/>まずは定例会議から言語化する</a></h1><div class=post-meta><span class=post-date>2022-11-07</span></div><span class=post-tags>#<a href=/diary/tags/mermaid/>mermaid</a>&nbsp;
#<a href=/diary/tags/management/>management</a>&nbsp;</span><div class=post-content><p>23時ぐらいに寝て2回ぐらい起きて7時に起きた。やっぱり家だとうまく眠れない。</p><h2 id=mermaid-の-er-図>mermaid の er 図</h2><p>メンバーが mermaid の <a href="https://mermaid-js.github.io/mermaid/#/entityRelationshipDiagram?id=entity-relationship-diagrams">Entity Relationship Diagrams</a> でデータモデルの図を書いてくれてレビューしてた。見た目もすっきりしていて、テキストも書きやすい方だと思うので印象はよかった。gitlab でもリポジトリや wiki で mermaid で書いた図を表示できた。</p><h2 id=定例会議の進め方>定例会議の進め方</h2><p>マネージャーっぽいお仕事の1つとして定例会議を週に1回行う。スクラムにあるデイリースクラムのような、毎日メンバー全員を集める会議するのが私は好みではない。そんなことしなくても定例会議が週1で 1on1 が週1回ならば5日のうち2回は話すし、あと個別の打ち合わせも1-2回やれば十分に話す機会を得られると考えている。定例会議の進め方というドキュメントを一通り書いてみた。私が忘れたときに見返したり、実際にやってみてよかったこと・わるかったことを振り返りながら改善するための、基準として設けた。基準があるから改善できる。最初の1-2ヶ月ぐらいはうまく成果がでなくて悩むことも想定しつつ、過去に書いたドキュメントがそういうときの拠り所になる場合もある。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1106/>メンタリングの学び直し</a></h1><div class=post-meta><span class=post-date>2022-11-06</span></div><span class=post-tags>#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;</span><div class=post-content><p>5時過ぎに寝て10時に起きた。出張で生活のリズムが狂ったまま。</p><h2 id=2-1-メンタリングで相手の思考をリファクタリング>2-1. メンタリングで相手の思考をリファクタリング</h2><p><a href=https://gihyo.jp/book/2018/978-4-7741-9605-3>エンジニアリング組織論への招待</a> のメンタリングの技術の章を読み直すことにした。3年前ぐらいに読んだのであまり覚えてない。私は管理職ではなかったし、若い人に口であれこれ言うのもハラスメントになる懸念から私の働き方をみて役に立つところを盗んでもらえればよいと考えていた。これまでメンタリングには関心がなかった。しかし、いまマネージャーとしての役割で臨む以上は最低限の基礎は抑えた上で取り組む必要があると考え方を改めた。今日は「2-1. メンタリングで相手の思考をリファクタリング」を読んだ。節を簡潔に要約してみる。</p><blockquote><p>メンタリングとは、対話を通じて、思考の幅を広げ、その人の歪んだ認知を補正し、次の行動を促し、成長させる手法である。スキルなので誰でも習得できる。自ら問題を発見し解決することができる <strong>自立型人材</strong> を作るために、信頼関係の上に正のフィードバックループから <strong>自己効力感 (self-efficiency)</strong> を与えられるように働きかける。次の条件を満たさないとメンターの言葉でメンティの行動を自ら変えるようにはならない。</p><ul><li>謙虚: お互いに弱さをみせられる</li><li>経緯: お互いに敬意をもっている</li><li>信頼: お互いにメンティ (自身) の成長期待をもっている</li></ul><p>自らいままでわからなかったことを理解した状況を <strong>自己説得</strong> と呼ぶ。他人が質問で促し、体験を伴い、行動の変化が発生しやすい。メンティが自己説得できる状態になるようメンターは対話で気付きを与えないといけない。悩むと考えるは違う。悩んでいるときは思考がぐるぐると巡り、もやもやした状態。非常に苦しい上に生産的でもない。一方で考えているときはメモ帳やホワイトボードなどに課題を書き出し、分解したり、抽象化したり、具体化したり、、、何かしら行動をとっている状態。次にとるべき行動がはっきりしていれば悩むことはない。メンティが行動できているかどうかを観察し、悩んでいるようならその背景を聞き出して、気付きを与えて考えている状態へ変えていく必要がある。</p></blockquote><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前154cmで、ストレッチ後159cmだった。東京出張であちこちガタがきていて全身に張りがあったように思う。生活や睡眠が不規則になったことによる疲労もそのままストレッチの窮屈さにつながっているように感じた。毎週ストレッチの機会があって本当に助かっている。ストレッチをした後は体が軽くなって疲労を軽減できているように思う。これまでたまにマッサージへ行って対応していたのが、毎週チェックして手入れできていることの価値がこういうときによくわかるようになってきた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1105/>フロントエンドの技術選定</a></h1><div class=post-meta><span class=post-date>2022-11-05</span></div><span class=post-tags>#<a href=/diary/tags/react/>react</a>&nbsp;
#<a href=/diary/tags/vue.js/>vue.js</a>&nbsp;
#<a href=/diary/tags/svelte/>svelte</a>&nbsp;</span><div class=post-content><p>24時に BOOK AND BED TOKYO にチェックインして雑多なことして25時過ぎには寝て8時過ぎに起きてチェックアウトした。それから新幹線に乗って神戸まで戻ってきた。東京・品川から新神戸間は、往路は <a href=/diary/posts/2022/1031/#東京出張>EX早特21ワイド</a> だと12,630円で、復路は自由席で14,420円だった。私の中で時間の制約はストレスやエネルギーを使う。帰りは時間に縛られたくないという思いで新幹線の駅に着いてから自由席を買うようにしている。一方で2千円近い差額も大きいので次回以降は帰りの新幹線もEX早特21ワイドで取ることにした。</p><h2 id=フロントエンドの調査>フロントエンドの調査</h2><p>昼過ぎに家に戻ってきて洗濯や片付けしたら疲れてまた寝てた。晩ご飯食べて21時ぐらいからオフィスで作業してた。猫みたいな生活。オフィスからお手伝い先のネットワーク接続の設定をやったりしながらフロントエンドのコードを読んでみた。これは作り直した方がよいだろうと私の中で決意して、どういった技術で作り直すかの技術選定のための調査を開始した。既存のフロントエンド開発の背景や経緯を知らないのでまだ確定ではない。提案の準備のために調査をしておく。</p><p>ここ最近 <a href=https://svelte.dev/>svelte</a> の人気があるのをみかける。1年ほど前に三ノ宮.devで教えてもらってチュートリアルをやってみて、そのときは特にどうとも思わなくて、こんなやり方もあるんやな程度にみていた。その後 vue.js (nuxtjs) での開発を半年間ほど経験して、思いの外、私にとって vue.js がよいものにはみえなかった。react よりも簡単と聞いていたけど、私にとってはあまりそうは思えなかった。vue.js は vue.js なりの難しさ (学習コスト) があるように感じられた。管理画面のような小規模な用途に react や vue.js のようなリッチなライブラリ・フレームワークを使わなくてよい方法があるかを考えたときに svelte を思い出した。svelte の実際のアプリケーションのサンプルコードとして次のコードを読んでいた。</p><ul><li><a href=https://github.com/sveltejs/realworld>svelte realworld example</a></li></ul><p>vue.js の single-file components は svelte の前身である <a href=https://github.com/ractivejs/component-spec>ractive.js のコンポーネント</a> の概念に影響を受けているという。従って、svelte のコンポーネント開発は vue.js と考え方が近いものの、dom 操作は svelte のコンパイル時にコード生成するので仮想 dom は使わない。これがパフォーマンス上の大きなメリットと言われている。react や vue.js よりもずっと軽量なコンパイラ・フレームワークと言える。次のページに複数のフロントエンドの技術の流行をまとめている。svelte はこの2年ぐらいで人気が急上昇していることがわかる。</p><ul><li><a href=https://gist.github.com/tkrotoff/b1caa4c3a185629299ec234d2314e190>Front-end frameworks popularity (React, Vue, Angular and Svelte)</a></li></ul><p>また react と vue.js の現状もちゃんと把握しようと調べていて次の記事がおもしろかった。</p><ul><li><a href=https://zenn.dev/sa2knight/articles/why_react_folks_dont_choose_vue>[Twitter] React ユーザーが Vue を選ばない理由</a></li></ul><p>vue.js は vue3 で react になろうとしていて、その過程の過渡期には様々な問題を抱えているように私からはみえた。</p><ul><li>vue2 と vue3 は互換性がない</li><li>vue3 移行へのエコシステムの本気度がみえない</li><li>vue2 の開発者が本当に vue3 を求めているのか懐疑的</li><li>シェアだけみたら vue.js よりも react の方が高い</li></ul></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1104/>出張の最終日</a></h1><div class=post-meta><span class=post-date>2022-11-04</span></div><span class=post-tags>#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;</span>
<img src=/diary/img/2022/1104_book-and-bed1.jpg class=post-cover alt=出張の最終日><div class=post-content><p>0時に寝て7時に起きた。疲れているせいか、よく眠れたと思う。わりと出張でよく眠れているので普段眠れていなかったのは体力が余っているからではないかという気もしてきた。</p><h2 id=課題の洗い出し>課題の洗い出し</h2><p>一昨日の続きでわかっていることや進捗のあったものを確認しながら、追加で課題を作って整理していく。まだまだ課題が足りないのでどんどん作っていかないといけない。それと同時に go のソースコードを読みながら設計や改善の要点を私の中で把握していく。java に慣れたプログラマーが書いた go のコードなので java の考え方の影響が強いようにみえた。私がいくつかアドバイスする余地はあるようにみえた。google でコードレビュー時によくある指摘事項をまとめた有名な wiki がある。メンバーに聞いたらちゃんと読んだことがないということだったので2-3回かけてみんなで読んで学ぶ機会にする。私自身、数年前に読んで忘れていていることも多いだろうから学び直し。テストのページは2019年9月に追加されている。たぶん読んだことない。</p><ul><li><a href=https://github.com/golang/go/wiki/CodeReviewComments>https://github.com/golang/go/wiki/CodeReviewComments</a></li><li><a href=https://github.com/golang/go/wiki/TestComments>https://github.com/golang/go/wiki/TestComments</a></li></ul><h2 id=課題管理勉強会>課題管理勉強会</h2><p>1時間分ぐらいの資料を用意したつもりが35分で終わってしまった。勉強会の雰囲気が固かったのか、慣れない場所での説明だったのか、マスクした状態で長々と話すことも過去に一度もやったことなくて話しにくかった。初めての試みであまりうまくいかなかったが、初めてやることでうまくいかないのは私にとって当たり前のことなので次の勉強会に向けて改善していきたい。どのぐらい伝わったのかわからないけれど、もっと参加者を巻き込んだ活気のある勉強会になるように努めていきたい。</p><h2 id=リアル飲み会>リアル飲み会</h2><p>19時から3年ぶりに友だちとリアル飲み会。せっかく東京に行く機会だからと5日のうち3日飲んでいたので後半になるほどバテていった。これは加齢による体力低下もあるのだろう。娯楽はどういうものか？という定義や在り方の議論が盛り上がって、私は暇つぶしの時間であって何もしないのでぼーっとしているのも退屈だからその時間を埋めるもの、楽しければいいけど楽しくなくても、どうせ何もしない時間なのであまり気にしないといった考え方をしている。私の友だちは楽しむために娯楽に集中するとか、その時間を無駄にしないようになるべく楽しめる娯楽を選択するとか、24時間のうち、1時間足りとも無駄な時間にはしないぞという姿勢がみえて、私からみたらそんな生活はしんどくないですか？みたいな気持ちになった。おそらく時間を無駄にしたことがストレスになるからそういう姿勢になるのだろうと推測する。娯楽をしながらだらだら時間を過ごすということはないらしい。オンライン飲み会はちょくちょくしていたものの、3年ぶりにオフ会をしたので飲食代をご馳走になった。感謝。前も会社を作った後の飲み会でご馳走になっていて、なかなか私からお返しできていない。それを覚えておくためにもここに書いておく。</p><h2 id=本棚に埋もれて眠る>本棚に埋もれて眠る</h2><p>この日は <a href=https://bookandbedtokyo.com/ja/shinjuku/>新宿 BOOK AND BED TOKYO</a> に泊まった。前に浅草の同施設に泊まったことはあったけれど新宿は初めて。大雑把に言えば本屋とカプセルホテルが合体したような施設になる。この非日常の雰囲気が好きなので機会があれば泊まるようにしている。宿泊費は6,000円とカプセルホテルより高くビジネスホテルより安いという価格帯。ここに来て本を読んだり泊まったりしている人はコワーキングスペースもしくはコミュニティ的なスペースが好きで本も好きな人たちだと思う。勉強会に行く感覚と似ている。そういう自分と似た人たちが集まる空間そのものが価値観の共有だったり安心感につながっていて私はそういう空気も楽しんでいたりする。とはいえ、バテバテで疲れていたので少しだけ本を読んでわりとすぐに寝た。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1103/>オフラインのもくもく会</a></h1><div class=post-meta><span class=post-date>2022-11-03</span></div><span class=post-tags>#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/management/>management</a>&nbsp;</span><div class=post-content><p>19時ぐらいに一口寝ようと思って寝たら0時過ぎまで寝てしまって、それから4時過ぎまで作業して寝て7時に起きた。出張の慣れない環境で生活が不規則になってきた。</p><h2 id=ドラム式洗濯機>ドラム式洗濯機</h2><p>泊まっているホテルの部屋に備え付けられていたので洗濯・乾燥した。館内設備として有償のコインランドリーがあるのは普通だと思うけど、部屋に洗濯機があって無料で使えるのは長期出張客を対象とした差別化の1つだと思う。乾燥もしてくれるならうちの洗濯機もドラム式に変えようかなと使いながら思った。</p><h2 id=もくもく会>もくもく会</h2><p><a href=https://kazamori.connpass.com/event/262898/>出張もくもく会</a> を開催した。8人が参加してくれた。知り合いが5人でそうじゃない人が3人も来てくれた。初めて行った場所のコワーキングスペースの会議室だから設備をわかっていなかった。8人で作業するにはちょっと窮屈な部屋と外の工事と換気扇がややうるさかった。もくもく会をやる上で我慢できないほどではないが、あまり参加者の満足度は高くなかったかもしれない。私は3つの作業を目標として作業してた。</p><ul><li>日記を書く</li><li>課題管理勉強会の資料作り</li><li>go 言語の勉強</li></ul><p>上の2つはできたが、それで疲れて go 言語の勉強はしなかった。17時から成果発表。なんだかんだで全員発表してくれたと思う。物理的にモニターやプロジェクターに接続しなくても zoom に参加してマイク／スピーカーをオフにして画面共有すればよいと教えてもらった。これはテレビ会議が当たり前になったいまのプラクティスとしてよいなと思えた。</p><h2 id=後の飲み会>後の飲み会</h2><p>もくもく会が終わってから5人で飲みにいった。参加者が知り合いを1人呼んで6人になった。2時間半制で18時から始めて20時半で終わった。眠かったのと翌日も飲みに行く予定があったので私はそこで帰ってホテルで2時間ほど寝てた。昔は当たり前だった勉強会後の飲み会というのも久しぶりの感覚で楽しかった。</p><p>知り合いだけならうちの会社の経費で落とそうかと考えていたものの、その考えがまとまらないうちに割り勘になってしまって、自身の優柔不断さを悔いた。会社の経費を使う理由は売上につながるかどうかというのが原則になる。知人であれば、日常的にお世話になっているからという大義名分が私の中で成り立つものの、そうじゃない状況になってしまったことで私の中で論理的に説明がつかなくなって接待として経費で落とすという決断ができなかった。個人ではなく経営者として判断するときは理論武装してないと固まってしまうことに気付いた。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1102/>課題に対する意思決定</a></h1><div class=post-meta><span class=post-date>2022-11-02</span></div><span class=post-tags>#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=post-content><p>1時に寝て7時に起きた。ホテルのビッフェ形式の朝ご飯は2回目のなのでうまくプレートに盛り付けて段取りよく配膳できた。昨日より改善できた。</p><h2 id=課題の意思決定と割り当て>課題の意思決定と割り当て</h2><p>プロジェクトの初期なのでとにかく段取りを早め早めに決めてタスクを洗い出し、メンバーが目標に向かって作業しやすい状況をマネージャーとして作り出さないといけない。昨日からプロジェクトのリポジトリ構成を変更しようというイシューを作ってメンバーと議論していた。当初は私がちゃちゃっと作業して移行しようと考えていたが、私の移行イメージを書き出していたらメンバーからいくつか背景や要望が出てきて、メンバー集めて打ち合わせして合意をとって決断することにした。私が入ってからプロジェクトでの初の意思決定かもしれない。</p><p>既存のソースを読んだらリポジトリ統合は少し工数がかかるとわかって、私がやるよりもメンバーの方がいいだろうと意思決定だけ私が判断して、実作業はメンバーに割り当てた。初めてのマネージャーっぽいお仕事をできたとちょっと自己満足。その議論の過程で monorepo vs polyrepo という比較記事を読んでみた。monorepo から polyrepo に切り出すのは容易だが、polyrepo から monorepo に統合するのは大変ということが書いてあって、まさにプロジェクトの状況と合致してメンバー間で認識合わせした。いま (過剰な) polyrepo で管理されているのを monorepo に統合しようという決断をした。これをやるのにコミット履歴を維持するのはコストがかかるのでソースファイルをコピーして新規ソースとして移行してよいという判断も下した。こういう意思決定は即断即決でやりたい。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>monorepo の対義語として polyrepo という言葉があるのか。勘と経験でリポジトリは複数に分割するので私がやってきたのは polyrepo ではあるのだけど、ちゃんと考えたことはなかったのでアーキテクチャとして議論する余地があるんやろな。 <a href=https://t.co/7LQY4cMteF>https://t.co/7LQY4cMteF</a></p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1587456158356635649?ref_src=twsrc%5Etfw">November 1, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=1on1>1on1</h2><p>マネージャーとして1on1を行う。プロジェクト初期は毎週やって、その後はメンバーの要望を聞きながら隔週でもよいと考えている。1on1 の目的ややり方は様々だが、私が提供できるのは次の3つに含まれることかなと思う。</p><ul><li>モチベーションアップ</li><li>業務・組織課題の改善</li><li>能力開発／キャリア支援</li></ul><p>初日から長時間の会議と懇親会などでチームのメンバーと話す機会が多かったので 1on1 もみんな気さくに話してくれてよかった。私はなるべく話さずに聞くことに専念しないといけない。私は圧倒的に自分の思ったことをがんがん話してしまう方なので他人の話を聞く姿勢を身につけるよい機会になると思う。今回は準備不足で雑談がメインではあったものの、1on1 の本なども読みながら勉強していこうと思う。</p></div></div><div class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1101/>課題管理の取っ掛かり</a></h1><div class=post-meta><span class=post-date>2022-11-01</span></div><span class=post-tags>#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=post-content><p>0時に寝て6時過ぎに起きた。朝からシャワー浴びてホテルのビッフェ形式の朝ご飯食べてた。初めてのオペレーションだと段取りわからなくて朝ご飯さえうまく配膳できなかった。経験のないことは全然できない。</p><h2 id=課題の洗い出し>課題の洗い出し</h2><p>お手伝い先のワークフローや段取りを学ぶ。毎週火曜日がプロジェクトの定例会議。火曜日の終わりに週報を書く。メールで週報を提出するという、いまどきの会社からみると古い会社の慣習にみえる。郷に入れば郷に従えということで私も同様に行う。課題管理で日々の活動をひたすら書いているので週報はいつでもすぐ書けるので私は全く苦にならない。</p><p>プロジェクトのリポジトリ構成の変更や課題の洗い出しなどをやっていた。イテレーションは週1でマイルストーンを4週間(月1)で設定して、その区切りでふりかえりなども実施していきたいと思う。コミュニケーションコストが高いことから、私は開発方法論としてスクラムを採用するつもりはない。あくまで自分がやってきた経験による課題管理 + イテレーション開発で製品開発のワークフローを構築したい。お手伝い先ではチームで課題を共有して開発に取り組むといったことはこれまでやってきていないものの、課題管理システムを使って開発者間でやり取りするのは普通にやっていたそうなのでイシューのコメントへの返信がめちゃくちゃ速い。イシュー上で議論していて私がこうしましょうとコメントを書いたら最も速いメンバーは5秒後にリアクションがつくぐらいの速さ。他のメンバーも数十分以内には返信がつくので課題管理システムを使うところのなにかを教える必要はない。課題管理が身に着くのに半年から1年間かかるというのは、他人のアクティビティを監視するという日々の運用 (行動) の変化に半年ぐらいかかると私は想定しているが、このチームはもっと早く課題管理の考え方に適応しそうな気がする。イシューの他人のコメントに5秒でリアクションできる開発者はそうそういない。</p><p>私がまだまだプロジェクトの理解が浅いので1-2週間はそのキャッチアップをして、メンバーが遊ばないように課題をどんどん作って優先度付けしてメンバーが担当できるようにしていきたい。</p></div></div><div class=pagination><div class=pagination__buttons><span class="button previous"><a href=/diary/dates/2022/11/page/3/><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a></span>
<span class="button next"><a href=/diary/dates/2022/11/page/5/><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></span></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script src=/diary/assets/main.js></script>
<script src=/diary/assets/prism.js></script></div></body></html>