<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>2022/08 on forest nook</title><link>/diary/dates/2022/08/</link><description>Recent content in 2022/08 on forest nook</description><generator>Hugo -- gohugo.io</generator><language>ja-jp</language><copyright>© 2021 Tetsuya Morimoto</copyright><atom:icon>/diary/favicon.ico</atom:icon><icon>/diary/favicon.ico</icon><atom:link href="/diary/dates/2022/08/index.xml" rel="self" type="application/rss+xml"/><item><title>Kubernetes Clients の調査</title><link>/diary/posts/2022/0804/</link><pubDate>Thu, 04 Aug 2022 10:21:17 +0900</pubDate><guid>/diary/posts/2022/0804/</guid><description>23時に寝て6時に起きた。
k8s cronjob の手動実行 いろんな定期／バッチ処理を k8s の cronjob に置き換えつつある。これまでアプリケーションサーバーでスケジュール実行していたものも本来サーバーである必要はないのでサーバーアプリケーションから cli アプリケーションに移行したりしている。そうやって定期実行ジョブが増えてくると、今度は調査やデバッグ目的で任意のタイミングで実行したくなる。kubectl を使って次のように実行できる。
$ kubectl create job --from=cronjob/my-schedule-job my-manual-job この cli を実行すると、cronjob のマニフェストから my-manual-job というジョブの pod が生成されて実行される。開発者ならこれでよいのだけど、非開発者も調査や検証目的で実行したい。そのためには非開発者向けのインターフェースを作らないといけない。本当は chatops のように slack apps によるコマンド実行ができるとカッコよいのだけど、k8s クラスターと slack 間の認証やセキュリティの仕組みを作る必要があって、既存の仕組みがないならそこはセキュリティリスクにも成り得るのでちょっと控えたい。そうすると、既存のサーバーアプリケーションの web api のインターフェースで提供できるようにしたい。複数の言語向けに Kubernetes Clients が提供されている。これを使って cronjob の手動実行を実装できそうな気がする。時間があれば週末に軽く調べてみようと思う。
python c# javascript java c haskel go ruby</description><content>&lt;p>23時に寝て6時に起きた。&lt;/p>
&lt;h2 id="k8s-cronjob-の手動実行">k8s cronjob の手動実行&lt;/h2>
&lt;p>いろんな定期／バッチ処理を k8s の cronjob に置き換えつつある。これまでアプリケーションサーバーでスケジュール実行していたものも本来サーバーである必要はないのでサーバーアプリケーションから cli アプリケーションに移行したりしている。そうやって定期実行ジョブが増えてくると、今度は調査やデバッグ目的で任意のタイミングで実行したくなる。kubectl を使って次のように実行できる。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$ kubectl create job --from&lt;span style="color:#f92672">=&lt;/span>cronjob/my-schedule-job my-manual-job
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>この cli を実行すると、cronjob のマニフェストから &lt;code>my-manual-job&lt;/code> というジョブの pod が生成されて実行される。開発者ならこれでよいのだけど、非開発者も調査や検証目的で実行したい。そのためには非開発者向けのインターフェースを作らないといけない。本当は chatops のように slack apps によるコマンド実行ができるとカッコよいのだけど、k8s クラスターと slack 間の認証やセキュリティの仕組みを作る必要があって、既存の仕組みがないならそこはセキュリティリスクにも成り得るのでちょっと控えたい。そうすると、既存のサーバーアプリケーションの web api のインターフェースで提供できるようにしたい。複数の言語向けに &lt;a href="https://github.com/kubernetes-client">Kubernetes Clients&lt;/a> が提供されている。これを使って cronjob の手動実行を実装できそうな気がする。時間があれば週末に軽く調べてみようと思う。&lt;/p>
&lt;ul>
&lt;li>python&lt;/li>
&lt;li>c#&lt;/li>
&lt;li>javascript&lt;/li>
&lt;li>java&lt;/li>
&lt;li>c&lt;/li>
&lt;li>haskel&lt;/li>
&lt;li>go&lt;/li>
&lt;li>ruby&lt;/li>
&lt;/ul></content></item><item><title>暑い日が続く</title><link>/diary/posts/2022/0803/</link><pubDate>Wed, 03 Aug 2022 08:19:41 +0900</pubDate><guid>/diary/posts/2022/0803/</guid><description>0時に寝て6時に起きた。今日は業務時間の大半が打ち合わせだった。
正史 諸葛亮孔明 「第十章 蜀の再建と出師表」を読んだ。
孔明の話し相手になっている 蔣琬 (しょうえん) のプロフィール情報がある。孔明の死後、後継者として内政を取り仕切ったらしい。孔明の後を継ぐ人物は相対比較されることから低い評価になりがちだが、蔣琬はそれでも評価が低くないことから時代が異なればもっと高い評価を得た政治家だったのかもしれない。むしろ孔明が北伐を5回もできた背景は留守中の内政を蔣琬始め、出師表で取り上げられた人物たちがうまく運営していたといった話しも出てくる。軍事は国庫を大いに逼迫し、蜀は魏や呉と比べて国力が劣る国家であったことから内政の負担も大きかったと思われる。
出師表 (すいしのひょう) という言葉を知らなかった。出師表とは臣下が出陣するときに君主に奉る文章のことを指す。孔明が君主の劉禅に奉った文章がとても有名らしい。2つあるので前出師表と後出師表と区別する場合もある。後出師表は孔明が書いたものではないという説もあるらしい。一般に出師表と言えば前出師表のことを指す。この出師表のどういったところがその時代の他の文章と異なるのか、また優れているのかといった内容が説明されている。孔明の人格者としての振る舞いや忠義が表れていると言える。</description><content>&lt;p>0時に寝て6時に起きた。今日は業務時間の大半が打ち合わせだった。&lt;/p>
&lt;h2 id="正史-諸葛亮孔明">正史 諸葛亮孔明&lt;/h2>
&lt;p>「第十章 蜀の再建と出師表」を読んだ。&lt;/p>
&lt;p>孔明の話し相手になっている &lt;a href="https://ja.wikipedia.org/wiki/%E8%94%A3%E7%90%AC">蔣琬 (しょうえん)&lt;/a> のプロフィール情報がある。孔明の死後、後継者として内政を取り仕切ったらしい。孔明の後を継ぐ人物は相対比較されることから低い評価になりがちだが、蔣琬はそれでも評価が低くないことから時代が異なればもっと高い評価を得た政治家だったのかもしれない。むしろ孔明が北伐を5回もできた背景は留守中の内政を蔣琬始め、出師表で取り上げられた人物たちがうまく運営していたといった話しも出てくる。軍事は国庫を大いに逼迫し、蜀は魏や呉と比べて国力が劣る国家であったことから内政の負担も大きかったと思われる。&lt;/p>
&lt;p>&lt;a href="https://ja.wikipedia.org/wiki/%E5%87%BA%E5%B8%AB%E8%A1%A8">出師表 (すいしのひょう)&lt;/a> という言葉を知らなかった。出師表とは臣下が出陣するときに君主に奉る文章のことを指す。孔明が君主の劉禅に奉った文章がとても有名らしい。2つあるので前出師表と後出師表と区別する場合もある。後出師表は孔明が書いたものではないという説もあるらしい。一般に出師表と言えば前出師表のことを指す。この出師表のどういったところがその時代の他の文章と異なるのか、また優れているのかといった内容が説明されている。孔明の人格者としての振る舞いや忠義が表れていると言える。&lt;/p></content></item><item><title>ふりかえりとむきなおり</title><link>/diary/posts/2022/0802/</link><pubDate>Tue, 02 Aug 2022 08:49:17 +0900</pubDate><guid>/diary/posts/2022/0802/</guid><description>23時に寝て何度か起きながら7時に起きた。なんか体調が悪い。
ふりかえりとむきなおり 毎週火曜日はふりかえりの日。今週もスプリントゴールは未達に終わったわけだけど、未達が普通で稀に達成できるのが常態化しつつある。悪く言えば ゾンビスクラム 状態と言えるのかもしれない。サービスインのゴタゴタも解消したので PO からもツッコミがあってスプリントゴール達成できない問題が再燃した。私からみたらこんなところか。
スプリント初期は前スプリントの残タスクをやるのが常態化している メンバーにやる気と実力がない コミュニケーションコストが高くてオーバーヘッドが大きい (スクラムイベント、確認や待ち時間など) フルタイムで働いていないメンバーがいる (ちょくちょくメンバーも休暇をとる) スプリントが1週間と短過ぎる その議論をしている中でスクラムマスターが むきなおり をしようといった結論になった。私は用語を知らなかったので調べてみた。
この3点を満たしながら、事業をふりかえって、行きたい方向へとむきなおることが今回の合宿の狙いでした。ただふりかえるだけではなく、あるべき姿との差から、今後の方向性を決めることを、特に「むきなおり」と名前付けしています。ふりかえり、むきなおる。今回の合宿はギルドワークスの今後の方針と向き合うための機会としました。
事業をふりかえって、行きたい方向へむきなおる
ふりかえりの結果から方向性を変えることを呼ぶらしい。私はまったく理解できていないのだけど、普通のふりかえりをして改善するときは何と呼ぶのだろうか。ただの言葉遊びじゃない？という気もする。また後日、そのためのイベントをするそうなのでそのときに理解を深めてみる。</description><content>&lt;p>23時に寝て何度か起きながら7時に起きた。なんか体調が悪い。&lt;/p>
&lt;h2 id="ふりかえりとむきなおり">ふりかえりとむきなおり&lt;/h2>
&lt;p>毎週火曜日はふりかえりの日。今週もスプリントゴールは未達に終わったわけだけど、未達が普通で稀に達成できるのが常態化しつつある。悪く言えば &lt;a href="/diary/diary/posts/2022/0708/#ゾンビスクラム">ゾンビスクラム&lt;/a> 状態と言えるのかもしれない。サービスインのゴタゴタも解消したので PO からもツッコミがあってスプリントゴール達成できない問題が再燃した。私からみたらこんなところか。&lt;/p>
&lt;ul>
&lt;li>スプリント初期は前スプリントの残タスクをやるのが常態化している&lt;/li>
&lt;li>メンバーにやる気と実力がない&lt;/li>
&lt;li>コミュニケーションコストが高くてオーバーヘッドが大きい (スクラムイベント、確認や待ち時間など)&lt;/li>
&lt;li>フルタイムで働いていないメンバーがいる (ちょくちょくメンバーも休暇をとる)&lt;/li>
&lt;li>スプリントが1週間と短過ぎる&lt;/li>
&lt;/ul>
&lt;p>その議論をしている中でスクラムマスターが &lt;strong>むきなおり&lt;/strong> をしようといった結論になった。私は用語を知らなかったので調べてみた。&lt;/p>
&lt;blockquote>
&lt;p>この3点を満たしながら、事業をふりかえって、行きたい方向へとむきなおることが今回の合宿の狙いでした。ただふりかえるだけではなく、あるべき姿との差から、今後の方向性を決めることを、特に「むきなおり」と名前付けしています。ふりかえり、むきなおる。今回の合宿はギルドワークスの今後の方針と向き合うための機会としました。&lt;/p>
&lt;p>&lt;a href="https://devtab.jp/entry/internal/18">事業をふりかえって、行きたい方向へむきなおる&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;p>ふりかえりの結果から方向性を変えることを呼ぶらしい。私はまったく理解できていないのだけど、普通のふりかえりをして改善するときは何と呼ぶのだろうか。ただの言葉遊びじゃない？という気もする。また後日、そのためのイベントをするそうなのでそのときに理解を深めてみる。&lt;/p></content></item><item><title>孔明の史実を読み始めた</title><link>/diary/posts/2022/0801/</link><pubDate>Mon, 01 Aug 2022 08:50:04 +0900</pubDate><guid>/diary/posts/2022/0801/</guid><description>0時に寝て7時に起きた。
正史 諸葛亮孔明 パリピ孔明 がおもしろかったので孔明の記事などを読んだりしていた。
私、姓は諸葛、名は亮、字を孔明と申します。
作品中のこの挨拶が印象に残っている。キャッチフレーズのようなものが挨拶というのも珍しい？そんなこんなもふくめて孔明の本も読んでみることにした。
正史 諸葛亮孔明 - 三国志の英雄たちが語らう 「第十一章 第一次北伐」を読んだ。
孔明が軍事で手腕を振るうようになるのは劉備の死後になる。北伐は第一次から第五次まである。そのうちの第一次北伐の失敗は 泣いて馬謖を斬る の故事で有名である。wikipedia の説明では正史と演義でこの故事に関する記述は異なっていることが書かれている。本書では、馬謖が副将の王平の諫言に従わず、山頂に布陣したことそのものは悪い策ではなかったと擁護されている。山頂から地の利をとって一刻も早く要衝を通過したい敵の張郃の軍にとって厄介な配置と考えることもできる。馬謖の失敗は実戦経験が乏しかったことで水源の確保を怠っていたことだという。かたや敵将の張郃は歴戦の名将であることから水源の確保ができていないことを看破して馬謖が布陣する近くの川や水源を確保してしまった。水源を確保することなど軍事に限らず当たり前の話しであり、戦術書に「水源を断て」などと記述しているものはないという。馬謖軍の布陣をみただけでそのことを見抜いた張郃の応用戦術を褒めている。さらに戦争に敗れただけであればまだよかったが、馬謖は敗北の責任を逃れるために逃亡したらしい。その承認欲求とプライドのために自分が負けた事実を受け入れられなかった。本書では、孔明の任命責任も大きいと締め括られている。馬謖が孔明の愛弟子であるから、実績のある諸将よりも私情を優先して実績をつけさせてあげようと抜擢した。その結果、馬謖もより大きな実績を挙げようと行動して失敗してしまった。どういう思いで涙を流したかは本書では書かれていなかった。</description><content>&lt;p>0時に寝て7時に起きた。&lt;/p>
&lt;h2 id="正史-諸葛亮孔明">正史 諸葛亮孔明&lt;/h2>
&lt;p>&lt;a href="https://paripikoumei-anime.com/">パリピ孔明&lt;/a> がおもしろかったので孔明の記事などを読んだりしていた。&lt;/p>
&lt;blockquote>
&lt;p>私、姓は諸葛、名は亮、字を孔明と申します。&lt;/p>
&lt;/blockquote>
&lt;p>作品中のこの挨拶が印象に残っている。キャッチフレーズのようなものが挨拶というのも珍しい？そんなこんなもふくめて孔明の本も読んでみることにした。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.wani.co.jp/event.php?id=7293">正史 諸葛亮孔明 - 三国志の英雄たちが語らう&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>「第十一章 第一次北伐」を読んだ。&lt;/p>
&lt;p>孔明が軍事で手腕を振るうようになるのは劉備の死後になる。北伐は第一次から第五次まである。そのうちの第一次北伐の失敗は &lt;a href="https://ja.wikipedia.org/wiki/%E6%B3%A3%E3%81%84%E3%81%A6%E9%A6%AC%E8%AC%96%E3%82%92%E6%96%AC%E3%82%8B">泣いて馬謖を斬る&lt;/a> の故事で有名である。wikipedia の説明では正史と演義でこの故事に関する記述は異なっていることが書かれている。本書では、馬謖が副将の王平の諫言に従わず、山頂に布陣したことそのものは悪い策ではなかったと擁護されている。山頂から地の利をとって一刻も早く要衝を通過したい敵の張郃の軍にとって厄介な配置と考えることもできる。馬謖の失敗は実戦経験が乏しかったことで水源の確保を怠っていたことだという。かたや敵将の張郃は歴戦の名将であることから水源の確保ができていないことを看破して馬謖が布陣する近くの川や水源を確保してしまった。水源を確保することなど軍事に限らず当たり前の話しであり、戦術書に「水源を断て」などと記述しているものはないという。馬謖軍の布陣をみただけでそのことを見抜いた張郃の応用戦術を褒めている。さらに戦争に敗れただけであればまだよかったが、馬謖は敗北の責任を逃れるために逃亡したらしい。その承認欲求とプライドのために自分が負けた事実を受け入れられなかった。本書では、孔明の任命責任も大きいと締め括られている。馬謖が孔明の愛弟子であるから、実績のある諸将よりも私情を優先して実績をつけさせてあげようと抜擢した。その結果、馬謖もより大きな実績を挙げようと行動して失敗してしまった。どういう思いで涙を流したかは本書では書かれていなかった。&lt;/p></content></item></channel></rss>