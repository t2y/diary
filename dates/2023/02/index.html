<!doctype html><html lang=en><head><title>2023/02 :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/dates/2023/02/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="2023/02"><meta property="og:description" content><meta property="og:url" content="/diary/dates/2023/02/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/dates/2023/02/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0204/>go の学び直し 静的解析編</a></h1><div class=post-meta><time class=post-date>2023-02-04 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/static-analysis/>static analysis</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて5時ぐらいにも起きて7時に起きた。昨日は podcast 収録でたくさん話して疲れてしまってそのまま帰ってすぐ寝た。すぐ起きるんだけど。</p><h2 id=ストレッチ>ストレッチ</h2><p>今日の開脚幅は開始前157cmで、ストレッチ後159cmだった。朝出かける前に開脚のストレッチしたら数値よくなるかな？と思ってやってみたらいつもより少しよくなった。ストレッチはいつも通りとも言えるし、腰の張りがまだまだ残っていることも確認できた。疲労が溜まっているんよな。毎週ストレッチしているからこの程度の疲労で済んでいるとも思える。お正月に実家から戻ってきてから1月の東京出張と35日は終えた。来週はまた2月の東京出張とその週末に49日がある。ここまで体力がもてばその次の法要は初盆なので少し空く。体力的に第4四半期の山場と言えるかもしれない。ただがんばる。</p><h2 id=go-の学び直し>go の学び直し</h2><p><a href=https://tenntenn.connpass.com/event/271533/>Gopher塾 #3 - 静的解析を使ったGoの開発ツール制作 入門編 - DAY 1</a> に参加した。</p><p>過去にも <a href=https://t2y.hatenablog.jp/entry/2015/03/11/025123>Python とマクロ、インポートフックと抽象構文木</a> や <a href=https://kazamori.jp/blogs/2020/07/12/java-annotation-processor/>Java のアノテーションプロセッサを試す</a> など、メタプログラミングのアプローチやコード生成などを実務で使ってきたので静的解析にも関心がある。講義内容の詳細は書かないけど、静的解析のような難しい話題に対して4時間という短い時間でとてもよい講義になっていたと思う。go の静的解析の要点や提供されているツールなどを一通り学ぶことができた。もちろん、実用するには試行錯誤や習熟を必要とするけど、取っ掛かりとして十分な内容に思えた。</p><p><a href=https://github.com/gostaticanalysis/skeleton>skeleton</a> というツールを使って静的解析のための analyzer プロジェクトのひな形を作る。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go install github.com/gostaticanalysis/skeleton/v2@latest
</span></span><span style=display:flex><span>$ skeleton myanalyzer
</span></span><span style=display:flex><span>$ tree myanalyzer
</span></span><span style=display:flex><span>myanalyzer
</span></span><span style=display:flex><span>├── cmd
</span></span><span style=display:flex><span>│   └── myanalyzer
</span></span><span style=display:flex><span>│       └── main.go
</span></span><span style=display:flex><span>├── go.mod
</span></span><span style=display:flex><span>├── myanalyzer.go
</span></span><span style=display:flex><span>├── myanalyzer_test.go
</span></span><span style=display:flex><span>└── testdata
</span></span><span style=display:flex><span>    └── src
</span></span><span style=display:flex><span>        └── a
</span></span><span style=display:flex><span>            ├── a.go
</span></span><span style=display:flex><span>            └── go.mod
</span></span></code></pre></div><p>意図的にテストが落ちるようになっていてすぐ動作確認できる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go mod tidy
</span></span><span style=display:flex><span>$ go test                                          
</span></span><span style=display:flex><span>--- FAIL: TestAnalyzer <span style=color:#f92672>(</span>0.05s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>    analysistest.go:448: a/a.go:5:6: diagnostic <span style=color:#e6db74>&#34;identifier is gopher&#34;</span> does not match pattern <span style=color:#e6db74>&#34;pattern&#34;</span>
</span></span><span style=display:flex><span>    analysistest.go:512: a/a.go:5: no diagnostic was reported matching <span style=color:#e6db74>&#34;pattern&#34;</span>
</span></span><span style=display:flex><span>FAIL
</span></span><span style=display:flex><span>exit status <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>FAIL	myanalyzer	0.349s
</span></span></code></pre></div><p>いろいろ説明を端折るけど、試しに FuncDecl の ast ノードに対して関数の行数をカウントする処理を実装してみた。<a href=https://pkg.go.dev/golang.org/x/tools/go/analysis#hdr-Pass>analysis パッケージの Pass</a> を使うと便利なユーティリティが提供されていて、静的解析をするときに面倒な処理をショートカットできて簡単に実装できることが理解できた。ここで作った analyzer は go vet で実行できるそうなのでプロジェクトの独自ルールを analyzer で実装して ci でチェックするといった運用もできる。応用範囲は広そう。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>ast</span>.<span style=color:#a6e22e>FuncDecl</span>:
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Name</span>, <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Pos</span>(), <span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>End</span>())
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>start</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>pass</span>.<span style=color:#a6e22e>Fset</span>.<span style=color:#a6e22e>Position</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>Pos</span>()).<span style=color:#a6e22e>Line</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>end</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>pass</span>.<span style=color:#a6e22e>Fset</span>.<span style=color:#a6e22e>Position</span>(<span style=color:#a6e22e>n</span>.<span style=color:#a6e22e>End</span>()).<span style=color:#a6e22e>Line</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Println</span>(<span style=color:#e6db74>&#34;the number of lines:&#34;</span>, <span style=color:#a6e22e>end</span><span style=color:#f92672>-</span><span style=color:#a6e22e>start</span>)
</span></span></code></pre></div></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0203/>雑談の多い日</a></h1><div class=post-meta><time class=post-date>2023-02-03 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/communication/>communication</a>&nbsp;
#<a href=/diary/tags/audio-media/>audio media</a>&nbsp;</span><div class=post-content><p>0時に寝て4時に起きて6時に起きた。本当はもっと早く起きて勉強会の資料作りやろうと思っていたけど、疲れと寒さでうまく起きれない。高速バスよりはずっと楽だけど、それでも土日に実家帰ってくると疲れが溜まる。次の週の週末になると蓄積度が違う。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。</p><ul><li><a href=/diary/posts/2023/0201/#テックブログのレビュー／公開>フロントエンドの技術選定</a>のふりかえり</li><li>プロジェクトマネジメントの話し</li><li><a href=/diary/posts/2023/0202/#ハドルと雑談>ハドルと雑談</a>の話し</li></ul><p>年末にはらさん主催の忘年会に参加した。参加者は10人前後いたと思う。そのときにはらさんが「会社でオンライン飲み会やっても盛り上がらない？」といった話題があった。その意見には私も同意でおそらく参加者が5人以上いるとオンライン飲み会は盛り上がらない。オンライン飲み会の難しさは1つの部屋だとせいぜい3-4人ぐらいでないと話せない。1つの部屋に10人とかいると、実質話しているのは3人ぐらいで残りのメンバーは聞いているだけになる。それが盛り上がらない要因だと思う。オフラインの飲み会なら、例えば4人テーブルに3グループに分かれて、それぞれのグループが3つの会話が成立するから盛り上がる。そして、隣の会話が薄く聞こえたり、ちょっと休むときに隣のグループの会話に混じったりもできる。これと同じことをオンラインでもチャンネルを分けてやればよいというのは理屈の上で正しい。しかし、オンラインで能動的に別のチャンネルに入り直すのは複数の意味で障壁が高い。まずツールの操作が分かりにくいし、幹事が仕切るわけでもないので運用ルールも曖昧。仮に幹事がいても仕切れるのは1つのチャンネルだけで、他のチャンネルが意図した運用をしているかどうか、チャンネルを出たり入ったりしないと監視するのが難しい。オフラインの飲み会に近い状態にするのは、オンラインミーティングツール側で自動的にうまいこと配慮しないといけないのではないかといった話を、はらさんとしていた。</p><h2 id=はんなりpodcast>はんなりPodcast</h2><p><a href=https://hannari-python.connpass.com/>はんなりプログラミング</a> のコミュニティが <a href=https://note.com/hannari_group/n/n219af97b2ddf>はんなりPodcast（仮）</a> を始めたらしい。私もちょくちょくはんなりさんのイベントに参加するので運営の方々とも懇意にさせていただいている。たまたまゲストで呼んでいただいた。感謝。内容はまた公開されてから書くので今日は収録の雰囲気だけ書いておく。かいせんさんとおがわさんとは、オンライン上でもよくやり取りしているので気軽に話すことができた。逆に私が調子に乗り過ぎて内容とは逸脱したことや自分の話したいことをわーっと話し過ぎてしまったのではないかという反省もあとになって思う。いま1人で働いているからこうやって自分の話しを聞いてくれる機会というのは貴重でそれはそれで楽しかった。ついつい自分の話しばかりし過ぎないように注意しないといけない。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0202/>オフィスアワー的なハドル</a></h1><div class=post-meta><time class=post-date>2023-02-02 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/communication/>communication</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;</span><div class=post-content><p>2時に寝て7時に起きた。お仕事は時間かけた割に成果でなくて、遅くに帰ってきて晩ご飯食べてダンまちみたら寝るのも遅くなった。</p><h2 id=ハドルと雑談>ハドルと雑談</h2><p>今日から午前中はハドルミーティングに滞在するようにして、メンバーが気軽に雑談しやすい雰囲気を作ってみる。大学で言うところのオフィスアワー。初日だったせいか、どんなものかとお試しでチーム外の開発者が来てくれたりもした。メンバーの1人もお昼前にとくに用ないけど試しに来てみましたと軽く雑談した。ハドル中じゃなかったけど、別のメンバーも午後にコードレビューの詳細について聞きたいといったメッセージが届いてハドルをした。リモートワークしていても気軽に話しかけていいんやでと表明することで、いくらか話しかけるのをためらう心理的障壁が下がったことは確認できた。普通に誰でも考えて起きること。あとはこれを一定期間、1ヶ月とか2ヶ月とか続けてみてどのぐらいの雑談ができるかを記録して、効果がありそうなら次のアクションを考える。とくに用事もないけど、暇だから気分転換に雑談に来ましたというのが高頻度で起これば心理的安全性にとってもよいことじゃないかな。私が逆の立場なら、用事もないのに会社の人に話しかけるのは仲のよい同僚しかいなかったと思う。他のメンバーも気軽にハドルに滞在するようになれば、物理的にオフィスに出社しなくても雑談しやすい雰囲気は作れるかもしれない。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0201/>テックブログ公開</a></h1><div class=post-meta><time class=post-date>2023-02-01 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/frontend/>frontend</a>&nbsp;
#<a href=/diary/tags/tech-selection/>tech selection</a>&nbsp;
#<a href=/diary/tags/writing/>writing</a>&nbsp;</span><div class=post-content><p>0時に寝て何度か起きて6時半に起きた。起きてから8時までだらだらしてた。寒くて起きれない。2月入ってしまった。早いなぁ。</p><h2 id=テックブログのレビュー公開>テックブログのレビュー／公開</h2><p><a href=/diary/posts/2023/0125/#フロントエンドの技術選定のテックブログ>先週に草稿は書き上げていた</a> ものの、レビューが滞っていた。他社のテックブログを勝手に書いて公開するわけにはいかないので慎重にレビューをお願いしていた。私がそういう特性の人間なのか、課題管理システムを長年使い続けてきたからそうなったのか、その両方なのか。私は <a href=https://lirio.com/blog/unit-bias-lirio-bias-brief/>Unit Bias</a> が大きい方の人間だと思う。自分の中で完了したタスクをクローズせずに放置しておくのが精神的に耐えられない。すぐに対応しない残作業があるなら新しい issue に作った上で古い issue をクローズすることもたまにある。放置するのは嫌なので今日は関係者にどんどん確認してレビューを進めた。</p><p>公開して知人にシェアしてみたものの、あまり反応がよくないので大して関心を唆る読みものにはなっていないようだ。扱っている内容が悪いわけではなく、私の構成や文章力が拙いのだと思う。悔しいのでもう1回ぐらい、この記事に関連するテックブログを書いて関心をもってもらうような読みものにしたい。関西人だからかぶせてかぶせて天丼にしていく。</p><ul><li><a href=https://blog.osstech.co.jp/posts/2023/02/frontend-tech-selection/>フロントエンドの技術選定</a></li></ul></div></article><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>