<!doctype html><html lang=en><head><title>Posts :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/posts/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:url" content="/diary/posts/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/posts/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1126/>朝から晩まで多忙な一日</a></h1><div class=post-meta><time class=post-date>2021-11-26 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/morning-activity/>morning activity</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;</span><div class=post-content><p>0時に寝て5時に起きた。昨日 slack で質問していた内容に5時頃に返信があるのをたまたまみかけた。この時間に起きているんだと思って返信にコメントしてたら別のメンバーからもコメントが書き込まれて、早起きは三文の得みたいな感じで朝5時から slack でやり取りしてた。いま私はだいたい8時から始業している。開発チームの半分ぐらいのメンバーはそのぐらいから始業しているのが課題管理システムや git のコミットログからわかる。このチームは朝早い人たちが多いなと感心した。</p><h2 id=朝活-アジャイル開発とスクラム-第2版>朝活: アジャイル開発とスクラム 第2版</h2><p><a href="https://www.youtube.com/watch?v=3T8CTKDFd9g">2021-11-26 AM 6 金曜朝6時開催のもくもく会</a> で第6章と第7章を読んだ。第2部は企業において実際にスクラムを導入していったときの四方山話が出てくる。私はあまり他社の事例に興味はないが、対談の過程で本質的に大事なことや難しいことなどがあぶり出されることもあるので、実務を通しての話題も参考になる場合があることは理解できる。大半の事例は実業務で使われているという結論がわかるだけでも十分だと思う。とくに大企業は様々な厳しい制約や要件の中で採用していると推測されるので、それだけで大きなメッセージをもつ。斜め読みでざっと読み進めながら興味のある話題があれば精読するといった程度で読んでた。</p><p>大企業あるあるな話しでスクラムイベントを通してお互いの距離感が縮まってうまくいったといった内容があった。開発者からすると距離感の遠近に関係なく、必要なら適切な相手を探し出してコミュニケーションを取るのが普通だけど、みんながみんなそうではないだろうし、(同じ会社の社員でも)よく知らない人とは話さないといった考え方をもつ人もいるだろう。ある人はこれを単純接触効果で説明していたけど、業務ではなく人間の側面からみてスクラムイベントが多いことにも意義があるのかもしれない。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>ある事例でスクラムにおいてイベントがたくさんあってそれに参加することでお互いの距離感を縮めたという効果が書かれている。開発者は気になったことは何でも確認するという姿勢をとりがちだけど、関係者のみんながそうではないというのも理解できる <a href="https://twitter.com/hashtag/%E9%87%91%E6%9C%9D%E3%83%84%E3%83%A1%E3%83%88%E3%82%AE?src=hash&amp;ref_src=twsrc%5Etfw">#金朝ツメトギ</a></p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1463982173212459019?ref_src=twsrc%5Etfw">November 25, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=顧問さんと雑談>顧問さんと雑談</h2><p>隔週で打ち合わせをしている。最近はお手伝いのお仕事が忙しいので今回は雑談になってしまったが、近況としてリーンキャンバス、スクラム実践の話題などを話していた。わりと盛り上がって1時間で切り上げるつもりが1時間半に伸びてしまって、別のお仕事の時間を圧迫したけど、それはそれで意義のある雑談になったので収穫はあった。</p><p>ある組織で新規事業を行う上で <a href=https://www.innovation.co.jp/urumo/aarrr/>AARRR (あー) モデル</a> をすごく重視しているといった話題が出た。バケツみたいなイメージがあって、そこに現実の数字を当てはめていってプロジェクト/プロダクトの改善やふりかえりなどに活かしているという。サービスのグロースに責任をもつ人には重要な概念だという。うちのプロダクトはグロースしなくてもよいけど、なんらかのフレームワークに当てはめて抜け・漏れがないかをチェックすることにも使えるかもしれない。世の中でよく使われているフレームワークを調査しておいて損はないと思う。私はビジネスに全く疎いのでリーンキャンバスを通じて、AARRR モデルの話題になって、それがどういった用途で使われているかというお話しは興味深かった。</p><p>具体的には AARRR モデルの他に、スクラムの話題からは野中郁次郎氏のオリジナルの論文、大規模アジャイルの方法論などが盛り上がっていくつかキーワードが出た。そういった雑談の中で感性に従って気になったことを深堀りしていくとおもしろい調査や知見になったりすることを経験的に実感しつつある。今後もそういう機会や内容を大事にしていきたい。</p><h2 id=カスタム-github-actions-の開発>カスタム GitHub Actions の開発</h2><p><a href=/diary/posts/2021/1116/#カスタム-github-actions-作成>先日</a> 調査していたものをベースに、普通にやる方法と カスタム GitHub Actions の compoiste action で実装する場合の検討資料などを作って、カスタム GitHub Actions を実装してよいといった許可をもらった。企業における唯一の懸念は (原則) public リポジトリで運用するところで、CI のような処理に社外秘は含まれないが、public そのものに審査や承認を必要とするような組織では腰が重くなるようなこともあるかもしれない。ロードマップにも private リポジトリでカスタム GitHub Actoins を動かせるようにしようという課題は作成されている。</p><ul><li><a href=https://github.com/github/roadmap/issues/74>Actions: Use actions from internal repositories #74</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1125/>コーディングスタイルの共通化</a></h1><div class=post-meta><time class=post-date>2021-11-25 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/java/>java</a>&nbsp;
#<a href=/diary/tags/ide/>ide</a>&nbsp;</span><div class=post-content><p>1時半に寝て6時に起きた</p><h2 id=ソースコードのフォーマッター>ソースコードのフォーマッター</h2><p>go 言語の <a href=https://pkg.go.dev/cmd/gofmt>gofmt</a> が成功をおさめたことからどんなプログラミング言語でもコーディングスタイルはツールで自動整形するのがよいという雰囲気が醸成され、とくに業務の開発においては統一すべしというルールを設けている組織が多いと思う。java はこの領域では後塵を拝していると言ってよいと思う。歴史的に java の言語仕様と ide は相性がよかったため、ide がコーディングスタイルを自動整形していた結果、ide ごとに互換性のない異なるコーディングスタイルが使われるようになってしまった。私がアリエルで開発していた頃、開発者はみんな eclipse しか使ってなかったので問題にならなかった。しかし、いまや私が知っている ide だけでも次のものがある。</p><ul><li><a href=https://www.eclipse.org/>eclipse</a></li><li><a href=https://www.jetbrains.com/idea/>intellij idea</a></li><li><a href=https://netbeans.apache.org/>netbeans</a></li><li><a href=https://code.visualstudio.com/>vscode</a></li></ul><p>この問題を解決するツールとして最もメジャーなのは <a href=https://github.com/google/google-java-format>google-java-format</a> で、当初はこのツールを導入しようと考えていた。しかし、開発チームのテックリードから google-java-format のコーディングスタイルはひどい、一番優れているのは intellij idea だというお気持ちを表明された。導入を止めろと言われたわけではないが、チームに入ったばかりの私はテックリードのお気持ちに忖度して google-java-format の導入を断念した。代わりに intellij idea のデフォルトフォーマットをどうやって他の ide を共有するかを調べたところ、<a href=https://www.jetbrains.com/help/idea/configuring-code-style.html#editorconfig>Manage code style on a directory level with EditorConfig</a> で <a href=https://editorconfig.org/>EditorConfig</a> の設定 (<code>.editorconfig</code>) を intellij idea で再利用できることがわかった。</p><p>うちの開発チームのメンバーは intellij idea と vscode しか使っていないため、現状はこれで解決できるように思えた。intellij idea にはデフォルトで EditorConfig プラグインがバンドルされていて有効になっている。リポジトリのルートディレクトリに <code>.editorconfig</code> があれば自動的にそれを読み込んでくれる。そこで intellij idea のデフォルト設定を <code>.editorconfig</code> 形式でエクスポートして、それをリポジトリのルートディレクトリに配置することでコーディングスタイルのフォーマッターを共通化できた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1124/>eLTAX 触ってみた</a></h1><div class=post-meta><time class=post-date>2021-11-24 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/scrum/>scrum</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/eltax/>eltax</a>&nbsp;</span><div class=post-content><p>0時半に寝て6時半に起きた。水曜日は朝活の日だったけど、申し込み忘れてカレンダーに入ってなかったから忘れてた。カレンダーの予定に従って生活していることがわかる。</p><h2 id=ふりかえり>ふりかえり</h2><p>今日はお仕事でスクラムイベントのレトロスペクティブがあった。最近は日本語でそのまま「ふりかえり」と呼ぶみたいやね。他の用語が英語なのであわせて英語で読んでたけど、ふりかえりの方が日本人的にはしっくりくるのでそれでいいと思う。</p><p>開発の情報共有のやり取りが活発になったという意見が出た。私は11月から働き始めてまだ3週間ほどなので以前がどうだったのかわからない。2週間前に本格的にスクラム開発に移行して、POや開発者のリーダーが新任したり、開発者に新規メンバー (私のこと) が追加したりと、いろんな状況が変わっている。なにか特別なことをしたというわけではないけど、自然にコミュニケーションがよい方に改善されているなら全体としてよい傾向に思える。私はまだ業務のことが全くわからないのでインフラやテストなどの非機能要件のタスクをやっているだけ。開発者からみて負債というほど大きなものではないが、やった方がよい技術的な残タスクのようなものを私がどんどん fix しているので開発環境がよくなっている気がするといったコメントを名指しでいただいた。スクラムマスターによると、ふりかえりでは、個人名で問題を指摘するのはよくないが、個人名で感謝を伝えるのはよいという。なので、よいことには個人名が前面に出る。褒められて悪い気がする人はそうそういないので、このプラクティスはチームの雰囲気をよくすることに寄与するのだろうと思えた。</p><h2 id=続-年末調整と住民税の納付>続: 年末調整と住民税の納付</h2><p><a href=/diary/posts/2021/1123/#年末調整と住民税の納付>昨日</a> の続き。eLTAX のソフト版をダウンロードして年末調整の給与支払報告書の申請、住民税の特別徴収の納付も行った。アプリケーションの操作方法と手続きのドキュメントは懇切丁寧な内容なので、アプリケーションそのものの使い勝手はいまいちだけど、とくに手続きに迷うこともなく、順番に操作していけば問題なく申請や納付を完了できた。この2つの手続きは、昨年は紙で申請したり納付したりしていたのが、今年は電子申告になったのでちょっとクラスチェンジしたような感覚で気分がよかった。定期的な行政手続きを毎年やりながら少しずつやり方を洗練させていったり、異なる手続きに挑戦してみたり、制度の仕組みを理解したり、そういう少しずつ改善して学びを深めていくことそのものに幸せ感がある。人に依るんだろうけど、わりと私はマイクロ法人の行政手続きを楽しんでいる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1123/>スクラムの起源</a></h1><div class=post-meta><time class=post-date>2021-11-23 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/eltax/>eltax</a>&nbsp;</span><div class=post-content><p>5時に寝て7時半に起きた。前週末は遊んでたので夜はいろいろ作業してた。朝起きる習慣がついてきたので何時に寝ても起きれる感じになってきた。うまく体調管理もできている。</p><h2 id=年末調整と住民税の納付>年末調整と住民税の納付</h2><p>年末調整は1月末まで、住民税の特別徴収は納付の特例を使うと6-11月の6ヶ月分を12月10日までに納める。年末調整も11月の給与を確定したら調整額を算出して12月の給与に反映する。必要な情報を入力したら会計システム (freee) で自動算出してくれて書類も一通り作ってくれるので難しくない。ここで出力される給与支払報告書を市役所と税務署のそれぞれに申請する。市役所向けの手続きは <a href=https://www.eltax.lta.go.jp/>eLTAX</a> で行い、税務署向けの手続きは <a href=https://www.e-tax.nta.go.jp/>e-Tax</a> で行う。先日 <a href=/diary/posts/2021/1103/#asus-rog-zephyrus-g15-ga503qr>Windows マシンを購入</a> したので、今回は eLTAX の DL 版で完全な手続きができるはず。ただし、e-Tax も eLTAX も祝日・日曜日は利用できないのでやろうと思ったものの、今日は祝日だからできなかった。</p><p>住民税の特別徴収の納付も今回が初めての試み。企業が社員に代わり住民税を納付するのが原則であり、これを特別徴収と呼ぶ。昨年は特別徴収への切り替え申請をしないといけないのを私が知らなくて手続きが遅れた結果、個人宛に届いた納付書でそのまま支払いした。納付自体はそれでも問題はない。おそらく徴税側からみたら源泉徴収して企業の担当者が納付した方が誤りがなく確実でサポートコストを削減できるという狙いなんだろうと推測する。住民税の納付も eLTAX でできるようなので後日挑戦してみる。</p><h2 id=アジャイル開発とスクラム-第2版-顧客技術経営をつなぐ協調的ソフトウェア開発マネジメント>アジャイル開発とスクラム 第2版 顧客・技術・経営をつなぐ協調的ソフトウェア開発マネジメント</h2><p>4日前から読み進めていて、第1部アジャイル開発とは何か、スクラムとは何か (第1章から第5章) を読み終えた。</p><p>冒頭の序論を読んでいて、スクラムは 1980 年代の日本の製造業の (革新的な) 製品開発スタイルの論文がオリジナルだというのを知った。ソフトウェア開発の文脈だと、米国から輸入した方法論のようにみえるが、もとは日本で編み出された方法論だったという。1986年に書かれたハーバード・ビジネス・レビューに投稿された論文がオリジナルらしい。</p><ul><li><a href=https://hbr.org/1986/01/the-new-new-product-development-game>The New New Product Development Game by Hirotaka Takeuchi and Ikujiro Nonaka</a></li></ul><p>前に <a href=https://scrumguides.org/docs/scrumguide/v2020/2020-Scrum-Guide-Japanese.pdf>スクラムガイド2020</a> を一通り読んでいたので、スクラムについての内容はだいたい理解できた。補足でよかったのは、スクラムガイド 2017 から 2020 で改訂された内容やその背景や意図などがコラムで紹介されていた。それらを知ることで、よりスクラムで陥りやすい失敗や誤解されがちなところを理解できた。たとえば「開発チーム」という用語から「開発者」に改められた。スクラムチームの中に別のチームがあるようにみえ、プロダクトオーナー vs 開発チームのような対立構造にならないよう、チームはスクラムチームという1つしかないという意図だという。そして、開発チームの自己組織化 (Self-organized) というキーワードが、スクラムチームの自己管理型 (Self-managed) へといったように、主体である開発チームだけ自律的且つ協働するように読めたのを、スクラムチームという1つのチームしかないと強調されている。</p><blockquote><h5 id=コラム-2020-スクラムガイド改訂とスクラムの3つの罠>コラム: 2020 スクラムガイド改訂とスクラムの3つの罠</h5><ul><li>スクラムが形式的、儀式的になってしまっている<ul><li>目的を理解せずにハウツーをなぞるだけのチームが増えたので抽象的な表現に変更した</li><li>例) デイリースクラムがただの報告するだけになっている<ul><li>デイリースクラムの目的は状況にあわせた再計画であるため、形式的な報告ではいけない</li></ul></li></ul></li><li>プロダクトオーナー vs 開発チームの構図に陥ってしまっている<ul><li>チーム内の分断をなくし、ワンチームになることが強調されている</li><li>開発チームから開発者へ、チームはスクラムチームが唯一</li><li>プロダクトオーナー vs 開発者が対立構図になることが多かった<ul><li>「開発チームの自己組織化」から「スクラムチームの自己管理」へ</li><li>スクラムは役割を超えて協力していくことが欠かせない<ul><li>問題 vs 私たち (スクラムチーム) という構図を引き出すことが重要</li></ul></li></ul></li></ul></li><li>スクラムマスターがスクラム警察もしくは雑用係になってしまっている<ul><li>スクラムマスターが「サーバントリーダー」とされていたが、単にサーバントになってしまうことがあった</li><li>スクラムマスターはプロダクトの成果や組織の目標にコミットメントしないといけない<ul><li>ただスクラムルールを守らせたり、会議の司会役をするだけではない</li></ul></li><li>「真のリーダー」としての資質とプロダクトの成果や組織の目標にコミットメントしていくための熱量を重視して専任していく必要がある</li></ul></li></ul></blockquote><p>これらのコラムを読むと、私が傍からみていたスクラムは本来の意図したスクラムの開発方法論ではなく、正しく運用されていなかったスクラムなのかもしれないとも思えてきた。本書の第1部を読み進めてみて、スクラムの意図している目的や価値には私が共感できるところが多々あった。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1122/>kustomize のパッチ適用の違い</a></h1><div class=post-meta><time class=post-date>2021-11-22 (Mon.) ::</time></div><span class=post-tags>#<a href=/diary/tags/kubernetes/>kubernetes</a>&nbsp;
#<a href=/diary/tags/writing/>writing</a>&nbsp;</span><div class=post-content><p>22時ぐらいには寝て6時半に起きた。昨日はお出かけしてきてバテたんで19時頃からうたた寝を繰り返してずっと寝てた。実家に帰っていた期間を除いて、土日のどちらかを休むのはここ3ヶ月はなかったと思うし、土日の2日間ほとんど仕事をしなかったのは半年ぐらいはなかったと思う。久しぶりに土日に仕事しなかったなという印象で、その理由は業務委託のお仕事の契約が決まって余裕があるからだと思う。</p><h2 id=kustomize-の-inline-patch>kustomize の Inline Patch</h2><p><a href=https://kubectl.docs.kubernetes.io/guides/example/inline_patch/>Inline Patch</a> に次の3つのやり方が説明されている。</p><blockquote><ul><li>patchesStrategicMerge: Strategic Merge Patch として解析されるパッチファイルのリスト</li><li>patchesJSON6902: 1つのターゲットリソースのみに適用可能な JSON Patch として解析されるパッチと関連付けされるターゲットのリスト</li><li>patches: 関連付けされるターゲットとパッチのリスト。このパッチは複数のオブジェクトに適用でき、パッチが Strategic Merge Patch なのか JSON Patch かは自動的に検出</li></ul></blockquote><p>patches は patchesStrategicMerge と patchesJSON6902 の両方を記述できる。運用上は patchesStrategicMerge か patchesJSON6902 を適用したいパッチの内容によって使い分けることになる。おそらく前者は base にない要素を追加したり、base の要素をすべて置き換えたりするときに使う。後者は base にある map や list の一部の要素のみを限定して置き換えたり、削除したりするときに使う。ちなみに patchesJSON6902 の 6902 というのは <a href=https://datatracker.ietf.org/doc/html/rfc6902>RFC 6902 JavaScript Object Notation (JSON) Patch</a> に由来する。</p><p>patchesJson6902 の例として次のような設定にパッチを適用する。base から読まれた metadata の要素から namespace のみを削除したり、spec.metadata の1番目のリストの secretKeyRef が参照する Secret を my-secret で置き換えたりできる。こういったパッチを patchesStrategicMerge で実現することはできないのではないかと思う (詳しくないので私が間違っているかもしれない) 。</p><h5 id=baseyml>base.yml</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>apiVersion</span>: <span style=color:#ae81ff>apps/v1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Component</span>
</span></span><span style=display:flex><span><span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>name</span>: <span style=color:#ae81ff>my-component</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>namespace</span>: <span style=color:#ae81ff>default</span>
</span></span><span style=display:flex><span><span style=color:#f92672>spec</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>metadata</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>username</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>value</span>: <span style=color:#ae81ff>user</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>password</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>secretKeyRef</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>base-secret</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>key</span>: <span style=color:#ae81ff>password</span>
</span></span></code></pre></div><h5 id=kustomizationyml>kustomization.yml</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>...
</span></span><span style=display:flex><span><span style=color:#f92672>patchesJson6902</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>path</span>: <span style=color:#ae81ff>my-patch.yaml</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>target</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>group</span>: <span style=color:#ae81ff>apps</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>version</span>: <span style=color:#ae81ff>v1</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>kind</span>: <span style=color:#ae81ff>Component</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>name</span>: <span style=color:#ae81ff>my-component</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><h5 id=my-patchyaml>my-patch.yaml</h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>- <span style=color:#f92672>op</span>: <span style=color:#ae81ff>remove</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/metadata/namespace</span>
</span></span><span style=display:flex><span>- <span style=color:#f92672>op</span>: <span style=color:#ae81ff>replace</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/spec/metadata/1/secretKeyRef/name</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>value</span>: <span style=color:#ae81ff>my-secret</span>
</span></span></code></pre></div><h2 id=リーンキャンバスレビュー-前半>リーンキャンバスレビュー (前半)</h2><p><a href=/diary/posts/2021/1114/#リーンキャンバス>前に作ったリーンキャンバス</a> を使って友だちにプロダクトの設計をレビューしてもらった。私がリーンキャンバスを作ったことがなかったので、この項目にはどういった内容を書くか、それぞれの項目がどういった関連付けや粒度で整理するかといった、リーンキャンバスの書き方そのものも含めて教えてもらった。</p><p>私が設計のために作った40枚のスライドを話すと2時間必要とするが、リーンキャンバスを使えば要点のみ15分で話せるようになるのが狙いになるみたい。とはいえ、リーンキャンバスの書いてある内容の半分を確認するだけで今日は2時間弱かかってしまった。議事録を取りながらだったので話すだけならもっと短くなったかもしれないし、その背景や根拠を細かくツッコミしていくとそれなりの時間はかかるのかもしれない。リーンキャンバス上は数枚の付箋で簡潔に書いてあるが、これどういうこと？みたいな問いになると詳細を説明しないといけないので時間がかかったように思う。リーンキャンバスの精度や品質が上がれば、読み手が詳細を確認しなくても意図を理解しやすくて詳細のツッコミが不要になるのかもしれない。これまで使ったことがないツールでおもしろいので週末に後半を行う。課題管理の背景には実践知、認知心理学、情報共有、組織論といった様々な分野にまたがるのでそのコンテキストを共有するのはなかなか難しいのではないかという思いもある。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1121/>六甲山と灘五郷</a></h1><div class=post-meta><time class=post-date>2021-11-21 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/kobe/>kobe</a>&nbsp;
#<a href=/diary/tags/sake/>sake</a>&nbsp;
</span><img src=/diary/img/2021/1121_ball.jpg class=post-cover alt=六甲山と灘五郷 title="Cover Image"><div class=post-content><p>1時ぐらいに寝て6時に起きた。</p><h2 id=オリックスレンタカー>オリックスレンタカー</h2><p>昨日、9:00 - 17:00 で予約したものの、8時には出掛けられる状態になったので電話で確認したら早くてもよいと言う話だったので 8:15 から車を借りる。車種は <a href=https://ja.wikipedia.org/wiki/%E3%83%88%E3%83%A8%E3%82%BF%E3%83%BB%E3%83%B4%E3%82%A3%E3%83%83%E3%83%84>トヨタ・ヴィッツ</a> 1.3l だった。wikipedia によると、2020年3月31日で販売終了になっているみたい。六甲山のような山登りを普通に走る分にはコンパクトな車体で快適に走行できた。私は車に全くこだわりがないのでこのぐらいのサイズの車で十分だと感じた。保険やWeb割引を含めて8時間レンタルして7,700円だった。</p><h2 id=神戸市立森林植物園>神戸市立森林植物園</h2><p>三ノ宮市内から約30分ほどで <a href=https://www.kobe-park.or.jp/shinrin/>神戸市立森林植物園</a> に着いた。8時15分ぐらいに出発したので比較的車が少なくて渋滞にあわずに行けたのもある。六甲山の山道は2車線しかなく、森林植物園の少し手前で渋滞になった。なぜ渋滞しているかというと、駐車場に入るところで料金の支払いが手作業だから。私が行った9時前の時間帯では駐車場のキャパシティは十分にあったが、駐車場の料金支払いで渋滞を引き起こしていたようにみえた。ネットワーク回線がどのような状態かわからないけど、ETC のような機器があれば渋滞を緩和できるのだろうと推測する。六甲山行くならなるべく朝早く出発した方がよいとわかった。</p><p>森林植物園全体の1/3ぐらいしかまわれなかったけど、写真とかでみる想像通りの場所でとてもよかった。11月は紅葉シーズンでライトアップもしているらしい。朝みても紅葉がすごくきれいだったのでライトアップも期待して見に行ってよさそうに思えた。時間があれば3時間ぐらいハイキングしても楽しめると思う。</p><p><figure><img src=/diary/img/2021/1121_forest1.jpg></figure><figure><img src=/diary/img/2021/1121_forest2.jpg></figure><figure><img src=/diary/img/2021/1121_forest3.jpg></figure></p><h2 id=六甲山牧場>六甲山牧場</h2><p>森林植物園から10分ちょっとぐらいで <a href=https://rokkosan.jp/>六甲山牧場</a> に着いた。ここも北エリアしかまわれなかったけど、山羊と羊と馬と牛に触れながらのほほんできるような場所。小さい子ども連れの家族が多かったので、子どもが動物と遊んでいるところの邪魔をしないように配慮しながら楽しむ感じ。</p><figure><img src=/diary/img/2021/1121_goat.jpg></figure><p>ちょっと前に山羊は草を食べてくれるという榛葉賀津也氏のツィートをみかけた。実家に草刈りのために定期的に帰るのが面倒だと常々思っていたので山羊を飼えばいいんじゃないかと考えている。そのためには山羊が生活する場所を作ってあげないといけない。田んぼの余っているスペースに柵を設け、一緒に山羊小屋も作ってあげればよさそう。六甲山牧場でも山羊はずっと草を食べていた。その辺に生えている雑草を食べるのかどうかわからないけど、確かに草を食べてくれそうな雰囲気はした。すぐに出来ることではないけど、段階的に実家で山羊を飼うための調査をしていこうと思う。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>【スタッフ】注目！！4月15日読売新聞夕刊に「ヤギのおじさん！」として紹介されました！ <a href=https://t.co/3lIObrub4X>pic.twitter.com/3lIObrub4X</a></p>&mdash; 参議院議員 榛葉賀津也 (@SHIMBA_OFFICE) <a href="https://twitter.com/SHIMBA_OFFICE/status/1382868429384806401?ref_src=twsrc%5Etfw">April 16, 2021</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=六甲山天覧台>六甲山天覧台</h2><p><a href=https://www.rokkosan.com/tenrandai/>六甲山天覧台</a> も行こうと予定していたが、道を間違えて辿り着けなかった。次回の機会があれば挑戦する。</p><h2 id=菊正宗酒造記念館と櫻正宗記念館>菊正宗酒造記念館と櫻正宗記念館</h2><p>お昼ごろに六甲山を降ってきたので <a href=https://www.kikumasamune.co.jp/kinenkan/>菊正宗酒造記念館</a> に行ってみた。お酒造りの道具や作業方法などの展示があって、お土産コーナーで無料試飲と有料試飲があって、無料でも2種類のきき酒ができる。お金を払うと4種類+つまみやアイスなどが付いてくるみたい。私は運転しないといけないのできき酒は飲めなかったけど、お酒が好きな人はいろんなお酒を試せておもしろそうに思う。</p><p>ついでにすぐ近くにある <a href=https://www.sakuramasamune.co.jp/sakuraen/sakuraen_index.html>櫻正宗記念館“櫻宴”</a> にも寄ってみた。ここは菊正宗記念館に比べると展示類などは少ないが、お土産コーナーは充実していたのとカフェと食事処は充実していた。また無料試飲はなく有料試飲のみだった。</p><p>灘五郷にはこういった記念館がたくさんあるので <a href=https://www.hyogo-tourism.jp/course/result/35>灘五郷酒蔵めぐり</a> をしても楽しそうに思えた。</p><h2 id=人と防災未来センター>人と防災未来センター</h2><p>レンタカーのレンタル時間がまだ少しあったので <a href=https://www.dri.ne.jp/>人と防災未来センター</a> に行ってみた。西館と東館に分かれていて、西館は阪神・淡路大震災の映像や展示など、東館は地震や津波一般の展示が行われているらしい。西館だけみてきた。10分ぐらいの阪神・淡路大震災の再現映像をみたけど、これはかなり迫力があって、震度7という地震の恐ろしさが伝わってきた。私は南あわじ市で15歳のときに震災を経験したけど、南あわじ市は震度4で大した被害がなかったと思う。震度7とか死んでてもおかしくないというのが再現映像から受け取れた。この映像をみて防災意識を高めるだけでも価値があったように思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1120/>レンタカーを予約した</a></h1><div class=post-meta><time class=post-date>2021-11-20 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/food/>food</a>&nbsp;</span><div class=post-content><p>1時前後に寝て6時に起きた。前日から母が泊まっていて、母は5時ぐらい起きて作業し始めるので必然的に朝起こされる。部屋を掃除してくれたのできれいになった。</p><h2 id=ストレッチ>ストレッチ</h2><p>今週もお仕事に忙しくてあまりストレッチもウォーキングはできなかったものの、前週から中殿筋 (ちゅうでんきん) の張りはずっと残っていて、今日もトレーナーさんによく伸ばしてもらったものの張りが強いなと言う印象がある。今日の開脚幅は開始前168cmで、ストレッチ後169.5cmだった。前週とほぼ同じで現状維持ちょっとよくなったぐらいかな。ボールを使った中殿筋のストレッチが気持ちよくて疲れたときによくやっているけど、やっぱり1人でやるストレッチには限界があって、誰かに押してもらったり伸ばしてもらったりする方がよく効く。</p><h2 id=三ノ宮元町観光>三ノ宮・元町観光</h2><p>親族が来ているので観光案内してきた。うちの会社のオフィスなども紹介した。三ノ宮・元町でショッピングして、南京町で豚まんや小籠包を買い食いしてきた。お昼は <a href=https://www.udonnoshikoku.com/>饂飩の四國</a> という老舗のうどん屋さんに入った。前からお店は知っていて、いつか入りたいなと思いつつ、やや価格帯も高いのでうどんだとちょっと高いかな？とも思っていたけど、今日初めて入ってみて食べたらおいしかったので価格は妥当と言える。私はおろし醤油焼きなすうどんを食べた。コシがあって長い麺はそれだけでもおいしかった。天ぷらが豪華だったので、接待などで天ざるや天丼をお勧めするのもよさそう。</p><figure><img src=/diary/img/2021/1120_udon.jpg></figure><h2 id=オリックスレンタカー>オリックスレンタカー</h2><p>住んでいるところに一番近いレンタカーに <a href=https://car.orix.co.jp/>オリックスレンタカー</a> がある。前に一度借りたことがあって、そのときは普通にお店に行って明日借りたいと言えば予約できた。今日も同じノリで明日借りたいと言ったら予約が埋まってますと返された。仕方ないと思って次に近いトヨタレンタカーで尋ねてみたけど、同様に予約が埋まっていますと返された。ネットで探すかなぁと思って、試しにオリックスレンタカーのアカウント作成して、予約検索してみたらちょうど探していたコンパクトサイズで予約できた。ほんの1時間前は予約で埋まっていると店員さんが言っていたのに、、、と思い返しながらいくつかのケースを考察した。</p><ul><li>私が質問して帰った後にたまたまキャンセルが出た</li><li>店舗予約とネット予約の在庫を別で管理していて、店舗予約在庫はなくなっていたが、ネット予約在庫だけ残っていた</li><li>店員さんが在庫を勘違いしていて実は1車だけ残っていた</li><li>Web の予約システムがバグっていて実は在庫がないのにネットから予約できてしまった</li><li>ネット予約すると近くの他の支店で余っている車両を再配置するワークフローがあるために予約できた</li></ul><p>昨日のメタ認知が暴走するではないけど、メタ認知を働かせるといろんなケースが出てくる。明日お店に行ってちゃんと配車されることを期待する。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1119/>メタ認知にもの思い</a></h1><div class=post-meta><time class=post-date>2021-11-19 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/metacognition/>metacognition</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;</span><div class=post-content><p>0時に寝て6時に起きた。昨日も疲れててウォーキングには出掛けられなくて寝て、3時や4時に起きつつも気付いたら5時半に起きてて、そう言えばと思い出したときに6時だったというふわふわした寝起きだった。</p><h2 id=朝活-ミクロ経済学入門の入門>朝活: ミクロ経済学入門の入門</h2><p><a href="https://www.youtube.com/watch?v=g9-KQ76QmtI">［金朝ツメトギ］ 2021-11-19 AM 6</a> で第10章の再分配を読んだ。この本はほとんど朝活で読み終えた。</p><p>市場は社会的余剰が最大化されるので社会全体の富を増やす働きの強い制度だという。その増える富の方向性をタテとヨコで表現しているが、タテ方向に増やす働き (資本家が莫大な富をもつ) はあっても、ヨコ方向に拡げていく (みんなが裕福になる) 機能はないという。本章では所得の再分配と、再分配が適正かどうかを測るための指標として <strong>ジニ係数</strong> について説明されている。ジニ係数を使うと、所得分布から不平等の状態を客観的に把握することに優れているという。富める者から貧しい者へ所得を移転することでジニ係数が下がる。ただし、両者の貧富を逆転させないものを <strong>ピグー・ドールトン移転</strong> と呼ぶ。このピグー・ドールトン移転を実行し続けると、最終的に所得分布は全員が同じである <strong>完全平等分布</strong> になる。このときのジニ係数はゼロになる。その逆に、1人がこの世すべての所得を独り占めすると <strong>完全不平等分布</strong> となり、そのジニ係数は 1 (に近い値) となる。</p><figure><img src=/diary/img/2021/1119_gini-coefficient.png></figure><ul><li>絶対的貧困: 世界銀行は生命の維持に必要な基準として1日の所得1.25ドルと定めている、絶対的貧困の指標の1つと考えられる</li><li>相対的貧困: 所得分布の真ん中の50%と OECD が定めている<ul><li>相対的貧困の基準に満たない人口の占める割合を <strong>相対的貧困率</strong> と呼ぶ</li><li><a href=https://www.mhlw.go.jp/toukei/saikin/hw/k-tyosa/k-tyosa19/dl/03.pdf>2019年 国民生活基礎調査の概況</a> によると、2019年の値は 15.7% になるらしい。6-7人に1人ぐらいの割合になる</li></ul></li></ul><h2 id=メタ認知が暴走>メタ認知が暴走</h2><p><a href=https://kentarokuribayashi.com/journal/2021/11/18/2021%e5%b9%b411%e6%9c%8818%e6%97%a5>あんちぽさんの日記</a> に次の動画が紹介されてた。<a href=https://note.com/t2y1979/n/n4713058f48ce>メタ認知で〈学ぶ力〉を高める：認知心理学が解き明かす効果的学習法</a> を読んでから、学びや書くことについてメタ認知というキーワードを意識して考えるようになっている。この動画ではメタ認知を「相対化」と説明していた。自己を相対化して、様々な文脈や状況、相手の意図なども考慮して結論が出せなくなったり、思考がまとまらなくなってしまうという。そういうメタ認知が暴走する人間を <em>メタモン</em> と名付けていた。ここでいう「モン」はモンスターの短縮なのかな？なかなかおもしろい。こんな極端ではないけど、私も相手の意図や状況を深読みしてしまって静観の姿勢を取るものの、なにも考えてない人だったりすると無駄に時間を浪費してしまうこともある。他にも <a href=https://ja.wikipedia.org/wiki/%E9%8A%83%E3%83%BB%E7%97%85%E5%8E%9F%E8%8F%8C%E3%83%BB%E9%89%84>銃・病原菌・鉄</a> の話題が気になって wikipedia を軽く読んだりした。</p><div class=video-container><iframe src=https://www.youtube.com/embed/sj7eer2tArs allowfullscreen title=意図せずメタ認知が暴走する悲しき怪物【ミーム提案委員会2】＃71></iframe></div><h2 id=会食>会食</h2><p>姪が大学に進学するそうでその面接に来たので一緒に晩ご飯することに。姉の勤め先の関係会社で <a href=https://kobe-plaisir.jp/>神戸プレジール</a> という神戸牛ステーキのややたっかい系のレストランで食べてきた。コース料理で1万円/人で飲みものやデザートなどは別途6千円ほどだった。但馬牛や神戸牛のステーキはもちろんとてもおいしかったんだけど、もう自分はこういう料理を求めてないなというのも感じた。個室で食べてたんやけど、姉の仕事の関係者が5-6人ぐらい、入れ代わり立ち代わりにやってきて、姉は直売所のパートだったのが、いつの間にか社員になって、いつの間にかナンバー2になっているらしい。おまけでフォークリフト免許まで取っている。なんやかんやも含めて、この場所を晩ご飯に選んでいるのもあるんだろうけど、職場の周りの人にしか言っていない今日の予定を、どこかで聞きつけて挨拶にくる関係者の人たち。私が学生の頃「田舎の噂は isdn より速い」と言ったものだけど、いまは「光回線よりも速い」と言うらしい。姉がいろんな関係者に挨拶しているのをみながら、もう自分はこういう仕事もたぶんできないなと実感した。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1118/>今年は忘年会やる</a></h1><div class=post-meta><time class=post-date>2021-11-18 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/git/>git</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;</span><div class=post-content><p>1時に寝て3時に起きて2度寝して6時に起きた。起き上がれなくて6時半までだらだらしてから起きた。</p><h2 id=リポジトリの改行コード指定>リポジトリの改行コード指定</h2><p>git のリポジトリ設定で <a href=https://git-scm.com/docs/gitattributes>.gitattributes</a> という設定方法がある。ざっくり理解するには <a href=https://kiririmode.hatenablog.jp/entry/20170416/1492300735>.gitattributesによる改行コードの変換設定</a> を読むのが早い。とりあえずこんな設定にしてみた。すでに crlf の改行コードでコミットされたファイルがあるため、それらを lf に変換しないといけない。<code>eol=lf</code> にすると crlf でコミットされている既存ファイルも変換してくれるみたい。おそらくチェックアウトしたときにそうなるのかな？</p><pre tabindex=0><code>*       text=auto eol=lf
*.jar   binary
</code></pre><p>ここ数年は Windows マシンを開発に使っている開発者と一緒に働いたことがなかったけど、OS 混在環境だとリポジトリ設定が必要だということに気付いた。多様性は大事。</p><h2 id=忘年会>忘年会</h2><p><a href=https://kobe-sannomiya-dev.connpass.com/event/231602/>三宮.dev＆bizpy 合同忘年会</a> に参加登録した。bizpy だけだと、忘年会の参加者を集めるのは厳しそうなので三ノ宮.devと共同でやる。これなら最低でも2人は確定しているのでイベントがなくなることはない。日程は参加者の希望を聞きながら水曜か金曜でやるみたい。いましか飲み会できないだろうからいいと思う。</p><h2 id=ミクロ経済学入門の入門>ミクロ経済学入門の入門</h2><p>第9章の公共財を読んだ。市場を考察するときに扱う財は一般論として <strong>私的財</strong> を想定している。私的財は次の2つの性質を満たす。</p><ul><li>競合的: 複数の人々が同時に利用できない</li><li>排除的: 拠出に貢献した特定のメンバーしか利用できない</li></ul><p>一方で私的財と対偶の関係にある競合的でも排除的でもない財を <strong>公共財</strong> と呼ぶ。例えば、国防サービスや一般道路などが相当する。侵攻してくる敵国から自国を防衛するときにすべての国民、納税していない人であっても国防の利益にあずかれる。非競合的だが、排除的である財を <strong>クラブ財</strong> と呼ぶ。高速道路などが相当する。みんなが利用できるが、利用料金を収めないと利用できない。競合的だが非排除的な財を <strong>コモンプール財</strong> と呼ぶ。漁場などが相当する。どの漁師が魚を獲るかは競合しているが、漁業権をもっている限り漁そのものは制限されない。</p><p>これをまとめると、財は次の4つの分類になる。</p><table><thead><tr><th style=text-align:center></th><th style=text-align:center>競合的</th><th style=text-align:center>非競合的</th></tr></thead><tbody><tr><td style=text-align:center>排除的</td><td style=text-align:center>私的財</td><td style=text-align:center>クラブ財</td></tr><tr><td style=text-align:center>非排除的</td><td style=text-align:center>コモンプール財</td><td style=text-align:center>公共財</td></tr></tbody></table><p>公共財の自発的供給の問いとして、排除的でも競合的でもない公共財が人々の自発的な行動で十分に供給できるかを考える。自分のお金を寄付する・寄付しないの2択でマトリクスを作成する。自分は寄付せず、他人の寄付から利益を得ることを <strong>フリーライド</strong> と呼ぶ。みんながフリーライドをしようとすると公共財はまったく供給されない。A と B の2者間における利得表を表すと次のようになる。相手が寄付して、自分が寄付しないときに最大の利益となり、どちらも寄付しないよりは両者が寄付した方が利益が大きくなる。</p><table><thead><tr><th style=text-align:center>A \ B</th><th style=text-align:center>寄付する</th><th style=text-align:center>寄付しない</th></tr></thead><tbody><tr><td style=text-align:center>寄付する</td><td style=text-align:center>4, 4</td><td style=text-align:center>2, 5</td></tr><tr><td style=text-align:center>寄付しない</td><td style=text-align:center>5, 2</td><td style=text-align:center>3, 3</td></tr></tbody></table><p>A が寄付するか・しないかの選択は、B の寄付の有無に関係なく、A は寄付しない方が寄付したよりもトクすることになる。相手がどういった選択をしても自分にとって一番トクな選択肢が同じときにその選択肢を <strong>支配戦略</strong> という。この話は B からみても同じになる。A も B も寄付しないがトクする状態のことを <strong>支配戦略均衡</strong> という。この状態が最善かと言えば、そうではなく、両者が寄付した方が両者が寄付しないよりもトクする状態になる。このように公共財の供給を個々のプレイヤーに任せていては <strong>パレート劣位</strong> な結果となってしまう。この状態からどうやって両者が寄付する <strong>パレート優位</strong> な状態に移行できるかを考えるのが、政府の徴税の方策と言える。</p><p>政府が誰にいくらの税を課して、どの程度の量の公共財を適切と決めるのかは難しい問題である。放っておいて上手くいかないものの、政府に任せて上手くいくことも保証されない。このようなゲーム理論を制度設計に活用する <strong>メカニズムデザイン</strong> という専門分野がある。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1117/>Testcontainers を触ってみた</a></h1><div class=post-meta><time class=post-date>2021-11-17 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/morning-activity/>morning activity</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/java/>java</a>&nbsp;</span><div class=post-content><p>23時頃に寝て3時に起きて、そこから寝たり起きたりしながら6時に半に起きた。怖い夢をみて眠れなくなって中途半端に寝てた。</p><h2 id=朝活-雑談>朝活: 雑談</h2><p><a href=https://kobe-sannomiya-dev.connpass.com/event/231078/>【三宮.dev オンライン】リモート朝活もくもく会</a> に参加した。寝坊、、、というよりは起きてたけど、イベントを忘れていて6時45分ぐらいから参加して主催者しかいなかったのでそのまま7時半まで雑談してた。始めが悪いとだらだらしてしまう。気をつけねば。</p><p>三宮.dev の主催者や参加者の常連さんたちとはだいぶ身近に話すにようになってきた。コミュニティって人間関係だと思っていて、話したり顔をあわせたりする回数が増えるに従って身近な知人になっていって、それ自体が価値の1つだったりすると思う。いま忘年会の企画を三宮.dev でも行っているが、bizpy と合同でやっていいんじゃないかと考えている。</p><h2 id=testcontainers>Testcontainers</h2><p>DB を使ったユニットテストのために <a href=https://www.testcontainers.org/modules/databases/postgres/>Testcontainers Postgres Module</a> を使ってみた。docker hub からイメージを取得して JUnit のテストプロセスの中からアクセスできるようにするためのライブラリになる。コンテナの扱いをテストコードから管理したいときなどに便利。ちょっと調べて簡単に設定できたのでまた時間のあるときに会社のブログに記事を書こうと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1116/>カスタム GitHub Actions のサンプルを作ってみた</a></h1><div class=post-meta><time class=post-date>2021-11-16 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;</span><div class=post-content><p>23時半に寝て5時半に起きた。昨夜は夜にウォーキングに出掛けようと思いつつ、22時頃に1時間ほど寝てしまった。それで出掛けるのが面倒になってそのまま寝てた。早く寝た分、早く起きた。せっかく早起きしたのでドラクエタクトのデイリーミッションやって、それから起きて7時ぐらいにはオフィスに着いてたと思う。</p><h2 id=カスタム-github-actions-作成>カスタム GitHub Actions 作成</h2><p>GitHub Docs の <a href=https://docs.github.com/ja/actions/creating-actions>アクションの作成</a> をみながらサンプルを作ってみた。カスタムアクションは3つの作成方法がある。</p><ul><li>docker コンテナを使ったアクション</li><li>javascript を使ったアクション</li><li>シェルスクリプトなどを使ったアクション (composite アクション)</li></ul><p>たぶんランタイムに何を使うかでアクションの作り方が異なるようにみえる。最後の composite アクションは呼び出される環境で動くことを想定しているのかな？サンプルには bash 上で動くものを紹介していた。ほとんどチュートリアルの内容そのままんだけど、動かして雰囲気を掴むために自分で composite アクションを作ってみた。単一のリポジトリに閉じたものなら通常のワークフローの設定に書けばいいけど、複数のリポジトリで同じ処理をしたい場合は composite アクションとして再利用できるようにするとよさそう。</p><ul><li><a href=https://github.com/t2y/gh-actions-sample>https://github.com/t2y/gh-actions-sample</a></li></ul></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/posts/page/79/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/posts/page/81/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>