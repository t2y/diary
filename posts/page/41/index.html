<!doctype html><html lang=en><head><title>Posts :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/posts/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:url" content="/diary/posts/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/posts/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1208/>rabbitmq 再び</a></h1><div class=post-meta><time class=post-date>2022-12-08 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/auth/>auth</a>&nbsp;
#<a href=/diary/tags/rabbitmq/>rabbitmq</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/blockchain/>blockchain</a>&nbsp;</span><div class=post-content><p>0時に寝て3時に起きて6時半に起きた。前日あまり寝てなかったから普段よりよく眠れた。</p><h2 id=rabbitmq-の認証>rabbitmq の認証</h2><p>たまたまなのだけど、前のお仕事でも rabbitmq を使っていて、いまのお仕事でも rabbitmq を使っている。私の中では <a href=https://kafka.apache.org/>kafka</a> のエコシステムに感銘を受けたので私が技術選定してよいなら kafka を使っていきたいところだけど、rabbitmq も人気があってすごいなと思う。インフラを触っていて rabbitmq の認証をしていないことに気付いた。<a href=https://hub.docker.com/_/rabbitmq>rabbitmq の docker image</a> を使うとデフォルトで guest/guest のユーザーが作られる。</p><blockquote><p>If you wish to change the default username and password of guest / guest, you can do so with the RABBITMQ_DEFAULT_USER and RABBITMQ_DEFAULT_PASS environmental variables. These variables were available previously in the docker-specific entrypoint shell script but are now available in RabbitMQ directly.</p></blockquote><p>おそらくメッセージのやり取りを通信するときも何も指定しなかったら guest ユーザーとして扱っているのかな？通信するときの <a href=https://www.rabbitmq.com/uri-spec.html>RabbitMQ URI Specification</a> によると、<code>amqp://user:pass@host:10000/vhost</code> のような、昔ながらの uri にユーザー／パスワードを埋め込むような認証になる。このやり方だと uri 自体が credentials になってしまって運用の使い勝手が悪くなってしまうものの、アプリケーションの変更は必要ないというメリットもある。おそらく歴史的に認証は後付けで追加されたのかな？ともかく実際の運用だとユーザー／パスワードでアクセス制御を行うだろうと想定されるので気付いたタイミングで開発環境の docker image の設定と uri の変更を行った。</p><h2 id=時事ネタの気軽な雑談会>時事ネタの気軽な雑談会</h2><p><a href=https://play2learn.connpass.com/event/267936/>【おはなし会】CEXだって安全にできるもん</a> に参加した。ちょうさんは fin-py のイベントで何度か発表を聞いたことがある。データサイエンス系のお仕事をされているのかな？<a href=/diary/posts/2022/1113/>ftx 事件</a> をうけて ethereum の創始者である vitalik buterin 氏がブログに投稿したアルゴリズムの解説をされていた。</p><ul><li><a href=https://vitalik.ca/general/2022/11/19/proof_of_solvency.html>Having a safe CEX: proof of solvency and beyond</a></li></ul><p>取引所の不正を防ぐための仕組みとして、それぞれの口座の残高を公開しなくても merkle tree とハッシュ関数をうまく使って、取引所が実際に管理している残高とユーザーの残高が一致しているかをチェックできるような、そんなアルゴリズムだったと思う。ちゃんとブログの記事を読んでないけど、ちょうさんの解説を聞く分にはアルゴリズムはそう難しくないように思えた。そんなすごい仕組みじゃなくて、簡易的に大きな計算コストもなく全体の残高があっていることのおおよそのチェックはできますよといったもの。</p><p>イベントが始まる前にちょうさんが大学の研究室にいた頃、研究室へ行くと同僚がいて気軽に新しい技術の話しができたけど、社会人になるとそういう機会が減ってしまったという。時事ネタを気軽に雑談できるイベントがあればという話しをされていて私も共感できた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1207/>gitlab の ci/cd 入門</a></h1><div class=post-meta><time class=post-date>2022-12-07 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/gitlab/>gitlab</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>0時に寝て3時に起きてそのまま眠れずにいたら6時になって7時過ぎから準備してオフィス行ってお仕事を始めた。</p><h2 id=gitlab-の-cicd-の調査>gitlab の ci/cd の調査</h2><p>初めて <a href=https://docs.gitlab.com/ee/ci/>GitLab CI/CD</a> を触っている。まだ触り始めたばかりだが、感覚的には github actions 相当の機能はあるようにみえる。ソースコードリポジトリやパッケージリポジトリ／コンテナレジストリと ci/cd がセットになっているととても便利だ。これはすごいことだと最近思うようになってきた。もはやソースコードリポジトリのみのホスティングビジネスは成り立たない。なぜなら github や gitlab のような ci/cd が当たり前になってしまうと、その機能がない場合、デメリットを上回るメリットがないとそんなソースコードリポジトリを選択しない。</p><p>docker image をビルドして push する仕組みは既にメンバーが作ってくれていたのでその後始末の処理を作った。<a href=https://docs.gitlab.com/ee/api/container_registry.html>Container Registry API</a> を使うと、不要な docker image を削除できる。</p><ul><li><a href=https://docs.gitlab.com/ee/api/container_registry.html#delete-registry-repository-tags-in-bulk>Delete registry repository tags in bulk</a></li></ul><p>削除向けに便利な api 設計になっている。こういう細かい配慮は嬉しい。<code>keep_n</code> で最低限残すイメージ数を指定して <code>older_than</code> で過去何日より古いイメージを削除対象とするといったよくある運用の設定ができる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -s -H <span style=color:#e6db74>&#34;PRIVATE-TOKEN: </span>$PROJECT_ACCESS_TOKEN<span style=color:#e6db74>&#34;</span> -X DELETE <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>endpoint<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#34;name_regex_delete=.*&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#34;keep_n=</span><span style=color:#e6db74>${</span>KEEP_N<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#ae81ff>\
</span></span></span><span style=display:flex><span><span style=color:#ae81ff></span>  --data <span style=color:#e6db74>&#34;older_than=</span><span style=color:#e6db74>${</span>OLDER_THAN<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>あとは認証のトークンを指定する方法として私が調べた限りだと2通りある。</p><ul><li>(<code>ci_job_token_scope</code> の feature flag を有効にして) <code>$CI_JOB_TOKEN</code> を使う<ul><li>こっちの方が一時トークンなのでよりセキュアなはず</li><li>この場合はヘッダーに JOB-TOKEN を指定する</li></ul></li><li><a href=https://docs.gitlab.com/ee/user/project/settings/project_access_tokens.html>プロジェクトレベルのアクセストークン</a> を発行して ci/cd の variables に登録する<ul><li>トークンが漏洩したときにプロジェクトレベルで被害が発生する</li><li>この場合はヘッダーに PRIVATE-TOKEN を指定する</li></ul></li></ul><p>使うトークンによってヘッダーが変わるというのがちょっと変な認証の設計にもみえるけど、まぁそれぐらいしか気にはならない。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1206/>echo のよさの1つはテストがやりやすい</a></h1><div class=post-meta><time class=post-date>2022-12-06 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=post-content><p>にわかサッカーファンになって、20時頃に1-2時間寝て24時からワールドカップのクロアチア戦をみて3時に寝て8時に起きた。睡眠のリズムが完全に狂ってしまった。</p><h2 id=echo-のテストのやりやすさ>echo のテストのやりやすさ</h2><p>うちのチームでは http フレームワークに <a href=/diary/posts/2022/1122/#echo-を採用>echo を採用</a> している。その後、開発を継続していていくつか http ハンドラーも実装されてきた。そろそろ http ハンドラーのテストを書いていこうと参照実装を私が書いてみた。メンバーが知らないことは、マネージャーの私が参照実装して教えるといったやり方をしている。echo.HandlerFunc に echo.Context を渡すシンプルなインターフェースはテストを書くときに http ハンドラー以外の依存関係 (例えば db とのコネクションなど) を context を介することでモックと差し替えるのが容易になる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>tests</span> <span style=color:#f92672>:=</span> []<span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>name</span>    <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>ctx</span>     <span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>Context</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>err</span>     <span style=color:#f92672>*</span><span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>HTTPError</span>
</span></span><span style=display:flex><span>} {
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>func</span>() <span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>Context</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>data</span> <span style=color:#f92672>:=</span> <span style=color:#e6db74>`{...}`</span>
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>newEchoContext</span>(<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>MethodPost</span>, <span style=color:#e6db74>&#34;/endpoint&#34;</span>, <span style=color:#a6e22e>data</span>)
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>Set</span>(<span style=color:#e6db74>&#34;db&#34;</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>myMockDB</span>{})
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>c</span>
</span></span><span style=display:flex><span>	}(),
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>myHTTPHandler</span>(<span style=color:#a6e22e>ctx</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>こんな感じで context にモックを入れてしまえば http ハンドラーそのものの単体テストを簡単に書ける。そんなことをツィートした。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>その後 echo を採用して echo のよいところに1つ気付いた。echo.HandlerFunc に echo.Context を渡すインターフェースはテストがやりやすい。例えば、コンテキストで db のコネクションを保持しておけば、テストのときにモックに差し替えて http ハンドラーの単体テストを実装しやすい。</p>&mdash; Tetsuya Morimoto (@t2y) <a href="https://twitter.com/t2y/status/1600337204286746624?ref_src=twsrc%5Etfw">December 7, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>そしたら podhmo からレスをもらったので go のリクエストコンテキストの扱いについても議論した。</p><ul><li>リクエストスコープのものを context に入れるのは同意</li><li>それ以外のスコープのものを context に入れるのは懸念がある<ul><li>http ハンドラーのレイヤーとアプリケーションのレイヤーが明確に分かれているならまだ理解できる</li><li>アプリケーションのレイヤーで context を自由に使うと依存関係や統制が取れなくなる<ul><li>これは私も同意するところでアプリケーションのレイヤーにリクエストコンテキストを渡す必要はない</li></ul></li></ul></li></ul><blockquote class=twitter-tweet><p lang=ja dir=ltr><a href=https://t.co/Yomdbyh1H0>https://t.co/Yomdbyh1H0</a><br><br>昔にこういう記事を書いてた。<br>chiはルーティングライブラリと考えるとスムーズ。<br><br>あとはnet/httpのミドルウェアを使いたいかechoなど専用のものを書くかの違いくらいかな。 <a href=https://t.co/9LtoanpY0c>https://t.co/9LtoanpY0c</a></p>&mdash; po (@podhmo) <a href="https://twitter.com/podhmo/status/1600338082242646016?ref_src=twsrc%5Etfw">December 7, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><h2 id=オフィス住所の更新>オフィス住所の更新</h2><p>引き続き、住所変更の手続きを時間をみつけてやっている。同じ銀行の住所変更の手続きでも PayPay 銀行と三菱 UFJ 銀行ではまったく異なる。前者はオンラインでアカウント情報を変更するだけで済んだ。簡単。一方で後者はオンラインではできず、来店予約をとって対面で行う。当日に登記事項証明書の原本をもってこいと。なんという面倒臭さ。よくよく考えたら法人の登記事項証明書は誰でも取得できる。行政のシステムがどうなっているか知らないが、銀行が法人の住所変更を自分たちで調べることもやろうと思えばできるはず。登記事項証明書をオンラインで取得する手数料は500円になる。来店予約すると応対する人の人件費を考えたらシステムの手数料を支払った方が安いのではないか。</p><p>国税庁の管轄ではあるが、<a href=https://www.houjin-bangou.nta.go.jp/>国税庁法人番号公表サイト</a> から法人の住所変更そのものは確認できる。これは e-tax で次の2つの書類を申請した。登記事項証明書がなくても申請はできた。なにも言ってこなければ問題ないのかな？</p><ul><li>異動届</li><li>給与支払事務所等の開設・移転・廃止の届出</li></ul><p>有償にはなるが <a href=https://www1.touki.or.jp/night.html>登記情報提供サービス</a> というのがあって登記情報をオンラインで確認できる。このサービスを会社で契約していればいつでも確認できるはず？</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1205/>法人登記変更申請にもの思い</a></h1><div class=post-meta><time class=post-date>2022-12-05 (Mon.) ::</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/government/>government</a>&nbsp;</span><div class=post-content><p>4時に寝て8時に起きた。3時過ぎまでオフィスの片付けなどをやっていた。貧乏暇なし。</p><h2 id=年金事務所でヒアリング>年金事務所でヒアリング</h2><p>8時半から住所変更のために年金事務所に立ち寄る。会社の住所変更をすると行政機関にその申請をしないといけないが、年金事務所がもっとも短くて移転後5日以内となっている。行ってみたら登記事項証明書のコピーがないと手続きをできないという。すべてに先立って法人登記の変更申請が必要なことがわかった。法人登記の変更申請に1週間かかるのでその時点でこの手続きは無理だとわかった。行政のバグの1つかもしれない。</p><h2 id=法務局で法人登記の変更申請>法務局で法人登記の変更申請</h2><p>以前、電子公告の変更で法人登記の変更申請をやったことがあったので手続きの雰囲気を理解していた。お昼休みを兼ねて法務局へ住所変更の申請に行く。合同会社の法人登記の変更申請は次のリンクにある。</p><ul><li><a href=https://houmukyoku.moj.go.jp/homu/COMMERCE_11-1.html#3-3>３　商号・目的の変更，本店移転</a></li></ul><p>しかし、このリンクを辿ると、3つの記載例がある。</p><blockquote><p>3-4 合同会社変更登記申請書（商号の変更及び目的の変更）【R4.11.11更新】</p><p>3-5 合同会社本店移転登記申請書（管轄内移転）【R4.9.20更新】</p><p>3-6 合同会社本店移転登記申請書（管轄外移転）【R4.9.20更新】</p></blockquote><p>ここで私が慌てていて 3-4 の「商号の変更及び目的の変更」の記載例しか目に入ってなくてその内容を確認して申請書類を作って提出してきた。後日、担当者から決定書が必要ですと電話がかかってきた。私が参考にしないといけない記載例は 3-5 の「管轄内移転」の方だった。たしかにその書類には決定書が含まれていた。3-4 にはそれが不要だったので申請書類から漏れた。後日、決定書を再作成して法務局へ再申請に行ってきた。申請自体は15分もあれば終わる作業だけど、1度で終わらせる手続きを済ませられなかったという自分の不甲斐なさにショックを受けた。余裕をもって周りの観察が大事という話し。</p><p>初めての会社のオフィス移転で学ぶことも多かった。申請には「原因年月日」を記述できるので予め前もって登記変更の申請を行うことはできないのだろうか？移転後2週間以内に申請する必要があると書かれた記事を読んでいたので私は引っ越し後にしか申請できないと思い込んでいた。</p><p>また定款の記載内容によってはオフィス移転で定款変更も必要になる可能性がある。定款の変更には同意書が必要なため、さらに申請書類が増える。うちの会社の定款の条項は次になる。</p><blockquote><p>(本店所在地)
第3条 当会社は、本店を神戸市に置く。</p></blockquote><p>定款の本店所在地は市町村まで構わない。神戸市内で引っ越しする分にはうちの会社は定款変更を必要としない。おそらく会社を設立するときにオフィスがまだ決まっていなかったからそうしたのかもしれない。私が意図して定款の本店所在地を決めたわけではない気もする。freee 経由で定款作成代理人がよしなに作ってくれたようだ。感謝。</p><p>さらにたまたま申請する直前にオフィスの掲示板で来月からビル名が変わりますという掲示をみつけた。登記変更の申請を知らない人向けにこの手続きはどんな内容であろうが申請に手数料が3万円かかる。ビル名が変わったらその都度3万円支払う必要がある。少し調べてみると、新しいオフィスのビル名が変わるのは3度目でどうもそういう傾向のあるビルにみえる。これは4度目もありそうだ。登記の住所についてさらに調べてみると、法律上は番地まで記載すればよくてビル名を登記に含める義務はないという。今回の登記変更の申請にはビル名を含めず番地までとした。これで未来に4度目のビル名の変更があっても登記変更を申請しなくて済む。たまたま申請前にオフィスの掲示板を眺めて気付いたことで登記の住所の仕様を学ぶことができた。周りの観察は大事という話し。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1204/>掃除は respect を表現している</a></h1><div class=post-meta><time class=post-date>2022-12-04 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/team-building/>team building</a>&nbsp;
</span><img src=/diary/img/2022/1204_cleaning.jpg class=post-cover alt="掃除は respect を表現している" title="Cover Image"><div class=post-content><p>22時に寝て1時に起きて吐き気がして苦しんでた。その後、寝て1度起きて7時半に起きた。寒くなってきたせいか、疲労のせいか、なんとなく体調が悪い。今日も掃除したり荷解きの片付けやったりしていた。</p><h2 id=退去するオフィスの掃除>退去するオフィスの掃除</h2><p>ワールドカップが盛り上がっているので関連するニュースを読んでいるうちにサポーターだけじゃなく、選手もロッカールームをきれいに掃除して退出しているニュースをみかけた。</p><ul><li><a href=https://nlab.itmedia.co.jp/nl/articles/2211/24/news123.html>FIFA公式が日本代表のマナーを絶賛　ピカピカ更衣室に「ドウモ アリガトウ」</a></li></ul><p>日本では小学校の頃から自分たちの活動の場を自分たちで掃除するという習慣が当たり前のように教育されている。その延長で自分たちが使った場所は掃除して帰るといった価値観が一般的に定着しているように思う。掃除するお仕事を奪っているという批判も、掃除はボランティアがやっている、ボランティアと言っても有償ではある、有償といっても歩合制でお金をもらっているわけではないでしょうとか。さまざまな意見がある。批判を認めないわけではないが、私も掃除をすることは正義の1つだと最近思うようになってきた。12月3日に引っ越しするのに12月4日 (予備日) まで借りていた理由はとくになかったのだけど、オフィスを掃除するためだったんだなと後付けの理由ができた。朝から掃除機をオフィスへ運んで掃除してきた。</p><blockquote><p>This isn&rsquo;t just a clean dressing room, it&rsquo;s a clear demonstration of values.</p><p>It&rsquo;s a statement about respect, gratitude and attention to detail.</p><p>The small things are the biggest indicator of the big things - your values.</p><p><a href=https://www.linkedin.com/posts/stevenbartlett-123_this-is-how-the-japanese-mens-team-left-activity-7001499750009044992-qpeU/>https://www.linkedin.com/posts/stevenbartlett-123_this-is-how-the-japanese-mens-team-left-activity-7001499750009044992-qpeU/</a></p></blockquote><p>たまたまねとらぼの記事を読んだ後に linkedin の投稿もみかけた。日本人は掃除に respect なんか感じたことはないかもしれないけど、外からみるとそういった振る舞いの1つにみえるんだという気付きにはなった。やっぱり掃除は正義やね。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1203/>オフィスの引っ越し</a></h1><div class=post-meta><time class=post-date>2022-12-03 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;</span><div class=post-content><p>3時に寝て8時に起きた。疲労困憊だけど、今日を乗り切ればよい。9時から荷造りの続き。昨日の深夜に大半の荷造りを終えていたので2時間ほどで終えて軽く掃除したりしていた。</p><h2 id=引っ越し>引っ越し</h2><p>14時から <a href=https://rentora.com/>レントラ便</a> さんにお願いしていた。13時25分にレントラ便の担当者から電話がかかってきてオフィスに到着したとのこと。私もすでに準備出来ていたのですぐやりましょうということで搬出作業が始まった。作業員として1名しかお願いしてなかったが、先方の担当者は2名いたので荷物の搬出がその分楽になった。だいたい30分ぐらいで搬出作業が終わった。新しいオフィスに移動して14時から搬入作業を開始した。搬入作業はだいたい20分ぐらいで終わった。出すよりも入れる方が速かったのは、バンに荷物を積み込むときにスペース効率を考えながら配置する必要がないからだろう。時間に余裕があったので追加で新しいオフィスにある椅子を保管するために家まで運んでもらった。オフィスの椅子はアーロンチェアを使っているので備え付けの椅子はいらない。それが終わったのが14時25分だった。そこで事務手続きして完了とした。荷物の移動も含めて約1時間で引っ越し作業を終えた。本当は14-16時で依頼していたが、早く始めて想定したよりも早く完了していいこと尽くめだった。また次回があればレントラ便さんにしようと思う。その後、荷解きしながらぼちぼち片付けをしていた。</p><h2 id=ストレッチ>ストレッチ</h2><p>19時半からストレッチ。<a href=/diary/posts/2022/1127/#玉ねぎを植える準備>先週の田んぼ作業</a> でスクワットに近い運動をたくさんやったので月曜日や火曜日はひどい筋肉痛になっていた。水曜日以降はましになったが、若干の違和感も残っていた。今日の開脚幅は開始前144cmで、ストレッチ後150cmだった。疲労と筋肉痛でまったくいつも通りにはいかなかった。お腹つったり足裏つったりしてた。トレーナーさんが言うには筋肉痛のときは普段のストレッチをあまりやるよりも筋肉をほぐすようなストレッチをした方が早く回復するみたいな話しをされていた気がする。あとはワールドカップの話などをしていた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1202/>クリーンアーキテクチャを勉強し直したい</a></h1><div class=post-meta><time class=post-date>2022-12-02 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/design/>design</a>&nbsp;
#<a href=/diary/tags/iterative-and-incremental-development/>iterative and incremental development</a>&nbsp;
#<a href=/diary/tags/scrum/>scrum</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=post-content><p>0時に寝て5時前に起きたらサッカーやってて最後の10分ほどみた。まさかスペインに勝つと思ってなかったから驚いた。</p><h2 id=アーキテクチャと設計>アーキテクチャと設計</h2><p><a href=/diary/posts/2022/1130/#メンバーの送別会>退職したメンバー</a> がドメイン駆動開発 (DDD) とクリーンアーキテクチャから既存のアーキテクチャを構成したというドキュメントを残してくれた。そのドキュメントを読みながら、説明の粗いところや足りないところを私が補って加筆し、既存のコードを読みながら誤っているところなどをリファクタリングしたりしていた。あとアーキテクチャや設計のドキュメントを書く上で図がないのはよくない。現代の開発は分割統治の概念で設計されていて、そこで扱う本質的複雑さは依存関係になる。誤解を恐れずに言えば、現代の開発のアーキテクチャは依存関係をどう管理するかの基本的な考え方に過ぎない。依存関係の向きが分かるので図があった方が圧倒的にわかりやすい。一方で私自身もクリーンアーキテクチャにそう明るくない。もう少し勉強し直す必要があることは感じた。クリーンアーキテクチャ勉強会もやっていいようにも思う。</p><h2 id=課題管理--イテレーション開発とスクラム開発の勉強会>課題管理 + イテレーション開発とスクラム開発の勉強会</h2><p>今週ずっと朝起きたら2-3時間かけて資料を作り続けてきた。前回は時間が余ったので今回は余らないよう、最終的には43枚のスライドになった。</p><ul><li>スクラム事前知識</li><li>スクラムガイド</li><li>課題管理+イテレーション開発とスクラム開発との比較</li><li>スクラムマスター</li><li>会議体とツール</li><li>分析・計測</li><li>スクラムの是非</li><li>まとめ</li></ul><p>話してみたら1時間を10分ほどオーバーした。勉強会で1時間話すネタを調整をするのは難しい。毎月出張でオフィスへ行くときは課題管理に関する勉強会を行う。課題管理や開発方法論の話しを聞いてくれる人たちがいるというだけでありがたい。5日前から準備を始めて資料作りの時間が少なかったので細部の調査はあまりできていないし、構成も荒くて練れていない。もう2-3ヶ月かけて細部の調査や理論武装をしたらよいコンテンツになるかもしれない。イテレーション開発とスクラム開発を比較するときの叩き台として寝かしておく。</p><h2 id=オフィスの引越しの荷造り>オフィスの引越しの荷造り</h2><p>神戸に戻ってきて一旦家に帰って晩ご飯を食べて一息ついて、23時過ぎから引越しのための荷造りを始めた。大きい家電や電子機器は購入時の箱を置いておくと引越しのときの荷造りが楽になる。言うても一部屋の荷物なんで本気出せばすぐ終わる程度の量。3時間ほど荷造りやって8割ぐらいできたところで今日の作業は終えた。出張と移動で疲労は積み重なってきた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1201/>進捗報告</a></h1><div class=post-meta><time class=post-date>2022-12-01 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/project-management/>project management</a>&nbsp;</span><div class=post-content><p>23時に寝て何度か起きて7時に起きた。朝から近況報告のための資料を作ってた。</p><h2 id=プロジェクトの進捗報告>プロジェクトの進捗報告</h2><p>お手伝い先の経営者の方々と、この1ヶ月で私がやったこと、開発の進捗、今後の展望などを打ち合わせした。組織のことも業務のこともわかっていないマネージャーがやってきて開発プロジェクトを仕切ることになったのが1ヶ月前。そんな簡単に成果を出せるわけがないがないと考えているため、私の所感としてはぎりぎりの及第点といったところかな。開発体制を構築し、4つのイテレーションから成る1ヶ月というマイルストーンを設け、その最初のサイクルがまわって、メンバーもどういった働き方を私が求めているか理解できたと思う。毎週の勉強会を設けて知識やスキルをチームで共有することの大切さも啓蒙している。嬉しいことにチーム外からも参加者がいる。ここからはこのワークフローを最適化していくだけ。その下地を作った1ヶ月だった。先方からも開発のプロがやるマネジメントから学ぶことも多いといったコメントをもらえた。1on1 も節目のタイミングでしかやっていなかったらしく毎週1on1をやっているのはよさそうといった話題も出た。一方で目標としている時期にこのプロダクトは何ができるのかわからないから次回はそれを明確にしてほしいといった要望もいただいた。この1ヶ月の私の課題として対応していきたい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1130/>仲の良いチーム</a></h1><div class=post-meta><time class=post-date>2022-11-30 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;</span><div class=post-content><p>1時に寝て何度か起きて7時に起きた。起きてからも昨日の夜にやってた勉強会の資料作りをずっとやってた。</p><h2 id=1on1-で設計談義>1on1 で設計談義</h2><p>あるマージリクエストで私が nil ガードを実装した方がよいとコメントした。その意図がわからないという話になって nil ガードを実装する背景について、実際のコードをみながらメンバーに説明した。プログラミングの文脈では全然難しくないことではあるけど、あまり経験がない人にとってはその意図や考え方を学ぶのは難しいかもしれない。こういった、詳しい人に聞けばすぐ解決するけど、ググって調べるのは難しいこともある。1on1 のような身近に話す機会があると、定例会議でみんなの時間に話すほどの重要度ではない話題を聞くことができる。そこで聞いた意見をベースに私が issue 化したり、ある話題をチームで話し合う打ち合わせの機会を設けたりしている。</p><h2 id=メンバーの送別会>メンバーの送別会</h2><p>私があるチームのマネージャーをして1ヶ月が経つ。メンバーの1人が退職することになった。実はマネージャーになって1週間後に転職が決まったという話しだった。いきなり開発体制がバタバタしたけれども、私からみたらやることは変わらないのでその影響は最小限に留められたのではないかと思う。いまのところ、当初の開発の計画にも変更をきたしていない。出張でオフィスに来ている機会なので私もそのメンバーの送別会に参加した。他の社員さんも20人ぐらい参加されていた。飲み会の雰囲気をみていて若い人が自由に発言して楽しんでいるのを傍から眺めてた。飲み会の雰囲気ってその組織の性格が出ておもしろいと思う。イヤな人がいないのは組織において重要になる。後日、経営者の方々とそういう会話をしていたら小さい会社はみんな仲良くできるといった話しをされていた。たしかにそれぞれのメンバーの顔とやっていることを見渡せる規模だから親近感を抱きやすいと言えるかもしれない。ここ数年どこへ手伝いに行ってもよい雰囲気をもつ会社は多い。変な言い方だけど、よい世の中になったと思えて嬉しい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1129/>初めてのマイルストーンふりかえり</a></h1><div class=post-meta><time class=post-date>2022-11-29 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;</span><div class=post-content><p>0時に寝て何度か起きつつ5時に起きた。慣れないホテルでの就寝なのに昨日はバテバテだったから割と眠れた方だと思う。</p><h2 id=ふりかえり>ふりかえり</h2><p>1ヶ月 (厳密には4イテレーション) をマイルストーンとし、マイルストーンを終えたらふりかえりを行う。前にスクラム開発で行っていたふりかえり手法をベースにしながらやってみる。ポジティブなふりかえり向けに fun/done/learn という手法がよさそうだったので採用してみた。ツールは jamboard を使った。</p><ul><li><a href=https://qiita.com/yattom/items/90ac533d993d3a2d2d0f>ファン・ダン・ラーン(FDL)ふりかえりボード</a></li><li><a href=https://www.ogis-ri.co.jp/otc/hiroba/others/ActivityPocket/FunDoneLearn.html>ふりかえりでFun! Done! Learn!</a></li></ul><p>初めてやってみたので進め方そのものにいくつか反省があった。オフィスで大きいスクリーンに映してみんながみえるようにしながら jamboard にコメントを書き込んでいく同時作業が割と忙しかった。jamboard で付箋を書くときの操作性が微妙によくない。慣れの問題かもしれないけど、なにかあとひと押しの操作性が足りない気がする。</p><p>最初なのでやり方の例として私も付箋にコメントを書きながらやっていた。私が参加者の1人として振る舞うと進行が止まってしまって忙しくなることに気付いた。あとで付箋に対して「いいね」をつけて共有してもらうときに、私の役割が開発者としての振る舞いとファシリテーターとしての振る舞いが混ざってしまって、他の参加者がどう感じたかはわからないが、私自身がいま何をやろうとしているのか分からなくなるといった混乱をきたすことがわかった。ファシリテーターとしての私はメンバーの意見を聞いてまとめ役をしないといけない。しかし、開発者としての私が意見を発してしまうと、私の意見を私がまとめることになってしまい、その客観性を担保しているのかどうかが分からなくなってしまう。要は簡潔なまとめなのか、個人の意見なのかの見分けがつかない。ファシリテーターとして振る舞うときはメンバーとしての意見を言わない方が進行がやりやすくなることに気付いた。初めてやったときはこんなもんか。次回への反省につなげる。</p><p>やったことは、課題管理システムから自分が担当者の issue をフィルターして眺めればすぐに把握できるが、ネガティブなふりかえりの気付いたことや改善したいことを掘り返す方法がないことにも気付いた。マイルストーンが1ヶ月なのでどこかに記録しておかないと忘れてしまう。go のプログラミングにまだ慣れていないといった付箋がたくさんあったが、それ以外はもう覚えていないというのもあったと思う。忘れないための一時記録の仕組みを考えないといけないことに私自身が気付いた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1128/>東京出張 2回目</a></h1><div class=post-meta><time class=post-date>2022-11-28 (Mon.) ::</time></div><span class=post-tags>#<a href=/diary/tags/biztrip/>biztrip</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/government/>government</a>&nbsp;
#<a href=/diary/tags/career/>career</a>&nbsp;
</span><img src=/diary/img/2022/1128_dinner.jpg class=post-cover alt="東京出張 2回目" title="Cover Image"><div class=post-content><p>0時に寝て4時に起きた。5時前には家を出た。初日だけは早起きして新幹線乗らないといけないので緊張する。新神戸6時10分発が始発になる。始発に乗った方が混雑もしていない。9時過ぎにはお手伝い先のオフィスについて業務を始められた。移動に約3時間。早起きは三文の徳みたいな話。</p><h2 id=フルリモートワーク>フルリモートワーク</h2><p>朝一でオフィスに着いたものの、チームのメンバーの1人はお休み、2人は在宅勤務、上長は出張だったので私が一人だけオフィスワークしてた。普段は私がフルリモートワークなのでうちのチームはリモートワークの働き方が容易になるように業務を設計している。私がオフィスにいようが、普通にリモートワークするのはある意味で自然な働き方とも言える。周りのチームの人に「あっ、いたんですね」とか声を掛けられながら1人で黙々とお仕事してた。</p><h2 id=全国旅行支援--ただいま東京プラス>全国旅行支援 + ただいま東京プラス</h2><p>今回の出張は全国旅行支援で宿泊費が40%オフになっていて、且つ <a href=https://ryokoshientokyo.jp/>ただいま東京プラス</a> という取り組みで3000円/日のクーポン券が付いていた。
<a href=https://region-pay.com/>region PAY</a> というアプリにクーポンを登録して QR コード決済で対応店舗で買いものできる。すべてのお店が対応しているわけではないが、普通に周りの飲食店やコンビニなどでも使えた。ちょっとよい晩ご飯の定食を食べて、帰りにコンビニで飲みものを買って帰るぐらいの贅沢ができる。至れり尽くせり。</p><h2 id=競輪選手というキャリア>競輪選手というキャリア</h2><p>ホテルでたまたまテレビをつけたらやっていておもしろかった。競輪オタクが競輪選手になったらめっちゃ強くて無双している、どこかのラノベみたいな話し。競輪という競技を私はあまりよく知らなかった。なぜこんなことができるかというと、競輪というスポーツは純粋な体力や身体能力で勝敗が決まらないらしい。試合展開の駆け引きがあって最後に勝敗が決まる。競輪オタクはすべての選手のプレースタイルを記憶していて、個々の選手の戦術を予測して対策できるから勝てるのだという。</p><ul><li><a href=https://post.tv-asahi.co.jp/post-202706/>競技経験ゼロ！28歳の「脱サラ競輪選手」。“オタク知識”をフル活用してまさかの快進撃</a></li></ul></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/posts/page/40/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/posts/page/42/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>