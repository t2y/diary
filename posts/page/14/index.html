<!doctype html><html lang=en><head><title>Posts :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/posts/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Posts"><meta property="og:description" content><meta property="og:url" content="/diary/posts/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/posts/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0710/>情報共有とメンバー課金の過ち</a></h1><div class=post-meta><time class=post-date>2023-07-10 (Mon.) ::</time></div><span class=post-tags>#<a href=/diary/tags/ldap/>ldap</a>&nbsp;
#<a href=/diary/tags/packaging/>packaging</a>&nbsp;
#<a href=/diary/tags/information-exchange/>information exchange</a>&nbsp;
#<a href=/diary/tags/business/>business</a>&nbsp;</span><div class=post-content><p>1時に寝て4時に起きて5時に起きて7時に起きた。明け方からうまく眠れなくなった。</p><h2 id=clang-の互換性>clang の互換性</h2><p>openldap 2.5 向けに ldap の overlay モジュールのビルド環境を作っていた。これまでは 2.4 向けのモジュールのみを提供していた。2.5 もそろそろやろうということで先週末からビルド環境の構築に着手していた。rpm のパッケージングの作業をしていて、openldap 2.5 のサーバーのビルドをしていると次のエラーが発生した。</p><pre tabindex=0><code>configure:21011: checking for pthread_detach with &lt;pthread.h&gt;
configure:21033: clang -o conftest -O2 -g3 -fstack-protector -fPIE -D_REENTRANT -D_THREAD_SAFE -DOPENLDAP_FD_SETSIZE=16384 -DLDAP_CONNECTIONLESS -DSLAPD_META_CLIENT_PR -D_GNU_SOURCE -Wl,-z,relro -Wl,--as-needed  -Wl,-z,now -specs=/usr/lib/rpm/redhat/redhat-hardened-ld -specs=/usr/lib/rpm/redhat/redhat-annobin-cc1  conftest.c    &gt;&amp;5
clang-15: warning: argument unused during compilation: &#39;-specs=/usr/lib/rpm/redhat/redhat-hardened-ld&#39; [-Wunused-command-line-argument]
clang-15: warning: argument unused during compilation: &#39;-specs=/usr/lib/rpm/redhat/redhat-annobin-cc1&#39; [-Wunused-command-line-argument]
conftest.c:118:16: error: incompatible pointer to integer conversion passing &#39;void *&#39; to parameter of type &#39;pthread_t&#39; (aka &#39;unsigned long&#39;) [-Wint-conversion]
pthread_detach(NULL);
               ^~~~
/usr/lib64/clang/15.0.7/include/stddef.h:89:16: note: expanded from macro &#39;NULL&#39;
#  define NULL ((void*)0)
               ^~~~~~~~~~
/usr/include/pthread.h:269:38: note: passing argument to parameter &#39;__th&#39; here
extern int pthread_detach (pthread_t __th) __THROW;
                                     ^
1 error generated.
</code></pre><p>エラーメッセージを調べていると、どうやら clang 15 に pthread_detach がないといったものらしい。clang 14 のときはビルドできたという。他の oss でも clang のバージョン違いでビルドできないといったことは発生しているらしい。有識者によると、次の修正が clang15 対応らしい。</p><ul><li><a href=https://git.openldap.org/openldap/openldap/-/commit/4a9aaf7c2621c2800b163efe928512c20bd422e2>ITS#10011 build: fix compatibility with stricter C99 compilers</a></li></ul><p>それ以外はとくに問題なく、ビルドできてモジュールそのものの動作も確認した。あとは rpm のパッケージングと gitlab ci/cd でビルドしたモジュールで動くかどうかの検証だけ。</p><h2 id=メンバー課金による過ち>メンバー課金による過ち</h2><p><a href=/diary/posts/2023/0709/>昨日 SuperGoodMeetings をさわってみた</a> ときにチーム管理の機能があって、任意のユーザーを招待するのは無制限で課金されないと書いてあった。「なるほどね。」とピンと来てコパイロツトの中の人に次のような所感を共有してみた。</p><blockquote><p>招待可能ユーザー数を無制限にしているのはよい視点だと私は思います。メンバー課金にすると、経費を削減するために共有アカウントを利用したり、あまり使わない人にはアカウントを作らないようになって情報共有の側面から望ましくない状態になる。一昔前のオンプレ時代は業務に使うシステムのアカウントは全社員がもっていて当たり前だったのが、クラウドサービスを使うようになってメンバー課金の経費削減から全社員がもたないようになりつつある (とくに中小企業) のは、情報共有の視点から過去よりも悪化しているという問題意識を私はもっています。</p></blockquote><p>コパイロツトさんもまったく同じ課題意識をもっていてメンバー課金しない料金体系にしているとのこと。鶏と卵みたいな話しだけど、組織には情報共有のためにアカウントのお金をケチんなと言いたいし、クラウドサービスの会社も料金体系を1人ずつじゃなくて、30人、100人、1000人といったある程度の階段でいいんじゃない？とか思ったりする。メンバー課金じゃないクラウドサービスとして basecamp や backlog などがある。</p><ul><li><a href=https://basecamp.com/pricing>https://basecamp.com/pricing</a></li><li><a href=https://backlog.com/ja/pricing/>https://backlog.com/ja/pricing/</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0709/>定例会議のプラクティスとプロダクト</a></h1><div class=post-meta><time class=post-date>2023-07-09 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;</span><div class=post-content><p>昨日も1時過ぎまで飲んでいて3時に寝て8時に起きて午前中はだらだらしていてお昼からオフィスへ出掛けて行って調べものをしていた。</p><h2 id=課題管理の雑談会へ向けての準備>課題管理の雑談会へ向けての準備</h2><p><a href=/diary/posts/2023/0617/#課題管理の雑談会へ向けての準備>先日の準備</a> の続き。</p><p>先日は私が関心をもっていることの資料を整理し直して先方に提示した。今日は <a href=https://copilot.jp/>コパイロツト</a> さんのプロダクトの1つである <a href=https://supergoodmeetings.com/>SuperGoodMeetings</a> にアカウント登録していろいろ触っていた。その過程で <a href="https://miro.com/app/board/uXjVMX-zl6s=/">Project Sprint プラクティカルガイド</a> を読んだりもしていた。</p><p>SuperGoodMeetings は Project Sprint という考え方で定例会議をうまくやるためのプロダクトにみえる。アプリケーションの完成度も高いしよく出来ていると思う。私からみたら課題管理システムのサブセットにみえる。会議のアジェンダが個々の issue に相当して詳細に管理できる。ui も最近の課題管理システムのそれに近い。一方でこのプロダクトは開発者向けのツールではないため、このツールだけでシステム開発を管理することは想定していないのではないか？と推測される。その辺りの話しも来週、出張したときに中の人に聞いてみようと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0708/>アイディアは移動距離に比例する</a></h1><div class=post-meta><time class=post-date>2023-07-08 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて5時に起きて7時に起きた。</p><h2 id=ストレッチ>ストレッチ</h2><p>旅行へ行ってきてからなぜか首の筋を痛めている。寝違えたわけでもないのに気がついたら急にある筋が痛いなと思うようになった。今日の開脚幅は開始前157cmで、ストレッチ後160cmだった。今週もわりと忙しかったり暑かったりして負荷はまぁまぁ高かった。先週からの疲労を加味するとややバテた。すねの外側の筋、右のおしりの一点、腰の張り、肩から首にかけての張りなど、全身あちこち痛いところいっぱいみたいな状態だった。来週は東京出張でまたバタバタするが、帰ってきたら週末休んでもいいんじゃないかと思うぐらいにはしんどい感じ。</p><h2 id=カフーツさん訪問>カフーツさん訪問</h2><p>お昼はずっと作業をしていて、それが一段落した後に17時半ぐらいから <a href=https://www.facebook.com/events/287696183719718>ブログJelly Vol.133</a> に参加してきた。他の参加者はいとうさんとながいさんの2人だった。いとうさんはお仕事が忙しいということでずっとお仕事をされていた。私はながいさんとあーでもないこーでもないといった、いろんな話題の雑談をしてきた。</p><blockquote><p>アイディアは移動距離に比例する</p></blockquote><p>なにかのきっかけでこういう言葉があることを知った。家を持たず、デジタルノマドのように地域に縛られずに移動しながら働く人たちは優位性があるといった話題になった。quora でも同じような Q&A がある。</p><ul><li><a href=https://jp.quora.com/%E3%82%A2%E3%82%A4%E3%83%87%E3%82%A2%E3%81%AF%E7%A7%BB%E5%8B%95%E8%B7%9D%E9%9B%A2%E3%81%AB%E6%AF%94%E4%BE%8B%E3%81%99%E3%82%8B-%E3%81%A8%E3%81%84%E3%81%86%E3%81%AE%E3%81%AF-%E3%81%A9%E3%82%93%E3%81%AA%E7%90%86>「アイデアは移動距離に比例する」というのは、どんな理由からでしょうか？</a></li></ul><p>今回は <a href=/diary/posts/2021/1109/#呑み>だいやめ</a> を持っていった。いつも通り翌1時過ぎまで飲んで酔っ払ってしまった。飲み過ぎた。歳のせいか、お酒に弱くなっているので摂生も考慮してもうちょっと控えるようにした方がいいかもしれない。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0707/>七夕と願い</a></h1><div class=post-meta><time class=post-date>2023-07-07 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/management/>management</a>&nbsp;
#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて6時に起きた。旅行から帰ってきてから最近はこのパターンになってきた。</p><p>google のロゴが <a href=https://www.google.com/doodles/tanabata-2023>Tanabata 2023</a> になっていて七夕だと気付いた。もう私にとって願いというのは健康を祈るぐらいしかない。残された寿命を使い切る前にいまやっていることをやり切りたい、もしくはその結果をみたいと思っていて、そのために必要なことは健康ぐらいかなと。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。</p><ul><li><a href=/diary/posts/2023/0628/>ADLIV さんふりかえり</a></li><li><a href=/diary/tags/sightseeing/>社員旅行の同行ふりかえり</a></li></ul><p>他社の社員旅行へ同行してみての所感として学ぶことは多々あった。</p><ul><li>強制参加にはしない (断ってもよい)</li><li>仕事だけではない人間関係の構築という価値観を大事にしている</li><li>上下関係がフラットなので参加者が自由に行動したり話したりできる</li><li>経営陣や上司に忖度しないメンバーがいることでフラットな関係性を共有できる</li><li>チーム単位で行動できるので組織の全体行動を強制される感覚が緩和される</li></ul><p>野中郁二郎先生は業務外での暗黙知を共有する「場」づくりが大事だと説いている。会社が危機のときやしんどいお仕事をこなすとき、最後は経営者やリーダーの人生観や価値観がモノを言うという考え方がある。そんなときにこういった価値観の共有は役に立つのかもしれない。「社員旅行」という単語自体が古い価値観をイメージしてネガティブに聞こえる。いまだったらワーケーションと呼ぶ方がよいかもしれない。</p><p>過去にスタートアップで働いていたとき、会社が M&A で売却して、私にとってはあまりメリットがなかったので即断で辞めると伝えた。即断できたのは経営者に理念がなかったからというのも大きな要因の1つだといまになって思える。時期の差はあれど、私以外の主要メンバーもその後に全員辞めた。要はそういうこと。</p><h2 id=go-の-generics-勉強会の準備>go の generics 勉強会の準備</h2><p>水曜日から資料を作っている。昨日はほぼまる一日コードレビューをやっていた。午前中の半日を費やしてようやく完成した。この資料は一般の go 勉強会でも使えるなと思ったのでお手伝い先のプロダクト開発に関するところを取り除いた資料を別途公開した。資料の中でその内容を検証するサンプルコードも次のリポジトリで公開している。</p><ul><li><a href=https://github.com/t2y/go-generics-study>https://github.com/t2y/go-generics-study</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0706/>コードレビューで1日が終わる日</a></h1><div class=post-meta><time class=post-date>2023-07-06 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/scim/>scim</a>&nbsp;
#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;</span><div class=post-content><p>0時に寝て2時に起きて6時半に起きた。旅行から帰ってきて睡眠の質が上がってきた気がする。</p><h2 id=コードレビュー>コードレビュー</h2><p>週明けから毎日ずっとコードレビューをしているわけだけど、今日は scim の id 連携の実装ができたのでそのコードレビューを半日以上やっていた。変更内容は2000行弱ぐらい。以前にも <a href=/diary/posts/2023/0627/#scim-調査>scim の調査</a> について少し書いた。</p><p>担当者は前マイルストーンのときから調査していて、今マイルストーンで初期実装は入れてしまおうという話しを昨日の 1on1 でしていた。また qa レベルのテストは来月末ぐらいでやるので詳細を作り込むよりもまずは大きな機能として入れておきたい。いまマイルストーンの期間を2週間に設定している。調査も含めて実装まで2つのマイルストーンを費やそうとしている。理想的にはどんな機能であっても、メンバーには2週間で完了する粒度で issue を分割して作業できるようになってほしいという狙いがある。</p><p>それは過去にどんな新機能を作っていても2週間を超えることはなかったという私の経験則でもある。これは2週間でどんな機能でも完成するという意味ではなく、2週間でマージできないような区切りのつかない機能開発はないという意味だ。機能実装のような issue でマイルストーンをまたぐ開発をしていると、進捗が不透明になったり、開発がダレると私は考えている。ダレるというのは短い期間に集中して開発した方が効率も品質もよいものができるのではないか。記憶の仕組みからは理屈上そうだと言える。開発のメリハリをつけるという働き方に範を示していきたい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0705/>go の generics 勉強会へ向けての準備</a></h1><div class=post-meta><time class=post-date>2023-07-05 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;</span><div class=post-content><p>0時に寝て6時に起きて7時に起きた。週明けから忙しくて余裕ない。それでもよく眠れていることが幸い。</p><h2 id=go-の-generics-勉強会の準備>go の generics 勉強会の準備</h2><p>今週末の金曜日に勉強会をする想定で作り始めた。generics は難しいのでなかなか本腰を入れて取り組めていなかった。基本的には tenntenn さんの <a href=https://tenn.in/generics>プログラミング言語Go完全入門 15章ジェネリクス（型パラメタ）</a> の資料をベースに、自分で理解できるように調査したり、サンプルコードを書いたり、自分で理解した内容を補足したりして資料を作り始めた。go 1.18 のジェネリクスで導入された概念は次になる。これらのキーワードに関するところをそれぞれ調べることにした。</p><ul><li>型パラメーター</li><li>型引数</li><li>インターフェースによる制約 (Type constraint)</li><li>型セット (Type sets)</li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0704/>ldap プロトコルの persistent search</a></h1><div class=post-meta><time class=post-date>2023-07-04 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/ldap/>ldap</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/web-design/>web design</a>&nbsp;
#<a href=/diary/tags/communication/>communication</a>&nbsp;</span><div class=post-content><p>0時に寝て5時に起きて6時半に起きた。朝から大鼓方を調べたりしていた。</p><h2 id=persistent-search-あれこれ>persistent search あれこれ</h2><p>ldap プロトコルの文脈でクライアントがサーバーに接続して、エントリーの更新を検出して更新があったエントリーのみを取得することを persistent search (永続検索) と呼ぶ。メッセージキューで言うところの pubsub の consumer に相当する機能。フィルター条件に合致したエントリーのみを取得するという側面では検索と言える。</p><p>ietf のワーキンググループに次のような仕様がある。</p><ul><li><a href=https://www.ietf.org/proceedings/50/I-D/ldapext-psearch-03.txt>Persistent Search: A Simple LDAP Change Notification Mechanism</a></li></ul><p>go-ldap で過去に <a href=https://github.com/go-ldap/ldap/pull/80>Add Persistent search control + PersistentSearch() #80</a> で実装を追加しようとしたのもあったので調べてみた。しかし、この機能に openldap は対応していないようだ。</p><p>以前から調べている <a href=/diary/posts/2023/0317/>openldap の syncrepl</a> も persistent search を実現する機能の1つと言える。ldap に詳しくないと用語と機能と実装の切り分けができなくて困惑する。syncrepl はもともとレプリケーションのための仕組みではあるが、pubsub の consumer としても使える。そういうときに syncrepl を使って <em>&ldquo;persistent search&rdquo;</em> を行うと言ったりする。このときに先の ietf に提案されている persistent search とはまったく関係ない。だから混乱する。</p><p>lopenldap サーバー同士で syncrepl の provider の機能は次の overlay モジュールによって提供される。逆に syncrepl の consumer の機能は openldap の組み込みの機能で提供される。なんらかの歴史的経緯があるのだろう。</p><pre tabindex=0><code>overlay syncprov
</code></pre><p>ldapsearch コマンドで persistent search (syncrepl consumer) を実行するには次のようにする。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ldapsearch -x -H <span style=color:#e6db74>&#34;ldap://localhost:389&#34;</span> -b <span style=color:#e6db74>&#34;dc=example,dc=com&#34;</span> -D <span style=color:#e6db74>&#34;cn=Manager,dc=example,dc=com&#34;</span> -w <span style=color:#e6db74>&#34;secret&#34;</span> -E <span style=color:#e6db74>&#39;!sync=rp&#39;</span>
</span></span></code></pre></div><p>ldap プロトコルの文脈で persistent search を行うといった場合、クライアントから pubsub で言うところの consumer を用意するといった意味だけで、その実装や通信方法はいくつか実現方法があるということを学んだ。</p><h2 id=サイトデザイン最終レビュー>サイトデザイン最終レビュー</h2><p>19時からデザイナーさんとはらさんと打ち合わせ。少し前に用意してくれた <a href=/diary/posts/2023/0619/#サイトデザインのサンプルページ>サイトデザインのサンプルページ</a> の最終レビューを行った。全体としては気に入っているので概ね ok なのだけど、詳細の気になったところやデザインの機微のようなところをはらさんと一緒にデザイナーさんとやり取りして共有した。</p><p>デザインだけをみてこちらで想定していたことも、デザイナーさんの意見や視点を伺ってみると発見があっておもしろかった。逆に言えば、デザインだけでデザイナーさんの意図を伝えるのはとても難しいということもわかった。背景の説明を受けると論理的だったり合理性があったりするものの、なにも情報がない状態でそのことに気付くのは難しい。これはコードリーディングにおいても同じで、作者に意図の説明を受けながらソースコードを読むと簡単に理解できたりする。そして、デザイナーさんもうちらの意見から考え方を見直すこともあった。ウェブデザインのようなものを1人で完全に気付きを得るのは難しそうだ。</p><p>はらさんにレビューに入ってもらっていてとても助かる。私は ui/ux については素人なので、要件やレビューする視点の重要なところにツッコミを入れてくれるので気付くことも多い。私がコードレビューで設計やプログラミングについて指摘しているのも、別の人の視点からみるとこういうみえ方をするんだろうなと思いながら聞いていた。「餅は餅屋」とはよく言った言葉だ。自分がよくわからない分野のお仕事を依頼もしくは話すときは、自分たちの立場でそういった外部の専門家を雇うことの重要性も同時に理解できた。私は課題管理の専門家としてそういうポジションを作っていきたい。</p></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/posts/page/13/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span></a>
<a href=/diary/posts/page/15/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>