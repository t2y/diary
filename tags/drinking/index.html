<!doctype html><html lang=en><head><title>drinking :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/drinking/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="drinking"><meta property="og:description" content><meta property="og:url" content="/diary/tags/drinking/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/drinking/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1101/>穴場のビアバー</a></h1><div class=post-meta><time class=post-date>2023-11-01 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/food/>food</a>&nbsp;
#<a href=/diary/tags/project-management/>project management</a>&nbsp;
#<a href=/diary/tags/mongodb/>mongodb</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span>
<img src=/diary/img/2023/1101_autumn.jpg class=post-cover alt=穴場のビアバー title="Cover Image"><div class=post-content><p>0時に寝て何度か起きて6時半に起きた。移動日の疲れもあってか、いつもよりよく眠れた気がする。</p><h2 id=朝食バイキング>朝食バイキング</h2><p><a href=/diary/posts/2023/0919/#大崎に泊まる>先々月から大崎探索</a> をしていて <a href=https://www.newotani-inntokyo.jp/>ニューオータニイン東京</a> に泊まってみた。川沿いの道を歩きながら朝食バイキングもおいしい。食品の品数があると満足度が高い。</p><figure><img src=/diary/img/2023/1101_breakfast.jpg></figure><h2 id=プロジェクトの進捗報告>プロジェクトの進捗報告</h2><p>出張したときの月例報告の11回目。<a href=/diary/posts/2023/0920/>前回の進捗報告はこちら</a> 。</p><p>まだ開発の序盤なので <a href=/diary/posts/2023/1028/#近況報告の資料作り>事前に準備した資料</a> の内容を一通り終えて雑談の時間も多かったように思う。3回目の開発フェーズになるのもあり、メンバーの練度も上がって、開発の手際はかなりよくなっているように私からはみえている。それらも含めて、メンバーが自律的に issue を作ったり、タスクを自分に割り当てたりしながら開発が進むようになっていると報告した。プロジェクトオーナーからも、最近のマイルストーン定例をみていて、メンバーが気付きが増えている、自律的によくないところを改善しようという意思がみえるといった話題も出ていた。課題管理のプラクティスを実践してきて、着実によい開発者の習慣を身につけて、よい開発チームに育ってきているように、私からもみえている。あとは課題管理についてのコンテンツを私が書かないといけないのを、バーンナウトの影響もあってか、先月はさぼってしまっていたので、今月こそなんか書きますと、自分を追い込む意図でもその場で話題にした。</p><h2 id=mongo-とトランザクションとレプリカセット>mongo とトランザクションとレプリカセット</h2><p>mongo には <a href=https://www.mongodb.com/docs/manual/core/transactions/>トランザクション</a> の機能が提供されている。しかし、トランザクションを使うためには <a href=https://www.mongodb.com/docs/v7.0/replication/>レプリケーション</a> を有効にしないといけない。レプリケーションは通常は複数台のマシンでクラスタリングを構築するものになる。うちらはシングルノードの mongo を扱っているのでレプリケーションを必要としていない。それでも、ドキュメントを読んでいると、スタンドアローンでも本番環境ではレプリカセットを使う方がよいといった説明もみつかる。</p><ul><li><a href=https://www.mongodb.com/docs/manual/tutorial/convert-standalone-to-replica-set/>Convert a Standalone mongod to a Replica Set</a></li></ul><p>ちょうど開発の要件としてトランザクションを必要とする状況も出てきた。mongo のレプリケーションやトランザクションの仕組みを理解するよい機会かもしれない。11月中には調査したいというところ。</p><h2 id=エビスバー>エビスバー</h2><p>大崎探検の2日目。<a href=https://www.ginzalion.jp/shop/brand/yebisubar/shop60.html>YEBISU BAR 大崎店</a> へ行ってみた。大崎駅横の駅ビルの2階にある。アクセスもよい。水曜日なのに20-21時半ぐらいまでいて、お客さんは3組ぐらしかいなかった。よい意味で空いてて静かにゆっくり飲めてよかった。穴場のバーをみつけた。ビール2杯とつまみ2品でちょうど3000円程度。ちょっと割高かもしれないけど、場所とお店の雰囲気とゆっくりできたことを考慮するとちょうどよい価格帯にも思える。またゆっくり軽く飲みたいときに行こうと思う。</p><p><figure><img src=/diary/img/2023/1101_beer.jpg></figure><figure><img src=/diary/img/2023/1101_salad.jpg></figure><figure><img src=/diary/img/2023/1101_potate.jpg></figure></p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0909/>久しぶりの異文化懇親会</a></h1><div class=post-meta><time class=post-date>2023-09-09 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/day-off/>day off</a>&nbsp;
#<a href=/diary/tags/biztrip/>biztrip</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>22時頃には戻ってきたそれから準備したらよいところを、だらだらしてうたた寝して気付いたら2時になっていた。もうこのまま寝て朝起きてから準備しようと3時50分にアラーム設定して起きた。それからお風呂入ってストレッチして荷造りして5時18分に三ノ宮を出発した。</p><h2 id=実家>実家</h2><p>6時21分に実家へ着いた。休憩せずに一気に帰ると約1時間ぐらい。先月ジモティーで譲ってもらっていた机とバランスチェアを実家へ持って帰った。朝ご飯を食べてからバランスチェアを組み立てる。ちょうど机と椅子がよい感じにリモートワーク可能な環境になった。</p><figure><img src=/diary/img/2023/0909_desk-char.jpg></figure><p>9時半頃まで実家でのんびり過ごして、言うても暇なので少し早めに香川県へ向けて出発した。</p><h2 id=オープンセミナー>オープンセミナー</h2><p>オープンセミナーとは、中四国地域で開催されている勉強会らしい。コロナ禍前はもっとたくさん開催されていたそうだが、いまは香川、広島、岡山といった地域で復活しているらしい。<a href=https://osk.connpass.com/event/292551/>オープンセミナー2023@香川</a> に参加した。高松市の高松港の真横にある <a href=https://www.e-topia-kagawa.jp/>eｰとぴあ・かがわ</a> という行政っぽいコミュニティ施設のイベントスペースを借りて開催された。実家から10分休憩を1度取った上で約1時間30分で着いた。実家から高松市まで1時間半とみておくとよさそう。</p><h3 id=てらださんpythonの現状からデータ分析やllm活用への発展>てらださん：Pythonの現状からデータ分析やLLM活用への発展</h3><p>てらださんの応援も兼ねて参加してみた。基調講演のような位置づけ。参加者の python 習熟度のレベルをみながら話す内容をあわせていた。</p><ol><li>あまり知らない</li><li>ちょっと知っている</li><li>がっつり使っている</li></ol><p>最初は python の用途や得意・不得意といった、入門的な話しから始めつつ、徐々に最近の話題へと展開していた。</p><p>python の用途</p><ul><li>システム系</li><li>web 系</li><li>データ分析や科学技術計算系</li><li>iot 系</li><li>3d グラフィックス</li></ul><p>苦手なこと</p><ul><li>web フロントエンド</li><li>デスクトップ gui アプリ開発</li><li>速度重視の低レイヤーの処理</li><li>趙大規模なミッションクリティカルな分野の処理</li></ul><p>python は年1リリース & 5年サポートになっている。</p><p>いまホットな話題として llm (large language model) がある。
私は chatgpt 以外のものはまったくわからないが、
oss で無料使えるツールや学習モデルがどんどん公開されているらしい。日本語に特化したものも出てきているみたい。</p><p>llm のツールチェーンを使って、任意のドキュメントに chatgpt のような質問で検索できるシステムの構築方法を紹介していた。
私が知らなかった技術として、インデクシングすると全文検索インデックスを作成する代わりにベクトル化をしてベクトル DB に保存する。
もっとも煩雑なところがドキュメントのベクトル化してベクトル DB に格納し、検索するときもクエリをベクトル化して、ベクトルの近似計算を行って検索結果を取得できる。
検索結果から回答の文章を生成するところを openai の api を使っているとのこと。有償なのでここだけお金がかかる。自前でやるには強力な gpu をもつマシンがないと処理が追いつかないといった話しだった気がする。
ai の学習モデルをホスティングするサービスとして <a href=https://huggingface.co/>Hugging Face</a> というものが有名らしい。
github ではなく、なにかしらモデルを管理するときに都合のよいことがあるみたい。
web ui には <a href=https://streamlit.io/>streamlit</a> を使っていた。私はまったく使ったことはないが、fin-py で紹介しているのを何度かみた感じでよいイメージをもっている。</p><h3 id=npo法人nemtus松岡さん後藤さん-ブロックチェーン概要説明--symbolブロックチェーンの特徴活用事例紹介>NPO法人NEMTUS　松岡さん、後藤さん 「ブロックチェーン概要説明 ＆ Symbolブロックチェーンの特徴・活用事例紹介」</h3><p>NEM を広めるための NPO 法人らしい。ブロックチェーンの技術説明のスライドがめちゃくちゃわかりやすく作られていた。2人で発表していて、前半は技術的な解説、後半は事例紹介となっていた。事例紹介であちこちで使われているのはわかるけれど、その大半はブロックチェーンを使わなくてもできるものばかりだった。ブロックチェーンの特性が活きるアプリケーションはグローバルな仮想通貨のような用途以外にみつかっていないという気がする。既存の web 技術でもできるものをブロックチェーンに置き換えても、効率の悪さ (コスト高) をどうやってカバーするのかを説明しないのは不誠実なようにも感じられた。せめてスマートコントラクトを絡めて話さないと伝わらないんじゃないかと思う。</p><h3 id=製造業-dx-を意識したときのiot-用-db-設計の注意点>製造業 dx を意識したときの、iot 用 db 設計の注意点</h3><p>会社名は公けに書かれていないから伏せておく。名前だけ聞くと、創業400年という、財閥系の JTC の会社の情シス部門のようなお仕事をされていた。工場の運用改善のために iot と社内システムをすべて内製/自前で構築しているという。工場から生データを収集し、それをデータベースに正規化して、分析して日々の業務の運用改善にあてるという、ストーリーは当たり前のもの。工場の売上は数千億円といった規模になるという。例えば4-5人のチームをアサインすると2000万円ほどの経費がかかるが、1000億円の0.1%を改善すれば1億円になるのでペイするという。そういった考え方で工場の運用改善をしているうちに、いまのチームは30人といった規模になったという。</p><p>事業会社で自分たちで技術を勉強してがんばっているようにみえる。発表のところどころの細かいところの認識が誤っていて、web のシニアエンジニアかアーキテクトがいれば、もっと効率のよいシステムを運用できるのになぁと思いながら聞いていた。あとで懇親会で詳しく聞いてみると、このチームは凄くてハードウェアまでカスタマイズできるという。基盤や回路まで自分たちで設計して作ったりもする。またメーカー品が自分たちの用途の機能を提供していなかったら、サポートを無視して勝手にメーカー品のハードウェアをカスタマイズして自分たちの用途にあったデータを取得できるようにカスタマイズしてしまうといったことも話していた。</p><p>ハードウェアの基盤開発から組み込みのプログラミング、データベース、web と1つのチームですべてやっているという。なかなかこれだけの技術スタックを1チームですべて一気通貫でやっているところはないと思う。web 技術のところではいくつかツッコミ所はあったんだけど、これだけの広い分野をみていると、それは些事だなとちょっと反省した。私が自分の得意な分野だけをみていい気になっていたような気持ちになって反省した。</p><p>懇親会で話していて、iot のシステムは基本的に安くて儲からないと話していて、しかし、ここに web システムを付けるだけで付加価値として売上の金額が上がるという。それは多くの iot メーカーは web に疎いため web システムを作れないらしい。ハードウェアと web の両方の技術に精通している会社/組織というのは意外に少ないらしく、iot + web が儲かるモデルとして話されていた。たしかに私は web に精通しているが iot はまったく分からないので納得感があった。</p><h3 id=lt>LT</h3><p>これが私のお仕事の部分だけど、会社としてイベントに登壇してきた。マーケティング活動の1つやね。</p><iframe class=speakerdeck-iframe frameborder=0 src=https://speakerdeck.com/player/dd65b3a94e5b4feeb73f780c9626cb0a title="Iintroduction of how big tech runs tech projects" allowfullscreen style="border:0;background:padding-box padding-box rgba(0,0,0,.1);margin:0;padding:0;border-radius:6px;box-shadow:rgba(0,0,0,.2)0 5px 40px;width:600px;height:auto;aspect-ratio:560/315" data-ratio=1.7777777777777777></iframe><h3 id=懇親会>懇親会</h3><p>17時から懇親会で21時過ぎまで飲んでいた。私は車で参加していたのでソフトドリンク。知らないイベントの懇親会で、あまりよく知らない人たちと技術の話題でわいわい盛り上がるのは久しぶりで楽しかった。昔の it 勉強会はこんな感じだったなとコロナ禍の終わりも実感した。</p><p>懇親会の参加者には組み込みやハードウェアに詳しい方が何人もいて、私のような web 系の方が少数派でちょっといつもとは違ったメンバーで聞く話しもとても新鮮味があった。iot やハードウェアの話しにさっぱり付いていけなかった。web 系の勉強会やイベントにしか行かないというのも、一種のエコーチェンバーだなと実感した。</p><h3 id=あと飲み>あと飲み</h3><p>21時過ぎから23時まで、てらださんと飲んでいた。てらださんは酔っ払ってどんどん呑むんだけど、酔い潰れるみたいな状態にはならなくて、余裕があるのかないのかよく分からないけど、呑むペースが速いなと感心していた。コミュニティの話し、教育の話し、経営の話し、政治の話し、わりといろんな話しをして時間でお開きにした。</p><h2 id=車中泊>車中泊</h2><p>その後、車を移動して、24時間空いているサウナで泊まろうと近くまで行ったものの、あまり外観の雰囲気がよくなくて、そのまま駐車場に車を泊めて車中泊にした。1時頃だったと思う。駐車場料金がホテル代のようなものになった。あとで調べたらアイドリングしたまま車中泊するのは、付近に家があると騒音がうるさいらしくマナー違反だという。歓楽街だったので周りは若者が遊んでいて、もともとうるさい場所だったと思うのでそれほど迷惑にはならなかったと思いたい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0826/>全身疲労と気分転換</a></h1><div class=post-meta><time class=post-date>2023-08-26 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/accounting/>accounting</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>23時に寝て何度か起きて6時に起きた。疲労でバテバテ。</p><h2 id=ストレッチ>ストレッチ</h2><p>先週もあまりよい状態ではなかったけれど、今日はことさら悪かった。疲労は着実に蓄積するんやと実感する。左足は筋肉痛やなって感じだけど、右足はそのうち足が動かなくなるんじゃないかとすら思えた。ふくらはぎは左右ともにパンパンだし、右の股関節の部位はピキッて感じで痛みが出たりするから根本的に悪そう。足全体が硬かったように思える。腰もいくつか張りがあって、特定のツボはかなり痛くてなにかが悪いのだと思えた。臀部のツボも一部だけすごく効いて痛かった。肩周りも凝りや張りはいつもより大きかったように思う。今日の開脚幅は開始前154cmで、ストレッチ後156cmだった。久しぶりにこんな調子の悪いのも珍しいなと思えた。あと2週間ぐらいがお仕事のピークだと思うのでもう少しだけもてばよい。</p><h2 id=請求書のテンプレート作り>請求書のテンプレート作り</h2><p>10月から施行されるインボイス対応の請求書として 10%, 8% の消費税の税率を明記して別々に小計を記載しなければならない。そろそろ個々の企業でも運用が始まるところ。うちの会社が扱う商品は10%のみだが、請求書のフォーマットそのものを変更しないといけない。ちょうど freee 側でもその対応で6-7月に新しい帳票管理の機能をリリースしていた。8月から順次切り替えとなっていた。私は開発にいっぱいいっぱいだったからベータ版は見送って正式リリース後に対応することにしていた。それが今日だ。今月分の請求書はインボイス対応の新しいフォーマットで作る。</p><p>その移行をしていて、この機会に会社のロゴや角印も請求書に載せることにした。はらさんに角印をどうやってデータ化したらよいかを尋ねたら、普通に白い紙に押印してスキャナで取り込んで、白色を透過処理して使っているとのこと。</p><p>オフィスの複合機で白い紙で押印した角印をスキャンする。pdf でダウンロードできる。pdftoppm で pdf を png に変換する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pdftoppm -png corporate-seal-square.pdf corporate-seal-square
</span></span><span style=display:flex><span>$ ls corporate-seal-square-*
</span></span><span style=display:flex><span>corporate-seal-square-1.png  corporate-seal-square-2.png
</span></span></code></pre></div><p>あとは白い背景を透過処理するだけ。pinta, incscape とやってみたけど、どうもうまくできない。最終的に次の記事を参考にしながら gimp を使って「ファジー選択」で透過処理したいところをちょこちょこ選択しながら変換していくのがもっとも私にとって簡単だった。</p><ul><li><a href=https://howpon.com/1450>GIMP – 画像を切り抜き背景を透明・透過して保存する方法</a></li></ul><p>請求書のテンプレートに対して角印を読み込んで、社名に重なるように配置するのが慣習らしい。なぜ社名に角印を重ねるかというと偽造や改ざんを防止するという意図になる。電子データの請求書に角印を載せる意味はないけれど、紙の慣習にあわせるという意図なら重ねた方がよいだろうと考えて社名に角印を重なるようにして作成した。請求書に角印とロゴが入って見栄えもよくなった。</p><h2 id=立ち呑み屋-本番>立ち呑み屋 本番</h2><p><a href=/diary/posts/2023/0819/#立ち呑み屋>先週行った立ち呑み屋</a> さんにコミュニティのメンバーと一緒に行ってきた。ずっと休日も開発してきて疲労困憊ないので気分転換しようという思いつき。</p><p>19時開始でたまたまオフィスを出たときに雷が鳴り始めて、私がお店に付いたすぐ後に豪雨になった。今日はついている。豪雨は1-2時間で止んでいたと思う。その後、さなださんとすみよしさんと合流して飲んでた。わいわい雑談できて楽しかった。いくつか始めて注文してみた料理もおいしかった。このお店の料理は何を頼んでもおいしい気がする。お酒も料理もマスターが1人で運営しているせいか、非常に良心的な価格設定になっている。もう1.5倍ぐらい値上げしたらいいんじゃないかと思う。それでも安い方だけど。立ち呑みだとしんどいので22時前にはお開きになった。長居せずに帰りやすいのも立ち呑みのよいところだと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0819/>開発もしながら雑多な土曜日</a></h1><div class=post-meta><time class=post-date>2023-08-19 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>1時に寝て何度か起きて7時に起きた。晩ご飯食べてオフィスに戻ったものの、知人と0時過ぎまでチャットしていて開発できなかった。たまにはそういうこともあるか。</p><h2 id=ストレッチ>ストレッチ</h2><p>左右両方のふくらはぎの筋の張りがやばくてめっちゃ効いた。トレーナーさん曰く、この筋が効くのはふくらはぎを酷使しているか、まったく使っていないかのどちらかだと言う。私の場合は後者だろう。椅子に座っている時間が長いとふくらはぎの筋が張る。今日の開脚幅は開始前156cmで、ストレッチ後160cmだった。数値の良さは維持できている。腰もひどくはないけど、やや張りを感じるようにはなってきた。トレーナーさんも全体的に硬い傾向があるとコメントしていたので疲労が溜まっているのはそうだと思う。</p><h2 id=散髪>散髪</h2><p>ストレッチを終えてから散髪へ行ってきた。短くきると頭が軽いし、お風呂で頭を洗うのも楽になっていい。もう今後はずっと短髪でいこうと思う。散髪していたらなぜかすごく眠気があって、終えてからお昼ご飯を食べて一旦帰って2時間ほど寝てた。なんか睡魔にとりつかれた。</p><h2 id=cli-コマンドの開発>cli コマンドの開発</h2><p>金曜日の夜にやるつもりのお仕事ができなかったので夕方から着手した。夕方の方がオフィスも涼しくて捗る。3時間ほどかけて cli コマンドを一通りつくって README に使い方を書いて issue をクローズした。難しい開発ではないけれど、やり切って満足。</p><h2 id=立ち呑み屋>立ち呑み屋</h2><p>たまたま食べログをみていて見つけた立ち呑み屋さんがよさそうだった。コミュニティのメンバーを誘って来週末に行くことにしているが、誘った手前、下見をしておこうと思って21時過ぎから1人で行ってみた。カウンターしかない小さいバーで詰めても10人入れないようなスペース。5人先客がいてマスターが1人でやりくりしている。その後も3グループぐらい入れ替わりにお客さんがやってきて常連さんの多いお店みたい。私はぼっちで行ったんだけど、徐々に話しかけてもらって、お酒を飲んでいるから2時間したら周りの人たちと話していた。そういう雰囲気のお店。立ち呑みなのに24時ぐらいまでいた。楽しかった。ふらっと1人で行って適当に雑談できるお店をみつけた。また行こうと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0816/>お盆の最終日</a></h1><div class=post-meta><time class=post-date>2023-08-16 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/drinking/>drinking</a>&nbsp;
#<a href=/diary/tags/mongodb/>mongodb</a>&nbsp;
#<a href=/diary/tags/testing/>testing</a>&nbsp;
#<a href=/diary/tags/writing/>writing</a>&nbsp;</span><div class=post-content><p>1時に寝て何度か起きて8時半に起きた。数ヶ月に1回ぐらいの頻度でしかないことだけど寝坊した。起きたら8時半であれ？と思った。起きてから家でそのぐらいの時間までだらだらするのはちょくちょくあることだけど、気付かず寝てたのは久しぶりだった。</p><h2 id=台風が過ぎた後の焼き鳥屋さん>台風が過ぎた後の焼き鳥屋さん</h2><p>今朝に寝坊した理由はこれだと思うけれど、昨日の22時から晩ご飯を求めて仲のよい焼き鳥屋さんへ行ってきた。台風で9割以上のお店が閉めている中、唯一と言っていいぐらいの珍しさで開いてた。そのお店 (グループ) のオーナーは雨が降ろうが槍が降ろうが営業日は開けるという方針らしい。マスターも夕方から台風は過ぎて雨も弱まっていたので普通に営業していたらしい。しかし、お客さんは数グループと少なかったと仰っていた。私が22時に行って誰もいなくて24時までいたけれど、誰も来なかった。通常なら22時だと他に2-3グループはいて、その後も最低でも1グループは飲みにやってくるぐらいの人気のある焼き鳥屋さんだ。そもそも駅から人が出てこないし、道にも人が歩いていない。物流も止まっていたのでいくつか仕入れが出来なくて提供できないメニューもあった。</p><p>いつもなら2杯飲んで帰るところを、こんな日だから売上に貢献しようと思って3杯飲んで寝坊した気がする。</p><h2 id=mongodb-700-リリース>mongodb 7.0.0 リリース</h2><p>ちょうど qa テスト前で mongodb のメジャーバージョンがリリースされそうなので毎週のようにチェックしていた。rc10 までいって ga されたみたい。</p><ul><li><a href=https://www.mongodb.com/community/forums/t/mongodb-7-0-0-is-released/239732>MongoDB 7.0.0 is released</a></li></ul><p>まだ docker hub には正式なリリースバージョンのコンテナイメージは公開されていない。しかし、rc10 が ga になったはずなのでひとまずはそれを使って開発環境とテスト環境を 7.0.0 に移行した。うちの用途だと ttl インデックスを作り直す以外には移行作業は必要なかった。自動テストはそのまま成功したし、テスト環境のデータもそのまま移行してパッとみた感じでは正常に動いている。来週から qa テストも始まるのでぎりぎり間に合ったというところ。<a href=https://www.mongodb.com/support-policy/lifecycles>MongoDB Software Lifecycle Schedules</a> によると、だいたい mongodb は3年サポートされる。メジャーバージョンが年に1回リリースされているようにみえるので、いまメジャーバージョンを上げておくと1年余裕をもって運用できる。</p><h2 id=テックブログの執筆開始>テックブログの執筆開始</h2><p>お昼からテックブログの執筆に着手した。あまり大きな意味はないのだけど、お手伝い先のテックブログの記事を早く3つ書きたかった。別に三部作というわけでもない。けれど、テックブログ書いてますよと他者へ伝えるときに最低3つぐらい記事を書いていないと、全然書いてないやんと私なら思ってしまう。3つぐらいあれば、この人はこういう技術に関心があるんだ、こんな業務をやっているんだ、内容もしっかり書けているねとか、そういう判断を下すことができる最低限のコンテンツ量と言えるのではないだろうか。私にとってはそれが3つの記事と言える。<a href=/diary/posts/2023/0815/#課題管理とプロジェクトマネージメントの話を熱く語る>ちょっと前に公開した podcast</a> でテックブログの記事を読んでくださいと話したのでリスナーが聞く前に増やしておきたい。ちょうどプロダクトのプレスリリースも出たのでその宣伝も兼ねられるし、勉強会のネタにもなるし、私の義務感を軽減してストレス解消にもなるし、ここは踏ん張って今日・明日で下書きを書き終えたい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0518/>次開発と打ち上げ</a></h1><div class=post-meta><time class=post-date>2023-05-18 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/team-building/>team building</a>&nbsp;
#<a href=/diary/tags/food/>food</a>&nbsp;
#<a href=/diary/tags/drink/>drink</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span>
<img src=/diary/img/2023/0518_unagi.jpg class=post-cover alt=次開発と打ち上げ title="Cover Image"><div class=post-content><p>能のサイトを眺めつつ <a href=https://www.nhk.jp/p/ts/9N81M92LXV/episode/te/6XWRL58JNK/>世界を変えた“愚か者”フラーとジョブズ</a> をみているうちに寝落ちした。0時過ぎに寝て何度か起きて8時過ぎに起きた。休日以外に8時まわるまで寝ていたという記憶が直近数ヶ月にはないので久しぶりに寝坊した。起きたら8時10数分でそんなことあるはずないとか思ってしまって脳が現実を受け入れられなくて起きた時間を認識できなかった。明らかに8時10数分なんだけど、時計が壊れているなとか思ってしまった。</p><h2 id=開発課題の打ち合わせ>開発課題の打ち合わせ</h2><p>大きく時間を使って次開発の打ち合わせ。事前にいくつか開発課題を洗い出せているが、その優先順位付けをしていかないといけない。開発メンバー + 別チームのコンサルタントにも入ってもらって各々の意見を出し合うといった会議をした。私が議題の資料を予め作っておいた。その進行に応じて議論や意見が盛り上がったのでうまくいってよかったと思う。
大項目でまとまった機能をやるよりも、個々の機能単位に優先順位付けした方がよいだろうという話しになって小さい単位で担当者を割り当てて開発を進めていくことになる。いずれはすべてやるが、開発の順番を決めていくのは意外と難しい。</p><p>話し終えてからメモをまとめ直しているうちに私自身が要件を詳細に把握できていない要件があることもわかってきた。空中戦だとわからないままふわっと進んでしまうので、文字に落とし込んで整理した上で、本当に必要なものをさらに深堀りして議論しないといけないことに気付いた。</p><p>少ない人数で会議をやる利点の1つとして、みんなの意見を順番に聞いていく余裕をもてることがあげられる。「誰一人取り残されない」とどこかの省庁がミッションにあげているように、うちのチームも課題管理を駆使して、それぞれのメンバーができることややりたいことでチームに貢献するような開発にしていきたい。もう半年やって課題管理に慣れてきているので、次開発は前回のようなやり方を教えるところからスタートにはならないはずだと思う。</p><h2 id=打ち上げ>打ち上げ</h2><p>4月末にリリースを終えたので区切りとして打ち上げしてきた。うちのチームメンバーと偉い人の5人で行くのだと思っていたら直前に社内のメンバーにたくさん声を掛けたそうで10数人での飲み会になって送別会や部署のキックオフみたいな飲み会になった。賑やかでよかった。個人だとあまり行かないようなちょっとお値段のするコースでよいものを食べられておいしかった。日本酒もいろいろ飲んだ。神戸の酒どころに住んでいるので日本酒に関心をもつようになってきた。</p><ul><li><a href=https://www.kigawaya.com/sake/jyouki/>山形 上喜元</a></li><li><a href=https://kuheiji.co.jp/>愛知 醸し人九平次</a></li></ul><p>18-20時と打ち上げやって、21時に新幹線を予約していたのでそのまま帰ってきた。このスケジュールの段取りもちょうどよかった。お酒を飲んで新幹線に乗ると思いの外眠れなくてそこだけ疲れた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0414/>oss な開発は chatgpt が猛威を振るう予感</a></h1><div class=post-meta><time class=post-date>2023-04-14 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/ldap/>ldap</a>&nbsp;
#<a href=/diary/tags/gpt/>gpt</a>&nbsp;
#<a href=/diary/tags/debug/>debug</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>2時に寝て6時半に起きた。開発の追い込みが佳境に入ってきて集中力が増してきた。</p><h2 id=chatgpt-と一緒にデバッグ>chatgpt と一緒にデバッグ</h2><p>openldap サーバーの拡張の仕組みに <a href=https://www.openldap.org/doc/admin24/overlays.html>Overlays</a> がある。c 言語でカスタム overlay を実装することで openldap サーバーに任意のフック処理を実装できる。いまやっていることはパスワードの追加や更新をフックしてそのパスワードを id 連携するためのモジュールを開発している。というか、開発済みだと聞いていたモジュールが意図したように動かないのでデバッグしている。例えば <code>ppolicy</code> という overlay を使って次のように設定すると、平文で送ったパスワードをディレクトリサービスの db へ格納する前に平文からパスワードをハッシュ化してくれる。この変換はパスワード変更を overlay でフックして実装されている。</p><pre tabindex=0><code>overlay ppolicy
ppolicy_hash_cleartext on
</code></pre><p>overlay は slapd.conf に設定した順番に実行されるようで、それぞれの overlay に依存関係がある場合は実際の処理にも影響がある。そんな openldap サーバーの拡張モジュールの開発を引き継ぐことになったが、私がまったく openldap サーバーのことをわかっていないので <a href=https://openai.com/blog/chatgpt>chatgpt</a> を使って理解しながらデバッグしている。これがそれなりにうまくいっていて調査が捗った。但し、chatgpt が教えてくれたことなので完全に正しいかどうかの保証がない。振る舞いで検証できるものはともかく、そうじゃないものは最後に有識者に正しいかどうかを確認する必要がある。</p><p>例えば、次のような ldif エントリーをサンプルとして、パスワードは <code>userPassword</code> という属性で扱う。ここで <code>userPassword</code> だけコロンが2重 (<code>::</code>) になっていることがわかる。これは属性の値が base64 でエンコーディングされていることを意味している。こういった2重コロンのような短いキーワードを検索で調べるのは難しい。chatgpt ならピンポイントに答えてくれる。</p><pre tabindex=0><code>dn: uid=jdoe,ou=users,dc=example,dc=com
objectClass: top
objectClass: person
objectClass: organizationalPerson
objectClass: inetOrgPerson
uid: jdoe
cn: John Doe
givenName: John
sn: Doe
mail: jdoe@example.com
userPassword:: e1NTSEF9bm9ZMU5kdzN3WUdSbFhpdDJUaTY5UW9SeXpXaklEeXc=
</code></pre><p>openldap は oss だし、ドキュメントもインターネット上にあるので構造体の定義や c 言語のサンプルコードも書いてくれる。それらが完全に正しいか、私には判断できないが、openldap のソースコードで調査するところの当たりをつけるには十分な情報を返してくれる。カスタム overlay を開発するときの主要なエントリーポイントと ldap 操作のタグ名は次になる。</p><ul><li>bi_op_bind: バインド（認証）操作に対応するエントリーポイント、LDAP_REQ_BIND</li><li>bi_op_search: 検索操作に対応するエントリーポイント、LDAP_REQ_SEARCH</li><li>bi_op_compare: 比較操作に対応するエントリーポイント、LDAP_REQ_COMPARE</li><li>bi_op_modify: 修正（属性の追加、削除、変更）操作に対応するエントリーポイント、LDAP_REQ_MODIFY</li><li>bi_op_modrdn: エントリ名の変更 (MODIFY RDN) 操作に対応するエントリーポイント、LDAP_REQ_MODRDN</li><li>bi_op_add: エントリの追加操作に対応するエントリーポイント、LDAP_REQ_ADD</li><li>bi_op_delete: エントリの削除操作に対応するエントリーポイント、LDAP_REQ_DELETE</li><li>bi_op_abandon: 中止操作に対応するエントリーポイント、LDAP_REQ_ABANDON</li><li>bi_op_extended: 拡張操作に対応するエントリーポイント、LDAP_REQ_EXTENDED</li></ul><p>例えば、LDAP_REQ_ADD は ldap.h で次のように定義されている。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#75715e>#define LDAP_REQ_ADD        ((ber_tag_t) 0x68U) </span><span style=color:#75715e>/* application + constructed */</span><span style=color:#75715e>
</span></span></span></code></pre></div><p>これを gdb でデバッグしてタグを確認するときは次のように Operation 構造体内の o_tag をチェックすればよい。gdb で16進数表示するときは <code>/x</code> を指定する。</p><pre tabindex=0><code>(gdb) print /x op-&gt;o_tag
$8 = 0x68
</code></pre><p>ppolicy よりも前にカスタム overlay を設定すれば平文のパスワードにアクセスできそうにみえるのだけど、gdb でデバッグしているとハッシュ化済みのパスワードになっていた。</p><p>あと稼働している openldap サーバーに gdb で attach してデバッグする方法も chatgpt に聞きながら行った。やりたい操作に対して gdb のコマンドを教えてもらってすぐに検証してフィードバックからさらに質問できるのでインタラクティブな repl のような環境と chatgpt は相性がよいように思えた。gdb のコマンドを覚えておく必要も、ググる必要もないことに気付いた。</p><h2 id=近況報告>近況報告</h2><p>元同僚と <a href=/diary/posts/2022/0311/#近況報告>約1年ぶりの近況報告</a> の雑談会をしてきた。これで3回目かな。毎年の恒例行事のようになってきた。兵庫県の住みたい街ランキングでいつも上位にある <a href=https://www.nishi.or.jp/>西宮市</a> でカレーを食べて、バーで飲んできた。三ノ宮から西宮は快速で15分程度の距離。すぐ行ける場所なんだが、とくに行く機会がなかったので神戸に引っ越してきて5年以上経つのに電車で行ったのは今回が初めてになる。いつも通り近況を聞きながら、みんな私と同じぐらいの世代なので今後のキャリアの方向性などを話していた。</p><p>私は起業して税金やその仕組みに関心をもつようになり、起業する前より少し詳しくなった。知人から節税相談を受けることもある。税金の基本的な考え方として、1つの大きな収入に対して節税することはできない。自由に使えるお金がほしかったら基本的に節税できない。税金をたくさん払って貯金するしかない。一方で個人と会社に資産を分割したり、共済や基金を活用することで手取りの収入は減るが、支払う税金は少なくなって中長期でみると資産が増える。例えば、共済や基金に積み立てたお金は原則としては退職所得で戻ってくるので、ずっと優遇された <a href=https://www.nta.go.jp/taxes/shiraberu/taxanswer/shotoku/1420.htm>退職所得の所得税</a> により、最終的に支払う税金が少なくなるからである。これが税金を支払う基本的な考え方。自分の手元にお金を残した上で税金を払いたくないが、どうすればよいか？とよく聞かれるが、そんなことはできないというのが模範回答になる。元同僚も私もそうなのだが、もはや自分の生活にお金をあまり必要としていない。私が節税の仕組みを調べたり実践したりするのは、税金の仕組みを学ぶために過ぎない。ただ知識として学ぶよりも、実際に実践して運用してみる方が学びになる。</p><p>以前の <a href=/diary/posts/2023/0408/#もくもく会>出張もくもく会</a> の後で懇親会のときにそのうち資本主義は新しい制度にとって変わられるのではないかという話題があった。それは行き過ぎた資本主義の弊害と、資本主義である限り40時間/週の労働時間から抜け出すには資本家になるしかなくて、人類はすでにこれだけ技術があるのだからもっと多くの人が今よりも働かずに食べていけるのではないかと多くの人が考えている。私の場合も、実質は自分のやりたいことしかやってなくて、自分のために働きながらも、老後のために一応はお金をもらっておくみたいな働き方になっている。この考え方は資本主義の次の制度へ移行するときに活きてくればいいなと思う。</p></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/drinking/page/2/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>