<!doctype html><html lang=en><head><title>Ci/Cd :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/ci/cd/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Ci/Cd"><meta property="og:description" content><meta property="og:url" content="/diary/tags/ci/cd/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/ci/cd/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><h1>Posts for: #Ci/Cd</h1><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0328/>backlog-github-integration-action を運用し始めた</a></h1><div class=post-meta><time class=post-date>2022-03-28</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>2時に寝て6時半に起きた。</p><h2 id=backlog-と-github-のインテグレーション-action-の試験運用>backlog と github のインテグレーション action の試験運用</h2><p>昨日作った backlog-github-integration-action を早速お手伝い先の github リポジトリと backlog に導入した。いま暇な時期というのもあって、誰からもクレームが出なかった。この閑散とした間隙を「乗るしかない、このビッグウェーブに」というノリで導入して運用して既成事実を作る。ses でお手伝いに行って課題管理のツールを作っているというのは頭おかしいと思うけど、周りからクレームが出る前に電光石火で運用にのせてしまう。実際に運用で使うといくつかバグがあって、いま latest の docker イメージを使ってカスタム action が動いている。バグがあったら修正して、<code>./gradlew jib</code> (docker push) で新しい docker イメージを gihtub packages に push して、不具合があった pr のジョブを再実行すれば再現環境でテストもできる。いくつかバグ修正をした。実際の運用のデータを使うとばらばらとバグがみつかる。運用で実際に使われていないツールはダメ、絶対。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0327/>backlog-github-integration-action を作った</a></h1><div class=post-meta><time class=post-date>2022-03-27</time></div><span class=post-tags>#<a href=/diary/tags/java/>java</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>0時に寝て7時に起きた。丸一日開発していた。構想1ヶ月、実装2日といったところか。</p><h2 id=backlog-と-github-のインテグレーション-action>backlog と github のインテグレーション action</h2><p>お手伝い先が <a href=https://backlog.com/ja/>backlog</a> を課題管理システムとして使っている。backlog は <a href=https://support-ja.backlog.com/hc/ja/sections/360005425774-Git>git 連携</a> の機能をもっているが、これは nulab 社のクラウド上に git リポジトリを構築したものと連携する機能であって、github と連携する機能ではない。そこで github と backlog と連携するためのカスタム github action を作った。</p><ul><li><a href=https://github.com/kazamori/backlog-github-integration-action>https://github.com/kazamori/backlog-github-integration-action</a></li></ul><p>カスタム github action を java で開発するのは普通にはやらないと思うが、いくつか理由があってお手伝い先が java しかできないというのと、nulab 社が提供している公式クライアント <a href=https://github.com/nulab/backlog4j>nulab/backlog4j</a> が java しかないから。最初は go で実装しようと思って go のクライアントを試したんだけど、サンプルコードをかいたら一部の処理でエラーになって、そのエラーがよくわからなくてやる気がなくなってしまった。最新の rest api の仕様にそってメンテナンスされていないのかな？と思って、やっぱり公式クライアントしかないなと。他にも次のライブラリを使っている。</p><ul><li>設定ファイル: <a href=https://github.com/lightbend/config>https://github.com/lightbend/config</a></li><li>コマンドライン解析: <a href=https://github.com/remkop/picocli>https://github.com/remkop/picocli</a></li><li>github クライアント: <a href=https://github.com/hub4j/github-api>https://github.com/hub4j/github-api</a></li></ul><p>これまでは commons-cli を使ってきたけど、サブコマンドの機能を提供していない。もうメンテされてないかも？サブコマンドの機能をもつ argument parser がほしくて picocli を選択した。初めて使っていて、実装してみたらわりと私の好みでよく出来ていると思う。今後は cli ライブラリとして picocli を使っていこうと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0321/>github actions の課金金額</a></h1><div class=post-meta><time class=post-date>2022-03-21</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>2時に寝て何度か起きてだらだらしながら10時に起きた。</p><h2 id=gihtub-api-tools-のリファクタリングとデータ分析>gihtub-api-tools のリファクタリングとデータ分析</h2><p>実際に使ってみながらリファクタリングしたり、足りない機能を追加したりした。ツールに拡張した機能が使えるかどうかの検証のため、お仕事のプライベートリポジトリのデータを使って分析をし始めて、気付いたら分析ならびに分析結果の資料まで作ってしまった。軽く半日ぐらいのお仕事をやってしまっていた。過去5ヶ月分の課金時間の合計を算出し、単体テストの実行を github actions に追加することで増える課金時間の見積もりと金額を算出した。月間でいまより3時間30分、全体の課金時間に対して20%弱程度の追加が見込まれる。それによる課金金額を算出すると 210 * $0.008 = $1.68 になる。いままで無料枠を超えないように運用してきたわけだが、こんな200円程度の金額を節約するために github actions 上でテスト実行しないといった判断がくだされていた。開発者は誰も実際の課金金額を知らなかったし、課金金額を算出するとあほらしくなった。あと github actions はめちゃくちゃ安い。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0320/>gihtub-api-tools の拡張</a></h1><div class=post-meta><time class=post-date>2022-03-20</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;
#<a href=/diary/tags/python/>python</a>&nbsp;</span><div class=post-content><p>5時に寝て9時過ぎに起きた。昨日は久しぶりに夜更ししてコードを書いてた。</p><h2 id=github-actions-のいろいろな時間の算出>github actions のいろいろな時間の算出</h2><p>以前作った github-api-tools を拡張して github actions の実行履歴の分析するための機能を作っている。</p><ul><li><a href=https://github.com/kazamori/github-api-tools/issues/2>Add actions statistics</a></li><li><a href=https://github.com/kazamori/github-api-tools/pull/4>Add gh-cli-actions command for Actions API</a></li></ul><p>ひとまずワークフローの実行履歴からジョブのステップの実行時間を積み上げた時間を算出してみた。いくつか API を調べているうちに課金時間は直接 API から取得できることに気付いた。この3つの時間は全然別の意味をもっていて、それぞれの時間は一致しない。</p><ul><li>ステップ実行時間: ジョブのそれぞれのステップの実行時間の合計</li><li>課金時間: 課金対象として数えられている時間の合計</li><li>ワークフロー実行時間: アクションのワークフローの実行にかかった時間</li></ul><p>github actions は public リポジトリに関しては課金対象ではないんやね。private リポジトリ且つ github-hosted ランナーを使っている場合のみ課金対象となるみたい。</p><ul><li><a href=https://docs.github.com/en/actions/monitoring-and-troubleshooting-workflows/viewing-job-execution-time>Viewing job execution time</a></li><li><a href=https://docs.github.com/en/billing/managing-billing-for-github-actions/about-billing-for-github-actions>About billing for GitHub Actions</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0318/>github actions の改善</a></h1><div class=post-meta><time class=post-date>2022-03-18</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;</span><div class=post-content><p>0時に寝て3時に起きて6時に起きた。</p><h2 id=失敗したジョブの再実行>失敗したジョブの再実行</h2><p>せらさんのツィートをみかけて調べたら2日ほど前に失敗したジョブからの再実行の改善が行われたらしい。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>GitHub Action で失敗したジョブだけ実行できる様になってる。今まで失敗しやすいものは再実行を小さくするために設定を分けたりとかしていたんだけど、そういうことをしなくてもよくなった。</p>&mdash; Kazuhiro Sera (瀬良) (@seratch_ja) <a href="https://twitter.com/seratch_ja/status/1504664461483085826?ref_src=twsrc%5Etfw">March 18, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><ul><li><a href=https://github.blog/2022-03-16-save-time-partial-re-runs-github-actions/>Save time with partial re-runs in GitHub Actions</a></li></ul><p>たまにだけど、i/o エラーみたいな内容で github actions のワークフロー実行が異常終了することがある。そんなときに途中から再実行できるといいなぁとは思っていた。これはステップ単位ではなく、ジョブ単位の実行みたいだけど、それでも途中から再実行できればワークフローの自由度や効率は上がると思う。github actions がどんどん強力になっていくのが楽しみ。あとやぎさんから教えてもらった <a href=https://miyajan.booth.pm/items/1865906>GitHub Actions 実践入門</a> も購入した。ある程度触ったところで雰囲気は掴めてきたので体系的に学んでみる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0314/>平穏な一日</a></h1><div class=post-meta><time class=post-date>2022-03-14</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>0時に寝て5時半に起きた。一仕事を終えて淡々と前の作業の続きのリファクタリングなどをしていた。</p><h2 id=デプロイ改善のタスク完了報告>デプロイ改善のタスク完了報告</h2><p>週末にパイプライン処理の検証やロールバック処理の実装を行った。ドキュメントも一通り書いた。チームの開発者にそれらを説明して3スプリント(3週間)に渡った改善が完了したことを報告した。チケットにすると26、そのうち私が担当したのが22なので、私がイニシアティブをとって完遂させた。github actions を始めとする、github のサービスの理解が深まってそれなりに学びがあった。自分でもいくつかカスタム action を作ってみようと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0312/>デプロイ改善の残作業</a></h1><div class=post-meta><time class=post-date>2022-03-12</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて4時ぐらいまでだらだらして寝て6時に起きた。</p><h2 id=ストレッチ>ストレッチ</h2><p>これまで11時からストレッチを受けていたが、今週から dr.stretch さんの土日の開店時間が10時になったのにあわせる形で時間変更した。朝に予定が入っているとその時間にあわせて起きて身支度して1日が始まるので家で中途半端にだらだらしなくてよい。いつもは11時にあわせて家を出掛けるのが、10時にあわせて出掛けるようになったのでいつもより1時間早く活動できるようになった。私はなんか予定がないとだらだらしてしまって怠惰に過ごしてしまう。そういう怠ける自分の性格もわかっているので適度に予定を入れて怠けないように注意している。</p><p>今日の開脚幅は開始前163cmで、ストレッチ後165cmだった。先週とほぼ同じ。今週もお仕事が忙しくて全くできなかったので現状維持といったところ。</p><h2 id=デプロイのパイプライン処理>デプロイのパイプライン処理</h2><p>github deployment から workflow dispatch に移行したおかげでせっかく deployments ベースで作ったパイプライン処理のツールを workflow dispatch 向けに移行する必要があった。言うても基本的に同じパラメーターを処理するだけなので大半は再利用できる。ツールのちょっとしたリファクタリングをやってパイプライン処理が動くかどうかの検証をして、ドキュメントを wiki にまとめた。あとはロールバックを自動化するための仕組みを作るだけ。基本的には k8s の kubectl を実行するワークフローを作るだけという想定。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0308/>デプロイ改善の成果まとめ</a></h1><div class=post-meta><time class=post-date>2022-03-08</time></div><span class=post-tags>#<a href=/diary/tags/book/>book</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>23時に寝て5時過ぎに起きた。何度か途中で起きたけど、久しぶりによく寝た。前日あまり寝てなかったから19時過ぎには帰ってきてだらだらしてた。</p><h2 id=もてなしだけではもう食えない>もてなしだけではもう食えない</h2><p>業界研究を兼ねて <a href="https://ec.hoteresonline.com/products/detail.php?product_id=262">もてなしだけではもう食えない -ホテル経営学の本質と実践-</a> を読み始めた。同じ出版社の週刊ホテルレストランという雑誌の連載を書籍化したものらしい。著者は立教大学で社会人向けビジネススクールでホテルマネジメントとホテルインベストメントを教えているらしい。ビジネスの堅い話しを小説調にすれば読みやすいんじゃないかみたいな取り組みなのかな？よくわかてないけど、小説仕立てで業界研究ができるような書籍になっているらしい。第1章プロローグと第2章腐りやすい在庫を読んだ。実際の現場でこんな仕事できない人が改革チームのリーダーなんかになったりしないなと思いながら読んでた。そこは本題じゃない！コンサルティングでありそうな経営の話しが出てくるのでうちの会社の経営の勉強にもなるかもしれない。少しずつ読んでいく。</p><h2 id=デプロイ改善の成果>デプロイ改善の成果</h2><p>水曜日がすくらむのふりかえりイベントがあるのでそれに間に合わせて簡単にまとめの資料を作った。3スプリント (3週間) もかけて抜本的に開発のワークフローからビルド/デプロイの ci/cd を見直したので開発全般に影響を与えた。</p><ul><li>本番環境デプロイ: 実行時間を約72%の短縮</li><li>テスト環境デプロイ: 実行時間を約51%の短縮</li><li>hotfix デプロイ: 実行時間を約64%の短縮<ul><li>そもそも従来のやり方では hotfix を出していないので机上の時間ではあるが</li></ul></li></ul><p>単純に github actions の実行時間だけ比較しても速くなっているのだけど、それ以上にブランチ戦略を大きく変えた。従来は3つのブランチで運用していた。</p><ul><li>develop</li><li>test</li><li>main</li></ul><p>これを1つのブランチのみで運用できるように開発のワークフローを刷新した。ブランチが1つしかないので ci/cd の戦略もシンプルになって、変則的な運用 (hotfix を出したいとか) をしても、開発全体に影響を与えない。「誰か勝手にブランチを作ってデプロイして」で終わる。従来のやり方は3つのブランチが開発ワークフローと ci/cd に密接であったために本番環境のリリースするときは開発すべてが止まってしまう状態だった。週1回のリリースだったので本番リリース前の1-2日は PR のレビューやマージを止めているという運用になっていた。それは開発速度に大きな影響を与えていた。ブランチ戦略を見直したことでいつでも本番環境にデプロイできるようになって、継続的デリバリーっぽいことがやりたかったらできるよという話しをした。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0307/>ワークフローの移行説明</a></h1><div class=post-meta><time class=post-date>2022-03-07</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>3時に寝て6時半に起きた。朝起きたら github actions のリソース上限に達しているという連絡が slack に書き込まれていて週末に移行作業して1500分ぐらいは浪費しましたと事後報告した。</p><h2 id=ワークフロー移行後の説明>ワークフロー移行後の説明</h2><p>週末に移行した新しい ci/cd の仕組みを開発者に説明した。開発のワークフローも大きく変わる。いくつか要望をもらいつつ、とくに混乱も誤解もなく受け入れられた。github actions の管理画面からボタンでデプロイ実行できるため、本番環境にデプロイできるユーザーは制限したいと言われて次のようなステップを追加した。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yml data-lang=yml><span style=display:flex><span>- <span style=color:#f92672>name</span>: <span style=color:#ae81ff>デプロイユーザーを確認</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>if</span>: <span style=color:#ae81ff>${{ env.DEPLOYMENT_ENV == &#39;prod&#39; }}</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>run</span>: |<span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    [[ &#34;${{ contains(fromJSON(env.DEPLOYABLE_USERS), github.actor) }}&#34; == &#34;true&#34; ]] &amp;&amp; exit 0
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    echo &#34;デプロイ権限のあるユーザーではありません&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>    exit 1</span>    
</span></span><span style=display:flex><span>  <span style=color:#f92672>env</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>DEPLOYABLE_USERS</span>: <span style=color:#e6db74>&#39;[&#34;user1&#34;, &#34;user2&#34;, &#34;app-bot&#34;]&#39;</span>
</span></span></code></pre></div><p>expressions の <a href=https://docs.github.com/en/actions/learn-github-actions/expressions#functions>Functions</a> に組み込みの関数がいくつか紹介されている。それらを組み合わせるとうまくいきそうと思って書いてみた。たしかにちょっと楽に実装はできるけど、github actions の expression とシェルの文字列との境界が、yaml のコード上では曖昧なため、真偽値などはとくにわかりにくい。例えば、次のコード。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>{ contains(fromJSON(env.DEPLOYABLE_USERS), github.actor) <span style=color:#e6db74>}</span><span style=color:#e6db74>}&#34;</span> <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;true&#34;</span> <span style=color:#f92672>]]</span>
</span></span></code></pre></div><p><code>${{ ... }}</code> で囲まれたところは github の expression なので boolean として評価できるが、それをシェルにもってくると文字列になってしまうので文字列で比較しないといけない。普通にコードを書いていて気づきにくいので実行して振る舞いを検証しないと間違うみたいな話し。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0306/>もっとさいきょうのでぷろい</a></h1><div class=post-meta><time class=post-date>2022-03-06</time></div><span class=post-tags>#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><h2 id=ぼくのかんがえたもっとさいきょうのでぷろい>ぼくのかんがえたもっとさいきょうのでぷろい</h2><p>昨日 <a href=/diary/posts/2022/0305/#ぼくのかんがえたさいきょうのでぷろい>ぼくのかんがえたさいきょうのでぷろい</a> を実装したんだけど、その後、残っていた残課題に対応しているうちにもっと最強のデプロイ方法があることに気付いた。結論から言って <a href=https://docs.github.com/en/rest/reference/deployments>GitHub Deployments</a> を使う必要がなかった。GitHub Deployments で過去のリビジョンを指定したときは次のような 409 エラーが発生する。</p><pre tabindex=0><code>gh: Conflict merging main into f0cff65c94c4a242efebc79c8fb1e31d58d2f592. (HTTP 409)
</code></pre><p>これを回避するためにどんな手段があるかなと <a href=https://docs.github.com/en/rest/reference/actions#create-a-workflow-dispatch-event>workflow dispatch event</a> をみていて <code>inputs</code> というパラメーターがあることに気付いた。あれ？workflow dispatch ってパラメーターを受け取ることができたんだっけ？と調べたら2020年7月ぐらいからできるようになってた。</p><ul><li><a href=https://github.blog/changelog/2020-07-06-github-actions-manual-triggers-with-workflow_dispatch/>GitHub Actions: Manual triggers with workflow_dispatch</a></li><li><a href=https://github.blog/changelog/2021-11-10-github-actions-input-types-for-manual-workflows/>GitHub Actions: Input types for manual workflows</a></li></ul><p>github actions の web ui とも連動していて画面からもパラメーターを渡せるようになっていた。jenkins で言うところのパラメーター付きビルドと呼ばれる機能。カスタムアクションの <a href=https://docs.github.com/en/actions/creating-actions/metadata-syntax-for-github-actions#inputs>inputs</a> と同じような使い勝手で利用できる。workflow dispatch がパラメーターを受け取れるなら GitHub Deployments を使うメリットって何があるっけ？と思ったら何もなかった。GitHub Deployments を使うことで無駄にリソースを浪費してパイプライン処理を複雑化させるデメリットしかなかった。inputs に渡す型に <a href=https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment>environment</a> を指定すると、環境の制限や権限、protected branch などにも応用できるらしい。但し、この environment は public リポジトリか、github enterprise でしか高度な設定はできないみたい。GitHub Deployments 経由でリソースの作成自体はできる。</p><figure><img src=/diary/img/2022/0306_workflow-dispatch.png></figure></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0305/>週末は休出</a></h1><div class=post-meta><time class=post-date>2022-03-05</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;
#<a href=/diary/tags/ci/cd/>ci/cd</a>&nbsp;</span><div class=post-content><p>2時に寝て8時頃に起きた。前日に深夜まで開発してたせいか、朝起きたら頭痛かった。</p><h2 id=ストレッチ>ストレッチ</h2><p>お仕事に集中していて今週は1回しかストレッチができなかった。今日の開脚幅は開始前164cmで、ストレッチ後165cmだった。先週と同じぐらいかな。それでも毎週予定が入っているので必ず週に1回はちゃんとしたストレッチを受けられる。もう1年以上続けているのだけど、以前より体調のよい状態をずっと継続できている。私はなにかに集中すると他のことをしばらく放置してそればっかりやってしまう傾向があるから毎週の予約があることが継続的な体調管理に大きく役立っている。太ももの後ろの筋肉と腰のストレッチの2つを楽しみにしている。デスクワークをする人は基本的にこの2つに疲労が蓄積するので疲労が溜まるのは自然と言える。その度合いがどのぐらいかでその週の疲労感や調子がよくわかる。今日は先週よりもその2つはましになっていた。</p><h2 id=ぼくのかんがえたさいきょうのでぷろい>ぼくのかんがえたさいきょうのでぷろい</h2><p>ここ2週間ほど、ビルドとデプロイの分離のための作業をしている。具体的には <a href=https://docs.github.com/en/rest/reference/deployments>GitHub Deployments</a> と <a href=https://docs.github.com/en/actions>GitHub Actions</a> を組み合わせて、新たな開発のワークフローを作るといったもの。main, test, develop と3つのブランチで開発/運用しているのを main ブランチ1つに統合し、ビルドもデプロイも最小限に留めて継続的デリバリーを目指すというもの。移行時は開発を止めてしまうのでこの土日で作業する予定だった。準備は十分にやっていたので問題なく移行を完了させた。今日は単体リポジトリのテスト環境へのデプロイができるところまでできた。あとはデプロイツールや github actions の処理を洗練させていくだけ。テンションが上がっているのでこのまま明日も休出してできるだけ品質をあげていく。</p></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/ci/cd/page/2/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/tags/ci/cd/page/4/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>