<!doctype html><html lang=en><head><title>Tax :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/tax/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Tax"><meta property="og:description" content><meta property="og:url" content="/diary/tags/tax/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/tax/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><h1>Posts for: #Tax</h1><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0215/>致命的バグをみつけた</a></h1><div class=post-meta><time class=post-date>2024-02-15</time></div><span class=post-tags>#<a href=/diary/tags/ldap/>ldap</a>&nbsp;
#<a href=/diary/tags/debug/>debug</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=post-content><p>2時頃に寝て5時過ぎに起きた。お風呂に入るときに fitbit を外して、その後付けるの忘れて寝てしまったから睡眠時間を計測できなかった。</p><p>今日の運動はレッグレイズ(椅子),腹筋ローラー,腕立て,スクワットをした。統計を <a href="https://docs.google.com/spreadsheets/d/1bg85QtM-LciUgey8I79uI7vW2PEwsP6TVdeIRVkACBg/edit?usp=sharing">運動の記録</a> にまとめる。</p><h2 id=agent-の致命的なバグ>agent の致命的なバグ</h2><p>先週から QA テストをしていて agent の致命的なバグに気付いた。もともとあった java 製の agent から私が設計して作り直した go 製の agent になる。<a href=/diary/posts/2024/0115/#ldap-エントリーの更新リクエストをランダムに行うツール>ldap エントリーの更新リクエストのテストツール</a> を作ったことでシビアなタイミングによるバグを検出できた。</p><p>ツールを使ってテストしていて、成功するはずのリクエストが失敗して、ログを調査しながらデバッグしていた。ldap エントリーを扱う難しさの1つに、ldap サーバーはエントリー間の依存関係やデータの整合性といったものを検証しない。そういった用途はアプリケーションの役割であって、ldap プロトコルはあくまで id を管理することに特化したものという役割分担になっているのだと推測する。そうすると、(open) ldap サーバーへ登録できたエントリーが次の agent や api サーバーといったアプリケーションのレイヤーでエラーになることがある。このとき、ldap サーバーではエラーが発生していないため、直接的なエラーを検知することができなくて、デバッグや調査に時間がかかる。</p><p>agent の実装として、ユーザーエントリのストリームとグループエントリーのストリームの2つに分割して、非同期にそれぞれのエントリーを id 連携する設計にしていた。というのは、ldap エントリーにはユーザーやグループといった概念は原則として存在しない。そのエントリーがユーザーなのか、グループなのかはアプリケーションが判断している。アプリケーションの用途としてはこの2つを明確にわけないと不便なことから、ワークアラウンドもしくは実務的な解決策として検索するときのフィルターと base dn で管理するようにしていた。そして、これらをそれぞれ別のストリームとして扱うよう、私が設計していた。このことがタイミングによってはユーザーエントリーとグループエントリーに依存関係がある場合、データの整合性を保証できないことに気付いた。なぜならば、ユーザーエントリーとグループエントリーそれぞれ非同期／並行に処理されてしまうから。</p><p>結論としては、ldap サーバーからエントリーの更新の順序を保証するには1つのストリームを subscribe しないといけない。そして、ストリームから取り出したエントリーがユーザーなのか、グループなのかはアプリケーションが判別しないといけない。テストツールを作ったことでシビアなバグも検出できた。</p><h2 id=定額減税>定額減税</h2><p><a href=https://www.nta.go.jp/users/gensen/teigakugenzei/index.htm>定額減税 特設サイト</a> が公開されたらしいというニュースをあちこちでみつける。従業員の税金が安くなるので経営者としての私がなにかしないといけないと思っているけれども、まだ何をしていいのかよくわかっていない。時間をみつけて調べないといけない。税制が変わるとこういった事務手続きが突発的に入ってくるのがマイクロ法人の面倒なところ。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0130/>午後半休と西へ南へ</a></h1><div class=post-meta><time class=post-date>2024-01-30</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/investing/>investing</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;</span><div class=post-content><p>3時頃に寝て4時半に起きて7時半に起きた。いろいろやっていたら眠れなかった。</p><p>今日の筋トレは腕立て:20x1をした。午後半休で出掛けて実家へ寄って疲れたので休トレーニング日にした。</p><h2 id=家族信託の契約書の読み合わせ>家族信託の契約書の読み合わせ</h2><p><a href=/diary/posts/2023/1124/#家族信託の打ち合わせ>前回の打ち合わせ</a> を経て、弁護士さんと三井住友信託銀行の担当者との契約書レビューを行い、契約書の叩き台が出来上がってきた。</p><p>午後半休をとって明石市の弁護士さんの事務所へ母と姉と私の3人で訪問してきた。目的は契約書の読み合わせで内容を確認しつつ、この契約は基本的に1度作ったら母が亡くなるまで10年や20年といった長期間に渡って効力をもつため、3人の利害関係者が本当に契約に合意しているかどうかの最終確認を弁護士さんが確認するという意図も含まれていたように思う。私の考えとしても姉はいまも今後も基本的に関わらないため、母に不利な契約の建付けをしているわけではないことを確認してもらう意図もあった。</p><p>母の財産を私 (と姉) が管理するという目的であり、母から私に必要なお金の送金を依頼するという形になる。母自身はその財産を自由に扱うことができない。母から私が依頼を受けて、契約内容の範疇で正当であれば、私が信託銀行の口座から母の口座へ振り込む。その際に大きなお金であれば、信託銀行の担当者から私に監査が入る。必要に応じて見積書や注文書などを求められるかもしれない。私は信託報酬として3万円/月を受け取る。年間で36万円になる。この金額は一般的な相場になる。信託報酬は生前贈与の代替として機能する。私が急死したり、病傷で入院して管理できなくなれば姉が引き継ぐ。</p><p>現時点において家族信託における資産の運用手段として NISA や投資信託は不可であるという。将来的に解禁される可能性はある。将来を見越して契約書に抽象的な表現で一応書いておくという話しにはなっているが、それを書いておいたところで将来 NISA や投資信託が容認されたとしても具体的な内容がないからダメだと信託銀行の担当者から拒否される可能性は高いとのこと。私の意図としては財産の一部を NISA の投資上限である360万円/年に追加していきたい。いまのところ、他の投資運用を考えるのが面倒でもあるので、NISA がダメならなにもせず預金として置いておくだけになるのかもしれない。</p><p>契約書を読み合わせしていておもしろかったのが、信託銀行の口座からの出金を私の口座に入れるのは不可だという。それが建て替えであっても。必ず母の口座、または請求者の口座でないといけないという。たとえば家が老朽化して新築し直したとしたら、信託銀行の担当者が工務店や建築会社の担当者とやり取りして直接支払ってくれるという。</p><p>この後の流れとして、作成した契約書を公証役場へ送り、弁護士さんと母と一緒に公証役場へ行く必要がある。そして公証人の前で契約書を作る。このときに公証人の前で母が契約内容の説明を求められる可能性もあるとのこと。契約書の手続きを完了したら私が三井住友信託銀行へ行って口座を開設する。口座を開設したら弁護士さんへ連絡して、父の遺産 (母の相続分) をその口座へ振り込むといった流れになる。</p><h2 id=送迎とコワーキングスペースの荷物運び>送迎とコワーキングスペースの荷物運び</h2><p>明石市で打ち合わせを終えて、そのまま母と姉を実家まで送って帰った。その際にコワーキングスペースで使う小物や家具なども一緒に運んで離れのスペースに設置した。<a href=/diary/posts/2024/0113/#ハンガーラック受け取り>ハンガーラック</a> を組み立てるのに少し時間がかかった。一通りの荷物運びを終えたらそのまま神戸まで戻ってきた。実家に泊まってもよかったが、週の中日だし、お仕事も溜まっているし、他にもいろいろある。20時半には神戸に戻ってきていたものの、あまり寝ていなかったせいか、眠気と疲労でそのまま寝てしまった。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0120/>ダブル掃除</a></h1><div class=post-meta><time class=post-date>2024-01-20</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/issue-tracking-system/>issue tracking system</a>&nbsp;
#<a href=/diary/tags/wiki/>wiki</a>&nbsp;
#<a href=/diary/tags/business/>business</a>&nbsp;</span><div class=post-content><p>0時に寝て3時に起きてちょっとネットみたりしてまた寝て7時に起きた。</p><p>今日の筋トレは腹筋:10x2,スクワット20x1をした。</p><h2 id=ストレッチ>ストレッチ</h2><p>筋トレの疲労がたまっているのかもしれないが、今日も太ももの後ろの筋がかなり張っていた。胸筋もやや張りがあったように感じた。トレーナーさんによると、筋トレした後に使ったところはストレッチして伸ばした方がよいという。今日の開脚幅は開始前153cmで、ストレッチ後156cmだった。先週とほぼ同じ。</p><p>筋トレを継続できているのでトレーナーさんにいろいろ聞いてみた。</p><ul><li>筋トレメニューに慣れてきたら強度をあげる？回数を増やす？<ul><li>回数を増やした方がよい</li><li>負荷をかけてしんどくなるとフォームが崩れて適切なトレーニングではなくなる懸念がある</li></ul></li><li>種別をもう1つ増やすなら何がよいか？<ul><li>背筋がいいんじゃないか</li></ul></li><li>筋トレを毎日やるのはどうか？<ul><li>大きな筋肉を使うトレーニングは2-3日休みを入れながらやった方がよい</li><li>小さな筋肉なら毎日でも構わない</li><li>私がやっている筋トレは10分でできるようなレベルなので毎日でよいだろう</li></ul></li></ul><h2 id=電子帳簿保存法対応の事務処理規定と運用ガイドラインの策定>電子帳簿保存法対応の事務処理規定と運用ガイドラインの策定</h2><p>税理士さんに <a href=/diary/posts/2024/0105/#事務処理規定の叩き台作成>電子帳簿保存法対応の事務処理規定の叩き台</a> をレビューしていただいた内容を規定に反映した。念のため、再レビューしてもらうが、これで完了とする予定。規定から実際の運用のためにガイドラインを作る。運用ガイドラインは <a href=https://www.notion.so/ja-jp>notion</a> にまとめる。</p><p>あまり notion を使う気になれないのは、課題管理システムをメインに使っているから wiki もそこにセットで付いていてほしいという願望がある。うちは jira cloud を使っているので本当は atlassian の wiki プロダクトを使いたいところだが confluence が使いにくいから使っていない。atlassian は confluence とは別にもっと軽量でシンプルな wiki プロダクトを別途提供すればよいのでないかとすら思う。一方で <a href=https://esa.io/>esa</a> や notion のような、wiki 単体のサービスを活用するのは課題管理システムとの連携において不便なように思えた。だから notion は最近プロジェクト管理の方に手を広げているのかもしれない。 github や gitlab のように、課題管理システムと wiki はとても相性がよいのでツールセットで提供するのがよいと思う。今後のプロダクト構想の中で wiki を考えていなかったけれど、アプリケーション間連携という視点から考察してもよいかもしれない。</p><p>sns などで電子帳簿保存法対応がすごく大変といったメッセージをたまにみかける。この法律は電子取り引き (請求書や領収書を pdf ベースでやり取りするサービスなど) に対応するもので紙の請求書や領収書でやり取りしている事業者には影響はない。しかし、昨今取り引きが電子化されていく流れでもあるため、電子取り引きはまったくないという事業者もあまり存在しないのではないかと思う。そして、これまではそういった事業者が取り引きの証拠となる電子データを消失してしまっても法律から言及できないという状態だった。電子取り引きはデータしかその取り引きがあったことを証明する証拠がないのにそのデータを消失して OK なわけないよね？というのが本来の電子帳簿保存法の目的になる。</p><p>おそらくパソコンやシステムでデータ管理していない事業者にとっては取引データ保存の仕組みや運用を新規構築する必要があってコスト増になって大変なのだと推測する。しかし、私のような、最初から大半の取り引きは電子取り引きであり、そのデータもすべてクラウドストレージに整理した上で保存している事業者にとってはほとんど運用に影響を与えない。もちろん現行の運用にあうようにするには事務処理規定を策定しないといけない。ここで影響があるのは訂正・削除の運用時に記録を残すという点ぐらいしか、既存の運用と変わることはない。そして、過去の電子取り引きの訂正・削除が発生したことは私の記憶にないぐらい稀にしか発生しないと推測される。</p><p>低辺 sier のひどい労働環境や多重請負契約の構造を it 業界の代表的なもののように揶揄されるのと同様、いかに世の中のできない人たちが自分たちのスキル不足や知識不足を大騒ぎしてその内容が正当であるかのように喧伝しているのかが伺える。まともにシステムを使っている会社は電子帳簿保存法で大きな影響を受けない。多少の運用手順が変わったり、システムの開発が必要になったりする程度だと思われる。これはインボイス対応もそう。うちのようなマイクロ法人でもインボイス対応は新規の取引先を登録していく作業が増えたぐらいで日々の会計処理にほとんど影響を受けていない。世の中のニュースと実際の実務運用に大きな乖離がある。そして、実際にやったこともないような人たちが「弱者いじめ」だと党派性をもって大騒ぎする。</p><h2 id=モニター変更>モニター変更</h2><p>これまで27インチと24インチのダブルディスプレイを使ってきた。実家 (コワーキングスペース) に27インチのモニターを持って帰ろうと思って、24インチのモニターをもう1つ買ってその入れ替えをしていた。24インチ x 2 のダブルディスプレイに変更した。27インチ x 2 は有効視野を考えると幅が広過ぎて私にはあわない。首振りが疲れる。1台でもっと大きいモニターを使うという選択肢もあるかもしれない。しかし、私はなんとなく2台のディスプレイで1つをコードを書くメイン、もう1つをブラウザで調べたものを表示させておくためのサブという使い方を気に入っている。ただの習慣かもしれない。</p><blockquote><p>人間の視野は左右の眼を合わせると180度以上あります。 片眼の視野は鼻側に約60度、耳側に約100度、上方向に約60度、下方向に約70度と言われています。その中で、標識の文字を読むなど、モノのカタチや色などがキチンと認識できる範囲を中心視と言い、わずか1～2度ほど。中心視のまわりの必要なものを識別できる範囲、有効視野は左右に35度ほど。その外側である周辺視野では、カタチや色などをハッキリと認識することはできません。</p><p><a href=https://global.honda/jp/safetyinfo/think_safety/vol14/vision/>中心視と周辺視野</a></p></blockquote><h2 id=オフィス掃除>オフィス掃除</h2><p>モニターを入れ替えしたら埃っぽくなったのでついでにオフィスも掃除した。掃除機は sharp の <a href=https://jp.sharp/souji/products/ecct12.html>EC-CT12-C</a> を使っている。サイクロンだからパワーもあるし、ゴミ捨ても紙パックいらないから簡単。コンパクトで数ヶ月に1回ぐらいしか使わない私の用途にちょうどよい。普段は箱にしまってある。</p><p>箱から掃除機を取り出して、終わったら片付けるときに箱にしまい方も書いてある。他の掃除機はどうなのか知らないけど、たまにしか使わない家電で使ったらまた箱にしまうよねと気の利いたこの絵が嬉しい。掃除機を作ることに一生懸命だとこういう気遣いはできない。こういった配慮ができるのは会社の文化や組織や開発体制に「余白」があるからじゃないかと、私もマネジメントをしていて最近は思うようになってきた。この絵があるからこの掃除機を購入するわけではない。それでも、この掃除機を使っていて故障してもまた sharp の掃除機を買おうかなという気持ちにさせる。</p><figure><img src=/diary/img/2024/0120.jpg></figure><h2 id=部屋のレイアウト変更>部屋のレイアウト変更</h2><p>マンションに帰って22時半から部屋のレイアウト変更を始めた。少し前に <a href=https://jp.sharp/hotcook/>ホットクック</a> を購入したものの、思いの外、大きくて置く場所がなくてそのための <a href=/diary/posts/2023/1125/#スタンディングデスク受け取り>置き台</a> をジモティーで購入していた。その置き台を台所の横に設置するには、本棚をどかす必要があって、それは重労働になるのでついつい先延ばししていた。こんな感じ。</p><figure><img src=/diary/img/2024/0120_hotcook.jpg></figure><p>設置して無線 LAN の接続や <a href=https://cocoroplus.jp.sharp/home/>COCORO HOME</a> に家電登録してアプリ間連携の設定をしていた。私のような Web 系の開発者からみると設定 UI やわかりにくさはひどいものだったが、家電メーカーの作るアプリはそんなものだろう。ホットクックの WiFi は 2.4GHz しかサポートしていない。うちの無線 LAN ルーターは 5GHz only で稼働させていたので 2.4GHz も有効化して接続した。私が購入したホットクック (KN-HW24G-W) は <a href=https://cocoroplus.jp.sharp/kitchen/>COCORO KITCHEN</a> に非対応だった。COCORO KITCHEN は deprecated で今後は COCORO HOME になるのかな？COCORO KITCHEN で家電登録しようとしてうまくいかないとまごまごしていた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0119/>年明けからコーポレート業務いろいろ</a></h1><div class=post-meta><time class=post-date>2024-01-19</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/finance/>finance</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/debug/>debug</a>&nbsp;
#<a href=/diary/tags/network/>network</a>&nbsp;</span><div class=post-content><p>23時に寝て4時半頃に起きてそのまま6時半までだらだらして起きた。早寝早起き。</p><p>今日の筋トレは腹筋:20x1,腕立て:15x1,スクワット20x1をした。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。内容が多くて1時間超えた。</p><ul><li><a href=/diary/posts/2024/0105/#事務処理規定の叩き台作成>電子帳簿保存法対応の事務処理規定の共有</a><ul><li>まだ始まったばかりで税理士さんの温度感も低い</li><li>事務処理規定が省令に沿っているかどうかの判断はプロセス監査で行われる</li><li>電子帳簿保存法には規定されていないため、事務処理規定の妥当性の検証は行われない</li></ul></li><li><a href=/diary/posts/2024/0107/#経営の価値観と財務>融資を受ける構想作り</a><ul><li>日本政策金融公庫のみで検討していたが、融資実績を作りたいなら信用金庫も加えた方がよい</li><li>借金のメンタリティ、担当者との折衝や審査など余裕のあるときに経験を積んでおくことはよいように思えた</li></ul></li><li><a href=/diary/posts/2024/0113/#ファイナンシャルプランナーとの打ち合わせ>ファイナンシャルプランナーさんとのやり取り</a><ul><li>会社の経費で役員のための保険に入ろうと考えている</li><li>個人の保険控除は8万円らしい</li></ul></li><li><a href=https://note.com/kanzan10to9/n/n49d8fe09ad5b>ローカル複業化プロジェクトの考察</a><ul><li>IT コミュニティに老人や子どもたちは入りにくい。農業なら老若男女誰でも入れる気がする</li><li>農業や地元の特産品を切り口にコワーキング (コミュニティ) で街の人たちと田舎の人たちをつなげるのはすごいことだと思う (関係人口の創出)</li><li>地元の有力者と仲良くなると、行政の口利きもしてくれて活動しやすくなる</li></ul></li></ul><p>はらさんが <a href=https://yorihiroi-frontend.engineer/ja>よりひろいフロントエンド</a> を始めたそうでその話しも聞いていた。個人のブログサイトにするのか、複数人で記事を共有するサイトにするのかもまだ曖昧だという。<a href=https://www.contentful.com/>Contentful</a> + Next.js + Cloudflare Pages という構成らしい。Contentful というツールを私が知らなかったのでまた時間のあるときに調べてみようと思う。</p><p>母が一人暮らしをしていて体調もよくないことから要介護状態になるリスクがそこそこあると考えている。最悪の場合、会社を休眠させてしばらく介護をするかもしれない。はらさんが仰るには休眠はよいアイディアだという。会社員に例えると退職した日の帰り道を想像するとよいと話されていたのだけど、私は過去の記憶があまりないというのもあるが、これまで6回も退職してきたのに退職日を特別に思ったことはあまりない。退職日と他の日に大きな違いはなくて、次のお仕事の準備や調査をしていることが私は多かったと思う。それでも退職にあわせて有休を1-2ヶ月とってゆっくり過ごしていたことには変わりない。私もそういう、メリハリのある働き方が好きだ。</p><h2 id=smtp-接続のタイムアウト>smtp 接続のタイムアウト</h2><p>たまたまメンバーが誤った設定で smtp サーバーに接続したときにタイムアウトするまで5分ほどかかるという現象を発見した。タイムアウトの設定をせずに接続しようとするからそんなことが起きるのかな？と考えて smtp クライアントのタイムアウト設定を調べてみると <a href=https://pkg.go.dev/net#DialTimeout>net.DialTimeout</a> を使えばよいという。</p><ul><li><a href=https://github.com/golang/go/issues/16436#issuecomment-233829112>https://github.com/golang/go/issues/16436#issuecomment-233829112</a></li></ul><p>多めに見積もって30秒のタイムアウトを設定して接続するようにして再度メンバーに再現検証してもらったら直っていないという。接続そのものは出来ていたのだ。ソースを読んでみると、smtp クライアントを生成するときに <code>220</code> というレスポンスを読むことがわかる。誤った接続設定でもコネクションは確立するが、レスポンスが返ってこなくて待ち状態になっていた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>conn</span> <span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>Conn</span>, <span style=color:#a6e22e>host</span> <span style=color:#66d9ef>string</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>Client</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>textproto</span>.<span style=color:#a6e22e>NewConn</span>(<span style=color:#a6e22e>conn</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>ReadResponse</span>(<span style=color:#ae81ff>220</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>text</span>.<span style=color:#a6e22e>Close</span>()
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Client</span>{<span style=color:#a6e22e>Text</span>: <span style=color:#a6e22e>text</span>, <span style=color:#a6e22e>conn</span>: <span style=color:#a6e22e>conn</span>, <span style=color:#a6e22e>serverName</span>: <span style=color:#a6e22e>host</span>, <span style=color:#a6e22e>localName</span>: <span style=color:#e6db74>&#34;localhost&#34;</span>}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>c</span>.<span style=color:#a6e22e>tls</span> = <span style=color:#a6e22e>conn</span>.(<span style=color:#f92672>*</span><span style=color:#a6e22e>tls</span>.<span style=color:#a6e22e>Conn</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>c</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>調べてみると Conn インターフェースにデッドラインを設定する API が提供されている。注意事項としては接続した後にデッドラインをリセットしないといけない。</p><blockquote><p>デッドラインとは、I/O操作がブロックされずに失敗する絶対時間のことである。デッドラインは、ReadやWriteを呼び出した直後のI/Oだけでなく、将来の保留中の I/O すべてに適用される。デッドラインを超過した後は、未来にデッドラインを設定することで、接続をリフレッシュすることができる。</p><p>デッドラインを超えた場合、ReadやWrite、その他のI/Oメソッドの呼び出しは、os.ErrDeadlineExceeded をラップしたエラーを返します。これは、errors.Is(err, os.ErrDeadlineExceeded)を使用してテストすることができます。errorのTimeoutメソッドはtrueを返しますが、期限を超過していなくてもTimeoutメソッドがtrueを返すエラーが他にもあることに注意してください。</p><p>アイドルタイムアウトは、ReadまたはWrite呼び出しに成功した後、デッドラインを繰り返し延長することで実装できる。tの値が0であれば、I/O操作はタイムアウトしない。</p><p><a href=https://pkg.go.dev/net#Conn>https://pkg.go.dev/net#Conn</a></p></blockquote><p>次のように <code>SetReadDeadline()</code> を使ってタイムアウトを5分から30秒に短縮できた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>s</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Clinet</span>) <span style=color:#a6e22e>connectWithReadDeadline</span>(<span style=color:#a6e22e>conn</span> <span style=color:#a6e22e>net</span>.<span style=color:#a6e22e>Conn</span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>Client</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>SetReadDeadline</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Now</span>().<span style=color:#a6e22e>Add</span>(<span style=color:#a6e22e>dialTimeout</span>)); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to set read deadline: %w&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>c</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>smtp</span>.<span style=color:#a6e22e>NewClient</span>(<span style=color:#a6e22e>conn</span>, <span style=color:#a6e22e>s</span>.<span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>Host</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to connect to the smtp server: %w&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#75715e>// clear read deadline
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>conn</span>.<span style=color:#a6e22e>SetReadDeadline</span>(<span style=color:#a6e22e>time</span>.<span style=color:#a6e22e>Time</span>{}); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to reset read deadline: %w&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>c</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0105/>コミュニティとコワーキングの違いを説明できるようになってきた</a></h1><div class=post-meta><time class=post-date>2024-01-05</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/community/>community</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;</span><div class=post-content><p>4時過ぎに寝て8時半に起きた。まだ年明けだし10時ぐらいにオフィスへ行こうかとのんびりしていたら9時からのはらさんの打ち合わせを忘れていた。慌てて準備して5分ほど遅刻した。</p><p>今日の筋トレは腹筋:10x1,腕立て:10x1,スクワット15x1をした。このぐらいなら時間を取らないので日記をアップするために筋トレする動機づけになる。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日も事前に慌てて議題を準備した。</p><ul><li><a href=/diary/posts/2023/1227/>税理士さんとの打ち合わせ内容</a> の共有</li><li><a href=/diary/posts/2023/1229/#コミュニティとコワーキングの違い>コミュニティとコワーキングの違い</a> の共有</li></ul><p>年始というのもあってほぼ雑談に近いものだったけれど、時間もあったのでわりと盛り上がって話していた。</p><p>はらさんも過去にコワーキングスペースの手伝いのようなお仕事をしたことがあったらしく、コワーキングマネージャーのあれこれで盛り上がった。コワーキングスペースは値段が安いため、ビジネスとして成り立たないという懸念についても私も同意する。コワーキングスペースを本業にするのではなく副業でやるのがよいと私も考えている。コワーキングスペースへ来る方は、他のコワーカーとのコミュニケーションを価値と考える方と単純に作業スペースを必要として来る方の2通りに分かれる。いとうさんは後者の用途はコワーキングスペースとは分けて、ワーキングプレースと呼ぼうと提案している。もちろん作業場としてのニーズがあることは間違いないし、そういった用途を否定するものでもない。しかし、いとうさんの仰る、本来の意図のコワーキングスペースというのは、他のコワーカーたちと協調しながら独りでは為し得なかったアイディアや価値を創り出すことにある。最初にワーキングプレースではないといったことを明言して来られる方を選択するのがよいのだろう。</p><p>あと sns を開発するのは難しいという話題も盛り上がった。とくに dm と決済は難しいという。dm は犯罪の温床になる懸念からプラットフォーマーとしての責任と利用者のプライバシー配慮の双方がぶつかり合う機能になるため、どういった実装をするかのバランスが難しいのだろうと推測する。</p><h3 id=最果てのユースホステルのドキュメンタリー>最果てのユースホステルのドキュメンタリー</h3><p>はらさんが休暇中にみたという番組を教えていただいた。コミュニティやコワーキングの文脈で参考になるのではないかと。</p><ul><li><a href=https://www.nhk-ondemand.jp/goods/G2023130567SA000/>ドキュメント７２時間　北海道・礼文島　最果てのユースホステルで</a></li></ul><p>もしかしたらドキュメンタリーだから意図的に特徴のある人を選択している可能性はあるけれど、人生に迷った人の境遇が紹介されていた。進路を悩んでいる、大学を休学している、組織の論理に従うのが嫌になったなど。以前からコワーキングやコミュニティに来る人たちは社会から弾かれた人が多いような気が私はしていた。既存の大勢派の考え方や論理に馴染めず、その枠組みとは異なる価値観や考え方を求めているような気がする。そして、それは人生においては、どちらかと言えば、順風満帆よりもうまくいっていないときに考える機会の方が多いのではないかと思う。</p><p>この番組で紹介していた事例は紛れもなくうまくいっている (即席の) コミュニティにみえる。宿泊者も一緒になってコミュニティのメンバーの一員としてイベントを盛り上げる役割を担っていて、そういう仕掛けをヘルパーと呼ばれる人たちがうまく誘導しているようにみえる。ヘルパーは実質的にコミュニティマネージャーを務めている。離島に数日泊まるという閉鎖的な環境や非日常が、そこに一緒にいる人たちと小さいコミュニティを築く上での装置としてうまく作用しているように私からは思えた。</p><h2 id=事務処理規定の叩き台作成>事務処理規定の叩き台作成</h2><p><a href=/diary/posts/2023/1227/>年末に税理士さんと打ち合わせ</a> した主な議題の1つで <a href=https://www.nta.go.jp/law/joho-zeikaishaku/sonota/jirei/tokusetsu/index.htm>電子帳簿保存法</a> 対応のための事務処理規定の叩き台を作成した。今日のところは叩き台を作成して税理士さんにレビュー依頼した。レビュー依頼が通ったら実際のワークフローや手順を細かく記載したガイドラインを <a href=https://www.notion.so/ja-jp>notion</a> に作ろうと思う。他に社員がいないのもあって、私だけわかればよいのであれば、課題管理システムの issue のみで事足りて、ほとんど notion を使う機会がないというのが現状。いつか社員雇う日がくるのかどうか。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0104/>年始は事務手続きからぼちぼち</a></h1><div class=post-meta><time class=post-date>2024-01-04</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/eltax/>eltax</a>&nbsp;</span><div class=post-content><p>0時に寝て何度か起きて7時過ぎに起きた。午前中はだらだらして午後からオフィスに出て会計や税務の財務の事務手続きをまとめてやっていた。</p><p>今日の筋トレは腹筋:10x1,腕立て:10x1,スクワット10x2をした。昨日さぼったから罪悪感が出て今日はちゃんとやろうと思った。</p><h2 id=給与支払報告書の申告>給与支払報告書の申告</h2><p><a href=/diary/posts/2023/1229/#年末の事務手続き>年末に作成済みの書類データ</a> を送信した。</p><p>給与支払報告書は神戸市へ、ほとんど同じ内容の法定調書合計表と源泉徴収票を税務署へ提出する。eltax のアカウントに e-tax のアカウントも紐付けることで、給与支払報告書の送信時に e-tax へ法定調書合計表と源泉徴収票のデータも送信してくれる。本来は2つ行う必要がある書類の作成／データ送信の作業が1つに軽減されるのでこれは便利な仕組みだと思う。</p><p>うちは社員1人なので手入力で書類を新規作成している。それ自体は簡単なのだけど、年に1回しかやらない作業なので書類のどこにどの値を入力するか、毎回忘れて過去の issue をみながら作業することになる。</p><h2 id=償却資産-固定資産税-の申告>償却資産 (固定資産税) の申告</h2><p>会計システムの固定資産台帳だけを眺めていると、基本的には30万円以内の機器を購入して次の特例を使って一括損金算入するので減価償却中の固定資産はないようにみえる。</p><ul><li><a href=https://www.nta.go.jp/taxes/shiraberu/taxanswer/hojin/5408.htm>No.5408 中小企業者等の少額減価償却資産の取得価額の損金算入の特例</a></li></ul><p>しかし、この特例は国税 (法人税と地方法人税) の減税のための制度であって、地方税である固定資産税とは無関係になる。だから固定資産台帳にある取得価額を資産が増加したら申告データに含めて登録する必要がある。課税標準額が150万円未満であれば、固定資産税そのものは課税されないが、申告そのものは必要になる。私も起業してから2年目のときにはらさんと話していて国税と地方税の違いによるこの誤解に気付いた。この申告も年に1回しかやらないので書類のフォーマットを思い出して理解するのにいつもまごまごする。</p><p>オンラインで調べると、課税標準額は先方で自動算出されるように書いてあったりするので eltax のアプリ内で算出してくれたらよいようにも思うのだけど、アプリ上ではとくに算出されない。もしかしたら取得価額の合計が150万円未満ならそもそも非課税になるので計算しないといった仕様なのかもしれないし、課税標準額も定額法や定率法のなにで算出するかで変わってくるから一概に算出できないのかもしれない。謎い。</p><h2 id=源泉所得税の納付>源泉所得税の納付</h2><p>半期に1回の源泉所得税の納付。これは手慣れたもので15分あれば申請と納付と会計システムに取引明細の登録までできる。</p><ul><li><a href=https://www.nta.go.jp/taxes/shiraberu/taxanswer/gensen/2505.htm>No.2505 源泉所得税及び復興特別所得税の納付期限と納期の特例</a></li></ul><h2 id=小規模企業共済オンライン手続きポータルのログイン確認>小規模企業共済オンライン手続きポータルのログイン確認</h2><p>以前 <a href=/diary/posts/2023/1127/#小規模企業共済オンライン手続きポータル>アカウント申請して</a> 翌日には本登録されていたものの、その後、ログインしていなかった気がしたのでついでに調べてみた。</p><p>ログインしたら <a href=https://e-shishobako.ne.jp/resources/pages/esapos8030.html>e-私書箱</a> と連携しろと言われ、そのシステムと連携したら今度は e-私書箱と <a href=https://myna.go.jp/>マイナポータル</a> を連携しろと言われて、3つのシステムを連携した。開発者の私でもこれは？？？になってしまう。私はシステム側の都合があることを理解できるが、こんな一方的な複数のシステム間連携を一般ユーザーは理解できるのかな？とか疑問に思いつつ、ひとまず連携設定はしておいた。マイナンバーカードで何度もパスワード入力さえすればすぐに連携できる。</p><p>小規模企業共済オンライン手続きポータルにおいても年間の納付データや証明書を取得できた。そして連携しているe-私書箱でも確認できるようになっていて、おそらくこの状態ならマイナポータルにも連携されるのだろうと推測する。私の場合、確定申告は freee で書類作成してやるからマイナポータルから確定申告をまとめてやることはないけれど、いずれ移行する可能性はあるのでシステム間連携は徐々に進めて仕組みなども理解していこうとは思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1227/>一周まわって飲み会も大事</a></h1><div class=post-meta><time class=post-date>2023-12-27</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>0時に寝て何度か起きて7時過ぎに起きた。9時までにはオフィスへ行くつもりが、気が緩んで9時はまわっていたと思う。年末でだらけている。</p><h2 id=税理士さんとの打ち合わせ>税理士さんとの打ち合わせ</h2><p>この3ヶ月ほど <a href=/diary/posts/2023/1208/#隔週の雑談>税理士さんとやり取り</a> してきた懸念事項の共有または改善も含め、<a href=https://www.nta.go.jp/law/joho-zeikaishaku/sonota/jirei/tokusetsu/index.htm>電子帳簿保存法</a> への対応の打ち合わせをしてきた。打ち合わせのため、姫路市にある税理士さんの事務所を訪問してきた。オンラインでできないわけではなかったが、1度も直接会ったことがなかったので、こちらの言い分や相手の言い分も気兼ねなく出し合う機会にしようと思って出掛けた。打ち合わせ後に一緒に晩ご飯を食べに行って、その後も2件飲み屋さんをはしごして、結果的には親睦を深めてお互いの考え方や人間性などを理解する機会になってよかったと思う。17時から22時まで飲み歩いてた。古い時代の人間関係では当たり前だったことが、いまどきの付き合いでは珍しいことかもしれない。</p><p>晩ご飯は <a href=https://tabelog.com/hyogo/A2805/A280501/28013652/>プロ酒場</a> というお店を紹介してもらった。路地裏の隠れた場所にあって地元の人が行くお店って感じだった。「プロ」はプロフェッショナルではなく、労働者を指す <a href=https://ja.wikipedia.org/wiki/%E3%83%97%E3%83%AD%E3%83%AC%E3%82%BF%E3%83%AA%E3%82%A2%E3%83%BC%E3%83%88>プロレタリアート</a> に由来するという。</p><p>あまり先方からはどういった運用をしたいという考えや既存のワークフローはないようで、ほぼこちらの言い分は通って改善へ向けての最初の切り口として収穫は大きかった。実際にそういった運用ができるかどうかはこれから徐々に実践して取り組んでいく。当社としてもこちらの要望だけを主張するつもりはなく、先方の状況や考えも聞いた上でお互いに合意できるところを探っていきましょうと伝えた。業務をうまくまわすために協調しましょうということは理解してもらえたのではないかと思う。</p><h2 id=姫路駅の雰囲気>姫路駅の雰囲気</h2><p>姫路駅の北側には姫路城がそびえている。駅を降りるとすぐに姫路城が目に入るようになっている。そして観光客向けのお店とアーケード街のお店も並んでいて、それほど人がいるわけではないけど活気がある。20分ほど駅から北側へ歩くと姫路城に辿り着く。</p><figure><img src=/diary/img/2023/1227_himeji-castle1.jpg></figure><figure><img src=/diary/img/2023/1227_himeji-castle2.jpg></figure><p>駅の南側はうってかわってオフィス街となっている。ビルが立ち並びお店などはあまりない。駅の南北で役割分担をしているような、おそらく都市計画でそういった整備が行われているのだと推測する。税理士さんの事務所まで、姫路駅から徒歩20分ぐらい歩いた。あらかじめ調べた上で歩いたわけだけど、それでもやや遠かった。体力が落ちていて駅から徒歩20分とか、普通には歩けないようになりつつあるのかもしれない。帰りはタクシーを使ったら運賃が1300円だった。三ノ宮から姫路まで JR で990円なのにこの距離で1300円なのかとか、いろいろ思うことがあるな。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1208/>税務相談のストレス</a></h1><div class=post-meta><time class=post-date>2023-12-08</time></div><span class=post-tags>#<a href=/diary/tags/svelte/>svelte</a>&nbsp;
#<a href=/diary/tags/blog/>blog</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=post-content><p>23時に寝て2時に起きて6時に起きた。晩ご飯食べてから作業するつもりが、疲れて寝てしまった。今日は権限管理のバグ修正したり、昨日の mongodb の調査を継続していた。</p><h2 id=テックブログ公開>テックブログ公開</h2><p>先日 <a href=/diary/posts/2023/1206/>テックブログレビュー</a> を終えていた記事を公開した。</p><ul><li><a href=https://blog.osstech.co.jp/posts/2023/12/sveltekit-apps-integration/>SvelteKit アプリケーションの組み込みへの考察</a></li></ul><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。</p><ul><li>テックブログ (↑) のふりかえり</li><li><a href=/diary/posts/2023/1203/>日本ナレッジ・マネジメント学会の年次大会の所感</a></li><li><a href=/diary/posts/2023/1016/>税理士さんと契約</a> して3ヶ月間やり取りした所感</li></ul><p>1ヶ月に1-2件ほど折りにふれて税務相談をする機会があったりする。税理士さんとは chatwork でやり取りしている。これがストレスになってきたのではらさんに相談にのってもらった。はらさん曰く、税理士さんの普通と it 業界のうちらとは業務の取り組み方への姿勢がまったく異なるため、最初の1年はストレスや不満がたまるのはあるという。士業という資格によって独占的に保護された業務のせいか、顧客に寄り添った対応をしてくれるわけではなく、質問の背景や意図を汲んでくれなくて質問に回答を返して終わりといった、チャットなのにメールのような一問一答のようなやり取りになっている。さらに回答が意図した内容ではなくて、追加で質問や背景の説明をしても、すぐにレスポンスが返ってくることはなく、数時間たってから回答が1つ届き、それも期待したものじゃないとさらに質問して、さらに数時間といったやり取りで5-6往復するのに数日かかるのがざらにある。はらさんがいうには税理士さんの回答を得るのに1週間ぐらいかかったり、問い合わせを数日放置されるのも普通とのことらしい。</p><p>先方も複数の顧客を相手にサポートしていて、やり取りに時間がかかることそのものは理解できるが、チャットのやり取りがコンテキストを理解しているようにみえなくてコミュニケーションが成立していない。例えば、当社への税理士報酬の支払いの対応について問い合わせたら次のような回答が戻ってくるだけ。</p><blockquote><p>報酬の額と消費税等の額が明確に区分されている場合には、その報酬の額のみを源泉徴収の対象とします。</p></blockquote><p>こんなことはググればすぐに分かるし、私も顧問報酬は原則として源泉徴収することを知っている。その上で税理士さん事務所の、当社への顧問報酬の明細について尋ねているのにこういった回答が返ってくるだけ。</p><ul><li><a href=https://www.nta.go.jp/law/tsutatsu/kobetsu/shotoku/gensen/111209/01.htm>インボイス制度開始後の報酬・料金等に対する源泉徴収</a></li></ul><p>インボイス対応もあるため、請求書に明細を書いて pdf で送ってくださいと依頼して2日間返信なく放置されている。税理士さん事務所の顧問報酬の明細や請求書について尋ねても即日に返信がこないような状況になる。はらさんが言うには税理士さんの対応とはそんなもんらしい。チャットでやり取りしている意味がないし、こんなググればわかるレベルのやり取りしかできないなら解約も検討している。もう1つ懸念に思っているのは本人がチャットで回答していないのではないか？と考えている。チャットなのに1問1答でしか返信がこないし、コンテキストが伝わっていないと感じることも多々ある。とてもベテランの税理士さんが答えているとは思えないコミュニケーションの齟齬がある。</p><p>ちょっと調べてみると、税理士は日本税理士会連合会に登録する必要があり、税理士試験に合格しても登録していない場合は税理士としての独占業務を行うことができないらしい。また税理士事務所で働いている人の中には無資格職員もいて税務補助をしている可能性もあるという。必ずしも税理士資格がなければダメだというわけでもない。無資格職員でも経験を積んで税務に詳しい人もいると思う。一方でチャットでベテランの税理士のふりをして職員が回答しているのであれば、それはそれで信頼関係や偽証などの問題がある。そこら辺も聞いてみようと思う。次の記事では無資格職員が税務相談をしている事務所もあると書いてある。</p><ul><li><a href=http://soei-tax.jp/15326648136918>税理士へ依頼したつもりが税理士でなかった</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1127/>sveltekit/vite アプリケーションの調査を再開</a></h1><div class=post-meta><time class=post-date>2023-11-27</time></div><span class=post-tags>#<a href=/diary/tags/svelte/>svelte</a>&nbsp;
#<a href=/diary/tags/vite/>vite</a>&nbsp;
#<a href=/diary/tags/debug/>debug</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=post-content><p>1時に寝て起きたか起きてないか覚えてない感じで6時に起きた。起きてちょっとゲームして気付いたら7時だった。</p><h2 id=kitvite-アプリケーションのデバッグ>kit/vite アプリケーションのデバッグ</h2><p><a href=/diary/posts/2023/1124/#テックブログ公開>先週公開したテックブログ</a> の続き。</p><p><a href=https://ja.vitejs.dev/guide/backend-integration.html>vite アプリケーションのバックエンドインテグレーション</a> の詳細を調査している。丸1日デバッグしていていくつか振る舞いがわかってきて、designer アプリケーションを作りたいという要件に対して、こうすればできるんじゃないかという仮説も立てられるようになった。いまやりたい要件は kit の ssr アプリケーションを埋め込みたい。これは要件に満たないが、kit の ssg アプリケーションならば static ディレクトリに置くだけで参照できるし、インポートパスさえ書き換えてやれば別の kit アプリに埋め込むこともできるのを確認した。意図した通りの振る舞い。</p><p>vite アプリケーションはビルドオプションで manifest.json を出力し、エントリーポイントやどのファイルがどのファイルをインポートしているかといった情報を管理している。sveltekit はこれらの manifest.json から rollup でバンドルするために manifest.js を生成している。厳密には、sveltekit では production ビルド向けのチューニングをしたビルドツールを <a href=https://kit.svelte.dev/docs/adapters>adapter</a> と呼び、vite のビルドをフックする場所に1つになっている。node.js サーバー向けに production ビルドするときは <a href=https://kit.svelte.dev/docs/adapter-node>adapter-node</a> を使う。この実装を読んでみると、vite がビルドした成果物に対して、再度 rollup でバンドルして成果物を作り直すといったことをしている。そして、vite の成果物 (manifest.json も含む) を抽象化したものが <a href=https://kit.svelte.dev/docs/types#public-types-builder>Builder</a> となる。adapter は Builder のインスタンスを使ってビルドの成果物を制御できる。先の manifest.js もこのときに生成していて、rollup でバンドルするためのパラメーターの1つとして使っているようにみえる。しかし、rollup のドキュメントをみても直接的に manifest.js の説明はなく、rollup の拡張の仕組みで manifest.js を作っているというよりは、sveltekit の要件によるもののようにもみえる。ここの背景はまだよくわからない。</p><p>私はフロントエンドのことが全然わからないのでライブラリのソースコードを読みながら、ドキュメントとあわせて調べて、1つずつ理解を深めていくというアプローチで進めている。こういった調査のやり方もメンバーへ伝えていければと考えている。</p><h2 id=小規模企業共済オンライン手続きポータル>小規模企業共済オンライン手続きポータル</h2><p><a href=/diary/posts/2022/0206/#2021年度の個人の確定申告>2021年度から小規模企業共済</a> に加入している。今年から掛け金を7万円/月に変更した。年間で84万円の所得控除となる。ちょうど2023年9月1日からポータルサイトが作成されたらしい。いずれマイナポータルと紐付くのかもしれない。</p><ul><li><a href=https://www.smrj.go.jp/org/info/press/2023/ool3bn000000kxx5-att/20230901_press01.pdf>「オンライン手続きポータル」を公開しました</a></li></ul><p>利用登録しようと思って、メールアドレスを登録しようとしたら会社のメールアドレスはなぜかバリデーションエラーになって gmail のアドレスなら登録できた。その後も氏名の半角カナ入力を強制されたりしながら、マイナンバーカードを読み取って認証チェックして利用登録の申請はできた。しかし、自動で本登録されるわけではなく、おそらく申請内容が先方に届いてなんらかの運用があって本登録されるみたい。オンラインポータルのホームでも半角カナを使っていたり、<code>&lt;title></code> タグには「マイナ手続きポータル」とあったり、申請しただけでいくつも不備がわかるようなひどいサイトになっている。2023年にまともな開発者が作ったサイトとは思えない。デジタル庁に作り直してもらった方がよいと思う。</p><ul><li><a href="https://portal.e-shishobako.ne.jp/dp_apl/pw-usr/#/portal/landing?riyoCd=RGO0226000">小規模企業共済ｵﾝﾗｲﾝ手続きﾎﾟｰﾀﾙ</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1124/>家族信託の打ち合わせ</a></h1><div class=post-meta><time class=post-date>2023-11-24</time></div><span class=post-tags>#<a href=/diary/tags/svelte/>svelte</a>&nbsp;
#<a href=/diary/tags/blog/>blog</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/investing/>investing</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=post-content><p>1時に寝て4時に起きてもう1度どこかで起きて7時半に起きた。</p><h2 id=テックブログ公開>テックブログ公開</h2><p><a href=/diary/posts/2023/1122/>テックブログレビュー</a> を終えて公開した。この機会に <a href=/diary/posts/2023/1120/#hugo-で書いた記事に目次を生成する>個々の記事に目次</a> も追加した。はらさんレビューから修正をして2時間後に公開しますよと宣言して勝手に公開した。</p><ul><li><a href=https://blog.osstech.co.jp/posts/2023/11/how-sveltekit-compiles/>SvelteKit はどのようにコンパイルしているのか？</a></li></ul><h2 id=家族信託の打ち合わせ>家族信託の打ち合わせ</h2><p>15時にお仕事を早退して、親と一緒に明石市にある弁護士さんの事務所へ訪問した。三ノ宮から車で向かって、ナビゲーションに従っていたら京橋から高速道路に入って若宮でおろされて、なんでこんな早く高速道路おりるんやろ？と不思議に思ったけど、須磨からの海岸線はそれほど渋滞せず信号も多くないから下道で行ってもそんなに時間はかからないという判断だったようにみえる。だいたい40-50分ほどで明石市の中心地に着いた。3分ほど遅刻して打ち合わせが始まった。</p><p>遺産を相続するとさまざまなリスクがある。大きなお金をもつというだけで詐欺のターゲットにされる。家族信託 (民事信託) という制度を使って、そのとき必要なお金のみを受け取るように運用する。構成要素は次の通り。</p><ul><li>委託者: 母</li><li>受託者: 私と姉</li><li>信託財産: 預金</li></ul><p>受託者は最低2人必要で、うちは姉もいるのでよいのではないかと弁護士さんが話されていた。たしかに1人っ子なら誰かにお願いしないといけない。大雑把に言えば、母の貯金を子どもに管理してもらうような制度になる。但し、最初の契約書に記載された内容の範囲内でしか、受託者はお金を引き出せないのでその契約書をしっかり作ることが重要になる。契約書に記載していれば、資産運用もできるらしい。契約書の叩き台として、どういった内容を書いておくかを相談した。弁護士さん曰く、契約書に書いておかないとその用途に使えなくなるため、1%でも可能性があれば、書くだけ書いておいた方がよいとのこと。書いておいて、実際に使わないというのはなんの問題もない。</p><p>3人でブレストするような感じで項目を洗い出した。</p><ul><li>生活費<ul><li>冠婚葬祭で払うお金<ul><li>10万円以内なら生活費として引き出してもよい</li><li>例えば30万円いるとして、建替え可能なら10万円/月を3ヶ月かけて引き出すでもよい</li></ul></li><li>(お金に困った親戚がいたと仮定して) 親戚への資金援助<ul><li>生活費の範囲内でやればよいはず</li></ul></li></ul></li><li>看護、療養といった通院も含めた医療費</li><li>老人ホームの入居費用</li><li>納税 (一時所得)<ul><li>太陽光発電で得た収益のうち、所得税をこの口座から引き出して支払うといったこともできる</li></ul></li><li>家の改築、修繕、取り壊しの費用</li><li>農業のための費用<ul><li>農機具の購入や修理など</li><li>トラクターが一番高い、100万円〜1,000万円ぐらいとピンからキリまである</li></ul></li><li>土地 (田んぼ、宅地) の購入</li><li>太陽光発電設備の撤去費用</li><li>自家用車の購入費用</li><li>生命保険の支払い<ul><li>死亡保険金は500万円 x 法定相続人数まで非課税なので相続税の節税になるらしい<ul><li>例) 母の死亡時に姉と私が500万円受け取るような生命保険に入る</li></ul></li><li>相続税の基礎控除が3,000万円 + 600万円 * 法定相続人数<ul><li>例) うちは私と姉で 3000 + 600 * 2 = 4,200万円が基礎控除となる<ul><li>この金額を超える遺産があれば相続税の課税対象となる</li><li>生命保険へ付け替えることで 4200 + 500 * 2 = 5,200万円まで非課税にできる？</li></ul></li></ul></li></ul></li><li>資産運用<ul><li>投資信託<ul><li>積み立て系の投資信託がもっとも望ましいのではないか<ul><li>リスクヘッジとして大きなお金を1度に動かすのはなるべく避けたい</li><li>NISA 口座を開設できるかどうかは調べないとわからない</li></ul></li><li>信託口座とは別に証券口座も開設しないといけない<ul><li>受託者が預金口座からお金を引き出して証券口座へ振り込むような運用になる？</li></ul></li><li>具体的にどういった運用にするかは信託銀行と応相談になるかもしれない<ul><li>なんらかの制約が課されるのではないかと推測される</li></ul></li></ul></li><li>株式投資<ul><li>可能ではあるが、条件を指定しないといけないため、中長期での実運用は難しいのではないか</li></ul></li></ul></li></ul><p>私が信託口座からお金を引き出すときに、一定金額以下の生活費 (例えば10万円) ならノーチェックだが、100万円とか大きなお金を引き出すときには銀行員からチェックがかかり、正当な使途なのかどうかを確認されるという。場合によっては見積もり書の提出なども必要かもしれないとのこと。それはとくに問題ない。契約書の作り直し自体は委託者が元気であればできる。しかし、手数料や手間暇もかかるため、実運用としては最初に作った契約書を変更するといったことはそうそう行われない。最初が大事。弁護士さんが契約書を作成するのに2-3週間かかる。その後に三井住友銀行さんで赤ペン先生のチェックが入る。契約内容の修正などのやり取りをしてその後手続きに進む。</p><p>思考実験として、詐欺にあって借金してしまった、または連帯保証人となって借金してしまった。その場合はどうなるか？というのも考えてみた。信託銀行に確認してみるとのことだったが、弁護士さんが言うには、家族信託の目的は財産を守ることにあるため、本来の使途ではないものへ支払いは抵抗があるかもしれないとのこと。その状況によって銀行員の判断次第かもしれないとのこと。</p><p>受託者は年に1回報告書 (帳簿) を作り、どのように運用したかを委託者へ報告する義務がある。これは家族間だけの話ではある。この手の情報処理 (データ処理) は私が得意とするのでそんなのすぐやりますと回答できた。弁護士さんによると、こういう事務作業を嫌がる受託者もいるという。スプレッドシートでちゃちゃっと作ればよいはず。</p><p>契約書を作成したら、それをもって委託者、受託者、弁護士の3人で <a href=http://kobe-koushou-center.jp/>神戸公証役場</a> へ一緒に行く。その公正証書をもって三井住友信託銀行へ行って、母が口座を開設して、そこに弁護士さんが遺産を振り込むといった段取りになる。将来、委託者の健康を害して成年後見人がつく状況になったとしても家族信託の口座はそのまま受託者が管理できる。成年後見人に信託口座が移管されるようなことはない。</p><p>最後に契約書の条項をチェックしていて次の内容を教えてもらった。</p><blockquote><p>弁護士業務の適正の確保</p><p>甲は、本件事件等の処理の依頼目的が犯罪収益移転に関わるものではないことを、表明し保証する。</p></blockquote><p>「半社チェックのようなもの？」と聞いたらちょっと違っていて、弁護士は大きなお金を動かしても監査を受けないという特権 (信頼) があって、その特権はマネーロンダリングできてしまうという諸刃の剣でもあるらしい。今回のお金は遺産なので半社会的なものに該当しないが、契約書では弁護士が扱う業務がマネーロンダリングではないことをチェックする必要があるみたい。</p><p>帰りに <a href=https://www.go-akashiyaki.com/>明石焼き ゴ</a> というお店で明石焼きを買った。駐車場の近くにあったお店に立ち寄ってテイクアウトしたのだけど、とてもおいしかった。それで <a href=https://tabelog.com/hyogo/A2804/A280401/28005563/>食べログ</a> の評価もみたら 3.49 とかなり高い。たまたま買ったところがよいお店だった。18時半頃に店内もほぼ満席だったと思う。また明石へ行く機会があれば寄ってみようと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1111/>ポッキーの日</a></h1><div class=post-meta><time class=post-date>2023-11-11</time></div><span class=post-tags>#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/investing/>investing</a>&nbsp;
#<a href=/diary/tags/tax/>tax</a>&nbsp;</span><div class=post-content><p>なんか深夜にお腹空いて2時から冷凍食品の横綱ラーメン作って食べた。深夜に食べるラーメンはおいしかった。それから寝て6時に起きて8時に起きた。</p><h2 id=ストレッチ>ストレッチ</h2><p>先週は筋肉痛で大変な状態だったが、今週は十分に休養して元に戻った。今日の開脚幅は開始前156cmで、ストレッチ後157cmだった。いつも通り。とくにどこかの部位が極端に疲労したり張りがあったりする感じはなかったが、左ふとももの後ろと左腰がやや張りが強かったように感じた。私のお気に入りのストレッチの部位としてふとももの後ろの筋を伸ばすのが痛気持ちいい。これは自分では伸ばせない筋なのでトレーナーさんにお願いしないといけない。張りがあっても痛気持ちよい。トレーナーさんと話していて今日が「ポッキーの日」だと教えてもらった。スーパーのクーポンでポッキーお奨めされているなと思っていたけど、そういうことだったのか。</p><h2 id=イオン-オーナーズカード>イオン オーナーズカード</h2><p><a href=https://www.aeon.info/ir/stock/benefit/>イオンの株主優待制度</a> としてオーナーズカードがある。イオン系列のスーパーなどで買いものしたときに半年後にキャッシュバックを受けられる。持ち株数に応じて 3, 4, 5, 7% のキャッシュバックになる。<a href=/diary/tags/sightseeing/>6月末に四国旅行</a> へ行ったときに同室に泊まった方と話していて、イオンのオーナーズカードがお得だよと教えてもらった。私が普段買いものしているスーパーは3つある。</p><ul><li><a href=https://www.kohyo.co.jp/>KOHYO</a></li><li><a href=https://www.hankyu-oasis.com/>阪急オアシス</a></li><li><a href=http://www.lifecorp.jp/>ライフ</a></li></ul><p>このうち、もっともよく行くスーパーが KOHYO である。その理由はもっとも家から近いから。KOHYO はイオン系列になる。オーナーズカードをもつとお得になることに気付いてイオンの株を購入してみた。8月末と2月末の年2回、権利確定が行われる。私の場合、8月末に権利確定され、いろいろ手続きをして、オーナーズカードが10月末に届いた。</p><p>カードを持ち運ぶのは面倒なので調べてみると <a href=https://www.aeon.com/aeonapp/>iAEON アプリ</a> でオーナーズカードを連携すれば代用できることに気付いた。iAEON アプリの会員証にオーナーズカードを連携できる。スーパーで買いものするときにスマホでオーナーズカードの認証ができる。このアプリでオーナーズカードを連携するには waon ポイントカードが必要にある。これも名前がおかしいのだけど、カードを作るという手続きをするが、物理カードを作らなくてもよくて、アプリ上で waon ポイントを管理できる。</p><p>waon とはイオンが提供している電子マネーのことで waon で書いものしたときに貯まるポイントが waon ポイントである。しかし、オーナーズカードで購入しても waon ポイントを貯めることができる、現金で支払ったとしても。これも名前が混乱してしまうが waon ポイントは waon 以外の決済でもポイントが貯まるのである。waon とは別に <a href=https://aeon.co.jp/service/lp/aeonpay/>AEON Pay</a> もある。iAEON アプリ上で AEON Pay が使える。AEON Pay は paypay のようなバーコード決済で、イオンカード以外にも銀行口座からもチャージできる。paypay 銀行は選択できなかったが、都市銀行や地方銀行などを選択して銀行口座から直接チャージできた。AEON Pay には waon ポイントを貯めるという仕組みはなく、AEON Pay の支払いをイオンカードにすることでイオンカードの利用によって waon ポイントが還元されるという仕組みになるため、銀行口座からチャージすると本来は waon ポイントが貯まらない。しかし、オーナーズカードの支払いは waon ポイントが貯まるので、オーナーズカードの認証をした上で AEON Pay をする分には waon ポイントが貯まっているようだ。</p><p>たまたま iAEON アプリで近所の KOHYO を登録すると、その店舗で使えるクーポンが発行されていることに気付く。なぜかクーポンを選択という手作業の登録をする必要がある。クーポンは商品ごとにたくさんあって、1つずつ選択して登録するのが面倒なので「一括選択」というボタンがある。このボタンをタップするとすべてのクーポンが選択済みになって登録される。いま選択済みのクーポンが46個ある。この次は「一括選択」をタップしなくても自動的にクーポンを選択済みの状態にしてほしい。クーポンを選択済みの状態で iAEON アプリで会員証の認証をしてから決済をするとクーポンが適用されて割引を受けられる。クーポンには何度も使える装備タイプと1回使うとなくなる道具タイプがある。そして、KOHYO のクーポンに何度でも使える全品3%引きの装備タイプのクーポンがある。さらに土曜日はそれが5%引きクーポンにクラスチェンジする。つまり、土曜日に KOHYO で買いものすれば、オーナーズカードで3%キャッシュバック、装備タイプのクーポンで5%引き、その上で waon ポイントがつくという、おそらく一番よい装備が整ったという雰囲気だ。</p><p>試しにポッキーのクーポンを使ってみようと、夜にスーパーへ行ったらすべて売り切れていた。仕方なく同じクーポンが適用されるプリッツを買ってきた。トマトプリッツ118円が、5%割引で112円になって、さらに別クーポンのバフがかかって10円引きで102円になる。この時点で 102/118 ≒ 86% なので14%引きになっている。さらにオーナーズカードで3%キャッシュバックになるので17%引きになる。なるほど、物価の上昇を吹き飛ばすような効果がありそうだ。</p><p>今週はここまでの設定をするのにいろいろ調べていた。waon なにそれ？みたいな人間がアプリダウンロードして、アカウント作ったり、waon ポイントカードを作ったり、オーナーズカードを連携したり、あれこれやって理解できた。</p><h2 id=ふるさと納税>ふるさと納税</h2><p>いつも年末に購入している。このぐらいの時期になると急に思い出して、思い出したときに購入しないと忘れてしまうので一気に買いものした。私は2019年から毎年ふるさと納税をしている。いつも食べものをいくつか、工芸品を1つぐらい選択している。気に入るものがなかったら食べものしか買わないときもある。とくに深い意図はなくて、適当に検索して今年は次の4つに決めた。</p><ul><li><a href="https://www.satofull.jp/products/detail.php?product_id=3163482">[北海道清水町] 十勝スロウフード 牛とろ丼セット</a></li><li><a href="https://www.satofull.jp/products/detail.php?product_id=1368233">[長崎県壱岐市]クラフトビール 6本詰め合わせ(3種類×2本)</a></li><li><a href="https://www.satofull.jp/products/detail.php?product_id=1320793">[大阪府泉佐野市]コンパクトバスタオル6枚&lt;シックグレー> 速乾中厚の泉州タオル 010B962</a></li><li><a href="https://www.satofull.jp/products/detail.php?product_id=1053132">[滋賀県甲賀市]信楽焼・明山のとなりのトトロ totoro-01</a></li></ul><p>普通にサラリーマンとして働いている人はふるさと納税のメリットがある。寄付金控除の限度額まで、実質2,000円で好きな返礼品をもらうことができる。私は毎年確定申告をしているのでワンストップ特例制度を利用する必要もなく、手続き上の手間暇もほぼないと言っていい。ふるさと納税の問題点としては次のようなことが指摘されている。</p><ul><li>(一般的に) 都市から地方へ税金が流出するので都市の自治体の税収が減る</li><li>収入の高い人ほど寄付金控除の限度額が高いために得をする傾向がある</li><li>寄付金 (税金) の3割以下 (返戻率と呼ぶ) のお金が本来の使途ではなく返礼品として流出する</li></ul><p>問題や懸念があることは私も知っているが、私のような人間は、こういう機会がないと本来使わないお金を使っていたりするので購買意欲を換気するという側面もある。どのみち、都市に住む人が納めた税金を地方交付税という形で国が地方自治体へ分配している。ふるさと納税が地方交付税の割合に影響を与えているかどうかは知らないが、都市に住む人が納めた税金が地方へ分配されるのはそう変わらないのではないかと思ったりもする。都市に住んでいる人の大半は地方出身者であり、私もそうだが、地方出身者が都市で働いて税金を納めることで都市を支えているとみなすこともできる。都市も地方から働きに来てもらわないと都市を維持できなない。地方と都市は共依存の関係でもある。そして、返礼品を購入してもそのお金は地方の地元企業の経済活動に使われる。それ自体に問題があるわけでもないのではないか。本来の税金の使途が返礼品という、どちらかと言えば、嗜好品に使われているのがやや懸念ではあるが、地方の経済をまわすことに役立っていれば、それはそれで別の意義も出てくるのではないかと思う。</p></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/tax/page/2/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>