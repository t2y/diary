<!doctype html><html lang=en><head><title>event :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/event/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="event"><meta property="og:description" content><meta property="og:url" content="/diary/tags/event/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/event/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1031/>アイマスク効果</a></h1><div class=post-meta><time class=post-date>2023-10-31 (Tue.) ::</time></div><span class=post-tags>#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/project-management/>project management</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>1ヶ月と2週間ぶりの出張。</p><p>0時に寝て2時半に起きた。なにも準備していないのが悪いけれど、出張前夜は寝坊したらどうしようというのが気になってあまり眠れない。起きてから出張の準備をして5時過ぎに出た。電車に乗るまで少し時間があったので朝からなか卯で <a href=https://www.nakau.co.jp/jp/menu/detail/in/116>まぐろのたたき丼</a> を初めて食べた。値段を考えると親子丼を食べた方がお得なように思えた。出張の日は夕方眠くて集中できないことが多い。新幹線の中で眠れるよう、ダイソーでアイマスクを買ってみた。その成果もあって、わりとよく眠れた。アイマスクの効果は確かにあったと思うが、なぜか寝違えて首を痛めた。新幹線でよく眠れたように考えていたが、15-16時は眠気に襲われた。やはり3-5時ぐらいから起きているとそのぐらいの時間に眠くなってしまうんやろか？</p><h2 id=マイルストーン定例>マイルストーン定例</h2><p>いつもの定例会議をやって、開発状況の共有や設計レビューなどを行う。私は権限管理の仕組み作りをちょっとずつ作っているのであまり全体を見渡せていないが、メンバーが主体となって段取りを進めてくれた。あと新規メンバーが先週から開発に参加する予定が、別プロジェクトの段取りがうまく行っていないようでまた仕切り直しになった。もう2週間ほど様子をみるという。3回目のスケジュール調整になる。こういう五月雨式に直前に遅れていくパターンを私は信用しない。スケジュールを自分で制御できる状態にない、または制御できたとしてもやる気がないようにみえる。いずれにしても、私が制御できないプロジェクトの影響で、うちのプロジェクトの成果物に影響が出ないようにしたい。機能開発を3ヶ月と見積もっているうちの、1ヶ月がすでに過ぎた。もう新規メンバーの受け入れは諦めて、既存メンバーだけで成果物ができるような体制へ移行することに決めた。幸いにも既存メンバーは十分にタスクをこなせるようになってきているし、私も10月後半ぐらいからバーンアウトを消化して開発の集中力も戻ってきた。11月にちょっと本気出してサーバーサイドの開発をしてもよいかもしれない。</p><h2 id=go-のオンライン勉強会>go のオンライン勉強会</h2><p><a href=https://gocon.connpass.com/event/299108/>Go 1.21 リリースパーティ & GopherCon 2023 報告会</a> をオンラインで参加した。ホテルについて少し寝てからアラームで起きて視聴してた。始まる前に30分ほど仮眠しても、移動日はしんどくて、みながら半分ぐらいは寝てた。最初と後半2つぐらいのセッションしか覚えていない。メルカリの社員さんたちは <a href=https://gophercon.org/>GopherCon 2023</a> に参加して、その内容などを紹介していた。もう私は海外カンファレンスへわざわざ行こうというモチベーションはない。たぶんもう行くことはないのだろうけど、そういった場に行って学んでいる開発者にはもう追いつけないのだろうなとも思えた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1025/>非日常を提供するという価値</a></h1><div class=post-meta><time class=post-date>2023-10-25 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/book/>book</a>&nbsp;</span><div class=post-content><p>1時半に寝て3時に起きてもう1回起きて6時半に起きた。</p><h2 id=interface-はデシリアライズできない>interface はデシリアライズできない</h2><p><a href=/diary/posts/2023/1024/#rbac-なライブラリの実装>昨日の続き</a> 。rbac なライブラリを使ってアプリケーションを実装していく。ログイン時にユーザーにロールを割り当ててセッションにロールを保持するのが都合よさそうに思えた。ロールの実装で一部の型は interface にして後から拡張できるような設計にしていた。例えば <a href=https://pkg.go.dev/encoding/json>encoding/json</a> ライブラリだと、Marshaler/Unmarshaler の interface を満たすことで任意の json のシリアライズ/デシリアライズをフックできる。調べたり、実際に動かしていていて気付いたのだけど、interface の場合はシリアライズは任意にできるけど、デシリアライズはできない。当たり前と言えば当たり前だが、interface を満たす複数の型がある中で json ライブラリがどの型でデシリアライズしていいか判別できないからだ。当初の interface を用いた設計が誤りだったことに気付いて、一部の型を汎用の構造体で設計し直すようなことをしていた。</p><p>またデシリアライズするときに一部の値を初期化したいといった要件がある。例えば mutex を初期化したい。このときに処理の内部で派生型を宣言して、それにキャストした上でデシリアライズの処理を実行した上で差分の処理を実装するというテクニックを学んだ。スコープが限定されて、コードがシンプルになって保守性も高い、久しぶりに頭のよいスマートなコードをみた。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Role</span>) <span style=color:#a6e22e>UnmarshalJSON</span>(<span style=color:#a6e22e>b</span> []<span style=color:#66d9ef>byte</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Alias</span> <span style=color:#a6e22e>Role</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>Unmarshal</span>(<span style=color:#a6e22e>b</span>, (<span style=color:#f92672>*</span><span style=color:#a6e22e>Alias</span>)(<span style=color:#a6e22e>r</span>)); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>r</span>.<span style=color:#a6e22e>mu</span> = <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>Mutex</span>{}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><ul><li><a href=https://stackoverflow.com/questions/56400734/custom-unmarshalbson-in-mongo-go-driver>Custom UnmarshalBSON in mongo-go-driver</a></li></ul><h2 id=コワーキングのオンラインイベント>コワーキングのオンラインイベント</h2><p>月例のカフーツさんのオンラインイベントに参加した。<a href=/diary/posts/2023/0927/#コワーキングのオンラインイベント>前回の所感はここ</a> 。今日は参加者が2人だけだった。コワーキングスペースを運営するコワーキングスペースマネージャーの連携を強化することで、コワーキングスペースの付加価値が上がったりしないか？といった内容を話したりしていた。コワーキングスペースマネージャーは、普通はお仕事で自分のコワーキングスペースにいないといけないから、なかなか他所のコワーキングスペースへ訪問すること自体が難しい。コワーキングスペース同士の連携により、お仕事でコワーキングスペースマネージャーが自分ところのコワーキングスペースの利用者を連れて、他所のコワーキングスペースへ訪問して、そこでイベントをしたりすればいいんじゃないかという案が出た。</p><p>いとうさんがよく <a href="https://cahootz.jp/?cat=21">コワーキングツアー</a> と称して、全国各地のコワーキングスペースへ訪問して、そこでイベント開催をしたり、その地域の取り組みなどを紹介したりしている。それと全く同じことを、コワーキングスペースの利用者に対してもその付加価値というのはあるかもしれないと私もよいアイディアだと思った。例えば、大阪のコワーキングスペースの利用者を広島へ連れていって、そこでイベントやって交流する。その逆も然り。通常のコワーキングスペースの利用者は自ら広島のコワーキングスペースへ行ってコラボレーションを行ったりしない。いや、いとうさんみたいに自らやる人もいるんだけど、そんな人は対象の利用者ではない。自分からは行かないが、誘われたら行ってもいいかなと考える人 (私もそんな1人だ) を移動させることで、新しい価値やアイディアが生まれるかもしれないと思える。私もいまはフルタイムのお仕事があるから自由に移動はできないが、いずれ会社の投資期間に入って、自分でスケジュールを決められる状況になれば、コワーキングツアーにも出掛けてみようと思う。</p><p>あと勉強会やイベント以外でコワーキングスペースで出来ることはないか？という話題でも盛り上がった。私は主催者の準備が大変だと出来ないから、主催者のコストが低いものという視点から考えて猫コワーキングがいいんじゃないかと提案してみた。ある週だけコワーキングスペースに猫が10匹ぐらいいますといった取り組み。課題は猫をどこから連れてくるかだけだが、そういう機会があれば確かに私も行ってみたい。そのアイディアの発散で非日常の体験ができるような取り組みがよいんじゃないかとまとめられていた。</p><ul><li>猫コワーキング (猫がたくさんいる)</li><li>深夜コワーキング (深夜に開いている)</li></ul><p>深夜コワーキングスペースのモデルとなる <a href=https://20db.stores.jp/>弐拾dB</a> さんというコワーキングスペースが広島の尾道にあるらしい。23-翌5時という営業時間だという。いとうさんが絶賛していたのでおもしろいオーナーが運営されているのだと思う。そのオーナーが執筆したエッセイの <a href=https://20db.stores.jp/items/61869c960548e03fb98a95ac>頁をめくる音で息をする</a> を購入してみた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1019/>メールの結合テストのツール</a></h1><div class=post-meta><time class=post-date>2023-10-19 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/testing/>testing</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;</span><div class=post-content><p>0時に寝て4時と5時に起きて6時に起きた。最近は4時から1時間ごとに起きたりする。メールの送信処理のリファクタリングのコードレビューが長く続いていてなかなかややこしい。</p><h2 id=mailhog-の-web-api-を使って検索する>mailhog の web api を使って検索する</h2><p>メール送信の結合テストに <a href=https://github.com/mailhog>mailhog</a> というツールを使っている。smtp サーバーとしてメールを受け付けて web ui でそのメールの内容を確認できる機能をもっている。さらに web api で任意のメール取り出すこともできる。パスワードリセットの一時トークンをメールで送信するため、結合テストで一連のパスワードリセットを検証するにはメールから一時トークンを取り出さないといけない。そこで mailhog の出番だ。</p><p>検索 api を使うと任意のメールをフィルターできる。例えば、送り先のメールアドレスで検索するときは次のようにリクエストする。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s <span style=color:#e6db74>&#34;http://localhost:8025/api/v2/search?kind=to&amp;query=myuser1@example.com&#34;</span> | jq .
</span></span></code></pre></div><p>うちらのやり方はメールのメッセージ ID に意図した uuid をセットしている。メールのメッセージから指定した uuid を含んでいるかを検索することで任意のメールをフィルターできる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s <span style=color:#e6db74>&#34;http://localhost:8025/api/v2/search?kind=containing&amp;query=28c9391f-25a5-4a8f-9035-7b8d5ac2d0f4&#34;</span> | jq .
</span></span></code></pre></div><p>それを結合テストのテストコードから呼び出すようにユーティリティを作ると次のようなコードになる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/mailhog/data&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>mmSearchResult</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Total</span> <span style=color:#66d9ef>int</span>            <span style=color:#e6db74>`json:&#34;total&#34;`</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Count</span> <span style=color:#66d9ef>int</span>            <span style=color:#e6db74>`json:&#34;count&#34;`</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Start</span> <span style=color:#66d9ef>int</span>            <span style=color:#e6db74>`json:&#34;start&#34;`</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>Items</span> []<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>Message</span> <span style=color:#e6db74>`json:&#34;items&#34;`</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>searchMail</span>(
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>host</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>kind</span> <span style=color:#66d9ef>string</span>, <span style=color:#a6e22e>query</span> <span style=color:#66d9ef>string</span>,
</span></span><span style=display:flex><span>) (<span style=color:#f92672>*</span><span style=color:#a6e22e>mmSearchResult</span>, <span style=color:#66d9ef>error</span>) {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>q</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>Values</span>{}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>Set</span>(<span style=color:#e6db74>&#34;kind&#34;</span>, <span style=color:#a6e22e>kind</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>Set</span>(<span style=color:#e6db74>&#34;query&#34;</span>, <span style=color:#a6e22e>query</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>u</span> <span style=color:#f92672>:=</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>url</span>.<span style=color:#a6e22e>URL</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Scheme</span>:   <span style=color:#e6db74>&#34;http&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Host</span>:     <span style=color:#a6e22e>host</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Path</span>:     <span style=color:#e6db74>&#34;/api/v2/search&#34;</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>RawQuery</span>: <span style=color:#a6e22e>q</span>.<span style=color:#a6e22e>Encode</span>(),
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>url</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>u</span>.<span style=color:#a6e22e>String</span>()
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>slog</span>.<span style=color:#a6e22e>Debug</span>(<span style=color:#e6db74>&#34;mailhog search endpoint&#34;</span>, <span style=color:#e6db74>&#34;url&#34;</span>, <span style=color:#a6e22e>url</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>req</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>NewRequest</span>(<span style=color:#e6db74>&#34;GET&#34;</span>, <span style=color:#a6e22e>url</span>, <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;http create new request error. err: %s&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>res</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>DefaultClient</span>.<span style=color:#a6e22e>Do</span>(<span style=color:#a6e22e>req</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;http request error. err: %s&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>StatusCode</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>400</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;returned response code is %d&#34;</span>, <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>StatusCode</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>r</span> <span style=color:#a6e22e>mmSearchResult</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>convertBody</span>(<span style=color:#a6e22e>res</span>, <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>r</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>, <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to convert: %s&#34;</span>, <span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>r</span>, <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=歯医者>歯医者</h2><p>17時から歯科検診へ行ってきた。歯科検診をしてくれた今回のスタッフはおそらく初めてだったと思うが、手際がよくていつもよりもストレスが少なかった気がした。うちのチームのメンバーは朝方なので8時過ぎにはだいたいみんな始業し始める。なので、朝よりも夜にいない方がメンバーにとってよいだろうと考えて、朝一 (9時) に歯医者へ行くよりも最終 (17時) に行くようにしている。</p><h2 id=pycamp-ふりかえり>pycamp ふりかえり</h2><p>先週末の <a href=/diary/posts/2023/1014/#python-boot-camp>Python Boot Camp</a> のふりかえり。ここまでがスタッフのお仕事なので一般的な kpt でイベントのふりかえりをした。仕事じゃないし、大きなトラブルもなかったし、参加者の評判 (アンケートの内容) もよかったので概ねよい内容だったと思う。テキストの改善点は直接 issue に追加してほしいと言われたので報告した。是非も含めてスタッフに判断してほしいので私が直すつもりはない。</p><ul><li><a href=https://github.com/pyconjp/pycamp.pycon.jp/issues/219>タプルとリストの違いの説明に辞書のキーになれることも追加する #219</a></li><li><a href=https://github.com/pyconjp/pycamp.pycon.jp/issues/220>Windows 環境で普通に pip upgrade をすると環境が壊れる #220</a></li><li><a href=https://github.com/pyconjp/pycamp.pycon.jp/issues/221>pip コマンドの説明で実際に存在するモジュールを書いてあると誤ってインストールしてしまう #221</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1014/>イベント参加のついでに実家に立ち寄り</a></h1><div class=post-meta><time class=post-date>2023-10-14 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/day-off/>day off</a>&nbsp;
#<a href=/diary/tags/agriculture/>agriculture</a>&nbsp;
#<a href=/diary/tags/community/>community</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>0時に寝て2時に起きて少し仮眠して5時に起きた。朝から出かける準備をして6時過ぎには出発した。神戸から実家まで約80kmの距離を、早朝だと高速道路が空いているのもあって1時間弱といったところ。</p><h2 id=軽トラのエンジンをかける>軽トラのエンジンをかける</h2><p>車のバッテリーがあがってしまったときに使う <a href=/diary/posts/2023/0101/#ジャンプスターター>ジャンプスターター</a> を昨年末に購入していた。また軽トラのバッテリーがあがってしまったようで、今回は母に使い方を教えながらエンジンをかけてみた。バッテリーにつなぐケーブルに boost ボタンがあってそれを押下してエンジンをかけるだけ。これは本当に買ってよかった。たまにしか農業しないような家の軽トラ向けにあると安心できる。軽トラのエンジンがかかったら1時間ほど走ってくればそれで元のバッテリーは回復する。</p><h2 id=草焼き>草焼き</h2><p>実家に着いたのが7時過ぎで朝ご飯を食べて、まだ時間があったので草焼きを手伝うことにした。すでに刈って干した草が集めてあったのでそれを火にかけて番をする。<a href=/diary/posts/2021/1006/>以前にも草焼きをした経験</a> があったので注意を払いながら行う。母が言うには、最近でも淡路島の人で草焼きをしていて2人亡くなっているという。おそらく煙に巻かれて一酸化炭素中毒で気を失ってしまったんだと推測する。干し草は一気に燃え上がるので青い草と干し草を調整ながら火の勢いを制御する。あとは表面だけ燃えるので内側も燃えるように混ぜ返したり空気を送ったりといった調整も必要になる。火の制御は難しい。1時間ほどやっていた。</p><figure><img src=/diary/img/2023/1014_kusayaki.jpg></figure><h2 id=python-boot-camp>Python Boot Camp</h2><p>今日の目的は次のイベントに TA として参加してきた。</p><ul><li><a href=https://pyconjp.connpass.com/event/293032/>Python Boot Camp in 徳島2nd</a></li></ul><p>現地11時集合だったものの、早めに実家を出たので10時半頃に着いてしまった。他のスタッフもその後すぐに合流して10時50分には全員が揃った。私は知り合いのスタッフがほとんどいなかったので挨拶したりしていた。だいたいスタッフは次のような構成だった。</p><ul><li>講師: 1人</li><li>現地スタッフ: 1人</li><li>TA: 3人</li><li>会場関係者: 2人</li></ul><p>次の段取りでほぼこの通りうまくスケジュールを進捗できたと思う。</p><pre tabindex=0><code>11:00 スタッフTA講師が集合
11:00-11:30 準備
11:30-12:30 スタッフTA講師でランチ
12:30 開場
13:00 PyCamp開始
17:00 PyCamp終了
17:30 撤収完了
</code></pre><p>お昼に食べた「鳴門うどん」もひやむぎ程度のサイズの麺をにゅうめんのような食感で食べるものだった。身近に住んでいてこれは知らなかった。おいしかった。</p><figure><img src=/diary/img/2023/1014_naruto-udon.jpg></figure><p>boot camp イベントも順調に進捗して受講者も喜んでいたようだったのでよかった。久しぶりにこういったイベントに参加すると、プログラミングを始めたばかりの気持ちなどを思い出してよかったと思う。いまはお仕事でプログラミングの随分と高度なことをマネージャーとして教えているわけだけど、簡単なコードが動いておもしろいといった気持ちがあることも大事だと思う。懇親会も出て、その後、スタッフ同士での反省会もやって、21時前には現地を解散して21時20分に実家に戻った。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0927/>地方は都会の人たちにとっての消費の場ではない</a></h1><div class=post-meta><time class=post-date>2023-09-27 (Wed.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/license/>license</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/community/>community</a>&nbsp;</span><div class=post-content><p>0時に寝てうまく眠れなくて、吐き気がして3時頃に起きてそのまま起きてたらいつの間にか寝て8時に起きた。夜遅くにアルフォート食べたのがよくなかったかもしれない。</p><h2 id=go-アプリケーションのライセンスチェック>go アプリケーションのライセンスチェック</h2><p>お手伝い先で開発しているプロダクトは原則として oss ライセンスにするといった方針らしい。公けにソースコードを公開していないものの、お客さんが望めばソースコードも提供するといった運用にしているらしい。実際にお客さんでソースコードを要求されたことはないという。そのため、自分たちの開発したアプリケーションを oss なライセンスで提供可能かどうかを、一応は、調べておく必要がある。プレスリリースもしているし、いつお客さんが使い始めるかもわからないので、プロジェクトの隙間のときにライセンスチェックをした。</p><p>ググってみたら <a href=https://github.com/google/go-licenses>google/go-licenses</a> というツールがあってこれを使って自分たちが開発したモジュールのライセンスチェックをした。問題なく apache 2.0 のライセンスで提供できることを検証した。</p><ul><li>インストール</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go install github.com/google/go-licenses@latest
</span></span></code></pre></div><ul><li>レポート出力</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd path/to/repository
</span></span><span style=display:flex><span>$ go-licenses report ./...
</span></span></code></pre></div><ul><li>ライセンスチェック</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ go-licenses check ./... 2&gt;&amp;<span style=color:#ae81ff>1</span> | egrep <span style=color:#e6db74>&#34;^(W|E)[[:digit:]]+&#34;</span>
</span></span></code></pre></div><h2 id=コワーキングのオンラインイベント>コワーキングのオンラインイベント</h2><p>月例のカフーツさんのオンラインイベントに参加した。<a href=/diary/posts/2023/0621/#コワーキングのオンラインイベント>前回の所感はここ</a> 。8月は私の予定があわなかったのでイベントを欠席したが、7月の所感がないのはなぜか忘れてしまった。単純に忙しくて書く余裕がなかったのかもしれない。</p><p>今回のテーマは都会と地方のコワーキングスペースの運営の違いなどについてざっくばらんに雑談するといったイベントだった。後半に <a href=https://onomichi-share.com/>ONOMICHI SHARE</a> というコワーキングスペースを運営しているごとうさんという方が参加されて、広島県尾道市という地方というバックボーンをもっていて、ごとうさんからの視点や考え方を話していただいて、いくつか示唆を受けることがあった。ごとうさんが言うには、都会から尾道市へ移住してくる人たちにはなにかしら目的があって来る、しかし、地方は都会の人たちが求めているなにかを消費するだけの場所ではないという考えを大事にしたいと話されていた。</p><p>私が地方出身の都会暮らしだから感じることがある。都会の人たちにとっての地方は娯楽とみられることが多い。わかりやすさのために、地方の不便さや独特の文化などを例にあげるが、そこに住んでいる人たちにとってはそれが日常だから何も思わないことを、都会の人たちは娯楽だと接しているようにみえることがよくある。そのギャップを埋める役割があって然るべきだと私からも思えた。要は勘違いした人たちを、現実に引き戻す役割というべきか。その話の延長上で、地方の人たちは暮らしをよくしようとか、世界をより良くしようとか、ビジネスに挑戦しようとか、そういったことをまったく考えていなくて、自治体がどんなに過疎化していっても、生活が不便になっても、この生活が一生続くと思ってなにもせず、そのまま暮らしているという人たちも多い。都会の人たちの役割の1つとして、そういった地方の人たちに世の中はどんどん進んでいて、新しいことに挑戦する価値や楽しさもあるんだよという気付きを与えることができるんじゃないかと、雑談しながら思えた。</p><p>おそらく、ごとうさんの話しを聞く限りでは、そういう仲介をする役割を担っているようにみえた。コワーキングスペースマネージャーも奥が深いという気付きを得た雑談だった。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0909/>久しぶりの異文化懇親会</a></h1><div class=post-meta><time class=post-date>2023-09-09 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/day-off/>day off</a>&nbsp;
#<a href=/diary/tags/biztrip/>biztrip</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/issue-management/>issue management</a>&nbsp;
#<a href=/diary/tags/drinking/>drinking</a>&nbsp;</span><div class=post-content><p>22時頃には戻ってきたそれから準備したらよいところを、だらだらしてうたた寝して気付いたら2時になっていた。もうこのまま寝て朝起きてから準備しようと3時50分にアラーム設定して起きた。それからお風呂入ってストレッチして荷造りして5時18分に三ノ宮を出発した。</p><h2 id=実家>実家</h2><p>6時21分に実家へ着いた。休憩せずに一気に帰ると約1時間ぐらい。先月ジモティーで譲ってもらっていた机とバランスチェアを実家へ持って帰った。朝ご飯を食べてからバランスチェアを組み立てる。ちょうど机と椅子がよい感じにリモートワーク可能な環境になった。</p><figure><img src=/diary/img/2023/0909_desk-char.jpg></figure><p>9時半頃まで実家でのんびり過ごして、言うても暇なので少し早めに香川県へ向けて出発した。</p><h2 id=オープンセミナー>オープンセミナー</h2><p>オープンセミナーとは、中四国地域で開催されている勉強会らしい。コロナ禍前はもっとたくさん開催されていたそうだが、いまは香川、広島、岡山といった地域で復活しているらしい。<a href=https://osk.connpass.com/event/292551/>オープンセミナー2023@香川</a> に参加した。高松市の高松港の真横にある <a href=https://www.e-topia-kagawa.jp/>eｰとぴあ・かがわ</a> という行政っぽいコミュニティ施設のイベントスペースを借りて開催された。実家から10分休憩を1度取った上で約1時間30分で着いた。実家から高松市まで1時間半とみておくとよさそう。</p><h3 id=てらださんpythonの現状からデータ分析やllm活用への発展>てらださん：Pythonの現状からデータ分析やLLM活用への発展</h3><p>てらださんの応援も兼ねて参加してみた。基調講演のような位置づけ。参加者の python 習熟度のレベルをみながら話す内容をあわせていた。</p><ol><li>あまり知らない</li><li>ちょっと知っている</li><li>がっつり使っている</li></ol><p>最初は python の用途や得意・不得意といった、入門的な話しから始めつつ、徐々に最近の話題へと展開していた。</p><p>python の用途</p><ul><li>システム系</li><li>web 系</li><li>データ分析や科学技術計算系</li><li>iot 系</li><li>3d グラフィックス</li></ul><p>苦手なこと</p><ul><li>web フロントエンド</li><li>デスクトップ gui アプリ開発</li><li>速度重視の低レイヤーの処理</li><li>趙大規模なミッションクリティカルな分野の処理</li></ul><p>python は年1リリース & 5年サポートになっている。</p><p>いまホットな話題として llm (large language model) がある。
私は chatgpt 以外のものはまったくわからないが、
oss で無料使えるツールや学習モデルがどんどん公開されているらしい。日本語に特化したものも出てきているみたい。</p><p>llm のツールチェーンを使って、任意のドキュメントに chatgpt のような質問で検索できるシステムの構築方法を紹介していた。
私が知らなかった技術として、インデクシングすると全文検索インデックスを作成する代わりにベクトル化をしてベクトル DB に保存する。
もっとも煩雑なところがドキュメントのベクトル化してベクトル DB に格納し、検索するときもクエリをベクトル化して、ベクトルの近似計算を行って検索結果を取得できる。
検索結果から回答の文章を生成するところを openai の api を使っているとのこと。有償なのでここだけお金がかかる。自前でやるには強力な gpu をもつマシンがないと処理が追いつかないといった話しだった気がする。
ai の学習モデルをホスティングするサービスとして <a href=https://huggingface.co/>Hugging Face</a> というものが有名らしい。
github ではなく、なにかしらモデルを管理するときに都合のよいことがあるみたい。
web ui には <a href=https://streamlit.io/>streamlit</a> を使っていた。私はまったく使ったことはないが、fin-py で紹介しているのを何度かみた感じでよいイメージをもっている。</p><h3 id=npo法人nemtus松岡さん後藤さん-ブロックチェーン概要説明--symbolブロックチェーンの特徴活用事例紹介>NPO法人NEMTUS　松岡さん、後藤さん 「ブロックチェーン概要説明 ＆ Symbolブロックチェーンの特徴・活用事例紹介」</h3><p>NEM を広めるための NPO 法人らしい。ブロックチェーンの技術説明のスライドがめちゃくちゃわかりやすく作られていた。2人で発表していて、前半は技術的な解説、後半は事例紹介となっていた。事例紹介であちこちで使われているのはわかるけれど、その大半はブロックチェーンを使わなくてもできるものばかりだった。ブロックチェーンの特性が活きるアプリケーションはグローバルな仮想通貨のような用途以外にみつかっていないという気がする。既存の web 技術でもできるものをブロックチェーンに置き換えても、効率の悪さ (コスト高) をどうやってカバーするのかを説明しないのは不誠実なようにも感じられた。せめてスマートコントラクトを絡めて話さないと伝わらないんじゃないかと思う。</p><h3 id=製造業-dx-を意識したときのiot-用-db-設計の注意点>製造業 dx を意識したときの、iot 用 db 設計の注意点</h3><p>会社名は公けに書かれていないから伏せておく。名前だけ聞くと、創業400年という、財閥系の JTC の会社の情シス部門のようなお仕事をされていた。工場の運用改善のために iot と社内システムをすべて内製/自前で構築しているという。工場から生データを収集し、それをデータベースに正規化して、分析して日々の業務の運用改善にあてるという、ストーリーは当たり前のもの。工場の売上は数千億円といった規模になるという。例えば4-5人のチームをアサインすると2000万円ほどの経費がかかるが、1000億円の0.1%を改善すれば1億円になるのでペイするという。そういった考え方で工場の運用改善をしているうちに、いまのチームは30人といった規模になったという。</p><p>事業会社で自分たちで技術を勉強してがんばっているようにみえる。発表のところどころの細かいところの認識が誤っていて、web のシニアエンジニアかアーキテクトがいれば、もっと効率のよいシステムを運用できるのになぁと思いながら聞いていた。あとで懇親会で詳しく聞いてみると、このチームは凄くてハードウェアまでカスタマイズできるという。基盤や回路まで自分たちで設計して作ったりもする。またメーカー品が自分たちの用途の機能を提供していなかったら、サポートを無視して勝手にメーカー品のハードウェアをカスタマイズして自分たちの用途にあったデータを取得できるようにカスタマイズしてしまうといったことも話していた。</p><p>ハードウェアの基盤開発から組み込みのプログラミング、データベース、web と1つのチームですべてやっているという。なかなかこれだけの技術スタックを1チームですべて一気通貫でやっているところはないと思う。web 技術のところではいくつかツッコミ所はあったんだけど、これだけの広い分野をみていると、それは些事だなとちょっと反省した。私が自分の得意な分野だけをみていい気になっていたような気持ちになって反省した。</p><p>懇親会で話していて、iot のシステムは基本的に安くて儲からないと話していて、しかし、ここに web システムを付けるだけで付加価値として売上の金額が上がるという。それは多くの iot メーカーは web に疎いため web システムを作れないらしい。ハードウェアと web の両方の技術に精通している会社/組織というのは意外に少ないらしく、iot + web が儲かるモデルとして話されていた。たしかに私は web に精通しているが iot はまったく分からないので納得感があった。</p><h3 id=lt>LT</h3><p>これが私のお仕事の部分だけど、会社としてイベントに登壇してきた。マーケティング活動の1つやね。</p><iframe class=speakerdeck-iframe frameborder=0 src=https://speakerdeck.com/player/dd65b3a94e5b4feeb73f780c9626cb0a title="Iintroduction of how big tech runs tech projects" allowfullscreen style="border:0;background:padding-box padding-box rgba(0,0,0,.1);margin:0;padding:0;border-radius:6px;box-shadow:rgba(0,0,0,.2)0 5px 40px;width:600px;height:auto;aspect-ratio:560/315" data-ratio=1.7777777777777777></iframe><h3 id=懇親会>懇親会</h3><p>17時から懇親会で21時過ぎまで飲んでいた。私は車で参加していたのでソフトドリンク。知らないイベントの懇親会で、あまりよく知らない人たちと技術の話題でわいわい盛り上がるのは久しぶりで楽しかった。昔の it 勉強会はこんな感じだったなとコロナ禍の終わりも実感した。</p><p>懇親会の参加者には組み込みやハードウェアに詳しい方が何人もいて、私のような web 系の方が少数派でちょっといつもとは違ったメンバーで聞く話しもとても新鮮味があった。iot やハードウェアの話しにさっぱり付いていけなかった。web 系の勉強会やイベントにしか行かないというのも、一種のエコーチェンバーだなと実感した。</p><h3 id=あと飲み>あと飲み</h3><p>21時過ぎから23時まで、てらださんと飲んでいた。てらださんは酔っ払ってどんどん呑むんだけど、酔い潰れるみたいな状態にはならなくて、余裕があるのかないのかよく分からないけど、呑むペースが速いなと感心していた。コミュニティの話し、教育の話し、経営の話し、政治の話し、わりといろんな話しをして時間でお開きにした。</p><h2 id=車中泊>車中泊</h2><p>その後、車を移動して、24時間空いているサウナで泊まろうと近くまで行ったものの、あまり外観の雰囲気がよくなくて、そのまま駐車場に車を泊めて車中泊にした。1時頃だったと思う。駐車場料金がホテル代のようなものになった。あとで調べたらアイドリングしたまま車中泊するのは、付近に家があると騒音がうるさいらしくマナー違反だという。歓楽街だったので周りは若者が遊んでいて、もともとうるさい場所だったと思うのでそれほど迷惑にはならなかったと思いたい。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0908/>お休み前の勉強会</a></h1><div class=post-meta><time class=post-date>2023-09-08 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/logging/>logging</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>22時に寝て24時に起きて2時に起きて4時に起きて6時に起きた。晩ご飯食べてからオフィスに戻る元気がない。本当は明日の出張に備えて今晩、実家へ帰ろうと思っていたが、まったく準備ができていないので明日の早朝に帰ることにした。</p><h2 id=slog-勉強会>slog 勉強会</h2><p>チーム勉強会向けに、今日は軽い話題として slog のブログ記事をピックアップしてみた。この内容を deepl で翻訳して社内の wiki に書いてそれをメンバーと共有した。</p><ul><li><a href=https://go.dev/blog/slog>Structured Logging with slog</a></li></ul><p>うちのプロジェクトの logger はすべて slog に移行済みではあるが、一部 slog を使う前に実装したログ関数があって、そのカスタムログ関数の移行だけまだできていない。アプリケーションの振る舞いには影響を与えないし、急ぐ必要もないので先送りにしているだけ。次の開発フェーズでカスタムログ関数周りもすべて移行して slog で万全の状態にしたい。そのための予備知識として slog でこんなことができるという全体像は理解できた。とてもよい記事だったと思う。</p><h2 id=lt-資料の推敲>LT 資料の推敲</h2><p>先日 <a href=/diary/posts/2023/0903/#LT-資料の作成>LT 資料のたたき台</a> を作成した。いくらか寝かして週のどこかの空いている時間に推敲しようとずっと頭の中にはあったものの、現実にはさぼっていて前日に最終見直しをしている。でも、見直した方がよいところのアイディアは2-3個思いついてはいる。少し手直ししたら明日のイベントに備えて早めに寝る。</p></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/event/page/2/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>