<!doctype html><html lang=en><head><title>Economy :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/economy/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Economy"><meta property="og:description" content><meta property="og:url" content="/diary/tags/economy/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/economy/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><h1>Posts for: #Economy</h1><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0805/>サーバーの拡張とフックポイント</a></h1><div class=post-meta><time class=post-date>2024-08-05</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/design/>design</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/investing/>investing</a>&nbsp;</span><div class=post-content><p>今日は東京株式市場の歴史的な急落もあっていろいろ経済ニュースを読んでいた。</p><h2 id=echo-の-custom-binding>echo の Custom Binding</h2><p>echo で開発していて気に入っているところの1つに、サーバーサイドの、ここをカスタマイズしたいという箇所にちゃんと拡張するためのフックが用意されているというのがある。例えば、リクエストデータとサーバー内部で使う構造体を紐付ける bind 処理もデフォルトの仕組みを拡張する <a href=https://echo.labstack.com/docs/binding#custom-binding>Custom Binding</a> が提供されている。</p><p>Echo 構造体の値に Binder というフィールドがあり、カスタマイズしたい処理を実装した Binder インターフェースの値をセットする。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>e</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>New</span>()
</span></span><span style=display:flex><span><span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>Binder</span> = <span style=color:#a6e22e>binder</span>.<span style=color:#a6e22e>New</span>()
</span></span></code></pre></div><p>Binder はリクエスト構造体の値と echo.Context の値を受け取る <code>Bind()</code> メソッドを実装する。基本的には echo.DefaultBinder を適用した後にカスタマイズしたい bind 処理を実装すればよいと思う。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Binder</span> <span style=color:#66d9ef>struct</span>{}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>b</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>Binder</span>) <span style=color:#a6e22e>Bind</span>(<span style=color:#a6e22e>i</span> <span style=color:#a6e22e>any</span>, <span style=color:#a6e22e>c</span> <span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>Context</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>defaultBinder</span> <span style=color:#f92672>:=</span> new(<span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>DefaultBinder</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>defaultBinder</span>.<span style=color:#a6e22e>Bind</span>(<span style=color:#a6e22e>i</span>, <span style=color:#a6e22e>c</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>req</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>i</span>.(<span style=color:#66d9ef>type</span>) {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>case</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>myRequest</span>:
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>BindSomething</span>(<span style=color:#a6e22e>c</span>); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>err</span>
</span></span><span style=display:flex><span>		}
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>New</span>() <span style=color:#f92672>*</span><span style=color:#a6e22e>Binder</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>return</span> <span style=color:#f92672>&amp;</span><span style=color:#a6e22e>Binder</span>{}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>bind 処理をどう実装するかはいろいろやり方があると思うが、echo.Context の値を渡せるので request 構造体にその実装を隠蔽するというのもいいんじゃないかと思う。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>type</span> <span style=color:#a6e22e>myRequest</span> <span style=color:#66d9ef>struct</span> {
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>myRequest</span>) <span style=color:#a6e22e>UnmarshalJSON</span>(<span style=color:#a6e22e>data</span> []<span style=color:#66d9ef>byte</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>type</span> <span style=color:#a6e22e>Alias</span> <span style=color:#a6e22e>myRequest</span> 
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>json</span>.<span style=color:#a6e22e>Unmarshal</span>(<span style=color:#a6e22e>data</span>, (<span style=color:#f92672>*</span><span style=color:#a6e22e>Alias</span>)(<span style=color:#a6e22e>r</span>)); <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Errorf</span>(<span style=color:#e6db74>&#34;failed to unmarshal ids request: %s&#34;</span>, <span style=color:#a6e22e>data</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>    <span style=color:#75715e>// implement custom validation
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> (<span style=color:#a6e22e>r</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>myRequest</span>) <span style=color:#a6e22e>BindSomething</span>(<span style=color:#a6e22e>c</span> <span style=color:#a6e22e>echo</span>.<span style=color:#a6e22e>Context</span>) <span style=color:#66d9ef>error</span> {
</span></span><span style=display:flex><span>    <span style=color:#75715e>// implement custom binding
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>nil</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=日経平均株価の歴史的な急落>日経平均株価の歴史的な急落</h2><p><a href=/diary/posts/2024/0802/#日経平均株価の急落>金曜日から2日連続</a> で株価指数が 5% 超も下落するのは世界的にも珍しいらしい。</p><ul><li><a href=https://www3.nhk.or.jp/news/html/20240805/k10014537281000.html>株価 過去最大の値下がり ブラックマンデー超え“4つの要因”</a></li></ul><blockquote class=twitter-tweet><p lang=ja dir=ltr>◆ CNBCトップに<br>「日経平均 急落」がCNBCやFTでもトップニュースになっています。2日連続で株価指数が5%超も下落するのは世界的にも珍しいことです。<br>ナスダック先物は2%超の値下がりしています <a href=https://t.co/YGuNKzEdT2>https://t.co/YGuNKzEdT2</a> <a href=https://t.co/CcB2XoycPd>pic.twitter.com/CcB2XoycPd</a></p>&mdash; 後藤達也 (@goto_finance) <a href="https://twitter.com/goto_finance/status/1820280069119783135?ref_src=twsrc%5Etfw">August 5, 2024</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>金曜日に史上2番目の下落幅という見出しでメディアでは煽られていて、下落幅と下落率は違うからそんな不安に感じなくてよいと楽観していたら、今日は史上2番目の下落率 (-12.40%) となった。さらにストップ安になっている銘柄が相次いでいるから実体はもっと悪いと考えられるとのこと。一方でリーマンショックのような、金融機関が破綻しているような状況でもなく、実体経済が傷んでないのに売りが売りを呼ぶ急落になっているので今後どうなるのかはよく分からない。明日も下がるのか、反発するのか、誰にもわからない (素人はしばらく何もしない方がよい) 。注目していた任天堂の株価も -16.53% と日経平均株価以上に急落している。これだけ落ちると、信用取引の追証が2営業日以内となるため、任天堂は明後日「投げ売り」されてもう少し下がる可能性もあるかもしれない。いずれにしても、私は今週いっぱいぐらいかけて空売りの返済をしていく。買うときも売るときも一度に行うのではなく、タイミングや数量を分割してならしていく。</p><p>株価の急落について私の記憶にあるのは、2016年の米大統領選挙でトランプ氏が初当選したとき、2020年にコロナが流行り始めたときを思い出した。たまたまだけど、4年に1回は急落がやってきている。2016年も2020年もとくになにもせず私は見守っていただけだった。しかし、今回は事前にポートフォリオを見直したり、空売りでリスクヘッジしていたりと急落の場面にも対応できた。以前よりは経済の背景を学んで資産運用の行動に反映できるようになってきた。これは経営においてもよいことだと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0802/>自分を騙す言い訳</a></h1><div class=post-meta><time class=post-date>2024-08-02</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/postmortem/>postmortem</a>&nbsp;
#<a href=/diary/tags/motivation/>motivation</a>&nbsp;
#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/investing/>investing</a>&nbsp;</span><div class=post-content><p>今日の運動はジム筋トレ,縄跳び(両足跳),散歩,ジョギング,ハンドグリップ,ダンベルをした。統計を <a href="https://docs.google.com/spreadsheets/d/1bg85QtM-LciUgey8I79uI7vW2PEwsP6TVdeIRVkACBg/edit?usp=sharing">運動の記録</a> と <a href="https://docs.google.com/spreadsheets/d/1YV4fg0m7Enpyeqj0Il1vkIt55N7UsCWtoQZvpss7L-8/edit?usp=sharing">筋トレの記録</a> にまとめる。ジョギングの後に <a href=/diary/posts/2024/0707/#右股関節をよくするための体操>右股関節の改善体操</a> をした。どこかのタイミングで今月からは運動を監視するのをやめて別のことへ移行していく。</p><h2 id=隔週の雑談>隔週の雑談</h2><p>顧問のはらさんと隔週の打ち合わせ。今日の議題はこれら。</p><ul><li>お手伝い先のプロジェクト近況</li></ul><p>今週の出張でお手伝い先でのふりかえりや進捗報告の要旨などを共有しつつ、うちの会社の課題管理ビジネスへの取り組みについて雑談したりした。ここ2-3ヶ月は私がバテてしまい、休日もオフィスへ足を運んでいるものの、運動したり日記を書いたり趣味の調べものをしたりと、のんびり過ごしていることが多い。課題管理ビジネスへの集中力が途切れてしまった。はらさんも上半期は自分のプロダクト開発などをやろうと考えていたものの、あまり想定したように進捗せず、下半期は他社のお仕事のお手伝いで忙しくなってくるらしい。はらさんは <a href=https://yorihiroi-frontend.engineer/ja/>よりひろいフロントエンド</a> を作ったり、最近は <a href=https://www.apple.com/apple-vision-pro/>Apple Vision Pro</a> のアプリ開発をされている。私と似たような状況だなと話しを聞いていて次のようなことを話された。</p><blockquote><p>歳をとると自分を騙すのがうまくなる。うまくいっていない言い訳を、もっともらしく、自分で受けいられるように作ってしまう。<br>危機感をもたなくなる。うまくいっていないことや結果が出ていないことを直視しないといけない</p></blockquote><p>まさに私にも当てはまることでこの2-3ヶ月の自分をみているみたいだ。私自身、今年はほとんど休まず会社のことばかりやってきたから、たまにはだらだらする時期があってもいいのかな程度に自分への言い訳をしていた。はらさんとは隔週で雑談する機会を設けている。こういう話しをするだけでもこの雑談には意味がある。これが自分ひとりだと、自分への言い訳をして、何もしないままどんどん時が過ぎ去っていくだけだったと思う。誰だって自分のネガティブな側面を直視するのはつらいから無意識に目を背けてしまう。信頼できる人たちからそういうことを指摘してもらって自身を省みるきっかけになればと思う。</p><h2 id=いそがみの筋トレ>いそがみの筋トレ</h2><p><a href=/diary/posts/2024/0726/#いそがみの筋トレ>前回の所感</a> 。19時過ぎから出掛けて、トレーニング器機の待ち時間などもあって21時前まで筋トレしてきた。出張中ずっと運動していなかったので行く前はやや面倒に感じていたが、やりきったら達成感があって行ってよかったと思えた。週2-3日のペースで筋トレや運動を継続していくのが心身ともによさそう。慣れてきたモノへのやる気はやり始めてから出てくる。なによりも大事なのはやり始めること。</p><p>体育館のトレーニングルーム通いも気付いたら5回目になった。少しずつ成果は出ていて、器機によっては重りをあげたり回数を増やしたりできるようになったのもある。そして終わってから外で縄跳びをして、ハンドグリップをしながら帰ってきた。これも筋トレした後だとややカラダがだるいのもあるけど、跳び始めてしまえば出来てしまう。毎日の運動は時間を取られて他のことが疎かになってしまった現状があるため、今後は週2-3日の筋トレの機会に集中して運動していくよう、日々の生活を変えていく。</p><h2 id=日経平均株価の急落>日経平均株価の急落</h2><p><a href=https://fin-py.connpass.com/>fin-py</a> という金融関係者向けのコミュニティがあり、数年前から参加している。何人か仲のよいメンバーもいるし <a href=/diary/posts/2024/0408/#税理士さん打ち合わせ>うちの会社の顧問税理士さん</a> もそのメンバーの1人でもある。老後の心配が出てくるのか、日々の生活が安定すると将来の生活に目を向ける余裕が出てくるのか、人生においてお金の話しは歳をとってから関心が出てくる話題の1つだと思う。</p><ul><li><a href=https://www3.nhk.or.jp/news/html/20240802/k10014533731000.html>株価 終値2200円以上値下がり 終値では過去2番目の下落幅</a></li></ul><p>下落幅は1987年のブラックマンデー以来、史上2番目らしい。一方で下落率でいうと 5.81% で史上30番目になる。2008年のリーマンショックでは下落率が11.41%と、この倍以上であったことからそこまで不安を煽る状況でもないが、メディアは不安を煽った方がニュースバリューになるからこういう見出しになるのは仕方ないらしい。米国の経済事情だったり、為替の円高転換などの要因で日本株が急落している。fin-py で時事のニュースなどをやり取りしていたのもあり、為替の円高転換は <a href=https://www.reuters.com/markets/asia/boj-weigh-rate-hike-next-week-detail-plan-halve-bond-buying-sources-say-2024-07-24/>Exclusive: BOJ to weigh rate hike next week, detail plan to halve bond buying, sources say</a> の記事が出た7月24日ぐらいから注目していた。私の投資のポートフォリオも徐々に含み益の保有株を売ったりして、円高になって株価が下がってもよいように準備していた。今日の急落にも備えていたから投資資金の50%ほどは含み益の状態で売却できた。今日の取引終了後も為替は円高に進んでいるし、日経平均先物も悪化しているので月曜日もさらに下がりそうにみえる。これでしばらく為替は円高へ進んでいくのかな。その状況を確認しながら追加でポートフォリオを変更してもよいかもしれない。しばらく為替や株価の変動が大きいだろうから落ち着くまで見守ろうと思う。fin-py で日々の経済のニュースなどを見聞きしているうちにその先の展望を推測して対策を講じたり準備したりできるようになってきた。これまでは起こった状況で気付いて含み損になってしまって何もしていなかった。急な変動が起こりそうな気配や背景を知っていると、準備ができていて、ポートフォリオを機動的に変える決断を早くできる。</p><p>たまたまこんな日に <a href=https://www.nintendo.co.jp/ir/pdf/2024/240802_2.pdf>任天堂 2025年3⽉期第1四半期 決算発表</a> があった。もともと2025年3月期の通期の業績は前期よりも悪くなることが以前からわかっていたのになぜか株価は高止まりしていた。今回の為替の急な円高 (任天堂は海外の売上比率の方が大きいため、円高になると為替差益が減る) と、第1四半期の業績も市場予測よりも悪かった？せいか、月曜日は株価が急落するようにみえる。以前から株価が高過ぎるのと、どこかで為替の円高転換もあるだろうと、2月頃から少しずつ空売りしていた。最悪の時期は任天堂の空売金額が-10%ほどの含み損になっていたものの、(想定したよりも過激な円高がやってきて) 今日の時点で3%ほどの含み益になっている。おそらく月曜日から任天堂の株価は急落すると推測される。</p><p>以前 <a href=/diary/posts/2023/1116/#オプトランのボラティリティ>オプトラン</a> という会社について書いた。ここも半導体産業、且つ為替で業績に影響を受ける会社になる。ずっと観察してきたし、ボラティリティが高いのでポートフォリオに入れたり出したりする定番の会社になっている。今日の時点では、おそらく思惑？だけで1711円と株価が急落している。過去の最安値が1420円、年初来最安値が1561円になる。1500-1600円台まで株価が落ちれば2-3年後のために投資していくのによいんじゃないかと注目している。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1120/>生活リズムが崩れた月曜日</a></h1><div class=post-meta><time class=post-date>2023-11-20</time></div><span class=post-tags>#<a href=/diary/tags/animation/>animation</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/ldap/>ldap</a>&nbsp;
#<a href=/diary/tags/hugo/>hugo</a>&nbsp;</span><div class=post-content><p>1時に寝て2時半に起きて5時に起きて7時に起きた。朝から昼過ぎまで寝てたのでトータルでは睡眠時間をたくさん取っているのになんか疲れている。生活のリズムを崩すのがよくないのかも。</p><h2 id=ガンダムに学ぶ経営学>ガンダムに学ぶ経営学</h2><p>教えてもらって寝る前にみたらおもしろかった。入山先生がガンダム大好きなことが伝わってくる。おもしろいのはそうだけど、まじレスすると、アニメの世界の組織や経済に学ぶというのは誤りで、当時の組織や経済のリアルを参考にして、ガンダムの世界観は作られていると推測する。だから入山先生はユーモアで盛り上げているのだと思うけれど、ガンダムから学ぶのではなく歴史から学べが正解だと思う。でも、ガンダムの世界観を知るよい番組だと思う。</p><div class=video-container><iframe src=https://www.youtube.com/embed/w7Hhimmu26c allowfullscreen title="ガンダムに学ぶ経営学 【まとめ】【テレ東経済ニュースアカデミー　GWセレクション３】"></iframe></div><h2 id=go-ldap-へのプルリクエスト>go-ldap へのプルリクエスト</h2><p>2週間ほど前に送った pr がまだレビューすらしてもらえていない。github actions のテストがいくつか落ちていて、この pr の修正によるものではないところでエラーになっている。メンテナーの1人が再実行してくれたんだけど、たくさんあるマトリックステストのどこかが落ちてまた再実行しないといけない。</p><ul><li><a href=https://github.com/go-ldap/ldap/pull/471>IsErrorAnyOf should match the given result code even if the error is wrapped #471</a></li></ul><p>それを待っている間に、テストがエラーになる本当の原因の問題を直そうと2-3日前に issue 登録していた。この issue の対応を本当は昨日やろうと思っていたのに、思いの外、寝てしまって、その後もいろいろ書きものをしていて時間を使ってしまってできていなかった。今朝からそれを片付けた。業務の一環なので日曜日にプルリクエストを送らなくてもよいのだけど、コントリビューションなので空き時間に終わらせて、業務の時間は別のことに使いたいという思いもあったりする。</p><ul><li><a href=https://github.com/go-ldap/ldap/pull/473>Fix DATA RACE as a result of changing ber&rsquo;s module global variable for fuzz tests #473</a></li></ul><p>さらに github actions のログに deprecated ワーニングが出ていたのでついでにそれも直した。</p><ul><li><a href=https://github.com/go-ldap/ldap/pull/474>Fix deprecated warning on GitHub Actions #474</a></li></ul><p>473, 474, 471 の順番にマージされていくのが望ましい。そろそろコミット権をくれたりしないかな？と思ったりもする。というのは、タイミングの問題で action の job が落ちたり、バージョン上げるだけの pr とか、自分でマージしてしまえばいいと思ったりする。</p><h2 id=hugo-で書いた記事に目次を生成する>hugo で書いた記事に目次を生成する</h2><p>お手伝い先のテックブログは hugo で運用されている。記事の目次がないなと気付いて追加してみた。hugo v0.60.0 以降のバージョンなら標準で目次生成の機能をもっている。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html><span style=display:flex><span>&lt;<span style=color:#f92672>aside</span>&gt;
</span></span><span style=display:flex><span>  {{ .TableOfContents }}
</span></span><span style=display:flex><span>&lt;/<span style=color:#f92672>aside</span>&gt;
</span></span></code></pre></div><ul><li><a href=https://gohugo.io/content-management/toc/>Table of contents</a></li></ul><p>デフォルトはヘッダー2レベルより下の目次を生成する。レベル1も生成したい場合は config.toml に次の設定を追加する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-toml data-lang=toml><span style=display:flex><span>[<span style=color:#a6e22e>markup</span>]
</span></span><span style=display:flex><span>  [<span style=color:#a6e22e>markup</span>.<span style=color:#a6e22e>tableOfContents</span>]
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>startLevel</span> = <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>endLevel</span> = <span style=color:#ae81ff>3</span>
</span></span></code></pre></div></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1116/>ボラティリティとビジネスの展望</a></h1><div class=post-meta><time class=post-date>2023-11-16</time></div><span class=post-tags>#<a href=/diary/tags/investing/>investing</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;</span><div class=post-content><p>1時に寝て何度か起きて8時に起きた。朝起きれなくなってきた。</p><h2 id=オプトランのボラティリティ>オプトランのボラティリティ</h2><p><a href=https://www.optorun.co.jp/>オプトラン</a> というオプトナノテクノロジーによる光学薄膜成膜のプロセスソリューション提供を生業にしているメーカーがある。光学薄膜装置という装置がデジカメやスマホを作る上で必要なものらしい。数年前 <a href=https://www.radionikkei.jp/personality/personality/tomiosugimura.html>杉村 富生</a> さんがラジオの「ザ・マネー」でオプトランという会社がよいと解説していたのをきっかけに株を購入した気がする。いまチャートで調べると2017年の終わり頃だったと思う。</p><p>それ以来、ずっとホルダーというわけではないが、<a href="https://finance.yahoo.co.jp/quote/6235.T/chart?styl=cndl&frm=mnthly&scl=stndrd&trm=10y&evnts=volume&ovrIndctr=sma%2Cmma%2Clma&addIndctr=">チャート</a> をみながら、買ったり売ったりをしながらかなりの期間をホルダーとして会社の成長を期待している株主の1人でもある。チャートをみてもらえばわかるが、全体としてはいまは右肩下がりであまり評価されていないようにみえるが、売り買いの波がはっきりしている会社でもある。もしかしたら他の会社もそんなものかもしれないが、私はこの会社を上場直後からずっと観測してきているので、ボラティリティの波が推測できるようになってきたかもしれない。</p><p>11月13日に第3四半期の決算発表があった。内容は <a href=https://www.optorun.co.jp/ir/library/library_12.html>決算説明会資料</a> をみてほしい。私の所感は決算自体は普通の内容で良くも悪くもない。しかし、株価は大きく下がるだろうと予測して、1731円のところに窓が空いていたのでそれを埋めるような1600円台まで下がると予想した。もともと下がった価格で買い増しするつもりだった。</p><p>実際の今週の時系列の株価が次になる。</p><table><thead><tr><th style=text-align:center>日付</th><th style=text-align:right>始値</th><th style=text-align:right>高値</th><th style=text-align:right>安値</th><th style=text-align:right>終値</th><th style=text-align:right>出来高</th><th style=text-align:right>調整後終値</th></tr></thead><tbody><tr><td style=text-align:center>2023-11-13</td><td style=text-align:right>1,826</td><td style=text-align:right>1,840</td><td style=text-align:right>1,791</td><td style=text-align:right>1,797</td><td style=text-align:right>347,100</td><td style=text-align:right>1,797</td></tr><tr><td style=text-align:center>2023-11-14</td><td style=text-align:right>1,570</td><td style=text-align:right>1,579</td><td style=text-align:right>1,420</td><td style=text-align:right>1,548</td><td style=text-align:right>1,330,800</td><td style=text-align:right>1,548</td></tr><tr><td style=text-align:center>2023-11-15</td><td style=text-align:right>1,575</td><td style=text-align:right>1,636</td><td style=text-align:right>1,544</td><td style=text-align:right>1,631</td><td style=text-align:right>555,100</td><td style=text-align:right>1,631</td></tr><tr><td style=text-align:center>2023-11-16</td><td style=text-align:right>1,671</td><td style=text-align:right>1,674</td><td style=text-align:right>1,636</td><td style=text-align:right>1,668</td><td style=text-align:right>377,800</td><td style=text-align:right>1,668</td></tr><tr><td style=text-align:center>2023-11-17</td><td style=text-align:right>1,658</td><td style=text-align:right>1,668</td><td style=text-align:right>1,631</td><td style=text-align:right>1,647</td><td style=text-align:right>272,400</td><td style=text-align:right>1,647</td></tr></tbody></table><p>翌日の株価は1,791円から1,570円寄り付き、ストップ安手前の1,420円まで下落した。5年以上観測している私にとってはたまに見慣れた現象で、オプトランの株価は仕手筋で操作されるようなことが起きる。よい決算でもトレンドで大きく売り込まれることがある。オプトランの経営陣もそれがわかっているのか、予算を保守的に見積もって終わってみれば超絶よい決算に終わることもある。そのせいか、コンセンサスもとんでもないハードルをあげて、決算資料だけをみたらよい決算なのに、コンセンサスに届かずで悪い決算であるかのように売り込まれたりする。その波が明らかなボラティリティになっていて、もう数年それをみてきたので決算の数字にあまり関係なく、決算後の株価の推移の予測がしやすくなってきている。もちろん、たまに超絶によい決算が出て、非のうちどころのない状況に仕手筋を打ち負かすときもある。しかし、超絶によい決算が出るのは稀なので大抵は予定調和のような推移になる。</p><p>今回の1,420円というのは上場来最安値になる。<a href=https://www.optorun.co.jp/ir/library/library_12.html>決算説明会資料</a> を自分の目で見直してほしい。赤字でもなく、ビジネスも好調で、過去と比べて受注残が減っていることからたしかに昔ほどの勢いは失われつつあるのは否めないが、ストップ安に近い評価を受けるような決算ではない。それをみて、今回はいつもより多めに買い増しした。1,420円をつけた後に今週だけでもどれだけ買い戻されているか分かるだろう。</p><p>今後の推移について予測してみる。この四半期がトレンド転換する時期だと私は考えていて、1ヶ月ほど1,600-1,500円を行ったり来たりしながら、次の決算へ向けて少しずつ上げていくだろう。次は本決算になるが、おそらく少しよい決算が出てそれが大きな上昇トレンドに変わるのではないかと予測している。但し、もし普通の決算だと1,420円以下に売り込まれる可能性も2割ぐらいはある。いまこの株を買うとしても、目論見が外れてさらに株価が下がってもまだ買い足せるぐらいの余裕をもって買う方が良い。そして、2年後ぐらいには30%程度は収益を期待できるのではないかと予測している。</p><p>戦争やインフレなどによって世界経済の動向はまだまだ混迷している。中国の2大不動産大手が倒産したことがどんな影響を及ぼすのかも未だよくわかっていない。生きているだけでリスクはたくさんある。現時点ではオプトランの株は買いだと私は考えているが、また本決算が終わったときに予測が当たったか外れたかをふりかえる。そのときのためにこの記事を残しておく。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1024/>初めて rbac なライブラリを実装した</a></h1><div class=post-meta><time class=post-date>2023-10-24</time></div><span class=post-tags>#<a href=/diary/tags/go/>go</a>&nbsp;
#<a href=/diary/tags/auth/>auth</a>&nbsp;
#<a href=/diary/tags/history/>history</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;</span><div class=post-content><p>22時頃から休んでいて寝たり起きたりで7時に起きた。起きたらネットの記事とかだらだら読んでた。</p><h2 id=rbac-なライブラリの実装>rbac なライブラリの実装</h2><p>昨日から認可のための仕組みを調査している。私の中ではもっとも一般的な rbac (role-based access control) でまずは作ってみようと思う。次の2つのライブラリの利用を検討したが、自分たちのやりたいことにあわない気がして今回は見送ることにした。</p><ul><li><a href=https://github.com/casbin/casbin>https://github.com/casbin/casbin</a><ul><li>モデル定義とポリシー設定が複雑過ぎて設定が難しい、保守が大変になりそう</li></ul></li><li><a href=https://github.com/mikespook/gorbac>https://github.com/mikespook/gorbac</a><ul><li>イメージはあっているが、この程度のライブラリなら自分で作った方が学習コストもなく、拡張にも柔軟に思える</li></ul></li></ul><p>一通り、ライブラリとして使えるように参照実装した。これから実際のアプリケーション要件にあわせてミドルウェアとして rbac な認可処理を作っていく。</p><h2 id=変わりゆく世界秩序>変わりゆく世界秩序</h2><p><a href=https://www3.nhk.or.jp/news/special/international_news_navi/articles/feature/2023/09/26/34645.html>サンフランシスコが陥った負の“スパイラル”</a> の記事にあるような、米国で950ドル以下の窃盗は軽犯罪とするという法律の変更によって、万引きを逮捕しなくなってモラル崩壊が起きて、小売店の商品を普通に盗むという事件が多発しているらしい。fin-py でおがわさんとそんな話しをしていたら次の動画を教えてもらった。私は歴史が好きなので、こういった「歴史は繰り返す」といったものはだいたいみてしまう。厳密な裏付けはわからないが、盛者必衰という言葉もあるように、どんな国でも栄枯盛衰のサイクルはあるだろうというのは大局の視点として同意できる。過去の歴史と国の栄枯盛衰をいくつかの指標とお金の視点から調査したものでおもしろかった。</p><p>日本は80年サイクルで戦争の周期がくるといった説もあるが、この動画でもサイクルの切り替わりのタイミングで平和的にしろ暴力的にしろ、かならず戦争は起きると説明している。もうすでに戦争は始まっている感もあるが、戦争は避けようがないという点も同意するところだ。本も読んでみようと思う。</p><div class=video-container><iframe src=https://www.youtube.com/embed/y3oy8y0EljY allowfullscreen title="レイ・ダリオ著 「変わりゆく世界秩序」"></iframe></div></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0118/>日銀会合の質疑応答をみた</a></h1><div class=post-meta><time class=post-date>2023-01-18</time></div><span class=post-tags>#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/coworking/>coworking</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;</span><div class=post-content><p>0時に寝て7時に起きた。最近はよく眠れるようになってきた。</p><h2 id=日銀会合の結果>日銀会合の結果</h2><p>12時から 1on1 だったのでずっとみていたわけじゃないけど、12時前チェックしたら為替が円安に触れていたので現状維持なことが伺えた。業務を終えてから後藤さんの記事も拝見した。YCC はいずれ修正されるので近い将来に金利が上がることはわかっているが、そのときに市場が動揺して急激な円高になってしまうようなことは経済にとってよくないとのこと。本来はそういうことが起こらないように中央銀行と市場が丁寧に対話を重ねるものだという。いまの日銀の雰囲気だと、3月か4月に急激な形で訪れるかもしれないといった懸念があるように伺えた。</p><ul><li><a href=https://note.com/goto_finance/n/n03e3364dadec>【速報】日銀会合 スピード解説</a></li></ul><div class=video-container><iframe src="https://www.youtube.com/embed/2kWDRvUGnq4?start=3742" allowfullscreen title=総裁定例記者会見（2023年1月18日）></iframe></div><p>後藤さんが質問しているところだけでもみようと思ってみた。のらりくらりとかわされてしまったとのこと。</p><h2 id=コワーキングのオンラインイベント>コワーキングのオンラインイベント</h2><p>月例のカフーツさんのオンラインイベントに参加した。<a href=/diary/posts/2022/1221/#コワーキングのオンラインイベント>先月の所感はここ</a> 。メンバーの1人が <a href=https://jmty.jp/>ジモティー</a> でイベントするのが熱いという話題がおもしろかった。ジモティーって中古品の売買するプラットフォームじゃないの？とみんな思ってたら、最近はイベントなんかもできるようになっていて、ユーザーが多いのにあまりイベント開催に使っている人がいないから狙い目だという。へーと思って、私もスマホにジモティーをインストールしてどんな雰囲気か眺めてみた。ざっとみたら婚活イベントが多くてうんざりしたが。</p><p>コワーキングスペースのイベント管理プラットフォームの開発を進めているらしい。日本にはコワーキングスペース向けのプラットフォームというのが存在しないからチャンスはあるのだと思う。これまでなかったのはコワーキングスペースという市場が小さ過ぎて儲からないから誰も参入しようとしていないだけでしょうというのは納得感がある。さらに私からみると、すでに世の中に sns や無料のプラットフォームがたくさんある中で、わざわざコワーキングスペース向けのツールが必要なのかどうか、需要のところでどうなんだろう？という懸念はある。これからクラウドファウンディングなども予定しているそうでそれが公開されたら、私も (会社として) お世話になっているから少しくらい寄付しようかと思う。この場合は会社間の付き合いとも受け取れるから協賛金として会計処理してよいはず。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0116/>今週は日銀会合に注目</a></h1><div class=post-meta><time class=post-date>2023-01-16</time></div><span class=post-tags>#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/code-reading/>code reading</a>&nbsp;</span><div class=post-content><p>2時に寝て7時半に起きた。ちょっと生活が乱れ気味。</p><h2 id=コードリーディングの準備>コードリーディングの準備</h2><p>tenntenn さんの <a href=https://tenntenn.dev/ja/posts/2022-01-18-tennconn-codereading/>コードリーディングをしよう #tennconn</a> のやり方を参考に、コードリーディングの勉強会を行うことにした。ある4つのプログラムがあって実績もあるという話しなので基本的には既存のコードがどのように動いているのかをメンバーみんなで確認しておこうといったもの。その段取りを決めたり、日程のスケジュールを調整したり、基本的にはイベント当日にソースを読むようにして準備の負担を少なくする一方、私が一番既存のコードを知らないので事前にソースを読んでおこうとリポジトリを眺めていた。</p><h2 id=インフレ勉強会>インフレ勉強会</h2><p><a href=https://inflation.connpass.com/event/271462/>エンジニアのためのインフレ研究会 #2</a> に参加した。この火曜日・水曜日の2日間に渡って開催される日銀会合に注目が集まっているという話題があった。議論に揉めたりしなかったら正午前に会合の結果がすぐ公表されるが、政策変更があるときは発表が遅れる傾向にあって発表時間が早い・遅いでも結果を予測して為替などが動くらしい。後藤さんの記事でも同じようなことが書いてあった。これまで日銀会合なんて気にしたことはなかったけど、政策変更の可能性があるかも？と言われるとへーと思って注目してみようと思う。こういう関心をもつ機会が増えると経済を学ぶきっかけになるかもしれない。</p><ul><li><a href=https://note.com/goto_finance/n/nb27ed02e1754>日銀会合 発表時刻も要注目</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/1113/>ftx 事件</a></h1><div class=post-meta><time class=post-date>2022-11-13</time></div><span class=post-tags>#<a href=/diary/tags/cryptocurrency/>cryptocurrency</a>&nbsp;
#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/web3/>web3</a>&nbsp;</span><div class=post-content><p>眠くて19時には帰ってきて、20時ぐらいには寝て、夜に何度か起きても寝て、9時まで寝ていた。疲労過多でなんもやる気しない。</p><h2 id=ftx-破産事件>ftx 破産事件</h2><p>金曜日ぐらいから大きな事件のようにタイムラインで話題になっていたので経済や金融の勉強の1つとして事件の成り行きを調べていた。いくつかニュース記事を読んだ。直近の数日間の時系列をまとめたものが次の記事になる。</p><ul><li><a href="https://coinpost.jp/?p=406333">仮想通貨市場に激震、アラメダショックとFTX騒動の動向まとめ</a></li></ul><p>過去の経緯や人間関係がわりと複雑らしいので時間がない人は次のフィクションを読んで雰囲気を理解するとよさそう。あくまでフィクション。</p><ul><li><a href=https://note.com/shinjiro_tigers/n/nf7f11fa7989b>猿でも分かる？　FTX破産騒動</a></li></ul><p>twitter のタイムラインでもいろいろみつかる。数億円もの暗号資産をすべて ftx に置いていて資産を失った人。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>Now on public. 公開します<br>All gone 全て逝きました <a href=https://t.co/iQBaLo19ud>pic.twitter.com/iQBaLo19ud</a></p>&mdash; ダニエル 全資産FTX (@Daniel58656357) <a href="https://twitter.com/Daniel58656357/status/1591414911179325440?ref_src=twsrc%5Etfw">November 12, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>今後の暗号資産や web3 界隈の資金繰りを心配する人。</p><blockquote class=twitter-tweet><p lang=ja dir=ltr>もっと正直に言うと↓<br><br>今引所、何とかプロダクト、何とかNFT関係、何とかDAO、何とかWeb3で務めてる方々へ：あなたが務めている会社（組織）の資金ぐりは今後急速に悪化します。その時に打つ手はあなたをクビにするしかない。だったら早めに転職の準備をしても１つの手、するかどうかは別としても。</p>&mdash; Sonny Wang｜生涯努力家 (@LinksSonny) <a href="https://twitter.com/LinksSonny/status/1591384722105864194?ref_src=twsrc%5Etfw">November 12, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><p>破産申請された内容から負債総額は100億ドルから500億ドル (1.4超円から7超円) の間とされていて、リーマンショックの負債総額は約6,000億ドル（約64兆円）だったことから規模はその10分の1ぐらい。また取引所にある顧客資産を流用していたことが発覚していることから、これはポンジ・スキームに近いものらしく、会社ぐるみで不正をしていたエンロンショックに近い詐欺事件として当局の調査もこれから行われていくらしい。今後、不正の手口なども明らかになっていくのだろうから経営や財務の勉強材料にする。</p><p>現時点で私が ftx 破産事件から学んだことはこれら。どのぐらい経済の影響を与えるのか、まだよくわからないのでしばらく注視していく。</p><ul><li>姉妹会社であるアラメダリサーチ社の資産の大半が ftx トレーディング社が発行するトークン (ftx token) で構成 (25%) されていた<ul><li>他の資産も流動性の低いトークンで構成されていて売却時のコストを考慮すると資産の評価は適切ではない懸念が指摘された暴露記事が騒動の発端</li><li>現金及び現金等価物は20億ドルしかなかった</li></ul></li><li>取引所が発行するトークンを、取引所同士で大量に持ち合いして価値の下支えをしている<ul><li>こういったトークンは流動性がないことから、大量保有者が売ると大幅に価値が下落する</li><li>ftx トレーディング社は自分たちで発行したトークンでグループ企業の資産価値を過剰に高くみせていた</li></ul></li><li>ftx トレーディング社の社長 (Sam Bankman-Fried) は経理システムにバックドアを作っていて顧客資産を流用していた<ul><li>破産申請の前夜にそのバックドアが使われて100億ドルの顧客資金が社長の投資会社に移され、そのうちの10億ドルから20億ドルの行方が分からなくなっている<ul><li>誰が何のためにバックドアを利用して資金移動したのかはまだ調査中</li></ul></li></ul></li><li>1つの取引所にすべての暗号資産を置かないこと</li><li>取引所に暗号資産をずっと置きっぱなしにしないこと</li><li>暗号資産はまったく安全ではないこと<ul><li>取引所という脆弱性、普通に盗難されるし、不正されるし、破産したら資産を失う</li></ul></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2022/0403/>カスタムドメインの設定</a></h1><div class=post-meta><time class=post-date>2022-04-03</time></div><span class=post-tags>#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/blog/>blog</a>&nbsp;
#<a href=/diary/tags/dns/>dns</a>&nbsp;
#<a href=/diary/tags/github/>github</a>&nbsp;</span><div class=post-content><p>3時に寝て7時半に起きた。前日の深夜にオフィスの掃除をしてた。シェアオフィスなので掃除機をかけると音がうるさくて周りに迷惑なので誰もいない時間帯を見計らって行う必要がある。</p><h2 id=逆イールド>逆イールド</h2><p>会社を経営する上で経済の状況は大きな影響を受けるので機をみて経済の勉強もしている。直近40年近くの統計では、米国債金利において、2年債の金利が10年債の金利を追い越してしまう現象が発生した場合、その1年後ぐらいに景気後退期がやってくる。この現象を <strong>逆イールド</strong> と呼ぶ。</p><p>なぜ逆イールドが発生すると景気後退となるのか。国債とは政府の借金。金融機関、年金、個人、海外などが貸している。金利は複雑で様々な要因で決まるので一概に言えないが、大雑把にまとめると経済の力や金融政策、世のおカネの量で決まる。政策金利によって3ヶ月債や2年債は大きく影響を受ける。利上げを急ぎでやろうとしている理由は高いインフレがある。米国は約40年ぶりの高インフレとなっている。FRB は約2%のインフレを目標としているが、現状は遥かに高い水準になるので金利を上げてインフレを抑制しようとしている。FRB は次の2つの使命を負っている。</p><ul><li>物価の安定</li><li>雇用の最大化</li></ul><p>いま物価が急上昇しているため、このまま金融緩和を続けるとさらに物価が上昇して悪い影響を及ぼしてしまう。いまは金融緩和を縮小して利上げをしていく必要がある。しかし、利上げは景気に対して悪影響となる可能性がある。どのぐらい利上げすればよいのかは実際には誰もわからない。最悪の状況として次がある。</p><ul><li><strong>スタグフレーション</strong>: 高インフレのまま景気が減速する現象</li></ul><p>スタグフレーションが発生すると経済対策や金融政策で対応しづらい非常にまずい状況となる。経済学者によっても意見が分かれるので、まだスタグフレーションが起こるとは限らない。しかし、起こる可能性があるという見方も出てきているらしい。</p><div class=video-container><iframe src=https://www.youtube.com/embed/apeDeUAXMdk allowfullscreen title=よくわかる「逆イールド」　景気後退のシグナル（後藤達也）></iframe></div><h2 id=英語のテックブログ開設>英語のテックブログ開設</h2><p>先日作った <a href=/diary/posts/2022/0327/#backlog-と-github-のインテグレーション-action>backlog-github-integration-action</a> の記事を書くことにした。会社のプロダクトとして作ったツールで汎用的なものや業務として保守していくものは積極的にアピールしていきたい。基本的に私は日本市場をあてにしていないのと、せっかく会社を作ったのだし、海外の会社と取り引きできるようになりたいという野望もある。プロダクトの情報発信は英語が基本で、余裕があったら日本語も書くといった優先度でやっていく。</p><p>少し前にたまたま <a href=https://hashnode.com/>hashnode</a> がイケてるというのをタイムラインでみかけたのを思い出した。せっかくなので調べてみたら、どうも <a href=https://support.hashnode.com/docs/mapping-domain>Custom Domain</a> を無償、且つお手軽に設定できるのが訴求点になっているらしい。カスタムドメインを使うと、url に統合性があってカッコいいという以外にも信頼できるドメインに対して SEO が行われるため、優良な記事を書いていると自社ドメインの信頼があがっていくといったメリットがある。コストがかからないならカスタムドメインを使わない理由は何もない。そして設定したものが次になる。</p><ul><li><a href=https://blog.kazamori.jp/>https://blog.kazamori.jp/</a></li></ul><p>ネームサーバーにカスタムドメインの設定をしていて間違って少しはまった。</p><p>間違った設定</p><pre tabindex=0><code>cname blog hashnode.network
</code></pre><p>正しい設定</p><pre tabindex=0><code>cname blog hashnode.network.
</code></pre><p>最後にドット <code>.</code> が必要になる。これで blog.kazamori.jp の名前解決が hashnode.network として解決される。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ dig blog.kazamori.jp
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>;; ANSWER SECTION:
</span></span><span style=display:flex><span>blog.kazamori.jp.	198	IN	CNAME	hashnode.network.
</span></span><span style=display:flex><span>hashnode.network.	46	IN	A	76.76.21.21
</span></span></code></pre></div><p>CNAME レコードを滅多に設定しないのでドットで終わらないといけない規則を忘れてた。設定後、dns の propagation に最大24時間ほどかかる。世界のどこからでもアクセスできるようになるには24時間ぐらいかかるかもしれないけど、ローカルで動作検証するなら数分で反映されてた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2021/1207/>クロスデフォルト</a></h1><div class=post-meta><time class=post-date>2021-12-07</time></div><span class=post-tags>#<a href=/diary/tags/economy/>economy</a>&nbsp;
#<a href=/diary/tags/java/>java</a>&nbsp;
#<a href=/diary/tags/logging/>logging</a>&nbsp;</span><div class=post-content><p>0時に寝て6時半に起きた。5時台には起きているんだけど、起き上がるところまではなかなかいけない。</p><h2 id=恒大集団のデフォルト>恒大集団のデフォルト</h2><p>11月から利払の期日の日はチェックしていて、支払うときは2-3日前には支払いを完了したというニュースが出ていたように思う。今日の支払いは前日に支払いしたというニュースが出ないからダメなんだろうなと様子をみていた。</p><ul><li><a href=https://jp.reuters.com/article/evergrande-idJPKBN2IM0F0>中国恒大、猶予期間終了までにオフショア債利払いできず＝関係筋</a></li></ul><p>1つの債務がデフォルトした場合、残りの債務も一括返済しないといけないことを <a href=https://www.ifinance.ne.jp/glossary/loan/loa259.html>クロスデフォルト</a> と呼ぶらしい。契約書にクロスデフォルト条項として書いてあるらしい。記事によると、クロスデフォルトによって約190億ドル (約2.1兆円) のオフショア債の返済を一括でしないといけないらしい。リーマンショックのようなことは起きないという見通しだけど、うちみたいな零細企業は世の中の影響を諸に受けるのでお仕事に影響がでなければいいなぁといったところ。</p><h2 id=アプリケーションログの調査>アプリケーションログの調査</h2><p>昨日の続き。ecs-logging-java で JSON Lines でログを制御するところで spring-boot の設定で tomcat のアクセスログの設定ができる。tomcat のアクセスログを log4j のレイアウトの仕組みを使って ecs-logging-java が提供する EcsLayout に変更できないかを3時間ほど調査して、どうもできないようだというのを教えてもらった。tomcat は apache のログを出力するという目的で実装されているから log4j の柔軟なログに対応していないという理屈。</p><p>じゃあ、どうやって apache のアクセスログを JSON Lines にするかというと、PatternLayout のパターンに json のフォーマットを直書きしてしまうというやり方がある。なんかプログラミングでスマートに解決したいところだけど、その仕組みがないなら仕方ないかって感じでこれでやろうと思う。</p><ul><li><a href=https://ogugu.hateblo.jp/entry/2018/08/03/153930>apacheのaccess_logをjson化しtd-agentで集約サーバへ収集する</a></li></ul></div></article><div class=pagination><div class=pagination__buttons></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2025 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>