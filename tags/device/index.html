<!doctype html><html lang=en><head><title>device :: forest nook</title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/device/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="device"><meta property="og:description" content><meta property="og:url" content="/diary/tags/device/"><meta property="og:site_name" content="forest nook"><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/device/index.xml rel=alternate type=application/rss+xml title="forest nook"></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0127/>かきまぜという進化</a></h1><div class=post-meta><time class=post-date>2024-01-27 (Sat.) ::</time></div><span class=post-tags>#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/noh/>noh</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/recipe/>recipe</a>&nbsp;</span><div class=post-content><p>2時過ぎに寝て6時半に起きた。晩ご飯食べてからちょっと自転車で走って運動してオフィスで軽く作業するつもりが、ブログ読んだりして結局意図した作業ができなかった。</p><p>今日の筋トレは腹筋ローラー:5x1,スクワット:20x1,両足跳び30x3をした。腹筋ローラーは腹筋も使うけど、肩や腕の筋肉もパンパンになっている。</p><h2 id=ストレッチ>ストレッチ</h2><p>筋トレを継続しているので軽い筋肉痛を引きずったままストレッチを受ける。トレーナーさんもストレッチしていて、体が硬めにみえるという話しはあるものの、筋肉痛をストレッチで伸ばすのは悪いことではないので問題ないという。昨日ルミナリエの案内に歩き回ったせいか足も腰もやや疲労していた。お尻の後ろのツボのようなところも普段平気なのに効いた気がする。トレーナーさんとネットで調べた情報をベースに筋トレの話しをしていて、毎日同じメニューをこなすよりも違うメニューをやった方が筋肉が回復する日を設けられて効果的らしい。ちょうどいま習慣化できてきたタイミングでいくつかメニューを増やそうとしているので1週間の筋トレのメニュー作りをしてもよいかもしれない。今日の開脚幅は開始前152cmで、ストレッチ後156cmだった。</p><h2 id=縄跳びの跳び方>縄跳びの跳び方</h2><p>筋トレのメニューの1つにしようと FEELCAT なわとびを購入してみた。</p><p><a href=https://amzn.to/49e0QAl target=_blank><img src=https://m.media-amazon.com/images/I/61dx3mllMrL._AC_SL1186_.jpg width=240></a></p><p>今日届いたので長さを調節して早速オフィスの近所の駐車場へ行ってやってみた。縄跳びなんか学校の体育でやって以降やったことないんじゃないかとすら思えた。最初はどうやって跳ぶんだっけ？みたいなところから始めて、段々記憶が戻ってきてリズムよく跳べるようになった。長さ調節の説明書に初心者は少したるむ感じの長い方がよいと書いてあったから長めに調節していたものの、跳んでみると縄がたるんだ分の回転するリズムが自分の感覚と違って返って跳びにくかった。戻ってきてさらに短く適性な長さに調節した。ひとまず両足跳び30回を3セット跳んでみた。これだけで息が切れた。</p><p>縄跳びの動画をみていて回数をこなすよりも跳び続ける秒数を測った方がよいようにみえる。これなら縄跳びが上達することで同じ時間でも回数が増えて負荷を上げていくのにちょうどよさそうに思える。まだ両足跳びも怪しいので慣れてきたら時間に移行していく。他のいろんな跳び方にも挑戦したい。</p><div class=video-container><iframe src=https://www.youtube.com/embed/OBjA8bCImS8 allowfullscreen title=なわとびトレーニング6種目3サイクル10分></iframe></div><h2 id=能楽の勉強>能楽の勉強</h2><p>4半期に1回ぐらいの「能のことばを読んでみる会」へ行ってきた。<a href=/diary/posts/2023/1021/#能楽の勉強>前回の所感はここ</a> 。久しぶりで最寄り駅は阪急芦屋川駅なのに、なぜか阪神だと勘違いしていて阪神芦屋駅に行ってしまい、そこから速歩きで20分かけて芦屋能楽堂に辿り着いた。1kmほど歩いた。そのせいで10分ほど遅刻した。よい運動にはなったけれど。</p><p>今回のお題は「難波」という、世阿弥の祝言能だという。世阿弥が自筆した本物の文献は国の重要文化財としてお寺に保管されている。その文献をすべて写真に撮ったものを影印 (えいいん) と呼び <a href=https://www.iwanami.co.jp/book/b265634.html>世阿弥自筆能本集</a> として販売されている。講師の朝原さんがその本を持ってこられてみせていただいた。おそらく難波の詞章もそこに書かれていたのだと思う。現代人は世阿弥の自筆をそのまま読めないが、びっしりとカタカナが書かれていた。発音どおりの表記をするために意図的に漢字やひらがなを使わずにカタカナで書いたと考えられている。この文献は世阿弥が自筆したことは間違いないが、書いてある内容がすべて世阿弥のオリジナルかどうかまではわかっていない。世阿弥が活躍したのは室町時代なので本は書き写すしかなかった。他人の創作物や文献を世阿弥が書き写した可能性もある。</p><ul><li><a href=https://nohgaku-kyodo.com/repertoire/yondemiru-naniwa20240127>《難波》 第37回能のことばを読んでみる会</a></li></ul><p>朝原さんによると、現代に伝わっている難波の詞章の内容と、世阿弥が自筆した文献に書いてある内容はいくつか食い違っているという。その理由としていくつかの仮説が考察される。</p><ul><li>世阿弥が書いたものは編集中の草稿だったのではないか</li><li>世阿弥が書いたものを現代まで伝わる過程で誰かが改変したのではないか</li><li>実は難波が誰かの創作物で、世阿弥はそれを書き写したものの、それはオリジナルではなかったのではないか</li></ul><p>難波の冒頭は次の言葉から始まる。</p><blockquote><p>山も霞みて浦の春。山も霞みて浦の春。波風静かなりけり</p></blockquote><p>七・五・七・五・七・四と七五調になっている。この冒頭の音を聞くだけで、いまから始まる物語はきれいな美しい物語を展開するよという意図が込められているという。また「波風静か」とは能の中では世の中が平和ですよという意味をもっているという。</p><blockquote><p>やまもかすみて うらのはる やまもかすみて うらのはる なみかぜしずか なりけり</p></blockquote><p>といった具合に、この1文だけで解説が10分といった、いつも通りの詳細な解説で進んでいく。</p><p>難波は <a href=https://ja.wikipedia.org/wiki/%E4%BB%81%E5%BE%B3%E5%A4%A9%E7%9A%87>仁徳天皇</a> の仁政を讃える内容となっている。所々、仁徳天皇の徳によってなにもしなくても平和で穏やかで人々は幸せに暮らしているみたいな表現が出てくる。現代人が習った仁徳天皇という呼び名は、奈良時代中期に中国を真似て漢字2文字で天皇の名前を表すようになって以降の話しだという。したがって奈良時代に成立した <a href=https://ja.wikipedia.org/wiki/%E6%97%A5%E6%9C%AC%E6%9B%B8%E7%B4%80>日本書紀</a> では仁徳天皇という名前は出ておらず、仁徳天皇を表す大鷦鷯尊 (おおさざきのみこと) という日本式の名前が使われている。難波の中でもその名前で出てくる。こういった漢字2文字で天皇の名前を表す以前の日本式の天皇名前を <a href=https://ja.wikipedia.org/wiki/%E8%AB%A1>和風諡号</a> と呼ぶらしい。</p><blockquote><p>咲くや木 (こ) の花 冬籠り</p></blockquote><p>「木の花」は「こそあど」言葉の指示語としての「これ」の意図がある。わざわざ「木の花」とあるのは <a href=https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%8E%E3%83%8F%E3%83%8A%E3%83%8E%E3%82%B5%E3%82%AF%E3%83%A4%E3%83%93%E3%83%A1>木花開耶姫 (このはなのさくやびめ)</a> と掛けているのだという。木花開耶姫は桜の女神 (または火山の神？) として伝わっている。難波の物語で出てくるのは梅についての問答なのに木花開耶姫が出てくるのはそもそもおかしいのだけど、当時は梅の女神でもあったのか？それともただ言葉を掛けただけなのか？といった複数の考察ができるという。</p><p>難波の物語自体は仁徳天皇がいかに素晴らしくて、その治世によって世の中は平和で美しくて、様々な情景を浮かべるような表現がたくさん出てくる。もし能をみて幻視できる人であれば、暖かくて穏やかで華やかな景色をたくさん眺められるのだと思う。いつもどおり和歌や漢詩の引用があちこちにあって、朝原さんも解説しきれないぐらいの背景の脱線しまくりしながら進めていた。おもしろかった。</p><h2 id=ホットクックに初挑戦>ホットクックに初挑戦</h2><p>先週末に <a href=/diary/posts/2024/0120/#部屋のレイアウト変更>部屋のレイアウト変更</a> してホットクックのための居場所を作った。その翌日の日曜日は出掛けてそのまま外食して、平日はなぜかいろいろ忙しくて、夜に用事があったり、寒くてスーパー行くのが億劫で冷凍食品で晩ご飯を済ませたりしているうちに1週間が過ぎてしまった。今日は満を持してスーパーへ出掛け、食材を購入してきた。最初は作り方や材料をよく知っていて慣れたものがよいだろうと思ってカレーにした。<a href=https://jp.sharp/hotcook/>ホットクック</a> は KN-HW24G を購入した。大き過ぎたかな？とも思ったけど、実際に作ってみたらスーパーで買ってきた食材を使い切って3食分ぐらいの作りおきにするにはちょうどよいサイズに思える。</p><p>牛すじカレーを作ってみた。約1時間。レシピはこんなところ。</p><ul><li>牛すじ 400-500g</li><li>玉ねぎ x 2</li><li>にんじん x 1</li><li>さつまいも x 1</li><li>じゃがいも x 2</li><li>ミディアムトマト x 8</li><li>しめじ</li><li>水 100 cc</li><li>業務カレールウ 1箱 (業務スーパーで売っているPB)</li></ul><figure><img src=/diary/img/2024/0127_hotcook.jpg></figure><p>私はどろどろカレー派なので水分の少ないこういうカレーは好みの方。牛すじも思ったより煮込めていてよい感じだった。圧力鍋で作ったカレーと食べ比べしないとわからないぐらいには、いつも作っているカレーの水分少なめのカレーになった。普通においしかったと思う。食材を切って鍋に入れるところまでは圧力鍋と同じだが、カレールウまで最初から入れてしまうというのが従来の調理と大きく異なる。圧力鍋なら火を通した後に蓋を開けてからカレールウを入れてかきまぜるという作業が必要になる。さらにホットクックでは調理中に食材もかきまぜるから <a href=https://jp.sharp/hotcook/products/knhw24g/feature/cook/>味がしみ込む</a> という。圧力鍋とホットクックの大きな違いの1つとして「かきまぜ」を自動化したことで手間をなくて料理の質も上げたようにみえる。素材の栄養も逃げないからこれは素晴らしい。</p><ul><li><a href=https://kakedashiwanko.com/hotcook-use/>【ホットクックを使いこなす】365日使い倒した私が使い方を徹底解説</a></li></ul><p>ホットクックは料理を作った後にそのまま保温ができる。今回作ったカレーをひとまず保温にしてみた。但し、この保温温度は75℃と細菌が繁殖しない設定になっているのでご飯の保温には向かないとのこと。保温と似て非なるものが予約調理になる。予約調理は次の図のように、まず一旦火を通した上で適温をキープして最後の仕上げになる。夜に予約したら深夜のうちにできてしまって朝まで保温するような仕組みにみえる。夜にセットして朝食べるか、朝にセットして夜に食べるか、どちらのパターンもありそう。</p><img src=https://jp.sharp/hotcook/products/knhw24g/feature/cook/images/sub08-1.jpg width=480><p>理想的な1日だと6-7時頃に起きて8時過ぎにオフィスへ行って18-19時までお手伝い先のお仕事をして、一旦家に帰ってきて晩ご飯を食べて、またオフィスへ戻って21-24時ぐらいまで自分の会社のお仕事をする。晩ご飯が遅くなっても若い頃はなにも起きなかったが、いまは寝る前に晩ご飯を食べると最悪のとき吐く。ここで21時頃に家でくつろいでいると、働きたくなくなってオフィスへ戻らないときもちょくちょくある。要はさぼってしまう。人間が弱い。</p><p>オフィスには <a href=/diary/posts/2023/0725/#小さい冷蔵庫>冷蔵庫</a> もあるから、ホットクック用の食材セットを冷蔵庫に保管しておいて、オフィスにも小さいホットクックを置いといたらそのまま晩ご飯を食べられるのではないかと考え始めた。フロアには給湯室もあるからご飯を食べてからホットクックの鍋を洗うこともできるだろう。徒歩5分で家に帰れるのだから帰ったらよいと普通なら考えると思う。当初は私もそう考えた。オフィスにいたらいくらでも働けるのに、家に帰ったらもう働きたくないという誘惑に打ち克つのはなかなか厳しい。理想的ではない1日だと18-19時頃にお手伝い先のお仕事を終えて、そのまま22時頃まで自分の会社のお仕事をする。そうすると晩ご飯が23時をまわってしまい、そのまま寝たら気分が悪くて3時頃に食べたものを吐いて眠れないという状況に陥る。それも何度かやってもう慣れたけれど。</p><p>閑話休題。調理に「かきまぜ」という進化をもたらしたことがこれほどすごいことだとは理解できていなかった。ということでオフィス用に一番小さい KN-HW10G を購入してみた。また今度、家とオフィスのダブルホットクックの運用も考えてみる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0125/>会社でもテックブログを読む会を始めた</a></h1><div class=post-meta><time class=post-date>2024-01-25 (Thu.) ::</time></div><span class=post-tags>#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/blog/>blog</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>昨日は疲れて21時頃から横になってうたた寝したりしながら何度か起きて6時半に起きた。</p><p>今日の筋トレは腹筋:10x2,腹筋ローラー:5x2,腕立て:15x1,スクワット:20x1,背筋:10x1をした。</p><h2 id=筋トレのメニュー追加>筋トレのメニュー追加</h2><p>だいぶ筋トレにも慣れてきてもう習慣化の壁は超えたかな？といったところ。そろそろ同じメニューばかりしているのも飽きてきたのでいくつか追加してみようと思う。過去に働いていた会社で腹筋ローラーをみんなでやったことがあったとふと思い出した。探したら家のクローゼットの奥から出てきた。久しぶりに腹筋ローラーやったらめっちゃしんどい。筋肉が落ちているんやな。さらにストレッチのトレーナーさんと話していて背筋もやったらどう？とアドバイスを受けたのでそれも追加してみることにした。</p><div class=video-container><iframe src=https://www.youtube.com/embed/n0Oa8IsJfzE allowfullscreen title=腹筋を割る！初心者でもできる腹筋ローラーの正しいやり方></iframe></div><h2 id=社内版テックブログを読む会をやってみた>社内版テックブログを読む会をやってみた</h2><p><a href=/diary/posts/2023/1210/#2023年ふりかえり>年末のふりかえりイベントで西原さんにテックブログを読む会のこと</a> を教えてもらった。その後、公けにやっているそのイベントに参加させてもらって、やり方の流れやコツなどを実際に参加して学んでいた。1ヶ月ほど通ったのでその経験をもとにお手伝い先の社内でも導入することに、半ば、私が強引に決めた。メンバーから開発の時間が少なくなるという懸念の声も上がった。それは私も理解できる。しかし、これはやった方が中長期でみてよいはず。「おれのサイドエフェクトがそう言ってる」気がする。</p><p>私は会議が嫌いな方なので、できる限り、チーム参加型の同期イベントを増やしたくないという思いがある。そんな私からみても、このイベントには価値があるとコミュニティイベントに15年以上参加してきて直感的に感じるものがある。たった30分のイベントだが価値がある。価値のあることだけを30分に凝縮している。洗練されている。一般人は内容も中身もシンプルですごく簡単に思うかもしれないが、このイベントを企画するには多くの試行錯誤を経ていることが私にはわかる。「恐ろしく速い手刀。オレでなきゃ見逃しちゃうね」と一般人では気付けまい。</p><p>第1回をチームでやってみた。30分でメンバーは記事を読んで所感を話して意図したようにうまく進行できたと思う。毎週30分。まずはこれを1ヶ月継続してみてメンバーの感想を聞いてみようと思う。</p><figure><img src=/diary/img/2024/0125_slack-channel.png></figure><h2 id=間接照明の受け取り>間接照明の受け取り</h2><p>ジモティーでアジア雑貨風の照明を500円で購入した。ニトリ製のようだ。これも実家のコワーキングスペースで使おうと考えている。もともと1000円で出品されていて、悪くはないけど、1000円はやや高いかなと見送っていた。何ヶ月かしてから値下げして500円になったので問い合わせしたら交渉が成立した。当初は東灘区まで取りに行くつもりが、出品者の実家が三ノ宮にあったそうで三ノ宮で受け渡しできた。電球をもっと明るいのに取り替えたら十分に間接照明として使えそう。</p><figure><img src=/diary/img/2024/0125_light.jpg></figure></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1217/>田んぼ休暇</a></h1><div class=post-meta><time class=post-date>2023-12-17 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/day-off/>day off</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/agriculture/>agriculture</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>1時に寝て5時半に起きてだらだらしてゲームをちょっとやって7時半に起きた。なぜか分からないけど、実家で寝ると普段3時間ぐらいしか睡眠できないのが4-5時間に伸びる。気圧？空気？土地の守りみたいなもん？夕方には神戸に戻ってきていたが、寒さで凍えたのもあってそれから作業する元気がなかった。</p><h2 id=田んぼ>田んぼ</h2><p>8時からトラクターで田んぼを耕す。昨日は暖かったのに一晩寝たら急に冷え込んだ。うちのトラクターは旧式なのでエアコンはついてなく、風を遮るものもないので風の強い気温の低い日はめっちゃ寒い。3時間ほど耕して畝を作った。写真は撮り忘れた。今回耕したところの畑は高低差ができてしまってよく耕せるところとそうじゃないところができて、あまりうまく耕せなかった。いずれ平坦にならさないといけない。</p><p>田んぼを終えてから近所の観光客向けの食堂でぶり丼を食べた。これで1,250円とやや割高ではあるけれど、ぶりの刺身は新鮮で質のよく、久しぶりにおいしいお刺身を食べた。若い子にとっては量が物足りないかも？だが、中年にとってはこのぐらいの量でちょうどよい。</p><figure><img src=/diary/img/2023/1217_buri-don.jpeg></figure><h2 id=スマートキーの電池交換>スマートキーの電池交換</h2><p>車のメーターパネルにスマートキーの電池残量低下という案内が出るようになった。調べてみると、スマートキーは常に電波を放出しているので短くて1年、長くても2年で電池が切れるという。ちょうどいま1年近く乗ったところなのでうちのスマートキーは1年程度で電池が切れるようだ。電池が切れたら車に乗れないのかな？と調べてみたらそうでもなくて、スマートキーに内蔵キーと呼ばれる物理キーも用意されていてそれでドアの施錠の開閉ができて、さらにエンジンのスタートも電池が切れていてもできる仕組みになっているそうな。そりゃそうか。電池切れる度に車に乗れなくなっていたら世の中もっと混沌としている。</p><ul><li><a href=https://www.honda.co.jp/ownersmanual/webom/jpn/fit/2020/details/136179090-4423.html>Hondaスマートキー</a></li><li><a href=https://www.honda.co.jp/ownersmanual/webom/jpn/fit/2020/details/136179090-14211.html>Hondaスマートキーの取り扱いと電池交換</a></li></ul><h2 id=ストレッチ>ストレッチ</h2><p>土日は実家に帰っていたので日曜日の夜にストレッチを受ける。土日に車で実家との往復をすると腰に負荷がかかる。さらに田んぼを耕すためにトラクターに数時間座って操作しているのでさらに追加で負荷がかかる。その目論見の通り、トレーナーさんの言葉からも、自他ともに今日は腰がもっとも疲弊していた。今日の開脚幅は開始前152cmで、ストレッチ後156cmだった。ストレッチ後に晩ご飯食べてからオフィスで作業するつもりが、外が寒くて出掛けるの億劫になってそのまま家でだらだらしていた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0618/>クラウド経由で tapo を制御する方法がわからない</a></h1><div class=post-meta><time class=post-date>2023-06-18 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>0時に寝て7時に起きて8時過ぎまでだらだらしてた。オフィスのエアコンの効き具合がよくなくて昼間暑くてやる気にならなかった。</p><h2 id=tp-link-cloud-api-で-tapo-の制御を調べる>tp-link cloud api で tapo の制御を調べる</h2><p>先日 <a href=/diary/posts/2023/0612/>ifttt で tapo p105 の制御</a> を行った。これが動くということはなんらかのクラウドの api 経由で tapo p105 を制御できている。次の記事をみながらやってみようと試してみた。結論から言ってクラウドの api 経由ではできなかった。</p><ul><li><a href=https://zenn.dev/book000/articles/tp-link-cloud-api>TP-Link cloud APIを使ってみる</a></li></ul><p>アクセストークンを取得する。terminalUUID は適当に生成すればよい。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;: &#34;login&#34;, &#34;params&#34;: {&#34;appType&#34;: &#34;iphone&#34;, &#34;cloudUserName&#34;: &#34;xxx@example.com&#34;, &#34;cloudPassword&#34;: &#34;***&#34;, &#34;terminalUUID&#34;: &#34;bf63e1d0-d5dc-4636-abf1-7eeada585935&#34;}}&#39;</span> https://wap.tplinkcloud.com/ | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: 0,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;result&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;accountId&#34;</span>: <span style=color:#e6db74>&#34;142785160&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;regTime&#34;</span>: <span style=color:#e6db74>&#34;2023-06-11 04:59:43&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;countryCode&#34;</span>: <span style=color:#e6db74>&#34;JP&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;riskDetected&#34;</span>: 0,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>&#34;xxx@example.com&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;token&#34;</span>: <span style=color:#e6db74>&#34;***-***&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>ここで取得したアクセストークンを使ってデバイスの一覧を取得する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;: &#34;getDeviceList&#34;}&#39;</span> https://wap.tplinkcloud.com/?token<span style=color:#f92672>=</span>***-*** | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: 0,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;result&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;deviceList&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceType&#34;</span>: <span style=color:#e6db74>&#34;SMART.TAPOPLUG&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;role&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;fwVer&#34;</span>: <span style=color:#e6db74>&#34;1.3.6 Build 20230308 Rel. 52591&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;appServerUrl&#34;</span>: <span style=color:#e6db74>&#34;https://aps1-wap.tplinkcloud.com&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceRegion&#34;</span>: <span style=color:#e6db74>&#34;ap-southeast-1&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceId&#34;</span>: <span style=color:#e6db74>&#34;802241DA5175CF114E567DE8D72A3094210CB12D&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceName&#34;</span>: <span style=color:#e6db74>&#34;P105&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceHwVer&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alias&#34;</span>: <span style=color:#e6db74>&#34;U21hcnQgUGx1ZyAoS2F6YW1vcmkgT2ZmaWNlKQ==&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceMac&#34;</span>: <span style=color:#e6db74>&#34;482254AC1D25&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;oemId&#34;</span>: <span style=color:#e6db74>&#34;495AC9D888EB711C42A28BECF62071CF&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceModel&#34;</span>: <span style=color:#e6db74>&#34;P105&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hwId&#34;</span>: <span style=color:#e6db74>&#34;58070BD9D8ECC915CD3D6F20A2172712&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;fwId&#34;</span>: <span style=color:#e6db74>&#34;1D18AD293A25ABDE41405B20C6F98816&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;isSameRegion&#34;</span>: true,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>ここまでは従来のスマートプラグと同様に動く。ここから先の手順は従来の hs105 と tapo p105 では手順が異なるみたい。<code>passthrough</code> というメソッドを呼び出してみてもエラーが返ってくる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;:&#34;passthrough&#34;, &#34;params&#34;: {&#34;deviceId&#34;: &#34;802241DA5175CF114E567DE8D72A3094210CB12D&#34;, &#34;requestData&#34;: &#34;{\&#34;system\&#34;:{\&#34;get_sysinfo\&#34;:null},\&#34;emeter\&#34;:{\&#34;get_realtime\&#34;:null}}&#34;}}&#39;</span> https://wap.tplinkcloud.com/?token<span style=color:#f92672>=</span>***-*** | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: -20571,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;Device is offline&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>どうやら tapo シリーズはスマートプラグ自体が web api のエンドポイントを提供していて、ローカルからデバイスの web api を呼び出して制御できるらしい。例えば、次の記事でその手順が書いてあって、同様のやり方で実装した野生のライブラリもたくさんみつかる。</p><ul><li><a href=https://guminote.sakura.ne.jp/archives/911>ESP8266 で Tp-Link のスマートプラグ『Tapo P105』を直接操作する</a></li></ul><p>うちのシェアオフィスのネットワークはローカルの ip アドレスへの通信をすべて拒否しているようなのでこのやり方はうちのオフィスでは検証できない。しかし、tp-link 社のスマホアプリと ifttt の webhook 経由で p105 の制御ができているため、おそらくローカルのエンドポイントに接続する以外の別の手段があるのだと推測する。それをインターネット上で数時間探してみたものの、発見できなかった。この前 interop の展示で聞いた話しだと ifttt は非公開 api を使ってインテグレーションを実装しているという話しだったけど、どうやってクラウド経由で通信しているのだろう？と不思議に思った。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0616/>アイディアのコラボレーション</a></h1><div class=post-meta><time class=post-date>2023-06-16 (Fri.) ::</time></div><span class=post-tags>#<a href=/diary/tags/document/>document</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;
#<a href=/diary/tags/payment/>payment</a>&nbsp;
#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>2時に寝て何度か起きて7時に起きた。今日は勉強会の登板なのになにも準備できてなくてどうしようとか思いながら寝た。</p><h2 id=パッケージングとリリースのドキュメント>パッケージングとリリースのドキュメント</h2><p>5月の落ち穂拾いの時期にプロジェクトの開発ドキュメントを刷新していろいろな要項を書き残している。最後に残ったまだ書いていないドキュメントに次の2つがある。水曜日から課題管理やコードレビューの隙間時間に書き出していって3日ほどかけて一通り書き終えた。私は文章を書くのが遅いのと、1回ですべての内容を網羅できなくて、書いているうちに思い出して追記したり、寝かした文章をあとで見返して推敲したりすることが多い。そのため、ドキュメントを1週間ぐらいかけて書いたりする。</p><ul><li>パッケージング</li><li>リリース</li></ul><p>たまたまメンバーにあるモジュールをリファクタリングのために再実装してもらっている。その開発を完了したら古いモジュールと入れ替える必要があるので、開発だけではなく、パッケージングやリリース周りの作業を把握してもらう、よい機会と言える。これまでパッケージングやリリース周りのインフラはほとんど私が作って運用をまわしてきたので徐々にそれらを引き継ぐタイミングとも言える。開発者はインフラのことを気にせず、アプリケーションを開発してコミットすれば後はすべて ci/cd が自動的にいろいろやってくれて便利ぐらいの感覚で扱えるようにするのが、外資系などではプラットフォームに投資しろと言われたりするものだと推測する。うちらが開発しているプロダクトはコンテナ、RPM、Windows インストーラーとパッケージングする種類が多い。その要項に加えて QA 責任の考え方などについても書いておいた。主には私がいなくなった後に役に立つドキュメントとなるだろう。</p><h2 id=チーム勉強会>チーム勉強会</h2><p>本当は go の generics の勉強会をやりますと先週宣言していた。しかし、私が遊んでいて全然準備できなかったので代わりに決済とスマートプラグの話しをした。<a href=/diary/posts/2023/0612/>先週末と月曜日</a> に作った決済とスマートプラグを組み合わせたもの。サービスや仕組みを簡単に説明して、実際にデモを動かして電球を灯す。</p><figure><img src=/diary/img/2023/0616_payment-and-smartplug.png></figure><p>参加者からスマートプラグをラズベリーパイに置き換えてパワーリレーというモジュールを使えばもっとスマートにできるんじゃないかという意見が出た。たしかにラズベリーパイなら stripe の決済イベントを受け取るサーバーをデバイス内に同梱させることもできるかもしれない。そうすると、スマートプラグのような電源の on/off だけではなく、ラズベリーパイが扱えるセンサーとインテグレーションすることもできそう。また時間のあるときにやってみたい。コラボレーションって正にこういうことを言うとわかってきた。私が1人でこの仕組みを実装していたときにはラズベリーパイというキーワードはまったく頭の中になかった。他者の視点が加わるから新しいアイディアが広がる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0612/>ネットワークからスマートプラグの制御</a></h1><div class=post-meta><time class=post-date>2023-06-12 (Mon.) ::</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>昨日は夕方に親が立ち寄るかもしれないというから待機していたのに空振りに終わった。0時に寝ようとしてあまり眠れなくて7時に起きた。ここ最近寝ているのか寝てないのかよく分からない眠り方になる。</p><h2 id=決済してスマートプラグを-on-にしろ>決済してスマートプラグを ON にしろ</h2><p><a href=/diary/posts/2023/0611/>昨日の続き</a> 。夕方に <a href=https://www.tp-link.com/jp/home-networking/smart-plug/tapo-p105/>Tapo P105</a> が届いたので業務を終えてからさっそく使ってみた。</p><figure><img src=/diary/img/2023/0612_smartplug.jpeg></figure><p>オフィスの wifi に接続して、tp-link 社のスマホアプリからデバイス登録する。スマホアプリからはすぐに on/off できた。スマホで電源の on/off を制御できてあまり嬉しいことはパッと思いつかないけど、プログラムから制御できるならなにか遊べそうな気もしてくる。<a href=https://ifttt.com>ifttt</a> というインテグレーションサービスがあって、それを使うと tp-link 社のデバイスと ifttt 社の web api 経由で制御できる。おそらくなんらかの web api が tp-link 社からも提供されているはず。それが公開されていれば ifttt を使う必要はないし、すでにハックされているものを使うのでもよいかもしれない。ひとまず動かすことを目的とするので ifttt を使う。スマートプラグに電球をつなげて、決済したら電球が灯って3秒後に消えるようなサンプルアプリを作った。一通り最後まで動かすことができておもしろかった。</p><ul><li><a href=https://github.com/kazamori/stripe-webhook-sample>https://github.com/kazamori/stripe-webhook-sample</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0611/>スマートプラグ制御の調査</a></h1><div class=post-meta><time class=post-date>2023-06-11 (Sun.) ::</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/kobe/>kobe</a>&nbsp;
#<a href=/diary/tags/food/>food</a>&nbsp;</span><div class=post-content><p>23時に寝てうまく眠れなくて5時に起きた。そのまま10時ぐらいまでだらだらしてた。</p><h2 id=スマートプラグの通電テスター>スマートプラグの通電テスター</h2><p><a href=/diary/posts/2023/0610/>昨日の続き</a> 。スマートプラグを検索すると TP-Link 社の製品がよく出てくるのでミニスマート wi-fi プラグの <a href=https://www.tp-link.com/jp/home-networking/smart-plug/tapo-p105/>Tapo P105</a> を購入してみた。この製品だとネットワーク経由で電源の on/off ができそう。ifttt というサービスが <a href=https://ifttt.com/tplink_tapo>TP-Link Tapo</a> インテグレーションを公開している。TP-Link 社も自前で <a href=https://www.tplinkcloud.com/>TP-LINK Cloud</a> というサービスを提供していて、どうやらその web api は公開されていないようだけど、おそらくそこで使っている web api を調べてライブラリにしたのが <a href=https://www.npmjs.com/package/tplink-cloud-api>tplink-cloud-api</a> のようにみえる。サイトをみる限りはカメラしかサポートしていないようにもみえる。スマートプラグのようなデバイスがハックしやすい性質のせいか、書いてある情報が曖昧で実際にどうやってデバイスを制御したらよいのかネット上の記事からよくわからない。実際に購入したもので試してみるのが早そう。明日届く予定。</p><p>このスマートプラグによる電源 on/off のテスターに、ダイソーで電球を購入してきた。電源ソケットアダプタが100円、電球は100円、200円、300円とそれぞれあったんだけど、100円の差異でどうせ買うなら精度のよいものをと考えて300円のものを購入した。LED で電力消費も少ない。</p><figure><img src=/diary/img/2023/0611_light.jpeg></figure><p>試しにオフィスにあった amazon 純正スマートプラグ経由で接続して alexa アプリで on/off したら意図したように電球が灯ってテスターの代替にできた。デモのために使うのでそれぐらいわかりやすいのがよい。</p><h2 id=モロゾフ>モロゾフ</h2><p>昨日参加したもくもく会を借りていた <a href=https://www.kobe-bunka.jp/facilities/chuo/>中央区文化センター</a> には2フロアに渡って大小いくつかの会議室がある。それぞれの会議室には張り紙をしていて借り主の名前が外からわかる。たまたま通ったところに「モロゾフ労働組合」と書いてあって、どこかの会社の労組が会議しているんだなと覚えていた。今日になって来週の東京出張のお土産を探していたらモロゾフというお店があることに気付いた。<a href=https://www.morozoff.co.jp/company_ir/history_index.html>モロゾフの歩み</a> によると1931年創業の神戸本店の洋菓子の会社らしい。これもなにかの縁だと思って今回はモロゾフさんの神戸本店へ行って <a href=https://www.morozoff.co.jp/products/baked_sweets/15_3/>ブロードランド 15個入</a> をお土産用に購入した。</p><p>自分用にアーモンドケーキを買って食べてみた。しっとり食感で控え目にアーモンドの風味がして甘過ぎなくて後味のよいケーキでおいしかった。</p><figure><img src=/diary/img/2023/0611_armond-cake.png></figure></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/device/page/2/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class="copyright copyright--user"><span>© 2021 Tetsuya Morimoto</span>
<span>:: Theme made by <a href=https://twitter.com/panr>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>