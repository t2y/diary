<!doctype html><html lang=en><head><title>Device :: </title><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=keywords content><meta name=robots content="noodp"><link rel=canonical href=/diary/tags/device/><link rel=stylesheet href=/diary/styles.css><link rel=stylesheet href=/diary/style.css><link rel="shortcut icon" href=/diary/favicon.ico><meta name=twitter:card content="summary"><meta name=twitter:site content="t2y"><meta name=twitter:creator content><meta property="og:locale" content="en"><meta property="og:type" content="website"><meta property="og:title" content="Device"><meta property="og:description" content><meta property="og:url" content="/diary/tags/device/"><meta property="og:site_name" content><meta property="og:image" content="/diary/favicon.ico"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="627"><link href=/diary/tags/device/index.xml rel=alternate type=application/rss+xml title></head><body class=green><div class="container full headings--one-size"><header class=header><div class=header__inner><div class=header__logo><a href=/diary><div class=logo>forest nook</div></a></div><ul class="menu menu--mobile"><li class=menu__trigger>Menu&nbsp;▾</li><li><ul class=menu__dropdown><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></li></ul></div><nav class=navigation-menu><ul class="navigation-menu__inner menu--desktop"><li><a href=/diary/about>自己紹介</a></li><li><a href=/diary/dates>月別一覧</a></li><li><a href=/diary/tags>タグ一覧</a></li></ul></nav></header><div class=content><h1>Posts for: #Device</h1><div class=posts><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0216/>fitbit にデータを連携していく</a></h1><div class=post-meta><time class=post-date>2024-02-16</time></div><span class=post-tags>#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>3時に寝て7時前に起きた。なぜかいろいろ忙しい。</p><p>今日の運動は腕立て,スクワット,水中ウォーキングをした。統計を <a href="https://docs.google.com/spreadsheets/d/1bg85QtM-LciUgey8I79uI7vW2PEwsP6TVdeIRVkACBg/edit?usp=sharing">運動の記録</a> にまとめる。</p><h2 id=体重計>体重計</h2><p><a href=/diary/posts/2024/0214/#fitbit-で睡眠時間を観察>ながいさんのアドバイス</a> のおかげで anker 製の fitbit 対応の体重計を購入した。<a href=https://apps.apple.com/jp/app/eufylife/id1153481724>EufyLife</a> というアプリを介して bluetooth 接続で体重に関するデータをスマホに取り込む。スペースの都合でスクリーンショットには6つしか表示されていないけど、12項目を計測できる。率と量は同じものだからそれでかさ増ししている感もある。基本的に肥満なのでいろいろ数値は悪いのだけれども、筋肉と骨だけが正常の値を示している。骨は昔から健康診断へ行く度に先生から頑丈だと褒められた記憶がある。筋肉は筋トレを始めて1ヶ月以上経つのでその成果が出てきているのかもしれない。</p><figure><img src=/diary/img/2024/0216_scale.jpg></figure><p>EufyLife アプリに fitbit と apple ヘルスケアへの連携設定がある。それを有効にすることで体重データも fitbit のダッシュボードでも確認できる。fitbit では体重と体脂肪率の2つしか管理していない。もっと細かい数値をみたかったら EufyLife のアプリを参照することになる。それぞれのアプリの用途が異なるので、今後も両方のアプリを使う気がする。</p><h2 id=プール>プール</h2><p>18時半から <a href=https://www.cospa-wellness.co.jp/corp/kobefukushi-sc/>神戸市立市民福祉スポーツセンター</a> のプールへ行ってみた。18時台は10人未満で1コースを1-2人で使っている状態で空いていていいなと思えた。19時まわってから徐々に人が増えていって20人前後になったと思う。平日でもみんなお仕事終えてからプールにくるんやなということがわかった。私が滞在していた1時間強ぐらいの間でも車椅子に乗った方が2人来られていた。土曜日は障がい者専用になっている。普段そういった属性の人たちと接することはないので新鮮に感じた。</p><p>fitbit を付けて歩いたり泳いだりしていたら、監視員の方に「時計は外してください」と注意された。fitbit は時計じゃないんだけど、時計機能も付いているから確かに時計だなと納得してしまった。その後、外して運動していたわけだけど、プールのアクティビティを記録することができない。監視員さんもルールに従って運営しているので、これは偉い人に fitbit をつけてプールに入れるようにルール改定の陳情しないといけないと理解した。</p><p>プールを終えてから元町の kaldi へ <a href=https://www.kaldi.co.jp/ec/pro/disp/1/4571347775105>いぶりがっこのタルタルソース 160g</a> を買いに行った。fitbit を付けてから運動量や消費エネルギーがみえることで有酸素運動のモチベーションが格段に上がった。意味なく少し遠いお店へ歩いて買いものへ行く。あと、いぶりがっこのタルタルソースがめちゃくちゃおいしい。これ考えた人は天才やと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0214/>fitbit おもしろい</a></h1><div class=post-meta><time class=post-date>2024-02-14</time></div><span class=post-tags>#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/founding/>founding</a>&nbsp;</span><div class=post-content><p>2時に寝て6時半過ぎに起きた。これまで眠れない状況の記録のためにこれを書いてきた。しかし、今後は fitbit が記録してくれるからここに書かなくてもよいかもしれない。</p><p>今日の運動は腕立て,スクワット,散歩をした。統計を <a href="https://docs.google.com/spreadsheets/d/1bg85QtM-LciUgey8I79uI7vW2PEwsP6TVdeIRVkACBg/edit?usp=sharing">運動の記録</a> にまとめる。</p><h2 id=fitbit-で睡眠時間を観察>fitbit で睡眠時間を観察</h2><p>fitbit を付けたまま眠ると睡眠時間や睡眠の質も計測できることに気付いた。昨日の睡眠時間がこれ。運動するまでは3時間ほどしか眠れなかったのが、体調がよくなって4時間眠れるようになった。睡眠スコアというものがあってほとんどの人は72〜83のスコアになるらしい。高いほどよい。ぎりぎりだけど、私もまだ普通のクラスにカテゴライズされている。これは意外だった。これも運動の記録のスプレッドシートに一応つけておく。</p><figure><img src=/diary/img/2024/0214_fitbit2.jpg></figure><p>昨日は午後に fitbit が届いたので半日しか付けてなかった。今日はフルで付けていて22時の時点だと次のような数値になる。今日は意識して歩く機会を増やしてみた。遠くのお店へ買いものへ行ったり、トランクルームへ箱を持っていったりした。30分ほど歩くとゾーン時間を稼げる。ゾーン時間とは心拍が上がってトレーニングできているような時間らしい。315分になっていて、平日にこんなずっと歩いていたわけではないので、日常のちょっとした負荷の高い動作でもゾーン時間にカウントされるみたい。毎日このぐらいの運動をしていれば、食べる量さえ調整できれば体重はどんどん落ちていくのではないか？</p><figure><img src=/diary/img/2024/0214_fitbit1.jpg></figure><p>ながいさんから fitbit 対応の体重計もあると教えてもらって、いくつかググってみているうちに Anker Eufy (ユーフィ) Smart Scale C1 が機能と値段のバランスがちょうどよいプロダクトにみえたので購入してみた。</p><p><a href=https://amzn.to/3SVw7mf target=_blank><img src=https://m.media-amazon.com/images/I/51nWBoaSZgL._SX466_.jpg width=240></a></p><h2 id=歯医者で治療>歯医者で治療</h2><p>前回の定期歯科検診で、歯の掃除をしてもらっているときに奥歯の銀の詰めものが外れてしまった。いつ治療したのかも覚えてないぐらいの昔 (10年以上？) のものなので寿命だろうと思う。歯医者さんが言うのは選択肢が3つあるという。</p><ol><li>銀の詰めものを付け直す</li><li>別の詰めものを付け直す</li><li>虫歯の治療をして別の詰めものを付け直す</li></ol><p>詰めものの下は虫歯になっていたらしい。せっかくの機会だから虫歯も直した方がよいだろうと思って3番目の治療をすることにした。今日は虫歯の治療で歯を削る日になる。麻酔をしてくれたものの、麻酔が全然効かなくて最終的には6回追加で麻酔した。マンガによくあるような「こいつ、毒が効かないのか？！」みたいな毒耐性を発揮して薬も効かないキャラクターみたいになってしまっていた。もはや途中から歯を削る恐怖よりも麻酔が効かないんじゃないかの恐怖とたたかっていた。痛くないように麻酔うってくれているのに、めっちゃ痛いんやからね。これはこの世のわりと高いのレベルの恐怖やわ。なんとかやり終えたが、もう今日は何もしないと思うぐらい疲れた。fitbit はこの心拍数の上昇をゾーン時間と勘違いしたのではないか？</p><h2 id=トランクルームのその後>トランクルームのその後</h2><p>オフィスに電子レンジを購入したのでその箱を歩いて持っていった。借りているスペースの半分ぐらいは埋まりつつある。これだけの箱を部屋に置いておく邪魔さを考慮すると借りてよかったなと思える。明日はモニターの箱も歩いてもっていこう。この歳になるとモチベーション管理が難しい。居住環境でストレスになるものはお金で排除していって集中力を維持できるようにしたい。</p><figure><img src=/diary/img/2024/0214_trunkroom.jpg></figure></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0213/>fitbit を買ってみた</a></h1><div class=post-meta><time class=post-date>2024-02-13</time></div><span class=post-tags>#<a href=/diary/tags/founding/>founding</a>&nbsp;
#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/statistic/>statistic</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>2時半に寝て5時過ぎに起きてホットクックで玄米ごはんをスタートしてまた寝て6時半に起きた。</p><p>今日の運動はレッグレイズ(椅子),腹筋ローラー,スクワット,背筋をした。統計を <a href="https://docs.google.com/spreadsheets/d/1bg85QtM-LciUgey8I79uI7vW2PEwsP6TVdeIRVkACBg/edit?usp=sharing">運動の記録</a> にまとめる。</p><h2 id=トランクルームへの搬出>トランクルームへの搬出</h2><p>昨日、契約をまとめたので祝日の深夜0時過ぎに車に荷物を積み込んで搬出した。繁華街の通り沿いにあるビルにトランクルームがある。繁華街でもさすがに平日前の深夜には誰もいなくて狭い通りではあるけど、車をビルに横付けしても迷惑にはならないように思える。サーバー類の箱、ホットクックの箱、その他、大きめの箱、あともともとオフィスに備え付けされてた椅子をマンションの部屋で保管してもの、防災向けの水と食べもの、置いておくだけの場所を大きく取っていたものをトランクルームへ移動させた。邪魔なモノがなくなって部屋が広くなって快適。</p><p><figure><img src=/diary/img/2024/0213_trunkroom1.jpg></figure><figure><img src=/diary/img/2024/0213_trunkroom2.jpg></figure></p><h2 id=fitbit-charge-6-を購入>fitbit charge 6 を購入</h2><p>運動の盛り上がりを支援するため、歩数と距離を取得するために購入した。お昼過ぎに届いて充電してそれから付けている。初期設定するとき、ある程度、充電しないとデバイスとスマホアプリの初回同期が途中でローバッテリーとやらでエラーになる。何度かやってみてダウンロードを始めるもののすぐにエラーになっていた。しばらく放置して充電してバッテリーが50%以上の状態になってから成功したような気がする。</p><p>2017年ぐらいに JJUG イベントで会ったときに元同僚が fitbit を付けていて、いろいろ話しを聞いて当時もよさそうにみえたけど、私は運動とかやらないなと思ってそのときは買わなかった。なぜそのときから運動しなかった、自分という、後悔先に立たず。いま運動の記録に散歩の距離を、私の感覚で適当に付けている。実際の数値は全く当てにならない。そして別に意図的な散歩ではなくても、たまたま遠くの飲食店へ行ったとか、出張であちこち移動したとか、そういう日もある。今日も近所のクリニックに歩いて往復しただけで距離数やエネルギー消費を稼いだ。今後は運動のための散歩という形態ではなく、その日の歩数と距離数として運動の記録に付けていく。bluetooth 接続でスマホアプリと fitbit が同期する。</p><p>私が fitbit 初心者なので他にどんな指標が役に立つのか、まだよくわかっていない。消費エネルギーがカロリーとして表示される。これで毎日 3000-5000 ぐらい消費するように運動すればいいといった目安になる。</p><figure><img src=/diary/img/2024/0213_fitbit1.jpg></figure><p>fitbit に詳しい人がいたら使い方を教えてほしい。公式に日本語の <a href=https://community.fitbit.com/t5/%E3%82%B3%E3%83%9F%E3%83%A5%E3%83%8B%E3%83%86%E3%82%A3/ct-p/JP>Fitbit コミュニティ</a> も用意されていた。これはカスタマーサポートの工数削減が目的かな。また暇なときに眺めてみる。</p><p><a href=https://amzn.to/3OLJB1l target=_blank><img src=https://m.media-amazon.com/images/I/51DVHlsQX2L._AC_SX679_.jpg width=240></a></p><h2 id=睡眠外来に行く>睡眠外来に行く</h2><p><a href=/diary/posts/2024/0204/>格闘家に学ぶ体脂肪コントロール</a> 本に代謝には疲労回復を促す睡眠が大事だと書いてあった。最近、運動していていつもより眠れるようになった気はするけど、運動する時間の分だけ可処分時間を圧迫して作業やお仕事の時間が削られて終わらなくなって、その補填に睡眠時間を削るという悪循環になっている。どうせ寝ても3時間しか眠れないのだからと睡眠は諦めていたものの、代謝をよくするためには睡眠も改善していく必要がある。私はいびきもあるのでそれも改善できれば睡眠の質がよくなるのではないかと考えた。</p><p>近所のクリニックの睡眠外来へ行ってみる。一通り状況をお医者さんに説明して、まずはいろいろ検査してみましょうということで、後日、検査キットを使って睡眠時無呼吸症候群の検査も行う。今日のところは肺活量と血圧と採血をした。血圧は高めだったらしく「普段どのぐらいですか？健康診断のときは？」と聞かれて「健康診断はもう5年ぐらいやってないです。覚えてません。」と答えたら、看護師が「こいつ、やばいやつだ。」みたいな空気になって、それ以上はなにも聞かれなかった。</p><p>コロナ禍以降、不摂生な生活を続けてきたので身体の数値は悪いだろうと推測する。それも含めて今年はカラダを整えていくことに注力しようと思う。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0127/>かきまぜという進化</a></h1><div class=post-meta><time class=post-date>2024-01-27</time></div><span class=post-tags>#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/noh/>noh</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/recipe/>recipe</a>&nbsp;</span><div class=post-content><p>2時過ぎに寝て6時半に起きた。晩ご飯食べてからちょっと自転車で走って運動してオフィスで軽く作業するつもりが、ブログ読んだりして結局意図した作業ができなかった。</p><p>今日の筋トレは腹筋ローラー:5x1,スクワット:20x1,縄跳び(両足跳)30x3をした。腹筋ローラーは腹筋も使うけど、肩や腕の筋肉もパンパンになっている。</p><h2 id=ストレッチ>ストレッチ</h2><p>筋トレを継続しているので軽い筋肉痛を引きずったままストレッチを受ける。トレーナーさんもストレッチしていて、体が硬めにみえるという話しはあるものの、筋肉痛をストレッチで伸ばすのは悪いことではないので問題ないという。昨日ルミナリエの案内に歩き回ったせいか足も腰もやや疲労していた。お尻の後ろのツボのようなところも普段平気なのに効いた気がする。トレーナーさんとネットで調べた情報をベースに筋トレの話しをしていて、毎日同じメニューをこなすよりも違うメニューをやった方が筋肉が回復する日を設けられて効果的らしい。ちょうどいま習慣化できてきたタイミングでいくつかメニューを増やそうとしているので1週間の筋トレのメニュー作りをしてもよいかもしれない。今日の開脚幅は開始前152cmで、ストレッチ後156cmだった。</p><h2 id=縄跳びの跳び方>縄跳びの跳び方</h2><p>筋トレのメニューの1つにしようと FEELCAT なわとびを購入してみた。</p><p><a href=https://amzn.to/49e0QAl target=_blank><img src=https://m.media-amazon.com/images/I/61dx3mllMrL._AC_SL1186_.jpg width=240></a></p><p>今日届いたので長さを調節して早速オフィスの近所の駐車場へ行ってやってみた。縄跳びなんか学校の体育でやって以降やったことないんじゃないかとすら思えた。最初はどうやって跳ぶんだっけ？みたいなところから始めて、段々記憶が戻ってきてリズムよく跳べるようになった。長さ調節の説明書に初心者は少したるむ感じの長い方がよいと書いてあったから長めに調節していたものの、跳んでみると縄がたるんだ分の回転するリズムが自分の感覚と違って返って跳びにくかった。戻ってきてさらに短く適性な長さに調節した。ひとまず両足跳び30回を3セット跳んでみた。これだけで息が切れた。</p><p>縄跳びの動画をみていて回数をこなすよりも跳び続ける秒数を測った方がよいようにみえる。これなら縄跳びが上達することで同じ時間でも回数が増えて負荷を上げていくのにちょうどよさそうに思える。まだ両足跳びも怪しいので慣れてきたら時間に移行していく。他のいろんな跳び方にも挑戦したい。</p><div class=video-container><iframe src=https://www.youtube.com/embed/OBjA8bCImS8 allowfullscreen title=なわとびトレーニング6種目3サイクル10分></iframe></div><ul><li><a href=https://www3.nhk.or.jp/sports/story/8956/>短時間で効率的！全身を鍛える”縄跳び”トレーニング 完全版</a></li></ul><h2 id=能楽の勉強>能楽の勉強</h2><p>4半期に1回ぐらいの「能のことばを読んでみる会」へ行ってきた。<a href=/diary/posts/2023/1021/#能楽の勉強>前回の所感はここ</a> 。久しぶりで最寄り駅は阪急芦屋川駅なのに、なぜか阪神だと勘違いしていて阪神芦屋駅に行ってしまい、そこから速歩きで20分かけて芦屋能楽堂に辿り着いた。1kmほど歩いた。そのせいで10分ほど遅刻した。よい運動にはなったけれど。</p><p>今回のお題は「難波」という、世阿弥の祝言能だという。世阿弥が自筆した本物の文献は国の重要文化財としてお寺に保管されている。その文献をすべて写真に撮ったものを影印 (えいいん) と呼び <a href=https://www.iwanami.co.jp/book/b265634.html>世阿弥自筆能本集</a> として販売されている。講師の朝原さんがその本を持ってこられてみせていただいた。おそらく難波の詞章もそこに書かれていたのだと思う。現代人は世阿弥の自筆をそのまま読めないが、びっしりとカタカナが書かれていた。発音どおりの表記をするために意図的に漢字やひらがなを使わずにカタカナで書いたと考えられている。この文献は世阿弥が自筆したことは間違いないが、書いてある内容がすべて世阿弥のオリジナルかどうかまではわかっていない。世阿弥が活躍したのは室町時代なので本は書き写すしかなかった。他人の創作物や文献を世阿弥が書き写した可能性もある。</p><ul><li><a href=https://nohgaku-kyodo.com/repertoire/yondemiru-naniwa20240127>《難波》 第37回能のことばを読んでみる会</a></li></ul><p>朝原さんによると、現代に伝わっている難波の詞章の内容と、世阿弥が自筆した文献に書いてある内容はいくつか食い違っているという。その理由としていくつかの仮説が考察される。</p><ul><li>世阿弥が書いたものは編集中の草稿だったのではないか</li><li>世阿弥が書いたものを現代まで伝わる過程で誰かが改変したのではないか</li><li>実は難波が誰かの創作物で、世阿弥はそれを書き写したものの、それはオリジナルではなかったのではないか</li></ul><p>難波の次第は次の言葉から始まる。</p><blockquote><p>山も霞みて浦の春。山も霞みて浦の春。波風静かなりけり</p></blockquote><p>七・五・七・五・七・四と七五調になっている。この冒頭の音を聞くだけで、いまから始まる物語はきれいな美しい物語を展開するよという意図が込められているという。また「波風静か」とは能の中では世の中が平和ですよという意味をもっているという。</p><blockquote><p>やまもかすみて うらのはる やまもかすみて うらのはる なみかぜしずか なりけり</p></blockquote><p>といった具合に、この1文だけで解説が10分といった、いつも通りの詳細な解説で進んでいく。</p><p>難波は <a href=https://ja.wikipedia.org/wiki/%E4%BB%81%E5%BE%B3%E5%A4%A9%E7%9A%87>仁徳天皇</a> の仁政を讃える内容となっている。所々、仁徳天皇の徳によってなにもしなくても平和で穏やかで人々は幸せに暮らしているみたいな表現が出てくる。現代人が習った仁徳天皇という呼び名は、奈良時代中期に中国を真似て漢字2文字で天皇の名前を表すようになって以降の話しだという。したがって奈良時代に成立した <a href=https://ja.wikipedia.org/wiki/%E6%97%A5%E6%9C%AC%E6%9B%B8%E7%B4%80>日本書紀</a> では仁徳天皇という名前は出ておらず、仁徳天皇を表す大鷦鷯尊 (おおさざきのみこと) という日本式の名前が使われている。難波の中でもその名前で出てくる。こういった漢字2文字で天皇の名前を表す以前の日本式の天皇名前を <a href=https://ja.wikipedia.org/wiki/%E8%AB%A1>和風諡号</a> と呼ぶらしい。</p><blockquote><p>咲くや木 (こ) の花 冬籠り</p></blockquote><p>「木の花」は「こそあど」言葉の指示語としての「これ」の意図がある。わざわざ「木の花」とあるのは <a href=https://ja.wikipedia.org/wiki/%E3%82%B3%E3%83%8E%E3%83%8F%E3%83%8A%E3%83%8E%E3%82%B5%E3%82%AF%E3%83%A4%E3%83%93%E3%83%A1>木花開耶姫 (このはなのさくやびめ)</a> と掛けているのだという。しかし、木花開耶姫は桜の女神 (または火山の女神？) として現代では伝わっている。難波の物語で出てくるのは梅についての問答なのに木花開耶姫が出てくるのはそもそもおかしいのだけど、当時は梅の女神でもあったのか？それともただ言葉を掛けただけなのか？といった複数の考察ができるという。</p><p>難波の物語自体は仁徳天皇がいかに素晴らしくて、その治世によって世の中は平和で美しくて、様々な情景を浮かべるような表現がたくさん出てくる。もし能をみて幻視できる人であれば、暖かくて穏やかで華やかな景色をたくさん眺められるのだと思う。いつもどおり和歌や漢詩の引用があちこちにあって、朝原さんも解説しきれないぐらいの背景の脱線しまくりしながら進めていた。おもしろかった。</p><h2 id=ホットクックに初挑戦>ホットクックに初挑戦</h2><p>先週末に <a href=/diary/posts/2024/0120/#部屋のレイアウト変更>部屋のレイアウト変更</a> してホットクックのための居場所を作った。その翌日の日曜日は出掛けてそのまま外食して、平日はなぜかいろいろ忙しくて、夜に用事があったり、寒くてスーパー行くのが億劫で冷凍食品で晩ご飯を済ませたりしているうちに1週間が過ぎてしまった。今日は満を持してスーパーへ出掛け、食材を購入してきた。最初は作り方や材料をよく知っていて慣れたものがよいだろうと思ってカレーにした。<a href=https://jp.sharp/hotcook/>ホットクック</a> は KN-HW24G を購入した。大き過ぎたかな？とも思ったけど、実際に作ってみたらスーパーで買ってきた食材を使い切って3食分ぐらいの作りおきにするにはちょうどよいサイズに思える。</p><p>牛すじカレーを作ってみた。約1時間。レシピはこんなところ。</p><ul><li>牛すじ 400-500g</li><li>玉ねぎ x 2</li><li>にんじん x 1</li><li>さつまいも x 1</li><li>じゃがいも x 2</li><li>ミディアムトマト x 8</li><li>しめじ</li><li>水 100 cc</li><li>業務カレールウ 1箱 (業務スーパーで売っているPB)</li></ul><figure><img src=/diary/img/2024/0127_hotcook.jpg></figure><p>私はどろどろカレー派なので水分の少ないこういうカレーは好みの方。牛すじも思ったより煮込めていてよい感じだった。従来の圧力鍋で作ったカレーと食べ比べしないとわからないぐらいには、いつも作っているカレーの水分少なめのカレーが出来上がった。普通においしかったと思う。食材を切って鍋に入れるところまでは圧力鍋と同じだが、カレールウまで最初から入れてしまうというのが従来の調理と大きく異なる。圧力鍋なら火を通した後に蓋を開けてからカレールウを入れてかきまぜるという調理が必要になる。さらにホットクックでは調理中にも食材をかきまぜるから <a href=https://jp.sharp/hotcook/products/knhw24g/feature/cook/>味がしみ込む</a> という。圧力鍋とホットクックの大きな違いの1つとして「かきまぜ」を自動化したことで手間をなくして料理の質も上げたようにみえる。素材の栄養も逃げないからこれは素晴らしい。</p><ul><li><a href=https://kakedashiwanko.com/hotcook-use/>【ホットクックを使いこなす】365日使い倒した私が使い方を徹底解説</a></li></ul><p>またホットクックは料理を作った後にそのまま保温ができる。今回作ったカレーをひとまず保温にしてみた。但し、この保温温度は75℃と細菌が繁殖しない設定になっているのでご飯の保温には向かないとのこと。保温と似て非なる機能が予約調理になる。予約調理は次の図のように、まず一旦火を通した上で適温をキープして最後の仕上げになる。夜に予約したら深夜のうちにできてしまって朝まで保温するような仕組みにみえる。夜にセットして朝食べるか、朝にセットして夜に食べるか、どちらのパターンもありそう。</p><img src=https://jp.sharp/hotcook/products/knhw24g/feature/cook/images/sub08-1.jpg width=480><p>理想的な1日だと6-7時頃に起きて8時過ぎにオフィスへ行って18-19時までお手伝い先のお仕事をして、一旦家に帰ってきて晩ご飯を食べて、またオフィスへ戻って21-24時ぐらいまで自分の会社のお仕事をする。晩ご飯が遅くなっても若い頃はなにも起きなかったが、いまは寝る前に晩ご飯を食べると最悪の状況では吐く。ここで21時頃に家でくつろいでいると、もう働きたくなくなってオフィスへ戻らないときもちょくちょくある。要はさぼってしまう。人間が弱い。</p><p>オフィスには <a href=/diary/posts/2023/0725/#小さい冷蔵庫>冷蔵庫</a> もあるから、ホットクック用の食材セットを冷蔵庫に保管しておいて、オフィスにも小さいホットクックを置いといたらそのまま晩ご飯を食べられるのではないかと考え始めた。フロアには給湯室もあるからご飯を食べてからホットクックの鍋を洗うこともできるだろう。徒歩5分で家に帰れるのだから帰ったらよいと普通なら考えると思う。当初は私もそう考えた。オフィスにいたらいくらでも働けるのに、家に帰ったらもう働きたくないという誘惑に打ち克つのはなかなか厳しい。理想的ではない1日だと18-19時頃にお手伝い先のお仕事を終えて、そのまま22時頃まで自分の会社のお仕事をする。そうすると晩ご飯が23時をまわってしまい、そのまま寝たら気分が悪くて3時頃に食べたものを吐いて眠れないというのが最悪の状況になる。それも何度かやってもう慣れたけれど。</p><p>閑話休題。調理に「かきまぜ」という進化をもたらしたことがこれほどすごいことだと理解できていなかった。ということでオフィス用に一番小さい KN-HW10G を購入してみた。また今度、家とオフィスのダブルホットクックの運用も考えてみる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2024/0125/>会社でもテックブログを読む会を始めた</a></h1><div class=post-meta><time class=post-date>2024-01-25</time></div><span class=post-tags>#<a href=/diary/tags/exercise/>exercise</a>&nbsp;
#<a href=/diary/tags/health/>health</a>&nbsp;
#<a href=/diary/tags/blog/>blog</a>&nbsp;
#<a href=/diary/tags/event/>event</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>昨日は疲れて21時頃から横になってうたた寝したりしながら何度か起きて6時半に起きた。</p><p>今日の筋トレは腹筋:10x2,腹筋ローラー:5x2,腕立て:15x1,スクワット:20x1,背筋:10x1をした。</p><h2 id=筋トレのメニュー追加>筋トレのメニュー追加</h2><p>だいぶ筋トレにも慣れてきてもう習慣化の壁は超えたかな？といったところ。そろそろ同じメニューばかりしているのも飽きてきたのでいくつか追加してみようと思う。過去に働いていた会社で腹筋ローラーをみんなでやったことがあったとふと思い出した。探したら家のクローゼットの奥から出てきた。久しぶりに腹筋ローラーやったらめっちゃしんどい。筋肉が落ちているんやな。さらにストレッチのトレーナーさんと話していて背筋もやったらどう？とアドバイスを受けたのでそれも追加してみることにした。</p><div class=video-container><iframe src=https://www.youtube.com/embed/n0Oa8IsJfzE allowfullscreen title=腹筋を割る！初心者でもできる腹筋ローラーの正しいやり方></iframe></div><h2 id=社内版テックブログを読む会をやってみた>社内版テックブログを読む会をやってみた</h2><p><a href=/diary/posts/2023/1210/#2023年ふりかえり>年末のふりかえりイベントで西原さんにテックブログを読む会のこと</a> を教えてもらった。その後、公けにやっているそのイベントに参加させてもらって、やり方の流れやコツなどを実際に参加して学んでいた。1ヶ月ほど通ったのでその経験をもとにお手伝い先の社内でも導入することに、半ば、私が強引に決めた。メンバーから開発の時間が少なくなるという懸念の声も上がった。それは私も理解できる。しかし、これはやった方が中長期でみてよいはず。「おれのサイドエフェクトがそう言ってる」気がする。</p><p>私は会議が嫌いな方なので、できる限り、チーム参加型の同期イベントを増やしたくないという思いがある。そんな私からみても、このイベントには価値があるとコミュニティイベントに15年以上参加してきて直感的に感じるものがある。たった30分のイベントだが価値がある。価値のあることだけを30分に凝縮している。洗練されている。一般人は内容も中身もシンプルですごく簡単に思うかもしれないが、このイベントを企画するには多くの試行錯誤を経ていることが私にはわかる。「恐ろしく速い手刀。オレでなきゃ見逃しちゃうね」と一般人では気付けまい。</p><p>第1回をチームでやってみた。30分でメンバーは記事を読んで所感を話して意図したようにうまく進行できたと思う。毎週30分。まずはこれを1ヶ月継続してみてメンバーの感想を聞いてみようと思う。</p><figure><img src=/diary/img/2024/0125_slack-channel.png></figure><h2 id=間接照明の受け取り>間接照明の受け取り</h2><p>ジモティーでアジア雑貨風の照明を500円で購入した。ニトリ製のようだ。これも実家のコワーキングスペースで使おうと考えている。もともと1000円で出品されていて、悪くはないけど、1000円はやや高いかなと見送っていた。何ヶ月かしてから値下げして500円になったので問い合わせしたら交渉が成立した。当初は東灘区まで取りに行くつもりが、出品者の実家が三ノ宮にあったそうで三ノ宮で受け渡しできた。電球をもっと明るいのに取り替えたら十分に間接照明として使えそう。</p><figure><img src=/diary/img/2024/0125_light.jpg></figure></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/1217/>田んぼ休暇</a></h1><div class=post-meta><time class=post-date>2023-12-17</time></div><span class=post-tags>#<a href=/diary/tags/day-off/>day off</a>&nbsp;
#<a href=/diary/tags/life/>life</a>&nbsp;
#<a href=/diary/tags/agriculture/>agriculture</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>1時に寝て5時半に起きてだらだらしてゲームをちょっとやって7時半に起きた。なぜか分からないけど、実家で寝ると普段3時間ぐらいしか睡眠できないのが4-5時間に伸びる。気圧？空気？土地の守りみたいなもん？夕方には神戸に戻ってきていたが、寒さで凍えたのもあってそれから作業する元気がなかった。</p><h2 id=田んぼ>田んぼ</h2><p>8時からトラクターで田んぼを耕す。昨日は暖かったのに一晩寝たら急に冷え込んだ。うちのトラクターは旧式なのでエアコンはついてなく、風を遮るものもないので風の強い気温の低い日はめっちゃ寒い。3時間ほど耕して畝を作った。写真は撮り忘れた。今回耕したところの畑は高低差ができてしまってよく耕せるところとそうじゃないところができて、あまりうまく耕せなかった。いずれ平坦にならさないといけない。</p><p>田んぼを終えてから近所の観光客向けの食堂でぶり丼を食べた。これで1,250円とやや割高ではあるけれど、ぶりの刺身は新鮮で質のよく、久しぶりにおいしいお刺身を食べた。若い子にとっては量が物足りないかも？だが、中年にとってはこのぐらいの量でちょうどよい。</p><figure><img src=/diary/img/2023/1217_buri-don.jpeg></figure><h2 id=スマートキーの電池交換>スマートキーの電池交換</h2><p>車のメーターパネルにスマートキーの電池残量低下という案内が出るようになった。調べてみると、スマートキーは常に電波を放出しているので短くて1年、長くても2年で電池が切れるという。ちょうどいま1年近く乗ったところなのでうちのスマートキーは1年程度で電池が切れるようだ。電池が切れたら車に乗れないのかな？と調べてみたらそうでもなくて、スマートキーに内蔵キーと呼ばれる物理キーも用意されていてそれでドアの施錠の開閉ができて、さらにエンジンのスタートも電池が切れていてもできる仕組みになっているそうな。そりゃそうか。電池切れる度に車に乗れなくなっていたら世の中もっと混沌としている。</p><ul><li><a href=https://www.honda.co.jp/ownersmanual/webom/jpn/fit/2020/details/136179090-4423.html>Hondaスマートキー</a></li><li><a href=https://www.honda.co.jp/ownersmanual/webom/jpn/fit/2020/details/136179090-14211.html>Hondaスマートキーの取り扱いと電池交換</a></li></ul><h2 id=ストレッチ>ストレッチ</h2><p>土日は実家に帰っていたので日曜日の夜にストレッチを受ける。土日に車で実家との往復をすると腰に負荷がかかる。さらに田んぼを耕すためにトラクターに数時間座って操作しているのでさらに追加で負荷がかかる。その目論見の通り、トレーナーさんの言葉からも、自他ともに今日は腰がもっとも疲弊していた。今日の開脚幅は開始前152cmで、ストレッチ後156cmだった。ストレッチ後に晩ご飯食べてからオフィスで作業するつもりが、外が寒くて出掛けるの億劫になってそのまま家でだらだらしていた。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0618/>クラウド経由で tapo を制御する方法がわからない</a></h1><div class=post-meta><time class=post-date>2023-06-18</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>0時に寝て7時に起きて8時過ぎまでだらだらしてた。オフィスのエアコンの効き具合がよくなくて昼間暑くてやる気にならなかった。</p><h2 id=tp-link-cloud-api-で-tapo-の制御を調べる>tp-link cloud api で tapo の制御を調べる</h2><p>先日 <a href=/diary/posts/2023/0612/>ifttt で tapo p105 の制御</a> を行った。これが動くということはなんらかのクラウドの api 経由で tapo p105 を制御できている。次の記事をみながらやってみようと試してみた。結論から言ってクラウドの api 経由ではできなかった。</p><ul><li><a href=https://zenn.dev/book000/articles/tp-link-cloud-api>TP-Link cloud APIを使ってみる</a></li></ul><p>アクセストークンを取得する。terminalUUID は適当に生成すればよい。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;: &#34;login&#34;, &#34;params&#34;: {&#34;appType&#34;: &#34;iphone&#34;, &#34;cloudUserName&#34;: &#34;xxx@example.com&#34;, &#34;cloudPassword&#34;: &#34;***&#34;, &#34;terminalUUID&#34;: &#34;bf63e1d0-d5dc-4636-abf1-7eeada585935&#34;}}&#39;</span> https://wap.tplinkcloud.com/ | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: 0,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;result&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;accountId&#34;</span>: <span style=color:#e6db74>&#34;142785160&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;regTime&#34;</span>: <span style=color:#e6db74>&#34;2023-06-11 04:59:43&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;countryCode&#34;</span>: <span style=color:#e6db74>&#34;JP&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;riskDetected&#34;</span>: 0,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;email&#34;</span>: <span style=color:#e6db74>&#34;xxx@example.com&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;token&#34;</span>: <span style=color:#e6db74>&#34;***-***&#34;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>ここで取得したアクセストークンを使ってデバイスの一覧を取得する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;: &#34;getDeviceList&#34;}&#39;</span> https://wap.tplinkcloud.com/?token<span style=color:#f92672>=</span>***-*** | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: 0,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;result&#34;</span>: <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;deviceList&#34;</span>: <span style=color:#f92672>[</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceType&#34;</span>: <span style=color:#e6db74>&#34;SMART.TAPOPLUG&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;role&#34;</span>: 0,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;fwVer&#34;</span>: <span style=color:#e6db74>&#34;1.3.6 Build 20230308 Rel. 52591&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;appServerUrl&#34;</span>: <span style=color:#e6db74>&#34;https://aps1-wap.tplinkcloud.com&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceRegion&#34;</span>: <span style=color:#e6db74>&#34;ap-southeast-1&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceId&#34;</span>: <span style=color:#e6db74>&#34;802241DA5175CF114E567DE8D72A3094210CB12D&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceName&#34;</span>: <span style=color:#e6db74>&#34;P105&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceHwVer&#34;</span>: <span style=color:#e6db74>&#34;1.0.0&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;alias&#34;</span>: <span style=color:#e6db74>&#34;U21hcnQgUGx1ZyAoS2F6YW1vcmkgT2ZmaWNlKQ==&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceMac&#34;</span>: <span style=color:#e6db74>&#34;482254AC1D25&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;oemId&#34;</span>: <span style=color:#e6db74>&#34;495AC9D888EB711C42A28BECF62071CF&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;deviceModel&#34;</span>: <span style=color:#e6db74>&#34;P105&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;hwId&#34;</span>: <span style=color:#e6db74>&#34;58070BD9D8ECC915CD3D6F20A2172712&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;fwId&#34;</span>: <span style=color:#e6db74>&#34;1D18AD293A25ABDE41405B20C6F98816&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;isSameRegion&#34;</span>: true,
</span></span><span style=display:flex><span>        <span style=color:#e6db74>&#34;status&#34;</span>: <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>ここまでは従来のスマートプラグと同様に動く。ここから先の手順は従来の hs105 と tapo p105 では手順が異なるみたい。<code>passthrough</code> というメソッドを呼び出してみてもエラーが返ってくる。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -X POST -H <span style=color:#e6db74>&#34;Content-Type: application/json&#34;</span> -d <span style=color:#e6db74>&#39;{&#34;method&#34;:&#34;passthrough&#34;, &#34;params&#34;: {&#34;deviceId&#34;: &#34;802241DA5175CF114E567DE8D72A3094210CB12D&#34;, &#34;requestData&#34;: &#34;{\&#34;system\&#34;:{\&#34;get_sysinfo\&#34;:null},\&#34;emeter\&#34;:{\&#34;get_realtime\&#34;:null}}&#34;}}&#39;</span> https://wap.tplinkcloud.com/?token<span style=color:#f92672>=</span>***-*** | jq .
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;error_code&#34;</span>: -20571,
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;msg&#34;</span>: <span style=color:#e6db74>&#34;Device is offline&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>どうやら tapo シリーズはスマートプラグ自体が web api のエンドポイントを提供していて、ローカルからデバイスの web api を呼び出して制御できるらしい。例えば、次の記事でその手順が書いてあって、同様のやり方で実装した野生のライブラリもたくさんみつかる。</p><ul><li><a href=https://guminote.sakura.ne.jp/archives/911>ESP8266 で Tp-Link のスマートプラグ『Tapo P105』を直接操作する</a></li></ul><p>うちのシェアオフィスのネットワークはローカルの ip アドレスへの通信をすべて拒否しているようなのでこのやり方はうちのオフィスでは検証できない。しかし、tp-link 社のスマホアプリと ifttt の webhook 経由で p105 の制御ができているため、おそらくローカルのエンドポイントに接続する以外の別の手段があるのだと推測する。それをインターネット上で数時間探してみたものの、発見できなかった。この前 interop の展示で聞いた話しだと ifttt は非公開 api を使ってインテグレーションを実装しているという話しだったけど、どうやってクラウド経由で通信しているのだろう？と不思議に思った。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0616/>アイディアのコラボレーション</a></h1><div class=post-meta><time class=post-date>2023-06-16</time></div><span class=post-tags>#<a href=/diary/tags/document/>document</a>&nbsp;
#<a href=/diary/tags/infrastructure/>infrastructure</a>&nbsp;
#<a href=/diary/tags/payment/>payment</a>&nbsp;
#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>2時に寝て何度か起きて7時に起きた。今日は勉強会の登板なのになにも準備できてなくてどうしようとか思いながら寝た。</p><h2 id=パッケージングとリリースのドキュメント>パッケージングとリリースのドキュメント</h2><p>5月の落ち穂拾いの時期にプロジェクトの開発ドキュメントを刷新していろいろな要項を書き残している。最後に残ったまだ書いていないドキュメントに次の2つがある。水曜日から課題管理やコードレビューの隙間時間に書き出していって3日ほどかけて一通り書き終えた。私は文章を書くのが遅いのと、1回ですべての内容を網羅できなくて、書いているうちに思い出して追記したり、寝かした文章をあとで見返して推敲したりすることが多い。そのため、ドキュメントを1週間ぐらいかけて書いたりする。</p><ul><li>パッケージング</li><li>リリース</li></ul><p>たまたまメンバーにあるモジュールをリファクタリングのために再実装してもらっている。その開発を完了したら古いモジュールと入れ替える必要があるので、開発だけではなく、パッケージングやリリース周りの作業を把握してもらう、よい機会と言える。これまでパッケージングやリリース周りのインフラはほとんど私が作って運用をまわしてきたので徐々にそれらを引き継ぐタイミングとも言える。開発者はインフラのことを気にせず、アプリケーションを開発してコミットすれば後はすべて ci/cd が自動的にいろいろやってくれて便利ぐらいの感覚で扱えるようにするのが、外資系などではプラットフォームに投資しろと言われたりするものだと推測する。うちらが開発しているプロダクトはコンテナ、RPM、Windows インストーラーとパッケージングする種類が多い。その要項に加えて QA 責任の考え方などについても書いておいた。主には私がいなくなった後に役に立つドキュメントとなるだろう。</p><h2 id=チーム勉強会>チーム勉強会</h2><p>本当は go の generics の勉強会をやりますと先週宣言していた。しかし、私が遊んでいて全然準備できなかったので代わりに決済とスマートプラグの話しをした。<a href=/diary/posts/2023/0612/>先週末と月曜日</a> に作った決済とスマートプラグを組み合わせたもの。サービスや仕組みを簡単に説明して、実際にデモを動かして電球を灯す。</p><figure><img src=/diary/img/2023/0616_payment-and-smartplug.png></figure><p>参加者からスマートプラグをラズベリーパイに置き換えてパワーリレーというモジュールを使えばもっとスマートにできるんじゃないかという意見が出た。たしかにラズベリーパイなら stripe の決済イベントを受け取るサーバーをデバイス内に同梱させることもできるかもしれない。そうすると、スマートプラグのような電源の on/off だけではなく、ラズベリーパイが扱えるセンサーとインテグレーションすることもできそう。また時間のあるときにやってみたい。コラボレーションって正にこういうことを言うとわかってきた。私が1人でこの仕組みを実装していたときにはラズベリーパイというキーワードはまったく頭の中になかった。他者の視点が加わるから新しいアイディアが広がる。</p></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0612/>ネットワークからスマートプラグの制御</a></h1><div class=post-meta><time class=post-date>2023-06-12</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;</span><div class=post-content><p>昨日は夕方に親が立ち寄るかもしれないというから待機していたのに空振りに終わった。0時に寝ようとしてあまり眠れなくて7時に起きた。ここ最近寝ているのか寝てないのかよく分からない眠り方になる。</p><h2 id=決済してスマートプラグを-on-にしろ>決済してスマートプラグを ON にしろ</h2><p><a href=/diary/posts/2023/0611/>昨日の続き</a> 。夕方に <a href=https://www.tp-link.com/jp/home-networking/smart-plug/tapo-p105/>Tapo P105</a> が届いたので業務を終えてからさっそく使ってみた。</p><figure><img src=/diary/img/2023/0612_smartplug.jpeg></figure><p>オフィスの wifi に接続して、tp-link 社のスマホアプリからデバイス登録する。スマホアプリからはすぐに on/off できた。スマホで電源の on/off を制御できてあまり嬉しいことはパッと思いつかないけど、プログラムから制御できるならなにか遊べそうな気もしてくる。<a href=https://ifttt.com>ifttt</a> というインテグレーションサービスがあって、それを使うと tp-link 社のデバイスと ifttt 社の web api 経由で制御できる。おそらくなんらかの web api が tp-link 社からも提供されているはず。それが公開されていれば ifttt を使う必要はないし、すでにハックされているものを使うのでもよいかもしれない。ひとまず動かすことを目的とするので ifttt を使う。スマートプラグに電球をつなげて、決済したら電球が灯って3秒後に消えるようなサンプルアプリを作った。一通り最後まで動かすことができておもしろかった。</p><ul><li><a href=https://github.com/kazamori/stripe-webhook-sample>https://github.com/kazamori/stripe-webhook-sample</a></li></ul></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0611/>スマートプラグ制御の調査</a></h1><div class=post-meta><time class=post-date>2023-06-11</time></div><span class=post-tags>#<a href=/diary/tags/smartplug/>smartplug</a>&nbsp;
#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/kobe/>kobe</a>&nbsp;
#<a href=/diary/tags/food/>food</a>&nbsp;</span><div class=post-content><p>23時に寝てうまく眠れなくて5時に起きた。そのまま10時ぐらいまでだらだらしてた。</p><h2 id=スマートプラグの通電テスター>スマートプラグの通電テスター</h2><p><a href=/diary/posts/2023/0610/>昨日の続き</a> 。スマートプラグを検索すると TP-Link 社の製品がよく出てくるのでミニスマート wi-fi プラグの <a href=https://www.tp-link.com/jp/home-networking/smart-plug/tapo-p105/>Tapo P105</a> を購入してみた。この製品だとネットワーク経由で電源の on/off ができそう。ifttt というサービスが <a href=https://ifttt.com/tplink_tapo>TP-Link Tapo</a> インテグレーションを公開している。TP-Link 社も自前で <a href=https://www.tplinkcloud.com/>TP-LINK Cloud</a> というサービスを提供していて、どうやらその web api は公開されていないようだけど、おそらくそこで使っている web api を調べてライブラリにしたのが <a href=https://www.npmjs.com/package/tplink-cloud-api>tplink-cloud-api</a> のようにみえる。サイトをみる限りはカメラしかサポートしていないようにもみえる。スマートプラグのようなデバイスがハックしやすい性質のせいか、書いてある情報が曖昧で実際にどうやってデバイスを制御したらよいのかネット上の記事からよくわからない。実際に購入したもので試してみるのが早そう。明日届く予定。</p><p>このスマートプラグによる電源 on/off のテスターに、ダイソーで電球を購入してきた。電源ソケットアダプタが100円、電球は100円、200円、300円とそれぞれあったんだけど、100円の差異でどうせ買うなら精度のよいものをと考えて300円のものを購入した。LED で電力消費も少ない。</p><figure><img src=/diary/img/2023/0611_light.jpeg></figure><p>試しにオフィスにあった amazon 純正スマートプラグ経由で接続して alexa アプリで on/off したら意図したように電球が灯ってテスターの代替にできた。デモのために使うのでそれぐらいわかりやすいのがよい。</p><h2 id=モロゾフ>モロゾフ</h2><p>昨日参加したもくもく会を借りていた <a href=https://www.kobe-bunka.jp/facilities/chuo/>中央区文化センター</a> には2フロアに渡って大小いくつかの会議室がある。それぞれの会議室には張り紙をしていて借り主の名前が外からわかる。たまたま通ったところに「モロゾフ労働組合」と書いてあって、どこかの会社の労組が会議しているんだなと覚えていた。今日になって来週の東京出張のお土産を探していたらモロゾフというお店があることに気付いた。<a href=https://www.morozoff.co.jp/company_ir/history_index.html>モロゾフの歩み</a> によると1931年創業の神戸本店の洋菓子の会社らしい。これもなにかの縁だと思って今回はモロゾフさんの神戸本店へ行って <a href=https://www.morozoff.co.jp/products/baked_sweets/15_3/>ブロードランド 15個入</a> をお土産用に購入した。</p><p>自分用にアーモンドケーキを買って食べてみた。しっとり食感で控え目にアーモンドの風味がして甘過ぎなくて後味のよいケーキでおいしかった。</p><figure><img src=/diary/img/2023/0611_armond-cake.png></figure></div></article><article class="post on-list"><h1 class=post-title><a href=/diary/posts/2023/0521/>yubikey bio を完全にマスターした</a></h1><div class=post-meta><time class=post-date>2023-05-21</time></div><span class=post-tags>#<a href=/diary/tags/device/>device</a>&nbsp;
#<a href=/diary/tags/pam/>pam</a>&nbsp;
#<a href=/diary/tags/auth/>auth</a>&nbsp;
#<a href=/diary/tags/security/>security</a>&nbsp;</span><div class=post-content><p>2時に寝て遅くまで飲んでいたせいか、やや吐き気もしながら朝起きてだらだらして11時ぐらいに起きた。</p><h2 id=1password-のロック解除を-yubikey-で行う>1password のロック解除を yubikey で行う</h2><p>先日購入して触っていた <a href=/diary/posts/2023/0429/#yubikey-bio-を触ってみた>yubikey bio の設定</a> の続き。1password のロック解除を指紋認証で行いたかったが、1password の 8.10.4 のアプリではロック解除をシステム認証で行おうとするとエラーが発生していた (バグってた) 。5月の頭に <a href=https://releases.1password.com/linux/8.10/#1password-for-linux-8.10.6>8.10.6</a> がリリースされていてシステム認証のバグが直っていることに気付いた。1password のアプリケーションがどうやって linux のシステム認証を使っているかは次の1文に書いてある。</p><blockquote><p>システム認証は、Linux のユーザーアカウントに組み込まれたアクセス制御機構を使用します。これは polkit と PAM (Pluggable Authentication Modules) という2つの Linux 標準に依存しています。この2つを組み合わせることで、安全な認証サービスを提供します</p><p><a href=https://support.1password.com/system-authentication-linux/#about-system-authentication-security>https://support.1password.com/system-authentication-linux/#about-system-authentication-security</a></p></blockquote><p>私は <a href=https://wiki.archlinux.org/title/Polkit>polkit</a> を使ったことがなくて初見でよく分かっていないが、どうやら polkit から pam を介して認証しているようにみえる。pam.d 配下の設定を調べてみると <code>/etc/pam.d/polkit-1</code> がある。前回の設定で pam.d の設定とテストの方法を理解していた。ここまでくれば <a href=https://github.com/Yubico/pam-u2f/tree/main#module-arguments>Module Arguments</a> のドキュメントをみながらオプションを設定するだけ。<a href=https://yoshiori.hatenablog.com/entry/2022/02/17/173147>1Password のロック解除をYubiKeyでやる</a> の記事で origin/appid にホスト名を指定しているが、最新のモジュールだと指定しないときはデフォルトでホスト名が使われるようにみえる。</p><ul><li>origin: FIDO 認証手順の party ID を設定する、値が指定されない場合は識別子 <code>pam://$HOSTNAME</code> が使用される</li><li>appid: FIDO 認証手順の application ID を設定する、値を指定しない場合は origin で使用されたものと同じ値が使用される (origin も指定しない場合は <code>pam://$HOSTNAME</code>)</li><li>nouserok: 認証しようとするユーザーが <code>authfile</code> 内に存在しない場合や <code>authfile</code> が欠落/不正確な場合でも、認証の試行を成功させるように設定する</li><li>cue: タッチすることを促すメッセージを表示するように設定する</li></ul><p>これらを踏まえて u2f で認証が成功したらそれ以降の処理をスキップするように次の設定を先頭に追加する。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo vi /etc/pam.d/polkit-1
</span></span><span style=display:flex><span>auth   sufficient   pam_u2f.so nouserok cue
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>cue を指定したことでパスワードプロンプトを表示せず、デバイスをタッチするように促される。よい感じ。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pamtester polkit-1 t2y authenticate
</span></span><span style=display:flex><span>Please touch the device.
</span></span><span style=display:flex><span>pamtester: successfully authenticated
</span></span></code></pre></div><p>これで pam の polkit の設定が正しいことを検証できる。この後に 1password のアプリケーションでロック解除するときに u2f を使って指紋認証できた。めっちゃ便利。</p><figure><img src=/diary/img/2023/0521_1password-system-auth.png></figure></div></article><div class=pagination><div class=pagination__buttons><a href=/diary/tags/device/ class="button previous"><span class=button__icon>←</span>
<span class=button__text>最近の日記</span>
</a><a href=/diary/tags/device/page/3/ class="button next"><span class=button__text>過去の日記</span>
<span class=button__icon>→</span></a></div></div></div></div><footer class=footer><div class=footer__inner><div class=copyright><span>© 2024 Powered by <a href=https://gohugo.io>Hugo</a></span>
<span>:: <a href=https://github.com/panr/hugo-theme-terminal target=_blank>Theme</a> made by <a href=https://github.com/panr target=_blank>panr</a></span></div></div></footer><script type=text/javascript src=/diary/bundle.min.js></script></div></body></html>